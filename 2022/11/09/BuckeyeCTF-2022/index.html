

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/banner/piano_man.png">
  <link rel="icon" href="/banner/piano_man.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="lanpesk">
  <meta name="keywords" content="">
  
    <meta name="description" content="null太难了打不动… 这个比赛还是学到了点密码学的知识的。">
<meta property="og:type" content="article">
<meta property="og:title" content="BuckeyeCTF 2022">
<meta property="og:url" content="http://example.com/2022/11/09/BuckeyeCTF-2022/index.html">
<meta property="og:site_name" content="lanpesk">
<meta property="og:description" content="null太难了打不动… 这个比赛还是学到了点密码学的知识的。">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2022-11-09T05:49:37.000Z">
<meta property="article:modified_time" content="2022-11-09T05:51:34.733Z">
<meta property="article:author" content="lanpesk">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="writeup">
<meta property="article:tag" content="Crypto">
<meta property="article:tag" content="Reverse">
<meta name="twitter:card" content="summary_large_image">
  
  
  <title>BuckeyeCTF 2022 - lanpesk</title><meta name="robots" content="noindex">

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4/github-markdown.min.css" />
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hint.css@2/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.css" />
  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.8.14","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.2"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>lanpesk</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                友链
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('https://s2.loli.net/2022/05/01/YwbfzI9vkWMaVc2.jpg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="BuckeyeCTF 2022">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2022-11-09 13:49" pubdate>
        2022年11月9日 下午
      </time>
    </span>
  
</div>

<div class="mt-1">
  

  

  
  
    
      <!-- 不蒜子统计文章PV -->
      <span id="busuanzi_container_page_pv" style="display: none">
        <i class="iconfont icon-eye" aria-hidden="true"></i>
        <span id="busuanzi_value_page_pv"></span> 次
      </span>
    
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">BuckeyeCTF 2022</h1>
            
            <div class="markdown-body">
              <p>null太难了打不动…</p>
<p>这个比赛还是学到了点密码学的知识的。</p>
<span id="more"></span>
<p>暂时只做了密码学和逆向。</p>
<h2 id="crypto"><a class="markdownIt-Anchor" href="#crypto"></a> Crypto</h2>
<h3 id="megaxord"><a class="markdownIt-Anchor" href="#megaxord"></a> megaxord</h3>
<figure class="highlight applescript"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><pre><code class="hljs applescript">Some pesky wizard stole <span class="hljs-keyword">the</span> article I was writing. I got <span class="hljs-keyword">it</span> <span class="hljs-keyword">back</span>, <span class="hljs-keyword">but</span> <span class="hljs-keyword">it</span>&#x27;s all messed up now :(<br><br>Hint: <span class="hljs-keyword">the</span> wizard used <span class="hljs-keyword">the</span> same magic <span class="hljs-keyword">on</span> <span class="hljs-keyword">every</span> <span class="hljs-built_in">character</span>...<br></code></pre></td></tr></table></figure>
<p>打开文件看一眼：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">7</span>/=*x<br><span class="hljs-attribute">96</span>?=*+x1+x96x5=*<span class="hljs-number">1</span>;<span class="hljs-number">96</span>x=<span class="hljs-number">6</span>,=*,<span class="hljs-number">9165</span>=<span class="hljs-number">6</span>,x96&lt;x5=*;<span class="hljs-number">096</span>&lt;<span class="hljs-number">1</span>+<span class="hljs-number">16</span>?x&gt;*<span class="hljs-number">96</span>;<span class="hljs-number">01</span>+=x:-<span class="hljs-number">14</span>,x9*<span class="hljs-number">7</span>-<span class="hljs-number">6</span>&lt;x9x41.=u9;,<span class="hljs-number">176</span>x+-(=*<span class="hljs-number">0</span>=*<span class="hljs-number">7</span>x,=<span class="hljs-number">4</span>=.<span class="hljs-number">1</span>+<span class="hljs-number">176</span>x+=*<span class="hljs-number">1</span>=+tx:<span class="hljs-number">9</span>+=&lt;x76x,<span class="hljs-number">0</span>=x9(<span class="hljs-number">96</span>=+=x,<span class="hljs-number">73</span>-+<span class="hljs-number">9</span>,+-x&gt;*<span class="hljs-number">96</span>;<span class="hljs-number">01</span>+=x-(=*x=<span class="hljs-number">6</span>,<span class="hljs-number">91</span>vx*<span class="hljs-number">7</span>&lt;-;=&lt;x&gt;<span class="hljs-number">1</span>*+,x:!x9:<span class="hljs-number">96</span>x6,=*,<span class="hljs-number">9165</span>=<span class="hljs-number">6</span>,tx+=;<span class="hljs-number">76</span>&lt;x:!xx6,=*,<span class="hljs-number">9165</span>=<span class="hljs-number">6</span>,tx49,=*x:!x9:<span class="hljs-number">96</span>x*<span class="hljs-number">96</span>&lt;+tx96&lt;x,<span class="hljs-number">7</span>&lt;<span class="hljs-number">9</span>!x:!xx7/=*x<br></code></pre></td></tr></table></figure>
<p>猜测是异或加密。取第一行作为样本，来爆破密钥。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.strxor <span class="hljs-keyword">import</span> strxor<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">r&quot;megaxord.txt&quot;</span>, <span class="hljs-string">&quot;rb&quot;</span>) <span class="hljs-keyword">as</span> fp:<br>    raw = fp.read()<br>    data = raw.splitlines()<br><br>test = data[<span class="hljs-number">0</span>]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">255</span>):<br>    <span class="hljs-built_in">print</span>(i, strxor(<span class="hljs-built_in">bytes</span>([i])*<span class="hljs-built_in">len</span>(test), test))<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">85 b&#x27;]bzh\x7f-&#x27;</span><br><span class="hljs-string">86 b&#x27;^ayk|.&#x27;</span><br><span class="hljs-string">87 b&#x27;_`xj&#125;/&#x27;</span><br><span class="hljs-string">88 b&#x27;Power &#x27;</span><br><span class="hljs-string">89 b&#x27;Qnvds!&#x27;</span><br><span class="hljs-string">90 b&#x27;Rmugp&quot;&#x27;</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><span class="hljs-built_in">print</span>(strxor(<span class="hljs-built_in">bytes</span>([<span class="hljs-number">88</span>])*<span class="hljs-built_in">len</span>(raw), raw))<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">The New Zealand Herald published on March 7, 2009, identified RPM as the last season of the Power Rangers run. </span><br><span class="hljs-string">Production manager Sally Campbell stated in an interview, &quot;...at this stage we will not be shooting another </span><br><span class="hljs-string">season.&quot;[buckeye&#123;m1gh7y_m0rph1n_w1k1p3d14_p4g3&#125;][23] A September</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><span class="hljs-comment"># buckeye&#123;m1gh7y_m0rph1n_w1k1p3d14_p4g3&#125;</span><br></code></pre></td></tr></table></figure>
<h3 id="twin-prime-rsa"><a class="markdownIt-Anchor" href="#twin-prime-rsa"></a> Twin prime RSA</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> Crypto.Util.number <span class="hljs-keyword">as</span> cun<br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    p = cun.getPrime(<span class="hljs-number">1024</span>)<br>    q = p + <span class="hljs-number">2</span><br>    <span class="hljs-keyword">if</span> cun.isPrime(q):<br>        <span class="hljs-keyword">break</span><br><br>n = p * q<br>e = <span class="hljs-number">0x10001</span><br><br>phi = (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>)<br>d = <span class="hljs-built_in">pow</span>(e, -<span class="hljs-number">1</span>, phi)<br><br>FLAG = cun.bytes_to_long(<span class="hljs-string">b&quot;buckeye&#123;?????????????????????????????????????????????????????????????&#125;&quot;</span>)<br>c = <span class="hljs-built_in">pow</span>(FLAG, e, n)<br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">pow</span>(c, d, n) == FLAG<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;n = <span class="hljs-subst">&#123;n&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;c = <span class="hljs-subst">&#123;c&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure>
<p>开方求解。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> iroot, invert<br><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span> nextprime, prevprime<br><br>n = ...<br>c = ...<br>e = <span class="hljs-number">0x10001</span><br><br>sqrt = <span class="hljs-built_in">int</span>(iroot(n, <span class="hljs-number">2</span>)[<span class="hljs-number">0</span>])<br><br><span class="hljs-keyword">if</span> isPrime(sqrt):<br>    p = sqrt<br>    q = nextprime(p)<br><span class="hljs-keyword">else</span>:<br>    p = prevprime(sqrt)<br>    q = nextprime(sqrt)<br><br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">abs</span>(p-q) == <span class="hljs-number">2</span><br><br>d = <span class="hljs-built_in">int</span>(invert(e, (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)))<br><br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">pow</span>(c,d,n)))<br><br><span class="hljs-comment"># b&#x27;buckeye&#123;B3_TH3R3_OR_B3_SQU4R3__abcdefghijklmonpqrstuvwxyz__0123456789&#125;&#x27;</span><br><span class="hljs-comment"># buckeye&#123;B3_TH3R3_OR_B3_SQU4R3__abcdefghijklmonpqrstuvwxyz__0123456789&#125;</span><br></code></pre></td></tr></table></figure>
<h3 id="fastfor"><a class="markdownIt-Anchor" href="#fastfor"></a> fastfor</h3>
<p>这题不知道他在考什么…</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-keyword">import</span> numpy<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">check_hash</span>(<span class="hljs-params">fi</span>):<br>    image = numpy.asarray(Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;static/IMG.png&#x27;</span>))<br>    submission = numpy.asarray(Image.<span class="hljs-built_in">open</span>(fi))<br>    <span class="hljs-keyword">if</span> image.shape != submission.shape:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    same = numpy.bitwise_xor(image, submission)<br>    <span class="hljs-keyword">if</span> (numpy.<span class="hljs-built_in">sum</span>(same) == <span class="hljs-number">0</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    im_alt = numpy.fft.fftn(image)<br>    in_alt = numpy.fft.fftn(submission)<br>    im_hash = numpy.std(im_alt)<br>    in_hash = numpy.std(in_alt)<br>    <span class="hljs-keyword">if</span> im_hash - in_hash &lt; <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> im_hash - in_hash &gt; -<span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br></code></pre></td></tr></table></figure>
<p>就是算了一下两个的n维傅里叶变换的值，判断前后的差值是否在1中。但实际上我只要修改一个点就过了。而且由于浮点数精度的问题。傅里叶和还是一样的。</p>
<p>这题有个web网页。IMG.png是从网站上拔下来的。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy<br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><br>image = numpy.array(Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;IMG.png&#x27;</span>))<br>fixed = image.copy()<br>fixed[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] = image[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] - <span class="hljs-number">100</span><br><br><span class="hljs-built_in">print</span>(fixed[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>][<span class="hljs-number">0</span>])<br><span class="hljs-built_in">print</span>(image[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>][<span class="hljs-number">0</span>])<br>im_alt = numpy.fft.fftn(image)<br>im_hash = numpy.std(im_alt)<br><br><span class="hljs-built_in">print</span>(im_hash)<br><br>in_alt = numpy.fft.fftn(fixed)<br>in_hash = numpy.std(in_alt)<br><br><span class="hljs-built_in">print</span>(in_hash)<br><br>same = numpy.bitwise_xor(image, fixed)<br><span class="hljs-keyword">if</span> (numpy.<span class="hljs-built_in">sum</span>(same) == <span class="hljs-number">0</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;NO&quot;</span>)<br><br><br>im = Image.fromarray(fixed)<br>im.save(<span class="hljs-string">&quot;fixed.png&quot;</span>)<br><br><span class="hljs-comment"># buckeye&#123;D33p_w0Rk_N07_WhY_574ND4RD_d3V&#125;</span><br></code></pre></td></tr></table></figure>
<h3 id="powerball"><a class="markdownIt-Anchor" href="#powerball"></a> powerball</h3>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">What could go wrong <span class="hljs-keyword">using</span> <span class="hljs-keyword">a</span> Linear Congruential Generator <span class="hljs-built_in">to</span> <span class="hljs-built_in">get</span> some <span class="hljs-built_in">random</span> numbers?<br></code></pre></td></tr></table></figure>
<p>直接告诉你是LCG问题。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> express <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;express&#x27;</span><br><span class="hljs-keyword">import</span> http <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;http&#x27;</span><br><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">Server</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;socket.io&#x27;</span><br><span class="hljs-keyword">import</span> crypto <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;crypto&#x27;</span><br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">nextRandomNumber</span> () &#123;<br>  <span class="hljs-keyword">return</span> (multiplier * seed) % modulus<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">areArraysEqual</span> (a, b) &#123;<br>  <span class="hljs-keyword">return</span> (<br>    a.<span class="hljs-property">length</span> === b.<span class="hljs-property">length</span> &amp;&amp;<br>    a.<span class="hljs-title function_">every</span>(<span class="hljs-function">(<span class="hljs-params">x, i</span>) =&gt;</span> &#123;<br>      <span class="hljs-keyword">return</span> x === b[i]<br>    &#125;)<br>  )<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">seedToBalls</span> (n) &#123;<br>  <span class="hljs-keyword">const</span> balls = []<br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) &#123;<br>    balls.<span class="hljs-title function_">push</span>(<span class="hljs-title class_">Number</span>(n % <span class="hljs-number">100n</span>))<br>    n = n / <span class="hljs-number">100n</span><br>  &#125;<br>  <span class="hljs-keyword">return</span> balls<br>&#125;<br><br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>()<br>app.<span class="hljs-title function_">use</span>(express.<span class="hljs-title function_">static</span>(<span class="hljs-string">&#x27;static&#x27;</span>))<br><br><span class="hljs-keyword">const</span> server = http.<span class="hljs-title function_">createServer</span>(app)<br><span class="hljs-keyword">const</span> io = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Server</span>(server)<br><br><span class="hljs-keyword">const</span> modulus = crypto.<span class="hljs-title function_">generatePrimeSync</span>(<span class="hljs-number">128</span>, &#123; <span class="hljs-attr">safe</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">bigint</span>: <span class="hljs-literal">true</span> &#125;)<br><span class="hljs-keyword">const</span> multiplier = (<span class="hljs-number">2n</span> ** <span class="hljs-number">127n</span>) - <span class="hljs-number">1n</span><br><span class="hljs-keyword">let</span> seed = <span class="hljs-number">2n</span><br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1024</span>; i++) &#123;<br>  seed = <span class="hljs-title function_">nextRandomNumber</span>()<br>&#125;<br><span class="hljs-keyword">let</span> winningBalls = <span class="hljs-title function_">seedToBalls</span>(seed)<br><span class="hljs-keyword">let</span> lastLotteryTime = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()<br><br><span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>  seed = <span class="hljs-title function_">nextRandomNumber</span>()<br>  winningBalls = <span class="hljs-title function_">seedToBalls</span>(seed)<br>  lastLotteryTime = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()<br>&#125;, <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>)<br><br>io.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;connection&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> &#123;<br>  socket.<span class="hljs-property">ticket</span> = &#123; <span class="hljs-attr">balls</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>], <span class="hljs-attr">submissionTime</span>: <span class="hljs-number">0</span> &#125;<br><br>  socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;updateRequest&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-keyword">let</span> flag = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">if</span> (<br>      <span class="hljs-title function_">areArraysEqual</span>(socket.<span class="hljs-property">ticket</span>.<span class="hljs-property">balls</span>, winningBalls) &amp;&amp;<br>      socket.<span class="hljs-property">ticket</span>.<span class="hljs-property">submissionTime</span> &lt; lastLotteryTime<br>    ) &#123;<br>      flag = process.<span class="hljs-property">env</span>.<span class="hljs-property">FLAG</span><br>    &#125;<br><br>    socket.<span class="hljs-title function_">emit</span>(<span class="hljs-string">&#x27;update&#x27;</span>, &#123;<br>      <span class="hljs-attr">last_winning_seed</span>: seed.<span class="hljs-title function_">toString</span>(),<br>      <span class="hljs-attr">flag</span>: flag<br>    &#125;)<br>  &#125;)<br><br>  socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;submitBalls&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">balls</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">if</span> (!(<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(balls) &amp;&amp; balls.<span class="hljs-property">length</span> === <span class="hljs-number">10</span>)) <span class="hljs-keyword">return</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) &#123;<br>      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> balls[i] !== <span class="hljs-string">&#x27;number&#x27;</span>) <span class="hljs-keyword">return</span><br>    &#125;<br><br>    socket.<span class="hljs-property">ticket</span> = &#123; <span class="hljs-attr">balls</span>: balls, <span class="hljs-attr">submissionTime</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() &#125;<br>  &#125;)<br>&#125;)<br><br>server.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Ready&#x27;</span>)<br>&#125;)<br></code></pre></td></tr></table></figure>
<p>这题也算半个web了。f12控制台会放出seed的信息。</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;last_winning_seed&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;118531139462567680237383046608527171358&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;flag&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>
<p>等个几个分钟，多收集一点seed序列。</p>
<p>这个序列的长度不固定，有可能你运气好4个就够了，这次我用了8个才出正确的结果。一直添加直到能过检查。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> math <span class="hljs-keyword">import</span> gcd<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> functools <span class="hljs-keyword">import</span> reduce<br><span class="hljs-keyword">from</span> libnum <span class="hljs-keyword">import</span> n2s<br><br><br>Xn = [<span class="hljs-number">95306060132134274034264579463842889279</span>, <span class="hljs-number">129883182640808436703118317079255328712</span>, <span class="hljs-number">116962711139558921267457520653198681598</span>, <span class="hljs-number">46574140996987716764198865501432463924</span>,<br>      <span class="hljs-number">248115531362286822224564168433858654366</span>, <span class="hljs-number">157763231920003498467573503185948866818</span>, <span class="hljs-number">174267870530630061122438873970235742109</span>, <span class="hljs-number">134449749791170055602523013022475444442</span>]<br>mul = <span class="hljs-number">2</span>**<span class="hljs-number">127</span> -<span class="hljs-number">1</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">crack_unknown_modulus</span>(<span class="hljs-params">states</span>):<br>    diffs = [s1 - s0 <span class="hljs-keyword">for</span> s0, s1 <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(states, states[<span class="hljs-number">1</span>:])]<br>    zeroes = [t2*t0 - t1*t1 <span class="hljs-keyword">for</span> t0, t1, t2 <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(diffs, diffs[<span class="hljs-number">1</span>:], diffs[<span class="hljs-number">2</span>:])]<br>    modulus = <span class="hljs-built_in">abs</span>(reduce(gcd, zeroes))<br>    <span class="hljs-keyword">return</span> modulus<br><br>n = crack_unknown_modulus(Xn)<br><span class="hljs-keyword">assert</span> isPrime(n) <span class="hljs-keyword">and</span> n.bit_length() == <span class="hljs-number">128</span><br><span class="hljs-built_in">print</span>(n)<br><br>next_number = <span class="hljs-keyword">lambda</span> x: mul*x % n<br><br>winner = next_number(<span class="hljs-number">71129646383219012561794335952713553500</span>)<br><span class="hljs-built_in">print</span>(winner)<br>numbers = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>    numbers.append(winner % <span class="hljs-number">100</span>)<br>    winner //= <span class="hljs-number">100</span><br><br><span class="hljs-built_in">print</span>(numbers)<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">282197447588972913465964086601636273787</span><br><span class="hljs-string">214505068864644244632829240151367451760</span><br><span class="hljs-string">[60, 17, 45, 67, 13, 15, 40, 92, 82, 32]</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br></code></pre></td></tr></table></figure>
<p>把这个序列输入到网站中等待下一次刷新即可。</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;last_winning_seed&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;214505068864644244632829240151367451760&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;flag&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;buckeye&#123;y3ah_m4yb3_u51nG_A_l1N34r_c0nGru3Nt1al_G3n3r4t0r_f0r_P0w3rB4lL_wA5nt_tH3_b3st_1d3A&#125;&quot;</span><br><span class="hljs-punctuation">&#125;</span><br><br><span class="hljs-comment">// buckeye&#123;y3ah_m4yb3_u51nG_A_l1N34r_c0nGru3Nt1al_G3n3r4t0r_f0r_P0w3rB4lL_wA5nt_tH3_b3st_1d3A&#125;</span><br></code></pre></td></tr></table></figure>
<h3 id="ssshit"><a class="markdownIt-Anchor" href="#ssshit"></a> SSSHIT</h3>
<p>算是有意思的一题。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> Crypto.Util.number <span class="hljs-keyword">as</span> cun<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> ast<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">evaluate_polynomial</span>(<span class="hljs-params">polynomial: <span class="hljs-built_in">list</span>, x: <span class="hljs-built_in">int</span>, p: <span class="hljs-built_in">int</span></span>):<br>    <span class="hljs-keyword">return</span> (<br>        <span class="hljs-built_in">sum</span>(<br>            (coefficient * <span class="hljs-built_in">pow</span>(x, i, p)) % p <span class="hljs-keyword">for</span> i, coefficient <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(polynomial)<br>        )<br>        % p<br>    )<br><br><br>N_SHARES = <span class="hljs-number">3</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-built_in">print</span>(<br>        <span class="hljs-string">f&quot;I wrote down a list of people who are allowed to get the flag and split it into <span class="hljs-subst">&#123;N_SHARES&#125;</span> using Shamir&#x27;s Secret Sharing.&quot;</span><br>    )<br>    MESSAGE = cun.bytes_to_long(<span class="hljs-string">b&quot;qxxxb, BuckeyeCTF admins, and NOT YOU&quot;</span>)<br><br>    p = cun.getPrime(<span class="hljs-number">512</span>)<br><br>    polynomial = [MESSAGE] + [random.randrange(<span class="hljs-number">1</span>, p) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(N_SHARES - <span class="hljs-number">1</span>)]<br>    points = [(i, evaluate_polynomial(polynomial, i, p)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, N_SHARES + <span class="hljs-number">1</span>)]<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Your share is:&quot;</span>)<br>    <span class="hljs-built_in">print</span>(points[<span class="hljs-number">0</span>])<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;The other shares are:&quot;</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(points)):<br>        <span class="hljs-built_in">print</span>(points[i])<br><br>    <span class="hljs-built_in">print</span>()<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Now submit your share for reconstruction:&quot;</span>)<br>    your_input = ast.literal_eval(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;&gt;&gt;&gt; &quot;</span>))<br>    <span class="hljs-keyword">if</span> (<br>        <span class="hljs-built_in">type</span>(your_input) <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">tuple</span><br>        <span class="hljs-keyword">or</span> <span class="hljs-built_in">len</span>(your_input) != <span class="hljs-number">2</span><br>        <span class="hljs-keyword">or</span> <span class="hljs-built_in">type</span>(your_input[<span class="hljs-number">0</span>]) <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">int</span><br>        <span class="hljs-keyword">or</span> <span class="hljs-built_in">type</span>(your_input[<span class="hljs-number">1</span>]) <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">int</span><br>        <span class="hljs-keyword">or</span> your_input[<span class="hljs-number">0</span>] != <span class="hljs-number">1</span><br>        <span class="hljs-keyword">or</span> <span class="hljs-keyword">not</span> (<span class="hljs-number">0</span> &lt;= your_input[<span class="hljs-number">1</span>] &lt; p)<br>    ):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Bad input&quot;</span>)<br>        <span class="hljs-keyword">return</span><br><br>    points[<span class="hljs-number">0</span>] = your_input<br><br>    xs = [point[<span class="hljs-number">0</span>] <span class="hljs-keyword">for</span> point <span class="hljs-keyword">in</span> points]<br>    ys = [point[<span class="hljs-number">1</span>] <span class="hljs-keyword">for</span> point <span class="hljs-keyword">in</span> points]<br><br>    y_intercept = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(N_SHARES):<br>        product = <span class="hljs-number">1</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(N_SHARES):<br>            <span class="hljs-keyword">if</span> i != j:<br>                product = (product * xs[i] * <span class="hljs-built_in">pow</span>(xs[i] - xs[j], -<span class="hljs-number">1</span>, p)) % p<br>        y_intercept = (y_intercept + ys[j] * product) % p<br><br>    reconstructed_message = cun.long_to_bytes(y_intercept)<br>    <span class="hljs-keyword">if</span> reconstructed_message == <span class="hljs-string">b&quot;qxxxb, BuckeyeCTF admins, and ME&quot;</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Here&#x27;s your flag:&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;buckeye&#123;?????????????????????????????????????????&#125;&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Sorry, only these people can see the flag: <span class="hljs-subst">&#123;reconstructed_message&#125;</span>&quot;</span>)<br><br><br>main()<br></code></pre></td></tr></table></figure>
<p>简单来说就是要求我们输入一个新的秘密分片。从而将解的的秘密修改。但是我们不知道模数，这点就很烦了。</p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs 1c">I wrote down a list of people who are allowed to get the flag and split it into <span class="hljs-number">3</span> using Shamir&#x27;s Secret Sharing.<br>Your share is:<br>(1, <span class="hljs-number">46068418407926</span><span class="hljs-number">55741097335098</span><span class="hljs-number">61536210561124</span><span class="hljs-number">10600905797687</span><span class="hljs-number">29749798744970</span><span class="hljs-number">45385709622231</span><span class="hljs-number">94916820079644</span><span class="hljs-number">47453172274966</span><span class="hljs-number">99193071609729</span><span class="hljs-number">42363087885319</span><span class="hljs-number">66428690778079</span>)<br>The other shares are:<br>(2, <span class="hljs-number">47563540743732</span><span class="hljs-number">37467895340117</span><span class="hljs-number">57830860359514</span><span class="hljs-number">07143417605255</span><span class="hljs-number">73566385495771</span><span class="hljs-number">53226781516543</span><span class="hljs-number">21093464930258</span><span class="hljs-number">85413182472403</span><span class="hljs-number">09512687411719</span><span class="hljs-number">26934695225899</span><span class="hljs-number">16267535361022</span>)<br>(3, <span class="hljs-number">44853670074174</span><span class="hljs-number">51803940150568</span><span class="hljs-number">88839493951698</span><span class="hljs-number">96275354227053</span><span class="hljs-number">14497603088347</span><span class="hljs-number">95408073603079</span><span class="hljs-number">15780636077898</span><span class="hljs-number">86031832442704</span><span class="hljs-number">31724096406965</span><span class="hljs-number">89000830542897</span><span class="hljs-number">818091332497</span>8)<br><br>Now submit your share for reconstruction:<br>&gt;&gt;&gt;<br></code></pre></td></tr></table></figure>
<p>现在我们直到三个密文，和三个x。对于这个x，我们在其解密算法中有：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>    product = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>        <span class="hljs-keyword">if</span> i != j:<br>            <span class="hljs-built_in">print</span>(xs[i], xs[i] - xs[j])<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n&quot;</span>)<br>        <br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">2 1</span><br><span class="hljs-string">3 2</span><br><span class="hljs-string">1 -1</span><br><span class="hljs-string">3 1</span><br><span class="hljs-string">1 -2</span><br><span class="hljs-string">2 -1</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>
<p>那么其算法就为：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>2</mn><mo>∗</mo><msup><mn>1</mn><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>∗</mo><mn>3</mn><mo>∗</mo><msup><mn>2</mn><mrow><mo>−</mo><mn>1</mn></mrow></msup><msub><mi>y</mi><mn>1</mn></msub><mo>+</mo><mn>1</mn><mo>∗</mo><mo stretchy="false">(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>∗</mo><mn>3</mn><mo>∗</mo><msup><mn>1</mn><mrow><mo>−</mo><mn>1</mn></mrow></msup><msub><mi>y</mi><mn>2</mn></msub><mo>+</mo><mn>1</mn><mo>∗</mo><mo stretchy="false">(</mo><mo>−</mo><mn>2</mn><msup><mo stretchy="false">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>∗</mo><mn>2</mn><mo>∗</mo><mo stretchy="false">(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><msub><mi>y</mi><mn>3</mn></msub><mo>=</mo><mi>M</mi><mi>E</mi><mi>S</mi><mi>S</mi><mi>A</mi><mi>G</mi><mi>E</mi></mrow><annotation encoding="application/x-tex">2*1^{-1}*3*2^{-1}y_1 + 1*(-1)^{-1}*3*1^{-1}y_2 + 1*(-2)^{-1}*2*(-1)^{-1}y_3 = MESSAGE
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.864108em;vertical-align:0em;"></span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.058548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">−</span><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.058548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">−</span><span class="mord">2</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">−</span><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">A</span><span class="mord mathdefault">G</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span></span></span></span></span></p>
<p>化简为：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>3</mn><msub><mi>y</mi><mn>1</mn></msub><mo>−</mo><mn>3</mn><msub><mi>y</mi><mn>2</mn></msub><mo>+</mo><msub><mi>y</mi><mn>3</mn></msub><mo>=</mo><mi>M</mi><mi>E</mi><mi>S</mi><mi>S</mi><mi>A</mi><mi>G</mi><mi>E</mi></mrow><annotation encoding="application/x-tex">3y_1-3y_2 + y_3 = MESSAGE
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">3</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">3</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">A</span><span class="mord mathdefault">G</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span></span></span></span></span></p>
<p>由于不存在分数。我们可以在不知道模数的情况下进行计算。</p>
<p>那么这个式子其实有三种情况。</p>
<p class='katex-block katex-error' title='ParseError: KaTeX parse error: Unknown column alignment: * at position 67: … \begin{array}{*̲*lr**}  
      …'>3y_1-3y_2 + y_3 - MESSAGE = 
\left\{  
             \begin{array}{**lr**}  
             0 &amp;  \\  
             m\\  
             km   
             \end{array}  
\right.  
</p>
<p>在下面的两种情况，我们可以求出模数m。</p>
<p>而且以这个式子为基础，我们可以修改任意的明文。</p>
<p>由于我们只能修改<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">y_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，所以这里我们设对<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">y_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>的修改为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span>,目标为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>M</mi><mi>E</mi><mi>S</mi><mi>S</mi><mi>A</mi><mi>G</mi><mi>E</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">MESSAGE2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">A</span><span class="mord mathdefault">G</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord">2</span></span></span></span>。有以下推到：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>3</mn><mo stretchy="false">(</mo><msub><mi>y</mi><mn>1</mn></msub><mo>+</mo><mi>x</mi><mo stretchy="false">)</mo><mo>−</mo><mn>3</mn><msub><mi>y</mi><mn>2</mn></msub><mo>+</mo><msub><mi>y</mi><mn>3</mn></msub><mo>=</mo><mi>M</mi><mi>E</mi><mi>S</mi><mi>S</mi><mi>A</mi><mi>G</mi><mi>E</mi><mn>2</mn><mspace linebreak="newline"></mspace><mn>3</mn><mi>x</mi><mo>+</mo><mi>M</mi><mi>E</mi><mi>S</mi><mi>S</mi><mi>A</mi><mi>G</mi><mi>E</mi><mo>=</mo><mi>M</mi><mi>E</mi><mi>S</mi><mi>S</mi><mi>A</mi><mi>G</mi><mi>E</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">3(y_1 + x)-3y_2 + y_3 = MESSAGE2 \\
3x  + MESSAGE = MESSAGE2
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">3</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">3</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">A</span><span class="mord mathdefault">G</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord">2</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">3</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">A</span><span class="mord mathdefault">G</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">A</span><span class="mord mathdefault">G</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord">2</span></span></span></span></span></p>
<p>所以我们只需要找到合适的x即可修改我们的明文。</p>
<p>但是这里有个小问题就是，我们的<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>M</mi><mi>E</mi><mi>S</mi><mi>S</mi><mi>A</mi><mi>G</mi><mi>E</mi><mn>2</mn><mo>−</mo><mi>M</mi><mi>E</mi><mi>S</mi><mi>S</mi><mi>A</mi><mi>G</mi><mi>E</mi></mrow><annotation encoding="application/x-tex">MESSAGE2 - MESSAGE</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">A</span><span class="mord mathdefault">G</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">A</span><span class="mord mathdefault">G</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span></span></span></span>他并不是三的倍数。所以我们需要使用模数对他进行修正。 因为在模m的情况下，加减m对结果是没有影响的。</p>
<p>由于环境每次都是随机的模数，所以我们多试几次就能得到满足要求的数，即可得到flag。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span> *<br><br>sh = remote(<span class="hljs-string">&quot;pwn.chall.pwnoh.io&quot;</span>, <span class="hljs-number">13382</span>)<br><br>sh.recvuntil(<span class="hljs-string">b&quot;Your share is:\n&quot;</span>)<br>point = []<br>point.append(<span class="hljs-built_in">eval</span>(sh.recvline()[:-<span class="hljs-number">1</span>]))<br><br>sh.recvline()<br>point.append(<span class="hljs-built_in">eval</span>(sh.recvline()[:-<span class="hljs-number">1</span>]))<br>point.append(<span class="hljs-built_in">eval</span>(sh.recvline()[:-<span class="hljs-number">1</span>]))<br><span class="hljs-built_in">print</span>(point)<br>sh.recvuntil(<span class="hljs-string">b&quot;&gt;&gt;&gt; &quot;</span>)<br><br>MESSAGE = bytes_to_long(<span class="hljs-string">b&quot;qxxxb, BuckeyeCTF admins, and NOT YOU&quot;</span>)<br>message = bytes_to_long(<span class="hljs-string">b&quot;qxxxb, BuckeyeCTF admins, and ME&quot;</span>)<br><br>y1,y2,y3 = point[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>],point[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>],point[<span class="hljs-number">2</span>][<span class="hljs-number">1</span>]<br><br>kp = <span class="hljs-number">3</span>*y1 - <span class="hljs-number">3</span>*y2 + y3<br><br><span class="hljs-comment"># 等于0的情况，这种情况下我们无法解</span><br><span class="hljs-keyword">if</span> kp == MESSAGE:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;This time fail&quot;</span>)<br>    exit(<span class="hljs-number">0</span>)<br><br><span class="hljs-comment"># 这种情况下我们需要手动进行yafu计算m，时间可能来不及。</span><br><span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> isPrime(<span class="hljs-number">3</span>*y1 - <span class="hljs-number">3</span>*y2 + y3 - MESSAGE):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;need factor <span class="hljs-subst">&#123;<span class="hljs-number">3</span>*y1 - <span class="hljs-number">3</span>*y2 + y3 - MESSAGE&#125;</span>&quot;</span>)<br>    exit(<span class="hljs-number">0</span>)<br><br><span class="hljs-comment"># 找到p,而且p与差值的和是三的倍数。这个我们就可以解了。</span><br>p = <span class="hljs-number">3</span>*y1 - <span class="hljs-number">3</span>*y2 + y3 - MESSAGE<br><span class="hljs-keyword">if</span> (p + message - MESSAGE) % <span class="hljs-number">3</span> == <span class="hljs-number">0</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;this is chance!&quot;</span>)<br>    sh.sendline(<span class="hljs-string">f&quot;(1,<span class="hljs-subst">&#123;y1 + (p + (message - MESSAGE)) // <span class="hljs-number">3</span>&#125;</span>)&quot;</span>.encode(<span class="hljs-string">&quot;UTF-8&quot;</span>))<br>    <span class="hljs-built_in">print</span>(sh.recvall())<br><br><br><span class="hljs-comment"># buckeye&#123;tH1s_SSS_sch3Me_c0uLd_u5e_s0M3_S1gna7Ur3s&#125;</span><br></code></pre></td></tr></table></figure>
<p>这里面这个解密算法还是需要研究研究的。在一定程度上，如果用这种解密算法的话。我们可以做到伪造任意明文。</p>
<h3 id="bonce"><a class="markdownIt-Anchor" href="#bonce"></a> bonce</h3>
<p>奇奇怪怪的一提，不难。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;sample.txt&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>    line = file.read()<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.txt&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>    flag = file.read()<br><br>samples = [line[i:i+<span class="hljs-number">28</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(line) - <span class="hljs-number">1</span> - <span class="hljs-number">28</span>, <span class="hljs-number">28</span>)]<br><br>samples.insert(random.randint(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(samples) - <span class="hljs-number">1</span>), flag)<br><br>i = <span class="hljs-number">0</span><br><span class="hljs-keyword">while</span> <span class="hljs-built_in">len</span>(samples) &lt; <span class="hljs-number">40</span>:<br>    samples.append(samples[<span class="hljs-built_in">len</span>(samples) - i - <span class="hljs-number">2</span>])<br>    i = random.randint(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(samples) - <span class="hljs-number">1</span>)<br><br>encrypted = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(samples)):<br>    x = samples[i]<br>    <span class="hljs-keyword">if</span> i &lt; <span class="hljs-number">10</span>:<br>        nonce = <span class="hljs-built_in">str</span>(i) * <span class="hljs-number">28</span><br>    <span class="hljs-keyword">else</span>:<br>        nonce = <span class="hljs-built_in">str</span>(i) * <span class="hljs-number">14</span><br>    encrypted.append(<span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-built_in">str</span>(<span class="hljs-built_in">ord</span>(a) ^ <span class="hljs-built_in">ord</span>(b)) + <span class="hljs-string">&#x27; &#x27;</span> <span class="hljs-keyword">for</span> a,b <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(x, nonce)))<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;output.txt&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">4</span>):<br>        file.write(<span class="hljs-string">&#x27;input: &#x27;</span> + samples[i] + <span class="hljs-string">&#x27;\noutput: &#x27;</span> + encrypted[i] + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>    file.write(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>, <span class="hljs-built_in">len</span>(samples)):<br>        file.write(<span class="hljs-string">&#x27;\ninput: ???\n&#x27;</span> + <span class="hljs-string">&#x27;output: &#x27;</span> + encrypted[i])<br></code></pre></td></tr></table></figure>
<p>也就是异或加密。密钥也都告诉你了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">if</span> i &lt; <span class="hljs-number">10</span>:<br>	nonce = <span class="hljs-built_in">str</span>(i) * <span class="hljs-number">28</span><br><span class="hljs-keyword">else</span>:<br>	nonce = <span class="hljs-built_in">str</span>(i) * <span class="hljs-number">14</span><br></code></pre></td></tr></table></figure>
<p>直接解就行了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">r&quot;output.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> fp:<br>    data = fp.read()<br><br>lines = data.splitlines()<br><br>lines = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">filter</span>(<span class="hljs-keyword">lambda</span> x: x.startswith(<span class="hljs-string">&quot;output: &quot;</span>), lines))<br><br>output = []<br><span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> lines:<br>    output.append(<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>,item.split()[<span class="hljs-number">1</span>:])))<br><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(output)):<br>    x = output[i]<br>    <span class="hljs-keyword">if</span> i &lt; <span class="hljs-number">10</span>:<br>        nonce = <span class="hljs-built_in">str</span>(i) * <span class="hljs-number">28</span><br>    <span class="hljs-keyword">else</span>:<br>        nonce = <span class="hljs-built_in">str</span>(i) * <span class="hljs-number">14</span><br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&quot;</span>.join( <span class="hljs-built_in">chr</span>(a^<span class="hljs-built_in">ord</span>(b)) <span class="hljs-keyword">for</span> a,b <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(x, nonce) ))<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">indows of thine age shall se</span><br><span class="hljs-string">eDespite of wrinkles this th</span><br><span class="hljs-string">y golden time.But if thou li</span><br><span class="hljs-string">buckeye&#123;some_say_somefish:)&#125;</span><br><span class="hljs-string">ve, rememberâ€™d not to be,D</span><br><span class="hljs-string">ie single, and thine image d</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><span class="hljs-comment"># buckeye&#123;some_say_somefish:)&#125;</span><br></code></pre></td></tr></table></figure>
<h3 id="quad-prime-rsa"><a class="markdownIt-Anchor" href="#quad-prime-rsa"></a> Quad prime RSA</h3>
<p>感谢这题让我了解到了连分数在渐进的应用。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> Crypto.Util.number <span class="hljs-keyword">as</span> cun<br><br>p = cun.getPrime(<span class="hljs-number">500</span>)<br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    q = cun.getPrime(<span class="hljs-number">1024</span>)<br>    r = q + <span class="hljs-number">2</span><br>    <span class="hljs-keyword">if</span> cun.isPrime(r):<br>        <span class="hljs-keyword">break</span><br><br>s = cun.getPrime(<span class="hljs-number">500</span>)<br><br>n_1 = p * q<br>n_2 = r * s<br><br>e = <span class="hljs-number">0x10001</span><br>d_1 = <span class="hljs-built_in">pow</span>(e, -<span class="hljs-number">1</span>, (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>))<br>d_2 = <span class="hljs-built_in">pow</span>(e, -<span class="hljs-number">1</span>, (r - <span class="hljs-number">1</span>) * (s - <span class="hljs-number">1</span>))<br><br>FLAG = cun.bytes_to_long(<span class="hljs-string">b&quot;buckeye&#123;??????????????????????????????????????????????????????????????????????&#125;&quot;</span>)<br>c_1 = <span class="hljs-built_in">pow</span>(FLAG, e, n_1)<br>c_2 = <span class="hljs-built_in">pow</span>(FLAG, e, n_2)<br><br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">pow</span>(c_1, d_1, n_1) == FLAG<br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">pow</span>(c_2, d_2, n_2) == FLAG<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;n_1 = <span class="hljs-subst">&#123;n_1&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;n_2 = <span class="hljs-subst">&#123;n_2&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;c_1 = <span class="hljs-subst">&#123;c_1&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;c_2 = <span class="hljs-subst">&#123;c_2&#125;</span>&quot;</span>)<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">Output:</span><br><span class="hljs-string">n_1 = ...</span><br><span class="hljs-string">n_2 = ...</span><br><span class="hljs-string">c_1 = ...</span><br><span class="hljs-string">c_2 = ...</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br></code></pre></td></tr></table></figure>
<p>在这题中。我们可以得到一个结论。</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><msub><mi>n</mi><mn>1</mn></msub><msub><mi>n</mi><mn>2</mn></msub></mfrac><mo>=</mo><mfrac><mrow><mi>p</mi><mi>q</mi></mrow><mrow><mi>r</mi><mi>s</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>p</mi><mi>q</mi></mrow><mrow><mo stretchy="false">(</mo><mi>q</mi><mo>+</mo><mn>2</mn><mo stretchy="false">)</mo><mi>s</mi></mrow></mfrac><mo>≈</mo><mfrac><mi>p</mi><mi>s</mi></mfrac></mrow><annotation encoding="application/x-tex">\frac{n_1}{n_2} = \frac{pq}{rs} = \frac{pq}{(q+2)s} \approx\frac{p}{s}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.94356em;vertical-align:-0.8360000000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1075599999999999em;"><span style="top:-2.3139999999999996em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8360000000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.7935599999999998em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1075599999999999em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">s</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.04356em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1075599999999999em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mclose">)</span><span class="mord mathdefault">s</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.7935599999999998em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1075599999999999em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">s</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>那么在这种情况下我们可以使用连分数逼近。当我们找到一个连分数可以整除n时。那么我们就找到了对于的p或s。这也是拓展维纳攻击的核心。</p>
<p>这一部分的学习还要深入，这题这次能做出来不过恰好我找到了对于的代码而已。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> functools <span class="hljs-keyword">import</span> reduce<br><br>e = <span class="hljs-number">0x10001</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">transform</span>(<span class="hljs-params">x, y</span>):  <span class="hljs-comment"># 使用辗转相除将分数x/y转为连分数的形式</span><br>    res = []<br>    <span class="hljs-keyword">while</span> y:<br>        res.append(x // y)<br>        x, y = y, x % y<br>    <span class="hljs-keyword">return</span> res<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">continued_fraction</span>(<span class="hljs-params">sub_res</span>):<br>    numerator, denominator = <span class="hljs-number">1</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> sub_res[::-<span class="hljs-number">1</span>]:  <span class="hljs-comment"># 从sublist的后面往前循环</span><br>        denominator, numerator = numerator, i * numerator + denominator<br>    <span class="hljs-keyword">return</span> denominator, numerator  <span class="hljs-comment"># 得到渐进分数的分母和分子，并返回</span><br><br><br><span class="hljs-comment"># 求解每个渐进分数</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sub_fraction</span>(<span class="hljs-params">x, y</span>):<br>    res = transform(x, y)<br>    res = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(continued_fraction, (res[<span class="hljs-number">0</span>:i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(res)))))  <span class="hljs-comment"># 将连分数的结果逐一截取以求渐进分数</span><br>    <span class="hljs-keyword">return</span> res<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">wienerAttack</span>(<span class="hljs-params">n1, n2</span>):<br>    <span class="hljs-keyword">for</span> (q2, q1) <span class="hljs-keyword">in</span> sub_fraction(n1, n2):  <span class="hljs-comment"># 用一个for循环来注意试探n1/n2的连续函数的渐进分数，直到找到一个满足条件的渐进分数</span><br>        <span class="hljs-keyword">if</span> q1 == <span class="hljs-number">0</span>:  <span class="hljs-comment"># 可能会出现连分数的第一个为0的情况，排除</span><br>            <span class="hljs-keyword">continue</span><br>        <span class="hljs-keyword">if</span> n1 % q1 == <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> q1 != <span class="hljs-number">1</span>:  <span class="hljs-comment"># 成立条件</span><br>            <span class="hljs-keyword">return</span> (q1, q2)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;该方法不适用&quot;</span>)<br><br><br>N1 = <span class="hljs-number">266809852588733960459210318535250490646048889879697803536547660295087424359820779393976863451605416209176605481092531427192244973818234584061601217275078124718647321303964372896579957241113145579972808278278954608305998030194591242728217565848616966569801983277471847623203839020048073235167290935033271661610383018423844098359553953309688771947405287750041234094613661142637202385185625562764531598181575409886288022595766239130646497218870729009410265665829</span><br>N2 = <span class="hljs-number">162770846172885672505993228924251587431051775841565579480252122266243384175644690129464185536426728823192871786769211412433986353757591946187394062238803937937524976383127543836820456373694506989663214797187169128841031021336535634504223477214378608536361140638630991101913240067113567904312920613401666068950970122803021942481265722772361891864873983041773234556100403992691699285653231918785862716655788924038111988473048448673976046224094362806858968008487</span><br>C = <span class="hljs-number">90243321527163164575722946503445690135626837887766380005026598963525611082629588259043528354383070032618085575636289795060005774441837004810039660583249401985643699988528916121171012387628009911281488352017086413266142218347595202655520785983898726521147649511514605526530453492704620682385035589372309167596680748613367540630010472990992841612002290955856795391675078590923226942740904916328445733366136324856838559878439853270981280663438572276140821766675</span><br>p,s = wienerAttack(N1, N2)<br><br>q = N1 // p<br>r = N2 // s<br><br><span class="hljs-built_in">print</span>(q,r)<br><br>d = <span class="hljs-built_in">pow</span>(e, -<span class="hljs-number">1</span>, (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>))<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">pow</span>(C,d,N1)))<br><br><span class="hljs-comment"># b&#x27;buckeye&#123;I_h0p3_y0u_us3D_c0nt1nu3d_fr4ct10Ns...th4nk5_d0R5A_f0r_th3_1nsp1r4t10n&#125;&#x27;</span><br><span class="hljs-comment"># buckeye&#123;I_h0p3_y0u_us3D_c0nt1nu3d_fr4ct10Ns...th4nk5_d0R5A_f0r_th3_1nsp1r4t10n&#125;</span><br></code></pre></td></tr></table></figure>
<h2 id="revserse"><a class="markdownIt-Anchor" href="#revserse"></a> Revserse</h2>
<h3 id="sinep"><a class="markdownIt-Anchor" href="#sinep"></a> sinep</h3>
<p>flag的加密值为0x111c0d0e150a0c151743053607502f1e10311544465c5f551e0e。</p>
<p>给的文件时加密算法。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> __cdecl <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span><br>&#123;<br>  <span class="hljs-type">int</span> result; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">size_t</span> v4; <span class="hljs-comment">// rbx</span><br>  _WORD v5[<span class="hljs-number">9</span>]; <span class="hljs-comment">// [rsp+1Ah] [rbp-26h] BYREF</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+2Ch] [rbp-14h]</span><br><br>  <span class="hljs-keyword">if</span> ( argc == <span class="hljs-number">2</span> )<br>  &#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Your plain text: %s\n&quot;</span>, argv[<span class="hljs-number">1</span>]);<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Applying Sinep Industry&#x27;s Certified unbreakable algorithm.&quot;</span>);<br>    <span class="hljs-built_in">strcpy</span>((<span class="hljs-type">char</span> *)v5, <span class="hljs-string">&quot;sinep&quot;</span>);<br>    *(_QWORD *)&amp;v5[<span class="hljs-number">3</span>] = argv[<span class="hljs-number">1</span>];<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Final: 0x&quot;</span>);<br>    <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; ; ++i )<br>    &#123;<br>      v4 = i;<br>      <span class="hljs-keyword">if</span> ( v4 &gt;= <span class="hljs-built_in">strlen</span>(*(<span class="hljs-type">const</span> <span class="hljs-type">char</span> **)&amp;v5[<span class="hljs-number">3</span>]) )<br>        <span class="hljs-keyword">break</span>;<br>      *(_BYTE *)(i + *(_QWORD *)&amp;v5[<span class="hljs-number">3</span>]) ^= *((_BYTE *)v5 + i % <span class="hljs-number">5</span>);<br>      <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%02x&quot;</span>, (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)*(<span class="hljs-type">char</span> *)(i + *(_QWORD *)&amp;v5[<span class="hljs-number">3</span>]));<br>    &#125;<br>    <span class="hljs-built_in">putchar</span>(<span class="hljs-number">10</span>);<br>    result = <span class="hljs-number">0</span>;<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Please enter the text to apply Sinep&#x27;s patented algorithm.&quot;</span>);<br>    result = <span class="hljs-number">1</span>;<br>  &#125;<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>其实就是用一个key做异或加密。key是sinep。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.strxor <span class="hljs-keyword">import</span> strxor<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>target = long_to_bytes(<span class="hljs-number">0x111c0d0e150a0c151743053607502f1e10311544465c5f551e0e</span>)<br>key = <span class="hljs-string">b&quot;sinep&quot;</span><br><br><span class="hljs-built_in">print</span>(strxor((key*<span class="hljs-number">6</span>)[:<span class="hljs-built_in">len</span>(target)], target))<br><br><span class="hljs-comment"># b&#x27;buckeye&#123;r3v_i5_my_p45510n&#125;&#x27;</span><br><span class="hljs-comment"># buckeye&#123;r3v_i5_my_p45510n&#125;</span><br></code></pre></td></tr></table></figure>
<h3 id="soda"><a class="markdownIt-Anchor" href="#soda"></a> soda</h3>
<p>很有意思的一题。</p>
<p>反编译的文件比较长这里就不放出来了。符号表都在，简单看看看到了printflag这个函数。从这个函数出发来找那个地方调用了。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">retrieve</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-type">int</span> <span class="hljs-variable">var1</span> <span class="hljs-operator">=</span> -<span class="hljs-number">1</span>;<br>      <span class="hljs-type">float</span> <span class="hljs-variable">var2</span> <span class="hljs-operator">=</span> -<span class="hljs-number">1.0F</span>;<br><br>      <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">var3</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; var3 &lt; <span class="hljs-number">12</span>; ++var3) &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.drinks[var3].status != soda.Drink.DrinkStatus.EMPTY &amp;&amp; <span class="hljs-built_in">this</span>.drinks[var3].cost &gt; var2) &#123;<br>          var1 = var3;<br>          var2 = <span class="hljs-built_in">this</span>.drinks[var3].cost;<br>        &#125;<br>      &#125;<br><br>      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.drinks[var1].status == soda.Drink.DrinkStatus.DROPPED) &#123;<br>        soda.printFlag();<br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;&gt;&gt; No flags in here... was the prophecy a lie...?&quot;</span>);<br>      &#125;<br><br>    &#125;<br></code></pre></td></tr></table></figure>
<p>在retrive中我们调用了printflag。得到flag的要求是，var1指向的饮料的状态是掉落的（这里还有一个状态是空，空和掉落是不一样的。这个就要求了这个必须是我们买到的才有dropped状态）。而var1是由上面的for循环指定的。这个循环是将var1指向到饮料机里面最贵的饮料。所以我们必须要买最贵的饮料才能得到flag。</p>
<p>看看怎么进入retrieve这个函数。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (var1[<span class="hljs-number">0</span>].equalsIgnoreCase(<span class="hljs-string">&quot;grab&quot;</span>)) &#123;<br>  <span class="hljs-keyword">if</span> (var0.dropped &gt; <span class="hljs-number">0</span>) &#123;<br>    System.out.println(<span class="hljs-string">&quot;&gt;&gt; Alright!! Let&#x27;s see what I got!&quot;</span>);<br>    var0.retrieve();<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    System.out.println(<span class="hljs-string">&quot;&gt;&gt; There&#x27;s nothing to grab...&quot;</span>);<br>  &#125;<br></code></pre></td></tr></table></figure>
<p>要求我们输入&quot;grab&quot;指令并且要有掉落的饮料才可进入。</p>
<p>那么这个drop要怎么修改呢。我们接着跟踪。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java">&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (var1[<span class="hljs-number">0</span>].equalsIgnoreCase(<span class="hljs-string">&quot;reach&quot;</span>)) &#123;<br>       <span class="hljs-keyword">if</span> (bystanders) &#123;<br>         System.out.println(<span class="hljs-string">&quot;&gt;&gt; I can&#x27;t do that with people around!\n&gt;&gt; They&#x27;ll think I&#x27;m stealing!&quot;</span>);<br>       &#125; <span class="hljs-keyword">else</span> &#123;<br>         var6 = var0.reach();<br>         var0.dropped += var6;<br>         <span class="hljs-keyword">if</span> (var6 &gt; <span class="hljs-number">0</span>) &#123;<br>           System.out.println(<span class="hljs-string">&quot;&gt;&gt; Ok, here goes... gonna reach through the door and try to knock it down...&quot;</span>);<br>           pause(<span class="hljs-number">3</span>);<br>           System.out.println(<span class="hljs-string">&quot;&gt;&gt; !!! I heard something fall!&quot;</span>);<br>         &#125; <span class="hljs-keyword">else</span> &#123;<br>           System.out.println(<span class="hljs-string">&quot;&gt;&gt; There&#x27;s nothing to reach for&quot;</span>);<br>         &#125;<br>       &#125;<br></code></pre></td></tr></table></figure>
<p>只有这个reach函数能增加dropped。那么进入这个代码块的条件是bystanders为false。而且还和reach的返回值有关。我们先看看reach函数是怎么样的，</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">reach</span><span class="hljs-params">()</span> &#123;<br>  <span class="hljs-type">int</span> <span class="hljs-variable">var1</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br><br>  <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">var2</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; var2 &lt; <span class="hljs-number">12</span>; ++var2) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.drinks[var2].status == soda.Drink.DrinkStatus.STUCK &amp;&amp; <span class="hljs-built_in">this</span>.drinks[var2].stuck == <span class="hljs-number">0</span>) &#123;<br>      <span class="hljs-built_in">this</span>.drinks[var2].status = soda.Drink.DrinkStatus.DROPPED;<br>      ++var1;<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">return</span> var1;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>要求饮料必须为STUCK状态，并且stuck的值为0，我们才能返回一个一个非0的值。</p>
<p>这个stuck在饮料初始化的时候，被初始化为3。我们来看看哪里可以减小这个值。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">tap</span><span class="hljs-params">()</span> &#123;<br>  <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">var1</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; var1 &lt; <span class="hljs-number">12</span>; ++var1) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.drinks[var1].status == soda.Drink.DrinkStatus.STUCK &amp;&amp; <span class="hljs-built_in">this</span>.drinks[var1].stuck &gt; <span class="hljs-number">0</span>) &#123;<br>      --<span class="hljs-built_in">this</span>.drinks[var1].stuck;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>当饮料为STUCK时，并且stuck不为0则可以用tap来减小stuck。</p>
<p>那么我们现在就剩下最后一个bystanders没有解决了。看看哪里有引用。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java">&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (var1[<span class="hljs-number">0</span>].equalsIgnoreCase(<span class="hljs-string">&quot;wait&quot;</span>)) &#123;<br>  <span class="hljs-type">boolean</span> <span class="hljs-variable">var2</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;<br><br>  <span class="hljs-keyword">try</span> &#123;<br>    var6 = Integer.parseInt(var1[<span class="hljs-number">1</span>]);<br>  &#125; <span class="hljs-keyword">catch</span> (Exception var5) &#123;<br>    System.out.println(<span class="hljs-string">&quot;&gt;&gt; Not sure what you mean&quot;</span>);<br>    <span class="hljs-keyword">return</span>;<br>  &#125;<br><br>  pause(var6);<br>  <span class="hljs-keyword">if</span> (var6 &gt;= <span class="hljs-number">10</span>) &#123;<br>    bystanders = <span class="hljs-literal">false</span>;<br>    System.out.println(<span class="hljs-string">&quot;&gt;&gt; ...Looks like nobody&#x27;s around...&quot;</span>);<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    bystanders = <span class="hljs-literal">true</span>;<br>    System.out.println(<span class="hljs-string">&quot;&gt;&gt; People are walking down the street.&quot;</span>);<br>  &#125;<br></code></pre></td></tr></table></figure>
<p>var6是我们输入wait后面跟的时间长度。所以我们只要wait 10秒以上就可以将bystander置为false了。</p>
<p>所以总体的上的流程就是：</p>
<p>买最贵的饮料，拍三次饮料机，够到饮料，拿取饮料即可。</p>
<p>这题还有个问题就是我们只有5块钱。但是有的时候能买的最贵的饮料要大于五块钱。所以我们就多开几次题目，直到遇到最贵的饮料是我们可以买的即可。</p>
<figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs erlang-repl">command&gt; grab<br>&gt;&gt; Alright!! Let&#x27;s see what I got!<br>&gt;&gt; WOAH!! There&#x27;s a flag in here!!<br>buckeye&#123;w3_c411_7h3_s7uff_<span class="hljs-string">&quot;p0p&quot;</span>_h3r3&#125;<br><br># buckeye&#123;w3_c411_7h3_s7uff_<span class="hljs-string">&quot;p0p&quot;</span>_h3r3&#125;<br></code></pre></td></tr></table></figure>
<!-- flag of hidden posts -->
            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/CTF/">CTF</a>
                    
                      <a class="hover-with-bg" href="/tags/writeup/">writeup</a>
                    
                      <a class="hover-with-bg" href="/tags/Crypto/">Crypto</a>
                    
                      <a class="hover-with-bg" href="/tags/Reverse/">Reverse</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  
  <div class="statistics">
    
    

    
      
        <!-- 不蒜子统计PV -->
        <span id="busuanzi_container_site_pv" style="display: none">
            总访问量 
            <span id="busuanzi_value_site_pv"></span>
             次
          </span>
      
      
        <!-- 不蒜子统计UV -->
        <span id="busuanzi_container_site_uv" style="display: none">
            总访客数 
            <span id="busuanzi_value_site_uv"></span>
             人
          </span>
      
    
  </div>


  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  <script  src="/js/local-search.js" ></script>



  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  
    <script  src="https://cdn.jsdelivr.net/npm/tocbot@4/dist/tocbot.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4/anchor.min.js" ></script>
  
  
    <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" ></script>
  



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
        typing(title);
      
    })(window, document);
  </script>





  

  
    <!-- KaTeX -->
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0/dist/katex.min.css" />
  











<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


</body>
</html>
